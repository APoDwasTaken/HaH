(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.io=e()}})(function(){var e,t,r;return function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){var c=typeof require=="function"&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};t[a][0].call(l.exports,function(e){var r=t[a][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[a].exports}var o=typeof require=="function"&&require;for(var a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){t.exports=e("./lib/")},{"./lib/":2}],2:[function(e,t,r){t.exports=e("./socket");t.exports.parser=e("engine.io-parser")},{"./socket":3,"engine.io-parser":19}],3:[function(e,t,r){(function(r){var n=e("./transports");var i=e("component-emitter");var o=e("debug")("engine.io-client:socket");var a=e("indexof");var s=e("engine.io-parser");var c=e("parseuri");var u=e("parsejson");var l=e("parseqs");t.exports=f;function h(){}function f(e,t){if(!(this instanceof f))return new f(e,t);t=t||{};if(e&&"object"==typeof e){t=e;e=null}if(e){e=c(e);t.hostname=e.host;t.secure=e.protocol=="https"||e.protocol=="wss";t.port=e.port;if(e.query)t.query=e.query}else if(t.host){t.hostname=c(t.host).host}this.secure=null!=t.secure?t.secure:r.location&&"https:"==location.protocol;if(t.hostname&&!t.port){t.port=this.secure?"443":"80"}this.agent=t.agent||false;this.hostname=t.hostname||(r.location?location.hostname:"localhost");this.port=t.port||(r.location&&location.port?location.port:this.secure?443:80);this.query=t.query||{};if("string"==typeof this.query)this.query=l.decode(this.query);this.upgrade=false!==t.upgrade;this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!t.forceJSONP;this.jsonp=false!==t.jsonp;this.forceBase64=!!t.forceBase64;this.enablesXDR=!!t.enablesXDR;this.timestampParam=t.timestampParam||"t";this.timestampRequests=t.timestampRequests;this.transports=t.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.policyPort=t.policyPort||843;this.rememberUpgrade=t.rememberUpgrade||false;this.binaryType=null;this.onlyBinaryUpgrades=t.onlyBinaryUpgrades;this.perMessageDeflate=false!==t.perMessageDeflate?t.perMessageDeflate||{}:false;if(true===this.perMessageDeflate)this.perMessageDeflate={};if(this.perMessageDeflate&&null==this.perMessageDeflate.threshold){this.perMessageDeflate.threshold=1024}this.pfx=t.pfx||null;this.key=t.key||null;this.passphrase=t.passphrase||null;this.cert=t.cert||null;this.ca=t.ca||null;this.ciphers=t.ciphers||null;this.rejectUnauthorized=t.rejectUnauthorized===undefined?null:t.rejectUnauthorized;var n=typeof r=="object"&&r;if(n.global===n){if(t.extraHeaders&&Object.keys(t.extraHeaders).length>0){this.extraHeaders=t.extraHeaders}}this.open()}f.priorWebsocketSuccess=false;i(f.prototype);f.protocol=s.protocol;f.Socket=f;f.Transport=e("./transport");f.transports=e("./transports");f.parser=e("engine.io-parser");f.prototype.createTransport=function(e){o('creating transport "%s"',e);var t=p(this.query);t.EIO=s.protocol;t.transport=e;if(this.id)t.sid=this.id;var r=new n[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders});return r};function p(e){var t={};for(var r in e){if(e.hasOwnProperty(r)){t[r]=e[r]}}return t}f.prototype.open=function(){var e;if(this.rememberUpgrade&&f.priorWebsocketSuccess&&this.transports.indexOf("websocket")!=-1){e="websocket"}else if(0===this.transports.length){var t=this;setTimeout(function(){t.emit("error","No transports available")},0);return}else{e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){this.transports.shift();this.open();return}e.open();this.setTransport(e)};f.prototype.setTransport=function(e){o("setting transport %s",e.name);var t=this;if(this.transport){o("clearing existing transport %s",this.transport.name);this.transport.removeAllListeners()}this.transport=e;e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})};f.prototype.probe=function(e){o('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),r=false,n=this;f.priorWebsocketSuccess=false;function i(){if(n.onlyBinaryUpgrades){var i=!this.supportsBinary&&n.transport.supportsBinary;r=r||i}if(r)return;o('probe transport "%s" opened',e);t.send([{type:"ping",data:"probe"}]);t.once("packet",function(i){if(r)return;if("pong"==i.type&&"probe"==i.data){o('probe transport "%s" pong',e);n.upgrading=true;n.emit("upgrading",t);if(!t)return;f.priorWebsocketSuccess="websocket"==t.name;o('pausing current transport "%s"',n.transport.name);n.transport.pause(function(){if(r)return;if("closed"==n.readyState)return;o("changing transport and sending upgrade packet");h();n.setTransport(t);t.send([{type:"upgrade"}]);n.emit("upgrade",t);t=null;n.upgrading=false;n.flush()})}else{o('probe transport "%s" failed',e);var a=new Error("probe error");a.transport=t.name;n.emit("upgradeError",a)}})}function a(){if(r)return;r=true;h();t.close();t=null}function s(r){var i=new Error("probe error: "+r);i.transport=t.name;a();o('probe transport "%s" failed because of error: %s',e,r);n.emit("upgradeError",i)}function c(){s("transport closed")}function u(){s("socket closed")}function l(e){if(t&&e.name!=t.name){o('"%s" works - aborting "%s"',e.name,t.name);a()}}function h(){t.removeListener("open",i);t.removeListener("error",s);t.removeListener("close",c);n.removeListener("close",u);n.removeListener("upgrading",l)}t.once("open",i);t.once("error",s);t.once("close",c);this.once("close",u);this.once("upgrading",l);t.open()};f.prototype.onOpen=function(){o("socket open");this.readyState="open";f.priorWebsocketSuccess="websocket"==this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++){this.probe(this.upgrades[e])}}};f.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState){o('socket receive: type "%s", data "%s"',e.type,e.data);this.emit("packet",e);this.emit("heartbeat");switch(e.type){case"open":this.onHandshake(u(e.data));break;case"pong":this.setPing();this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data;this.onError(t);break;case"message":this.emit("data",e.data);this.emit("message",e.data);break}}else{o('packet received with socket readyState "%s"',this.readyState)}};f.prototype.onHandshake=function(e){this.emit("handshake",e);this.id=e.sid;this.transport.query.sid=e.sid;this.upgrades=this.filterUpgrades(e.upgrades);this.pingInterval=e.pingInterval;this.pingTimeout=e.pingTimeout;this.onOpen();if("closed"==this.readyState)return;this.setPing();this.removeListener("heartbeat",this.onHeartbeat);this.on("heartbeat",this.onHeartbeat)};f.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){if("closed"==t.readyState)return;t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)};f.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer);e.pingIntervalTimer=setTimeout(function(){o("writing ping packet - expecting pong within %sms",e.pingTimeout);e.ping();e.onHeartbeat(e.pingTimeout)},e.pingInterval)};f.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})};f.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;if(0===this.writeBuffer.length){this.emit("drain")}else{this.flush()}};f.prototype.flush=function(){if("closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){o("flushing %d packets in socket",this.writeBuffer.length);this.transport.send(this.writeBuffer);this.prevBufferLen=this.writeBuffer.length;this.emit("flush")}};f.prototype.write=f.prototype.send=function(e,t,r){this.sendPacket("message",e,t,r);return this};f.prototype.sendPacket=function(e,t,r,n){if("function"==typeof t){n=t;t=undefined}if("function"==typeof r){n=r;r=null}if("closing"==this.readyState||"closed"==this.readyState){return}r=r||{};r.compress=false!==r.compress;var i={type:e,data:t,options:r};this.emit("packetCreate",i);this.writeBuffer.push(i);if(n)this.once("flush",n);this.flush()};f.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var e=this;if(this.writeBuffer.length){this.once("drain",function(){if(this.upgrading){n()}else{t()}})}else if(this.upgrading){n()}else{t()}}function t(){e.onClose("forced close");o("socket closing - telling transport to close");e.transport.close()}function r(){e.removeListener("upgrade",r);e.removeListener("upgradeError",r);t()}function n(){e.once("upgrade",r);e.once("upgradeError",r)}return this};f.prototype.onError=function(e){o("socket error %j",e);f.priorWebsocketSuccess=false;this.emit("error",e);this.onClose("transport error",e)};f.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){o('socket close with reason: "%s"',e);var r=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",e,t);r.writeBuffer=[];r.prevBufferLen=0}};f.prototype.filterUpgrades=function(e){var t=[];for(var r=0,n=e.length;r<n;r++){if(~a(this.transports,e[r]))t.push(e[r])}return t}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{"./transport":4,"./transports":5,"component-emitter":15,debug:17,"engine.io-parser":19,indexof:23,parsejson:26,parseqs:27,parseuri:28}],4:[function(e,t,r){var n=e("engine.io-parser");var i=e("component-emitter");t.exports=o;function o(e){this.path=e.path;this.hostname=e.hostname;this.port=e.port;this.secure=e.secure;this.query=e.query;this.timestampParam=e.timestampParam;this.timestampRequests=e.timestampRequests;this.readyState="";this.agent=e.agent||false;this.socket=e.socket;this.enablesXDR=e.enablesXDR;this.pfx=e.pfx;this.key=e.key;this.passphrase=e.passphrase;this.cert=e.cert;this.ca=e.ca;this.ciphers=e.ciphers;this.rejectUnauthorized=e.rejectUnauthorized;this.extraHeaders=e.extraHeaders}i(o.prototype);o.prototype.onError=function(e,t){var r=new Error(e);r.type="TransportError";r.description=t;this.emit("error",r);return this};o.prototype.open=function(){if("closed"==this.readyState||""==this.readyState){this.readyState="opening";this.doOpen()}return this};o.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){this.doClose();this.onClose()}return this};o.prototype.send=function(e){if("open"==this.readyState){this.write(e)}else{throw new Error("Transport not open")}};o.prototype.onOpen=function(){this.readyState="open";this.writable=true;this.emit("open")};o.prototype.onData=function(e){var t=n.decodePacket(e,this.socket.binaryType);this.onPacket(t)};o.prototype.onPacket=function(e){this.emit("packet",e)};o.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":15,"engine.io-parser":19}],5:[function(e,t,r){(function(t){var n=e("xmlhttprequest-ssl");var i=e("./polling-xhr");var o=e("./polling-jsonp");var a=e("./websocket");r.polling=s;r.websocket=a;function s(e){var r;var a=false;var s=false;var c=false!==e.jsonp;if(t.location){var u="https:"==location.protocol;var l=location.port;if(!l){l=u?443:80}a=e.hostname!=location.hostname||l!=e.port;s=e.secure!=u}e.xdomain=a;e.xscheme=s;r=new n(e);if("open"in r&&!e.forceJSONP){return new i(e)}else{if(!c)throw new Error("JSONP disabled");return new o(e)}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{"./polling-jsonp":6,"./polling-xhr":7,"./websocket":9,"xmlhttprequest-ssl":10}],6:[function(e,t,r){(function(r){var n=e("./polling");var i=e("component-inherit");t.exports=l;var o=/\n/g;var a=/\\n/g;var s;var c=0;function u(){}function l(e){n.call(this,e);this.query=this.query||{};if(!s){if(!r.___eio)r.___eio=[];s=r.___eio}this.index=s.length;var t=this;s.push(function(e){t.onData(e)});this.query.j=this.index;if(r.document&&r.addEventListener){r.addEventListener("beforeunload",function(){if(t.script)t.script.onerror=u},false)}}i(l,n);l.prototype.supportsBinary=false;l.prototype.doClose=function(){if(this.script){this.script.parentNode.removeChild(this.script);this.script=null}if(this.form){this.form.parentNode.removeChild(this.form);this.form=null;this.iframe=null}n.prototype.doClose.call(this)};l.prototype.doPoll=function(){var e=this;var t=document.createElement("script");if(this.script){this.script.parentNode.removeChild(this.script);this.script=null}t.async=true;t.src=this.uri();t.onerror=function(t){e.onError("jsonp poll error",t)};var r=document.getElementsByTagName("script")[0];if(r){r.parentNode.insertBefore(t,r)}else{(document.head||document.body).appendChild(t)}this.script=t;var n="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);if(n){setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e);document.body.removeChild(e)},100)}};l.prototype.doWrite=function(e,t){var r=this;if(!this.form){var n=document.createElement("form");var i=document.createElement("textarea");var s=this.iframeId="eio_iframe_"+this.index;var c;n.className="socketio";n.style.position="absolute";n.style.top="-1000px";n.style.left="-1000px";n.target=s;n.method="POST";n.setAttribute("accept-charset","utf-8");i.name="d";n.appendChild(i);document.body.appendChild(n);this.form=n;this.area=i}this.form.action=this.uri();function u(){l();t()}function l(){if(r.iframe){try{r.form.removeChild(r.iframe)}catch(e){r.onError("jsonp polling iframe removal error",e)}}try{var e='<iframe src="javascript:0" name="'+r.iframeId+'">';c=document.createElement(e)}catch(e){c=document.createElement("iframe");c.name=r.iframeId;c.src="javascript:0"}c.id=r.iframeId;r.form.appendChild(c);r.iframe=c}l();e=e.replace(a,"\\\n");this.area.value=e.replace(o,"\\n");try{this.form.submit()}catch(e){}if(this.iframe.attachEvent){this.iframe.onreadystatechange=function(){if(r.iframe.readyState=="complete"){u()}}}else{this.iframe.onload=u}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{"./polling":8,"component-inherit":16}],7:[function(e,t,r){(function(r){var n=e("xmlhttprequest-ssl");var i=e("./polling");var o=e("component-emitter");var a=e("component-inherit");var s=e("debug")("engine.io-client:polling-xhr");t.exports=u;t.exports.Request=l;function c(){}function u(e){i.call(this,e);if(r.location){var t="https:"==location.protocol;var n=location.port;if(!n){n=t?443:80}this.xd=e.hostname!=r.location.hostname||n!=e.port;this.xs=e.secure!=t}else{this.extraHeaders=e.extraHeaders}}a(u,i);u.prototype.supportsBinary=true;u.prototype.request=function(e){e=e||{};e.uri=this.uri();e.xd=this.xd;e.xs=this.xs;e.agent=this.agent||false;e.supportsBinary=this.supportsBinary;e.enablesXDR=this.enablesXDR;e.pfx=this.pfx;e.key=this.key;e.passphrase=this.passphrase;e.cert=this.cert;e.ca=this.ca;e.ciphers=this.ciphers;e.rejectUnauthorized=this.rejectUnauthorized;e.extraHeaders=this.extraHeaders;return new l(e)};u.prototype.doWrite=function(e,t){var r=typeof e!=="string"&&e!==undefined;var n=this.request({method:"POST",data:e,isBinary:r});var i=this;n.on("success",t);n.on("error",function(e){i.onError("xhr post error",e)});this.sendXhr=n};u.prototype.doPoll=function(){s("xhr poll");var e=this.request();var t=this;e.on("data",function(e){t.onData(e)});e.on("error",function(e){t.onError("xhr poll error",e)});this.pollXhr=e};function l(e){this.method=e.method||"GET";this.uri=e.uri;this.xd=!!e.xd;this.xs=!!e.xs;this.async=false!==e.async;this.data=undefined!=e.data?e.data:null;this.agent=e.agent;this.isBinary=e.isBinary;this.supportsBinary=e.supportsBinary;this.enablesXDR=e.enablesXDR;this.pfx=e.pfx;this.key=e.key;this.passphrase=e.passphrase;this.cert=e.cert;this.ca=e.ca;this.ciphers=e.ciphers;this.rejectUnauthorized=e.rejectUnauthorized;this.extraHeaders=e.extraHeaders;this.create()}o(l.prototype);l.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx;e.key=this.key;e.passphrase=this.passphrase;e.cert=this.cert;e.ca=this.ca;e.ciphers=this.ciphers;e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new n(e);var i=this;try{s("xhr open %s: %s",this.method,this.uri);t.open(this.method,this.uri,this.async);try{if(this.extraHeaders){t.setDisableHeaderCheck(true);for(var o in this.extraHeaders){if(this.extraHeaders.hasOwnProperty(o)){t.setRequestHeader(o,this.extraHeaders[o])}}}}catch(e){}if(this.supportsBinary){t.responseType="arraybuffer"}if("POST"==this.method){try{if(this.isBinary){t.setRequestHeader("Content-type","application/octet-stream")}else{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}}catch(e){}}if("withCredentials"in t){t.withCredentials=true}if(this.hasXDR()){t.onload=function(){i.onLoad()};t.onerror=function(){i.onError(t.responseText)}}else{t.onreadystatechange=function(){if(4!=t.readyState)return;if(200==t.status||1223==t.status){i.onLoad()}else{setTimeout(function(){i.onError(t.status)},0)}}}s("xhr data %s",this.data);t.send(this.data)}catch(e){setTimeout(function(){i.onError(e)},0);return}if(r.document){this.index=l.requestsCount++;l.requests[this.index]=this}};l.prototype.onSuccess=function(){this.emit("success");this.cleanup()};l.prototype.onData=function(e){this.emit("data",e);this.onSuccess()};l.prototype.onError=function(e){this.emit("error",e);this.cleanup(true)};l.prototype.cleanup=function(e){if("undefined"==typeof this.xhr||null===this.xhr){return}if(this.hasXDR()){this.xhr.onload=this.xhr.onerror=c}else{this.xhr.onreadystatechange=c}if(e){try{this.xhr.abort()}catch(e){}}if(r.document){delete l.requests[this.index]}this.xhr=null};l.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}if(t==="application/octet-stream"){e=this.xhr.response}else{if(!this.supportsBinary){e=this.xhr.responseText}else{try{e=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(t){var r=new Uint8Array(this.xhr.response);var n=[];for(var i=0,o=r.length;i<o;i++){n.push(r[i])}e=String.fromCharCode.apply(null,n)}}}}catch(e){this.onError(e)}if(null!=e){this.onData(e)}};l.prototype.hasXDR=function(){return"undefined"!==typeof r.XDomainRequest&&!this.xs&&this.enablesXDR};l.prototype.abort=function(){this.cleanup()};if(r.document){l.requestsCount=0;l.requests={};if(r.attachEvent){r.attachEvent("onunload",h)}else if(r.addEventListener){r.addEventListener("beforeunload",h,false)}}function h(){for(var e in l.requests){if(l.requests.hasOwnProperty(e)){l.requests[e].abort()}}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{"./polling":8,"component-emitter":15,"component-inherit":16,debug:17,"xmlhttprequest-ssl":10}],8:[function(e,t,r){var n=e("../transport");var i=e("parseqs");var o=e("engine.io-parser");var a=e("component-inherit");var s=e("yeast");var c=e("debug")("engine.io-client:polling");t.exports=l;var u=function(){var t=e("xmlhttprequest-ssl");var r=new t({xdomain:false});return null!=r.responseType}();function l(e){var t=e&&e.forceBase64;if(!u||t){this.supportsBinary=false}n.call(this,e)}a(l,n);l.prototype.name="polling";l.prototype.doOpen=function(){this.poll()};l.prototype.pause=function(e){var t=0;var r=this;this.readyState="pausing";function n(){c("paused");r.readyState="paused";e()}if(this.polling||!this.writable){var i=0;if(this.polling){c("we are currently polling - waiting to pause");i++;this.once("pollComplete",function(){c("pre-pause polling complete");--i||n()})}if(!this.writable){c("we are currently writing - waiting to pause");i++;this.once("drain",function(){c("pre-pause writing complete");--i||n()})}}else{n()}};l.prototype.poll=function(){c("polling");this.polling=true;this.doPoll();this.emit("poll")};l.prototype.onData=function(e){var t=this;c("polling got data %s",e);var r=function(e,r,n){if("opening"==t.readyState){t.onOpen()}if("close"==e.type){t.onClose();return false}t.onPacket(e)};o.decodePayload(e,this.socket.binaryType,r);if("closed"!=this.readyState){this.polling=false;this.emit("pollComplete");if("open"==this.readyState){this.poll()}else{c('ignoring poll - transport state "%s"',this.readyState)}}};l.prototype.doClose=function(){var e=this;function t(){c("writing close packet");e.write([{type:"close"}])}if("open"==this.readyState){c("transport open - closing");t()}else{c("transport not open - deferring close");this.once("open",t)}};l.prototype.write=function(e){var t=this;this.writable=false;var r=function(){t.writable=true;t.emit("drain")};var t=this;o.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,r)})};l.prototype.uri=function(){var e=this.query||{};var t=this.secure?"https":"http";var r="";if(false!==this.timestampRequests){e[this.timestampParam]=s()}if(!this.supportsBinary&&!e.sid){e.b64=1}e=i.encode(e);if(this.port&&("https"==t&&this.port!=443||"http"==t&&this.port!=80)){r=":"+this.port}if(e.length){e="?"+e}var n=this.hostname.indexOf(":")!==-1;return t+"://"+(n?"["+this.hostname+"]":this.hostname)+r+this.path+e}},{"../transport":4,"component-inherit":16,debug:17,"engine.io-parser":19,parseqs:27,"xmlhttprequest-ssl":10,yeast:30}],9:[function(e,t,r){(function(r){var n=e("../transport");var i=e("engine.io-parser");var o=e("parseqs");var a=e("component-inherit");var s=e("yeast");var c=e("debug")("engine.io-client:websocket");var u=r.WebSocket||r.MozWebSocket;var l=u;if(!l&&typeof window==="undefined"){try{l=e("ws")}catch(e){}}t.exports=h;function h(e){var t=e&&e.forceBase64;if(t){this.supportsBinary=false}this.perMessageDeflate=e.perMessageDeflate;n.call(this,e)}a(h,n);h.prototype.name="websocket";h.prototype.supportsBinary=true;h.prototype.doOpen=function(){if(!this.check()){return}var e=this;var t=this.uri();var r=void 0;var n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx;n.key=this.key;n.passphrase=this.passphrase;n.cert=this.cert;n.ca=this.ca;n.ciphers=this.ciphers;n.rejectUnauthorized=this.rejectUnauthorized;if(this.extraHeaders){n.headers=this.extraHeaders}this.ws=u?new l(t):new l(t,r,n);if(this.ws.binaryType===undefined){this.supportsBinary=false}if(this.ws.supports&&this.ws.supports.binary){this.supportsBinary=true;this.ws.binaryType="buffer"}else{this.ws.binaryType="arraybuffer"}this.addEventListeners()};h.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()};this.ws.onclose=function(){e.onClose()};this.ws.onmessage=function(t){e.onData(t.data)};this.ws.onerror=function(t){e.onError("websocket error",t)}};if("undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)){h.prototype.onData=function(e){var t=this;setTimeout(function(){n.prototype.onData.call(t,e)},0)}}h.prototype.write=function(e){var t=this;this.writable=false;var n=e.length;for(var o=0,a=n;o<a;o++){(function(e){i.encodePacket(e,t.supportsBinary,function(i){if(!u){var o={};if(e.options){o.compress=e.options.compress}if(t.perMessageDeflate){var a="string"==typeof i?r.Buffer.byteLength(i):i.length;if(a<t.perMessageDeflate.threshold){o.compress=false}}}try{if(u){t.ws.send(i)}else{t.ws.send(i,o)}}catch(e){c("websocket closed before onclose event")}--n||s()})})(e[o])}function s(){t.emit("flush");setTimeout(function(){t.writable=true;t.emit("drain")},0)}};h.prototype.onClose=function(){n.prototype.onClose.call(this)};h.prototype.doClose=function(){if(typeof this.ws!=="undefined"){this.ws.close()}};h.prototype.uri=function(){var e=this.query||{};var t=this.secure?"wss":"ws";var r="";if(this.port&&("wss"==t&&this.port!=443||"ws"==t&&this.port!=80)){r=":"+this.port}if(this.timestampRequests){e[this.timestampParam]=s()}if(!this.supportsBinary){e.b64=1}e=o.encode(e);if(e.length){e="?"+e}var n=this.hostname.indexOf(":")!==-1;return t+"://"+(n?"["+this.hostname+"]":this.hostname)+r+this.path+e};h.prototype.check=function(){return!!l&&!("__initialize"in l&&this.name===h.prototype.name)}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{"../transport":4,"component-inherit":16,debug:17,"engine.io-parser":19,parseqs:27,ws:undefined,yeast:30}],10:[function(e,t,r){var n=e("has-cors");t.exports=function(e){var t=e.xdomain;var r=e.xscheme;var i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||n)){return new XMLHttpRequest}}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!r&&i){return new XDomainRequest}}catch(e){}if(!t){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}}},{"has-cors":22}],11:[function(e,t,r){t.exports=n;function n(e,t,r){var n=false;r=r||i;o.count=e;return e===0?t():o;function o(e,i){if(o.count<=0){throw new Error("after called too many times")}--o.count;if(e){n=true;t(e);t=r}else if(o.count===0&&!n){t(null,i)}}}function i(){}},{}],12:[function(e,t,r){t.exports=function(e,t,r){var n=e.byteLength;t=t||0;r=r||n;if(e.slice){return e.slice(t,r)}if(t<0){t+=n}if(r<0){r+=n}if(r>n){r=n}if(t>=n||t>=r||n===0){return new ArrayBuffer(0)}var i=new Uint8Array(e);var o=new Uint8Array(r-t);for(var a=t,s=0;a<r;a++,s++){o[s]=i[a]}return o.buffer}},{}],13:[function(e,t,r){(function(e){"use strict";r.encode=function(t){var r=new Uint8Array(t),n,i=r.length,o="";for(n=0;n<i;n+=3){o+=e[r[n]>>2];o+=e[(r[n]&3)<<4|r[n+1]>>4];o+=e[(r[n+1]&15)<<2|r[n+2]>>6];o+=e[r[n+2]&63]}if(i%3===2){o=o.substring(0,o.length-1)+"="}else if(i%3===1){o=o.substring(0,o.length-2)+"=="}return o};r.decode=function(t){var r=t.length*.75,n=t.length,i,o=0,a,s,c,u;if(t[t.length-1]==="="){r--;if(t[t.length-2]==="="){r--}}var l=new ArrayBuffer(r),h=new Uint8Array(l);for(i=0;i<n;i+=4){a=e.indexOf(t[i]);s=e.indexOf(t[i+1]);c=e.indexOf(t[i+2]);u=e.indexOf(t[i+3]);h[o++]=a<<2|s>>4;h[o++]=(s&15)<<4|c>>2;h[o++]=(c&3)<<6|u&63}return l}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],14:[function(e,t,r){(function(e){var r=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder;var n=function(){try{var e=new Blob(["hi"]);return e.size===2}catch(e){return false}}();var i=n&&function(){try{var e=new Blob([new Uint8Array([1,2])]);return e.size===2}catch(e){return false}}();var o=r&&r.prototype.append&&r.prototype.getBlob;function a(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.buffer instanceof ArrayBuffer){var n=r.buffer;if(r.byteLength!==n.byteLength){var i=new Uint8Array(r.byteLength);i.set(new Uint8Array(n,r.byteOffset,r.byteLength));n=i.buffer}e[t]=n}}}function s(e,t){t=t||{};var n=new r;a(e);for(var i=0;i<e.length;i++){n.append(e[i])}return t.type?n.getBlob(t.type):n.getBlob()}function c(e,t){a(e);return new Blob(e,t||{})}t.exports=function(){if(n){return i?e.Blob:c}else if(o){return s}else{return undefined}}()}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{}],15:[function(e,t,r){t.exports=n;function n(e){if(e)return i(e)}function i(e){for(var t in n.prototype){e[t]=n.prototype[t]}return e}n.prototype.on=n.prototype.addEventListener=function(e,t){this._callbacks=this._callbacks||{};(this._callbacks[e]=this._callbacks[e]||[]).push(t);return this};n.prototype.once=function(e,t){var r=this;this._callbacks=this._callbacks||{};function n(){r.off(e,n);t.apply(this,arguments)}n.fn=t;this.on(e,n);return this};n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var r=this._callbacks[e];if(!r)return this;if(1==arguments.length){delete this._callbacks[e];return this}var n;for(var i=0;i<r.length;i++){n=r[i];if(n===t||n.fn===t){r.splice(i,1);break}}return this};n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks[e];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n){r[n].apply(this,t)}}return this};n.prototype.listeners=function(e){this._callbacks=this._callbacks||{};return this._callbacks[e]||[]};n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],16:[function(e,t,r){t.exports=function(e,t){var r=function(){};r.prototype=t.prototype;e.prototype=new r;e.prototype.constructor=e}},{}],17:[function(e,t,r){r=t.exports=e("./debug");r.log=o;r.formatArgs=i;r.save=a;r.load=s;r.useColors=n;r.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c();r.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function n(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}r.formatters.j=function(e){return JSON.stringify(e)};function i(){var e=arguments;var t=this.useColors;e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+r.humanize(this.diff);if(!t)return e;var n="color: "+this.color;e=[e[0],n,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0;var o=0;e[0].replace(/%[a-z%]/g,function(e){if("%%"===e)return;i++;if("%c"===e){o=i}});e.splice(o,0,n);return e}function o(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(e){try{if(null==e){r.storage.removeItem("debug")}else{r.storage.debug=e}}catch(e){}}function s(){var e;try{e=r.storage.debug}catch(e){}return e}r.enable(s());function c(){try{return window.localStorage}catch(e){}}},{"./debug":18}],18:[function(e,t,r){r=t.exports=a;r.coerce=l;r.disable=c;r.enable=s;r.enabled=u;r.humanize=e("ms");r.names=[];r.skips=[];r.formatters={};var n=0;var i;function o(){return r.colors[n++%r.colors.length]}function a(e){function t(){}t.enabled=false;function n(){var e=n;var t=+new Date;var a=t-(i||t);e.diff=a;e.prev=i;e.curr=t;i=t;if(null==e.useColors)e.useColors=r.useColors();if(null==e.color&&e.useColors)e.color=o();var s=Array.prototype.slice.call(arguments);s[0]=r.coerce(s[0]);if("string"!==typeof s[0]){s=["%o"].concat(s)}var c=0;s[0]=s[0].replace(/%([a-z%])/g,function(t,n){if(t==="%%")return t;c++;var i=r.formatters[n];if("function"===typeof i){var o=s[c];t=i.call(e,o);s.splice(c,1);c--}return t});if("function"===typeof r.formatArgs){s=r.formatArgs.apply(e,s)}var u=n.log||r.log||console.log.bind(console);u.apply(e,s)}n.enabled=true;var a=r.enabled(e)?n:t;a.namespace=e;return a}function s(e){r.save(e);var t=(e||"").split(/[\s,]+/);var n=t.length;for(var i=0;i<n;i++){if(!t[i])continue;e=t[i].replace(/\*/g,".*?");if(e[0]==="-"){r.skips.push(new RegExp("^"+e.substr(1)+"$"))}else{r.names.push(new RegExp("^"+e+"$"))}}}function c(){r.enable("")}function u(e){var t,n;for(t=0,n=r.skips.length;t<n;t++){if(r.skips[t].test(e)){return false}}for(t=0,n=r.names.length;t<n;t++){if(r.names[t].test(e)){return true}}return false}function l(e){if(e instanceof Error)return e.stack||e.message;
return e}},{ms:25}],19:[function(e,t,r){(function(t){var n=e("./keys");var i=e("has-binary");var o=e("arraybuffer.slice");var a=e("base64-arraybuffer");var s=e("after");var c=e("utf8");var u=navigator.userAgent.match(/Android/i);var l=/PhantomJS/i.test(navigator.userAgent);var h=u||l;r.protocol=3;var f=r.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6};var p=n(f);var d={type:"error",data:"parser error"};var m=e("blob");r.encodePacket=function(e,r,n,i){if("function"==typeof r){i=r;r=false}if("function"==typeof n){i=n;n=null}var o=e.data===undefined?undefined:e.data.buffer||e.data;if(t.ArrayBuffer&&o instanceof ArrayBuffer){return g(e,r,i)}else if(m&&o instanceof t.Blob){return y(e,r,i)}if(o&&o.base64){return E(e,i)}var a=f[e.type];if(undefined!==e.data){a+=n?c.encode(String(e.data)):String(e.data)}return i(""+a)};function E(e,t){var n="b"+r.packets[e.type]+e.data.data;return t(n)}function g(e,t,n){if(!t){return r.encodeBase64Packet(e,n)}var i=e.data;var o=new Uint8Array(i);var a=new Uint8Array(1+i.byteLength);a[0]=f[e.type];for(var s=0;s<o.length;s++){a[s+1]=o[s]}return n(a.buffer)}function v(e,t,n){if(!t){return r.encodeBase64Packet(e,n)}var i=new FileReader;i.onload=function(){e.data=i.result;r.encodePacket(e,t,true,n)};return i.readAsArrayBuffer(e.data)}function y(e,t,n){if(!t){return r.encodeBase64Packet(e,n)}if(h){return v(e,t,n)}var i=new Uint8Array(1);i[0]=f[e.type];var o=new m([i.buffer,e.data]);return n(o)}r.encodeBase64Packet=function(e,n){var i="b"+r.packets[e.type];if(m&&e.data instanceof t.Blob){var o=new FileReader;o.onload=function(){var e=o.result.split(",")[1];n(i+e)};return o.readAsDataURL(e.data)}var a;try{a=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){var s=new Uint8Array(e.data);var c=new Array(s.length);for(var u=0;u<s.length;u++){c[u]=s[u]}a=String.fromCharCode.apply(null,c)}i+=t.btoa(a);return n(i)};r.decodePacket=function(e,t,n){if(typeof e=="string"||e===undefined){if(e.charAt(0)=="b"){return r.decodeBase64Packet(e.substr(1),t)}if(n){try{e=c.decode(e)}catch(e){return d}}var i=e.charAt(0);if(Number(i)!=i||!p[i]){return d}if(e.length>1){return{type:p[i],data:e.substring(1)}}else{return{type:p[i]}}}var a=new Uint8Array(e);var i=a[0];var s=o(e,1);if(m&&t==="blob"){s=new m([s])}return{type:p[i],data:s}};r.decodeBase64Packet=function(e,r){var n=p[e.charAt(0)];if(!t.ArrayBuffer){return{type:n,data:{base64:true,data:e.substr(1)}}}var i=a.decode(e.substr(1));if(r==="blob"&&m){i=new m([i])}return{type:n,data:i}};r.encodePayload=function(e,t,n){if(typeof t=="function"){n=t;t=null}var o=i(e);if(t&&o){if(m&&!h){return r.encodePayloadAsBlob(e,n)}return r.encodePayloadAsArrayBuffer(e,n)}if(!e.length){return n("0:")}function a(e){return e.length+":"+e}function s(e,n){r.encodePacket(e,!o?false:t,true,function(e){n(null,a(e))})}b(e,s,function(e,t){return n(t.join(""))})};function b(e,t,r){var n=new Array(e.length);var i=s(e.length,r);var o=function(e,r,i){t(r,function(t,r){n[e]=r;i(t,n)})};for(var a=0;a<e.length;a++){o(a,e[a],i)}}r.decodePayload=function(e,t,n){if(typeof e!="string"){return r.decodePayloadAsBinary(e,t,n)}if(typeof t==="function"){n=t;t=null}var i;if(e==""){return n(d,0,1)}var o="",a,s;for(var c=0,u=e.length;c<u;c++){var l=e.charAt(c);if(":"!=l){o+=l}else{if(""==o||o!=(a=Number(o))){return n(d,0,1)}s=e.substr(c+1,a);if(o!=s.length){return n(d,0,1)}if(s.length){i=r.decodePacket(s,t,true);if(d.type==i.type&&d.data==i.data){return n(d,0,1)}var h=n(i,c+a,u);if(false===h)return}c+=a;o=""}}if(o!=""){return n(d,0,1)}};r.encodePayloadAsArrayBuffer=function(e,t){if(!e.length){return t(new ArrayBuffer(0))}function n(e,t){r.encodePacket(e,true,true,function(e){return t(null,e)})}b(e,n,function(e,r){var n=r.reduce(function(e,t){var r;if(typeof t==="string"){r=t.length}else{r=t.byteLength}return e+r.toString().length+r+2},0);var i=new Uint8Array(n);var o=0;r.forEach(function(e){var t=typeof e==="string";var r=e;if(t){var n=new Uint8Array(e.length);for(var a=0;a<e.length;a++){n[a]=e.charCodeAt(a)}r=n.buffer}if(t){i[o++]=0}else{i[o++]=1}var s=r.byteLength.toString();for(var a=0;a<s.length;a++){i[o++]=parseInt(s[a])}i[o++]=255;var n=new Uint8Array(r);for(var a=0;a<n.length;a++){i[o++]=n[a]}});return t(i.buffer)})};r.encodePayloadAsBlob=function(e,t){function n(e,t){r.encodePacket(e,true,true,function(e){var r=new Uint8Array(1);r[0]=1;if(typeof e==="string"){var n=new Uint8Array(e.length);for(var i=0;i<e.length;i++){n[i]=e.charCodeAt(i)}e=n.buffer;r[0]=0}var o=e instanceof ArrayBuffer?e.byteLength:e.size;var a=o.toString();var s=new Uint8Array(a.length+1);for(var i=0;i<a.length;i++){s[i]=parseInt(a[i])}s[a.length]=255;if(m){var c=new m([r.buffer,s.buffer,e]);t(null,c)}})}b(e,n,function(e,r){return t(new m(r))})};r.decodePayloadAsBinary=function(e,t,n){if(typeof t==="function"){n=t;t=null}var i=e;var a=[];var s=false;while(i.byteLength>0){var c=new Uint8Array(i);var u=c[0]===0;var l="";for(var h=1;;h++){if(c[h]==255)break;if(l.length>310){s=true;break}l+=c[h]}if(s)return n(d,0,1);i=o(i,2+l.length);l=parseInt(l);var f=o(i,0,l);if(u){try{f=String.fromCharCode.apply(null,new Uint8Array(f))}catch(e){var p=new Uint8Array(f);f="";for(var h=0;h<p.length;h++){f+=String.fromCharCode(p[h])}}}a.push(f);i=o(i,l)}var m=a.length;a.forEach(function(e,i){n(r.decodePacket(e,t,true),i,m)})}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{"./keys":20,after:11,"arraybuffer.slice":12,"base64-arraybuffer":13,blob:14,"has-binary":21,utf8:29}],20:[function(e,t,r){t.exports=Object.keys||function e(t){var r=[];var n=Object.prototype.hasOwnProperty;for(var i in t){if(n.call(t,i)){r.push(i)}}return r}},{}],21:[function(e,t,r){(function(r){var n=e("isarray");t.exports=i;function i(e){function t(e){if(!e)return false;if(r.Buffer&&r.Buffer.isBuffer(e)||r.ArrayBuffer&&e instanceof ArrayBuffer||r.Blob&&e instanceof Blob||r.File&&e instanceof File){return true}if(n(e)){for(var i=0;i<e.length;i++){if(t(e[i])){return true}}}else if(e&&"object"==typeof e){if(e.toJSON){e=e.toJSON()}for(var o in e){if(Object.prototype.hasOwnProperty.call(e,o)&&t(e[o])){return true}}}return false}return t(e)}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{isarray:24}],22:[function(e,t,r){try{t.exports=typeof XMLHttpRequest!=="undefined"&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=false}},{}],23:[function(e,t,r){var n=[].indexOf;t.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r){if(e[r]===t)return r}return-1}},{}],24:[function(e,t,r){t.exports=Array.isArray||function(e){return Object.prototype.toString.call(e)=="[object Array]"}},{}],25:[function(e,t,r){var n=1e3;var i=n*60;var o=i*60;var a=o*24;var s=a*365.25;t.exports=function(e,t){t=t||{};if("string"==typeof e)return c(e);return t.long?l(e):u(e)};function c(e){e=""+e;if(e.length>1e4)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);var c=(t[2]||"ms").toLowerCase();switch(c){case"years":case"year":case"yrs":case"yr":case"y":return r*s;case"days":case"day":case"d":return r*a;case"hours":case"hour":case"hrs":case"hr":case"h":return r*o;case"minutes":case"minute":case"mins":case"min":case"m":return r*i;case"seconds":case"second":case"secs":case"sec":case"s":return r*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r}}function u(e){if(e>=a)return Math.round(e/a)+"d";if(e>=o)return Math.round(e/o)+"h";if(e>=i)return Math.round(e/i)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}function l(e){return h(e,a,"day")||h(e,o,"hour")||h(e,i,"minute")||h(e,n,"second")||e+" ms"}function h(e,t,r){if(e<t)return;if(e<t*1.5)return Math.floor(e/t)+" "+r;return Math.ceil(e/t)+" "+r+"s"}},{}],26:[function(e,t,r){(function(e){var r=/^[\],:{}\s]*$/;var n=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;var i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;var o=/(?:^|:|,)(?:\s*\[)+/g;var a=/^\s+/;var s=/\s+$/;t.exports=function t(c){if("string"!=typeof c||!c){return null}c=c.replace(a,"").replace(s,"");if(e.JSON&&JSON.parse){return JSON.parse(c)}if(r.test(c.replace(n,"@").replace(i,"]").replace(o,""))){return new Function("return "+c)()}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{}],27:[function(e,t,r){r.encode=function(e){var t="";for(var r in e){if(e.hasOwnProperty(r)){if(t.length)t+="&";t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r])}}return t};r.decode=function(e){var t={};var r=e.split("&");for(var n=0,i=r.length;n<i;n++){var o=r[n].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},{}],28:[function(e,t,r){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;var i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function e(t){var r=t,o=t.indexOf("["),a=t.indexOf("]");if(o!=-1&&a!=-1){t=t.substring(0,o)+t.substring(o,a).replace(/:/g,";")+t.substring(a,t.length)}var s=n.exec(t||""),c={},u=14;while(u--){c[i[u]]=s[u]||""}if(o!=-1&&a!=-1){c.source=r;c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":");c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":");c.ipv6uri=true}return c}},{}],29:[function(t,r,n){(function(t){(function(i){var o=typeof n=="object"&&n;var a=typeof r=="object"&&r&&r.exports==o&&r;var s=typeof t=="object"&&t;if(s.global===s||s.window===s){i=s}var c=String.fromCharCode;function u(e){var t=[];var r=0;var n=e.length;var i;var o;while(r<n){i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){o=e.charCodeAt(r++);if((o&64512)==56320){t.push(((i&1023)<<10)+(o&1023)+65536)}else{t.push(i);r--}}else{t.push(i)}}return t}function l(e){var t=e.length;var r=-1;var n;var i="";while(++r<t){n=e[r];if(n>65535){n-=65536;i+=c(n>>>10&1023|55296);n=56320|n&1023}i+=c(n)}return i}function h(e){if(e>=55296&&e<=57343){throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}}function f(e,t){return c(e>>t&63|128)}function p(e){if((e&4294967168)==0){return c(e)}var t="";if((e&4294965248)==0){t=c(e>>6&31|192)}else if((e&4294901760)==0){h(e);t=c(e>>12&15|224);t+=f(e,6)}else if((e&4292870144)==0){t=c(e>>18&7|240);t+=f(e,12);t+=f(e,6)}t+=c(e&63|128);return t}function d(e){var t=u(e);var r=t.length;var n=-1;var i;var o="";while(++n<r){i=t[n];o+=p(i)}return o}function m(){if(y>=v){throw Error("Invalid byte index")}var e=g[y]&255;y++;if((e&192)==128){return e&63}throw Error("Invalid continuation byte")}function E(){var e;var t;var r;var n;var i;if(y>v){throw Error("Invalid byte index")}if(y==v){return false}e=g[y]&255;y++;if((e&128)==0){return e}if((e&224)==192){var t=m();i=(e&31)<<6|t;if(i>=128){return i}else{throw Error("Invalid continuation byte")}}if((e&240)==224){t=m();r=m();i=(e&15)<<12|t<<6|r;if(i>=2048){h(i);return i}else{throw Error("Invalid continuation byte")}}if((e&248)==240){t=m();r=m();n=m();i=(e&15)<<18|t<<12|r<<6|n;if(i>=65536&&i<=1114111){return i}}throw Error("Invalid UTF-8 detected")}var g;var v;var y;function b(e){g=u(e);v=g.length;y=0;var t=[];var r;while((r=E())!==false){t.push(r)}return l(t)}var T={version:"2.0.0",encode:d,decode:b};if(typeof e=="function"&&typeof e.amd=="object"&&e.amd){e(function(){return T})}else if(o&&!o.nodeType){if(a){a.exports=T}else{var R={};var w=R.hasOwnProperty;for(var x in T){w.call(T,x)&&(o[x]=T[x])}}}else{i.utf8=T}})(this)}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{}],30:[function(e,t,r){"use strict";var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i=64,o={},a=0,s=0,c;function u(e){var t="";do{t=n[e%i]+t;e=Math.floor(e/i)}while(e>0);return t}function l(e){var t=0;for(s=0;s<e.length;s++){t=t*i+o[e.charAt(s)]}return t}function h(){var e=u(+new Date);if(e!==c)return a=0,c=e;return e+"."+u(a++)}for(;s<i;s++)o[n[s]]=s;h.encode=u;h.decode=l;t.exports=h},{}],31:[function(e,t,r){var n=e("./url");var i=e("socket.io-parser");var o=e("./manager");var a=e("debug")("socket.io-client");t.exports=r=c;var s=r.managers={};function c(e,t){if(typeof e=="object"){t=e;e=undefined}t=t||{};var r=n(e);var i=r.source;var c=r.id;var u=r.path;var l=s[c]&&u in s[c].nsps;var h=t.forceNew||t["force new connection"]||false===t.multiplex||l;var f;if(h){a("ignoring socket cache for %s",i);f=o(i,t)}else{if(!s[c]){a("new io instance for %s",i);s[c]=o(i,t)}f=s[c]}return f.socket(r.path)}r.protocol=i.protocol;r.connect=c;r.Manager=e("./manager");r.Socket=e("./socket")},{"./manager":32,"./socket":34,"./url":35,debug:39,"socket.io-parser":47}],32:[function(e,t,r){var n=e("engine.io-client");var i=e("./socket");var o=e("component-emitter");var a=e("socket.io-parser");var s=e("./on");var c=e("component-bind");var u=e("debug")("socket.io-client:manager");var l=e("indexof");var h=e("backo2");var f=Object.prototype.hasOwnProperty;t.exports=p;function p(e,t){if(!(this instanceof p))return new p(e,t);if(e&&"object"==typeof e){t=e;e=undefined}t=t||{};t.path=t.path||"/socket.io";this.nsps={};this.subs=[];this.opts=t;this.reconnection(t.reconnection!==false);this.reconnectionAttempts(t.reconnectionAttempts||Infinity);this.reconnectionDelay(t.reconnectionDelay||1e3);this.reconnectionDelayMax(t.reconnectionDelayMax||5e3);this.randomizationFactor(t.randomizationFactor||.5);this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==t.timeout?2e4:t.timeout);this.readyState="closed";this.uri=e;this.connecting=[];this.lastPing=null;this.encoding=false;this.packetBuffer=[];this.encoder=new a.Encoder;this.decoder=new a.Decoder;this.autoConnect=t.autoConnect!==false;if(this.autoConnect)this.open()}p.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps){if(f.call(this.nsps,e)){this.nsps[e].emit.apply(this.nsps[e],arguments)}}};p.prototype.updateSocketIds=function(){for(var e in this.nsps){if(f.call(this.nsps,e)){this.nsps[e].id=this.engine.id}}};o(p.prototype);p.prototype.reconnection=function(e){if(!arguments.length)return this._reconnection;this._reconnection=!!e;return this};p.prototype.reconnectionAttempts=function(e){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=e;return this};p.prototype.reconnectionDelay=function(e){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=e;this.backoff&&this.backoff.setMin(e);return this};p.prototype.randomizationFactor=function(e){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=e;this.backoff&&this.backoff.setJitter(e);return this};p.prototype.reconnectionDelayMax=function(e){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=e;this.backoff&&this.backoff.setMax(e);return this};p.prototype.timeout=function(e){if(!arguments.length)return this._timeout;this._timeout=e;return this};p.prototype.maybeReconnectOnOpen=function(){if(!this.reconnecting&&this._reconnection&&this.backoff.attempts===0){this.reconnect()}};p.prototype.open=p.prototype.connect=function(e){u("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;u("opening %s",this.uri);this.engine=n(this.uri,this.opts);var t=this.engine;var r=this;this.readyState="opening";this.skipReconnect=false;var i=s(t,"open",function(){r.onopen();e&&e()});var o=s(t,"error",function(t){u("connect_error");r.cleanup();r.readyState="closed";r.emitAll("connect_error",t);if(e){var n=new Error("Connection error");n.data=t;e(n)}else{r.maybeReconnectOnOpen()}});if(false!==this._timeout){var a=this._timeout;u("connect attempt will timeout after %d",a);var c=setTimeout(function(){u("connect attempt timed out after %d",a);i.destroy();t.close();t.emit("error","timeout");r.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(c)}})}this.subs.push(i);this.subs.push(o);return this};p.prototype.onopen=function(){u("open");this.cleanup();this.readyState="open";this.emit("open");var e=this.engine;this.subs.push(s(e,"data",c(this,"ondata")));this.subs.push(s(e,"ping",c(this,"onping")));this.subs.push(s(e,"pong",c(this,"onpong")));this.subs.push(s(e,"error",c(this,"onerror")));this.subs.push(s(e,"close",c(this,"onclose")));this.subs.push(s(this.decoder,"decoded",c(this,"ondecoded")))};p.prototype.onping=function(){this.lastPing=new Date;this.emitAll("ping")};p.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)};p.prototype.ondata=function(e){this.decoder.add(e)};p.prototype.ondecoded=function(e){this.emit("packet",e)};p.prototype.onerror=function(e){u("error",e);this.emitAll("error",e)};p.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new i(this,e);this.nsps[e]=t;var r=this;t.on("connecting",n);t.on("connect",function(){t.id=r.engine.id});if(this.autoConnect){n()}}function n(){if(!~l(r.connecting,t)){r.connecting.push(t)}}return t};p.prototype.destroy=function(e){var t=l(this.connecting,e);if(~t)this.connecting.splice(t,1);if(this.connecting.length)return;this.close()};p.prototype.packet=function(e){u("writing packet %j",e);var t=this;if(!t.encoding){t.encoding=true;this.encoder.encode(e,function(r){for(var n=0;n<r.length;n++){t.engine.write(r[n],e.options)}t.encoding=false;t.processPacketQueue()})}else{t.packetBuffer.push(e)}};p.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}};p.prototype.cleanup=function(){u("cleanup");var e;while(e=this.subs.shift())e.destroy();this.packetBuffer=[];this.encoding=false;this.lastPing=null;this.decoder.destroy()};p.prototype.close=p.prototype.disconnect=function(){u("disconnect");this.skipReconnect=true;this.reconnecting=false;if("opening"==this.readyState){this.cleanup()}this.backoff.reset();this.readyState="closed";if(this.engine)this.engine.close()};p.prototype.onclose=function(e){u("onclose");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",e);if(this._reconnection&&!this.skipReconnect){this.reconnect()}};p.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts){u("reconnect failed");this.backoff.reset();this.emitAll("reconnect_failed");this.reconnecting=false}else{var t=this.backoff.duration();u("will wait %dms before reconnect attempt",t);this.reconnecting=true;var r=setTimeout(function(){if(e.skipReconnect)return;u("attempting reconnect");e.emitAll("reconnect_attempt",e.backoff.attempts);e.emitAll("reconnecting",e.backoff.attempts);if(e.skipReconnect)return;e.open(function(t){if(t){u("reconnect attempt error");e.reconnecting=false;e.reconnect();e.emitAll("reconnect_error",t.data)}else{u("reconnect success");e.onreconnect()}})},t);this.subs.push({destroy:function(){clearTimeout(r)}})}};p.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=false;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",e)}},{"./on":33,"./socket":34,backo2:36,"component-bind":37,"component-emitter":38,debug:39,"engine.io-client":1,indexof:42,"socket.io-parser":47}],33:[function(e,t,r){t.exports=n;function n(e,t,r){e.on(t,r);return{destroy:function(){e.removeListener(t,r)}}}},{}],34:[function(e,t,r){var n=e("socket.io-parser");var i=e("component-emitter");var o=e("to-array");var a=e("./on");var s=e("component-bind");var c=e("debug")("socket.io-client:socket");var u=e("has-binary");t.exports=r=f;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1};var h=i.prototype.emit;function f(e,t){this.io=e;this.nsp=t;this.json=this;this.ids=0;this.acks={};this.receiveBuffer=[];this.sendBuffer=[];this.connected=false;this.disconnected=true;if(this.io.autoConnect)this.open()}i(f.prototype);f.prototype.subEvents=function(){if(this.subs)return;var e=this.io;this.subs=[a(e,"open",s(this,"onopen")),a(e,"packet",s(this,"onpacket")),a(e,"close",s(this,"onclose"))]};f.prototype.open=f.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"==this.io.readyState)this.onopen();this.emit("connecting");return this};f.prototype.send=function(){var e=o(arguments);e.unshift("message");this.emit.apply(this,e);return this};f.prototype.emit=function(e){if(l.hasOwnProperty(e)){h.apply(this,arguments);return this}var t=o(arguments);var r=n.EVENT;if(u(t)){r=n.BINARY_EVENT}var i={type:r,data:t};i.options={};i.options.compress=!this.flags||false!==this.flags.compress;if("function"==typeof t[t.length-1]){c("emitting packet with ack id %d",this.ids);this.acks[this.ids]=t.pop();i.id=this.ids++}if(this.connected){this.packet(i)}else{this.sendBuffer.push(i)}delete this.flags;return this};f.prototype.packet=function(e){e.nsp=this.nsp;this.io.packet(e)};f.prototype.onopen=function(){c("transport is open - connecting");if("/"!=this.nsp){this.packet({type:n.CONNECT})}};f.prototype.onclose=function(e){c("close (%s)",e);this.connected=false;this.disconnected=true;delete this.id;this.emit("disconnect",e)};f.prototype.onpacket=function(e){if(e.nsp!=this.nsp)return;switch(e.type){case n.CONNECT:this.onconnect();break;case n.EVENT:this.onevent(e);break;case n.BINARY_EVENT:this.onevent(e);break;case n.ACK:this.onack(e);break;case n.BINARY_ACK:this.onack(e);break;case n.DISCONNECT:this.ondisconnect();break;case n.ERROR:this.emit("error",e.data);break}};f.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t);if(null!=e.id){c("attaching ack callback to event");t.push(this.ack(e.id))}if(this.connected){h.apply(this,t)}else{this.receiveBuffer.push(t)}};f.prototype.ack=function(e){var t=this;var r=false;return function(){if(r)return;r=true;var i=o(arguments);c("sending ack %j",i);var a=u(i)?n.BINARY_ACK:n.ACK;t.packet({type:a,id:e,data:i})}};f.prototype.onack=function(e){var t=this.acks[e.id];if("function"==typeof t){c("calling ack %s with %j",e.id,e.data);t.apply(this,e.data);delete this.acks[e.id]}else{c("bad ack %s",e.id)}};f.prototype.onconnect=function(){this.connected=true;this.disconnected=false;this.emit("connect");this.emitBuffered()};f.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++){h.apply(this,this.receiveBuffer[e])}this.receiveBuffer=[];for(e=0;e<this.sendBuffer.length;e++){this.packet(this.sendBuffer[e])}this.sendBuffer=[]};f.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};f.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++){this.subs[e].destroy()}this.subs=null}this.io.destroy(this)};f.prototype.close=f.prototype.disconnect=function(){if(this.connected){c("performing disconnect (%s)",this.nsp);this.packet({type:n.DISCONNECT})}this.destroy();if(this.connected){this.onclose("io client disconnect")}return this};f.prototype.compress=function(e){this.flags=this.flags||{};this.flags.compress=e;return this}},{"./on":33,"component-bind":37,"component-emitter":38,debug:39,"has-binary":41,"socket.io-parser":47,"to-array":51}],35:[function(e,t,r){(function(r){var n=e("parseuri");var i=e("debug")("socket.io-client:url");t.exports=o;function o(e,t){var o=e;var t=t||r.location;if(null==e)e=t.protocol+"//"+t.host;if("string"==typeof e){if("/"==e.charAt(0)){if("/"==e.charAt(1)){e=t.protocol+e}else{e=t.host+e}}if(!/^(https?|wss?):\/\//.test(e)){i("protocol-less url %s",e);if("undefined"!=typeof t){e=t.protocol+"//"+e}else{e="https://"+e}}i("parse %s",e);o=n(e)}if(!o.port){if(/^(http|ws)$/.test(o.protocol)){o.port="80"}else if(/^(http|ws)s$/.test(o.protocol)){o.port="443"}}o.path=o.path||"/";var a=o.host.indexOf(":")!==-1;var s=a?"["+o.host+"]":o.host;o.id=o.protocol+"://"+s+":"+o.port;o.href=o.protocol+"://"+s+(t&&t.port==o.port?"":":"+o.port);return o}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{debug:39,parseuri:45}],36:[function(e,t,r){t.exports=n;function n(e){e=e||{};this.ms=e.min||100;this.max=e.max||1e4;this.factor=e.factor||2;this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0;this.attempts=0}n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random();var r=Math.floor(t*this.jitter*e);e=(Math.floor(t*10)&1)==0?e-r:e+r}return Math.min(e,this.max)|0};n.prototype.reset=function(){this.attempts=0};n.prototype.setMin=function(e){this.ms=e};n.prototype.setMax=function(e){this.max=e};n.prototype.setJitter=function(e){this.jitter=e}},{}],37:[function(e,t,r){var n=[].slice;t.exports=function(e,t){if("string"==typeof t)t=e[t];if("function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},{}],38:[function(e,t,r){t.exports=n;function n(e){if(e)return i(e)}function i(e){for(var t in n.prototype){e[t]=n.prototype[t]}return e}n.prototype.on=n.prototype.addEventListener=function(e,t){this._callbacks=this._callbacks||{};(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t);return this};n.prototype.once=function(e,t){function r(){this.off(e,r);t.apply(this,arguments)}r.fn=t;this.on(e,r);return this};n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length){delete this._callbacks["$"+e];return this}var n;for(var i=0;i<r.length;i++){n=r[i];if(n===t||n.fn===t){r.splice(i,1);break}}return this};n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks["$"+e];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n){r[n].apply(this,t)}}return this};n.prototype.listeners=function(e){this._callbacks=this._callbacks||{};return this._callbacks["$"+e]||[]};n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],39:[function(e,t,r){arguments[4][17][0].apply(r,arguments)},{"./debug":40,dup:17}],40:[function(e,t,r){arguments[4][18][0].apply(r,arguments)},{dup:18,ms:44}],41:[function(e,t,r){(function(r){var n=e("isarray");t.exports=i;function i(e){function t(e){if(!e)return false;if(r.Buffer&&r.Buffer.isBuffer&&r.Buffer.isBuffer(e)||r.ArrayBuffer&&e instanceof ArrayBuffer||r.Blob&&e instanceof Blob||r.File&&e instanceof File){return true}if(n(e)){for(var i=0;i<e.length;i++){if(t(e[i])){return true}}}else if(e&&"object"==typeof e){if(e.toJSON&&"function"==typeof e.toJSON){e=e.toJSON()}for(var o in e){if(Object.prototype.hasOwnProperty.call(e,o)&&t(e[o])){return true}}}return false}return t(e)}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{isarray:43}],42:[function(e,t,r){arguments[4][23][0].apply(r,arguments)},{dup:23}],43:[function(e,t,r){arguments[4][24][0].apply(r,arguments)},{dup:24}],44:[function(e,t,r){arguments[4][25][0].apply(r,arguments)},{dup:25}],45:[function(e,t,r){arguments[4][28][0].apply(r,arguments)},{dup:28}],46:[function(e,t,r){(function(t){var n=e("isarray");var i=e("./is-buffer");r.deconstructPacket=function(e){var t=[];var r=e.data;function o(e){if(!e)return e;if(i(e)){var r={_placeholder:true,num:t.length};t.push(e);return r}else if(n(e)){var a=new Array(e.length);for(var s=0;s<e.length;s++){a[s]=o(e[s])}return a}else if("object"==typeof e&&!(e instanceof Date)){var a={};for(var c in e){a[c]=o(e[c])}return a}return e}var a=e;a.data=o(r);a.attachments=t.length;return{packet:a,buffers:t}};r.reconstructPacket=function(e,t){var r=0;function i(e){if(e&&e._placeholder){var r=t[e.num];return r}else if(n(e)){for(var o=0;o<e.length;o++){e[o]=i(e[o])}return e}else if(e&&"object"==typeof e){for(var a in e){e[a]=i(e[a])}return e}return e}e.data=i(e.data);e.attachments=undefined;return e};r.removeBlobs=function(e,r){function o(e,c,u){if(!e)return e;if(t.Blob&&e instanceof Blob||t.File&&e instanceof File){a++;var l=new FileReader;l.onload=function(){if(u){u[c]=this.result}else{s=this.result}if(!--a){r(s)}};l.readAsArrayBuffer(e)}else if(n(e)){for(var h=0;h<e.length;h++){o(e[h],h,e)}}else if(e&&"object"==typeof e&&!i(e)){for(var f in e){o(e[f],f,e)}}}var a=0;var s=e;o(s);if(!a){r(s)}}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{"./is-buffer":48,isarray:43}],47:[function(e,t,r){var n=e("debug")("socket.io-parser");var i=e("json3");var o=e("isarray");var a=e("component-emitter");var s=e("./binary");var c=e("./is-buffer");r.protocol=4;r.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"];r.CONNECT=0;r.DISCONNECT=1;r.EVENT=2;r.ACK=3;r.ERROR=4;r.BINARY_EVENT=5;r.BINARY_ACK=6;r.Encoder=u;r.Decoder=f;function u(){}u.prototype.encode=function(e,t){n("encoding packet %j",e);if(r.BINARY_EVENT==e.type||r.BINARY_ACK==e.type){h(e,t)}else{var i=l(e);t([i])}};function l(e){var t="";var o=false;t+=e.type;if(r.BINARY_EVENT==e.type||r.BINARY_ACK==e.type){t+=e.attachments;t+="-"}if(e.nsp&&"/"!=e.nsp){o=true;t+=e.nsp}if(null!=e.id){if(o){t+=",";o=false}t+=e.id}if(null!=e.data){if(o)t+=",";t+=i.stringify(e.data)}n("encoded %j as %s",e,t);return t}function h(e,t){function r(e){var r=s.deconstructPacket(e);var n=l(r.packet);var i=r.buffers;i.unshift(n);t(i)}s.removeBlobs(e,r)}function f(){this.reconstructor=null}a(f.prototype);f.prototype.add=function(e){var t;if("string"==typeof e){t=p(e);if(r.BINARY_EVENT==t.type||r.BINARY_ACK==t.type){this.reconstructor=new d(t);if(this.reconstructor.reconPack.attachments===0){this.emit("decoded",t)}}else{this.emit("decoded",t)}}else if(c(e)||e.base64){if(!this.reconstructor){throw new Error("got binary data when not reconstructing a packet")}else{t=this.reconstructor.takeBinaryData(e);if(t){this.reconstructor=null;this.emit("decoded",t)}}}else{throw new Error("Unknown type: "+e)}};function p(e){var t={};var o=0;t.type=Number(e.charAt(0));if(null==r.types[t.type])return m();if(r.BINARY_EVENT==t.type||r.BINARY_ACK==t.type){var a="";while(e.charAt(++o)!="-"){a+=e.charAt(o);if(o==e.length)break}if(a!=Number(a)||e.charAt(o)!="-"){throw new Error("Illegal attachments")}t.attachments=Number(a)}if("/"==e.charAt(o+1)){t.nsp="";while(++o){var s=e.charAt(o);if(","==s)break;t.nsp+=s;if(o==e.length)break}}else{t.nsp="/"}var c=e.charAt(o+1);if(""!==c&&Number(c)==c){t.id="";while(++o){var s=e.charAt(o);if(null==s||Number(s)!=s){--o;break}t.id+=e.charAt(o);if(o==e.length)break}t.id=Number(t.id)}if(e.charAt(++o)){try{t.data=i.parse(e.substr(o))}catch(e){return m()}}n("decoded %s as %j",e,t);return t}f.prototype.destroy=function(){if(this.reconstructor){this.reconstructor.finishedReconstruction()}};function d(e){this.reconPack=e;this.buffers=[]}d.prototype.takeBinaryData=function(e){this.buffers.push(e);if(this.buffers.length==this.reconPack.attachments){var t=s.reconstructPacket(this.reconPack,this.buffers);this.finishedReconstruction();return t}return null};d.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]};function m(e){return{type:r.ERROR,data:"parser error"}}},{"./binary":46,"./is-buffer":48,"component-emitter":49,debug:39,isarray:43,json3:50}],48:[function(e,t,r){(function(e){t.exports=r;function r(t){return e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer}}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{}],
49:[function(e,t,r){arguments[4][15][0].apply(r,arguments)},{dup:15}],50:[function(t,r,n){(function(t){(function(){var i=typeof e==="function"&&e.amd;var o={function:true,object:true};var a=o[typeof n]&&n&&!n.nodeType&&n;var s=o[typeof window]&&window||this,c=a&&o[typeof r]&&r&&!r.nodeType&&typeof t=="object"&&t;if(c&&(c["global"]===c||c["window"]===c||c["self"]===c)){s=c}function u(e,t){e||(e=s["Object"]());t||(t=s["Object"]());var r=e["Number"]||s["Number"],n=e["String"]||s["String"],i=e["Object"]||s["Object"],a=e["Date"]||s["Date"],c=e["SyntaxError"]||s["SyntaxError"],l=e["TypeError"]||s["TypeError"],h=e["Math"]||s["Math"],f=e["JSON"]||s["JSON"];if(typeof f=="object"&&f){t.stringify=f.stringify;t.parse=f.parse}var p=i.prototype,d=p.toString,m,E,g;var v=new a(-0xc782b5b800cec);try{v=v.getUTCFullYear()==-109252&&v.getUTCMonth()===0&&v.getUTCDate()===1&&v.getUTCHours()==10&&v.getUTCMinutes()==37&&v.getUTCSeconds()==6&&v.getUTCMilliseconds()==708}catch(e){}function y(e){if(y[e]!==g){return y[e]}var i;if(e=="bug-string-char-index"){i="a"[0]!="a"}else if(e=="json"){i=y("json-stringify")&&y("json-parse")}else{var o,s='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if(e=="json-stringify"){var c=t.stringify,u=typeof c=="function"&&v;if(u){(o=function(){return 1}).toJSON=o;try{u=c(0)==="0"&&c(new r)==="0"&&c(new n)=='""'&&c(d)===g&&c(g)===g&&c()===g&&c(o)==="1"&&c([o])=="[1]"&&c([g])=="[null]"&&c(null)=="null"&&c([g,d,null])=="[null,null,null]"&&c({a:[o,true,false,null,"\0\b\n\f\r\t"]})==s&&c(null,o)==="1"&&c([1,2],null,1)=="[\n 1,\n 2\n]"&&c(new a(-864e13))=='"-271821-04-20T00:00:00.000Z"'&&c(new a(864e13))=='"+275760-09-13T00:00:00.000Z"'&&c(new a(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&c(new a(-1))=='"1969-12-31T23:59:59.999Z"'}catch(e){u=false}}i=u}if(e=="json-parse"){var l=t.parse;if(typeof l=="function"){try{if(l("0")===0&&!l(false)){o=l(s);var h=o["a"].length==5&&o["a"][0]===1;if(h){try{h=!l('"\t"')}catch(e){}if(h){try{h=l("01")!==1}catch(e){}}if(h){try{h=l("1.")!==1}catch(e){}}}}}catch(e){h=false}}i=h}}return y[e]=!!i}if(!y("json")){var b="[object Function]",T="[object Date]",R="[object Number]",w="[object String]",x="[object Array]",H="[object Boolean]";var _=y("bug-string-char-index");if(!v){var S=h.floor;var M=[0,31,59,90,120,151,181,212,243,273,304,334];var A=function(e,t){return M[t]+365*(e-1970)+S((e-1969+(t=+(t>1)))/4)-S((e-1901+t)/100)+S((e-1601+t)/400)}}if(!(m=p.hasOwnProperty)){m=function(e){var t={},r;if((t.__proto__=null,t.__proto__={toString:1},t).toString!=d){m=function(e){var t=this.__proto__,r=e in(this.__proto__=null,this);this.__proto__=t;return r}}else{r=t.constructor;m=function(e){var t=(this.constructor||r).prototype;return e in this&&!(e in t&&this[e]===t[e])}}t=null;return m.call(this,e)}}E=function(e,t){var r=0,n,i,a;(n=function(){this.valueOf=0}).prototype.valueOf=0;i=new n;for(a in i){if(m.call(i,a)){r++}}n=i=null;if(!r){i=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"];E=function(e,t){var r=d.call(e)==b,n,a;var s=!r&&typeof e.constructor!="function"&&o[typeof e.hasOwnProperty]&&e.hasOwnProperty||m;for(n in e){if(!(r&&n=="prototype")&&s.call(e,n)){t(n)}}for(a=i.length;n=i[--a];s.call(e,n)&&t(n));}}else if(r==2){E=function(e,t){var r={},n=d.call(e)==b,i;for(i in e){if(!(n&&i=="prototype")&&!m.call(r,i)&&(r[i]=1)&&m.call(e,i)){t(i)}}}}else{E=function(e,t){var r=d.call(e)==b,n,i;for(n in e){if(!(r&&n=="prototype")&&m.call(e,n)&&!(i=n==="constructor")){t(n)}}if(i||m.call(e,n="constructor")){t(n)}}}return E(e,t)};if(!y("json-stringify")){var C={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"};var k="000000";var L=function(e,t){return(k+(t||0)).slice(-e)};var P="\\u00";var O=function(e){var t='"',r=0,n=e.length,i=!_||n>10;var o=i&&(_?e.split(""):e);for(;r<n;r++){var a=e.charCodeAt(r);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=C[a];break;default:if(a<32){t+=P+L(2,a.toString(16));break}t+=i?o[r]:e.charAt(r)}}return t+'"'};var N=function(e,t,r,n,i,o,a){var s,c,u,h,f,p,v,y,b,_,M,C,k,P,F,I;try{s=t[e]}catch(e){}if(typeof s=="object"&&s){c=d.call(s);if(c==T&&!m.call(s,"toJSON")){if(s>-1/0&&s<1/0){if(A){f=S(s/864e5);for(u=S(f/365.2425)+1970-1;A(u+1,0)<=f;u++);for(h=S((f-A(u,0))/30.42);A(u,h+1)<=f;h++);f=1+f-A(u,h);p=(s%864e5+864e5)%864e5;v=S(p/36e5)%24;y=S(p/6e4)%60;b=S(p/1e3)%60;_=p%1e3}else{u=s.getUTCFullYear();h=s.getUTCMonth();f=s.getUTCDate();v=s.getUTCHours();y=s.getUTCMinutes();b=s.getUTCSeconds();_=s.getUTCMilliseconds()}s=(u<=0||u>=1e4?(u<0?"-":"+")+L(6,u<0?-u:u):L(4,u))+"-"+L(2,h+1)+"-"+L(2,f)+"T"+L(2,v)+":"+L(2,y)+":"+L(2,b)+"."+L(3,_)+"Z"}else{s=null}}else if(typeof s.toJSON=="function"&&(c!=R&&c!=w&&c!=x||m.call(s,"toJSON"))){s=s.toJSON(e)}}if(r){s=r.call(t,e,s)}if(s===null){return"null"}c=d.call(s);if(c==H){return""+s}else if(c==R){return s>-1/0&&s<1/0?""+s:"null"}else if(c==w){return O(""+s)}if(typeof s=="object"){for(P=a.length;P--;){if(a[P]===s){throw l()}}a.push(s);M=[];F=o;o+=i;if(c==x){for(k=0,P=s.length;k<P;k++){C=N(k,s,r,n,i,o,a);M.push(C===g?"null":C)}I=M.length?i?"[\n"+o+M.join(",\n"+o)+"\n"+F+"]":"["+M.join(",")+"]":"[]"}else{E(n||s,function(e){var t=N(e,s,r,n,i,o,a);if(t!==g){M.push(O(e)+":"+(i?" ":"")+t)}});I=M.length?i?"{\n"+o+M.join(",\n"+o)+"\n"+F+"}":"{"+M.join(",")+"}":"{}"}a.pop();return I}};t.stringify=function(e,t,r){var n,i,a,s;if(o[typeof t]&&t){if((s=d.call(t))==b){i=t}else if(s==x){a={};for(var c=0,u=t.length,l;c<u;l=t[c++],(s=d.call(l),s==w||s==R)&&(a[l]=1));}}if(r){if((s=d.call(r))==R){if((r-=r%1)>0){for(n="",r>10&&(r=10);n.length<r;n+=" ");}}else if(s==w){n=r.length<=10?r:r.slice(0,10)}}return N("",(l={},l[""]=e,l),i,a,n,"",[])}}if(!y("json-parse")){var F=n.fromCharCode;var I={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"};var B,j;var D=function(){B=j=null;throw c()};var U=function(){var e=j,t=e.length,r,n,i,o,a;while(B<t){a=e.charCodeAt(B);switch(a){case 9:case 10:case 13:case 32:B++;break;case 123:case 125:case 91:case 93:case 58:case 44:r=_?e.charAt(B):e[B];B++;return r;case 34:for(r="@",B++;B<t;){a=e.charCodeAt(B);if(a<32){D()}else if(a==92){a=e.charCodeAt(++B);switch(a){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:r+=I[a];B++;break;case 117:n=++B;for(i=B+4;B<i;B++){a=e.charCodeAt(B);if(!(a>=48&&a<=57||a>=97&&a<=102||a>=65&&a<=70)){D()}}r+=F("0x"+e.slice(n,B));break;default:D()}}else{if(a==34){break}a=e.charCodeAt(B);n=B;while(a>=32&&a!=92&&a!=34){a=e.charCodeAt(++B)}r+=e.slice(n,B)}}if(e.charCodeAt(B)==34){B++;return r}D();default:n=B;if(a==45){o=true;a=e.charCodeAt(++B)}if(a>=48&&a<=57){if(a==48&&(a=e.charCodeAt(B+1),a>=48&&a<=57)){D()}o=false;for(;B<t&&(a=e.charCodeAt(B),a>=48&&a<=57);B++);if(e.charCodeAt(B)==46){i=++B;for(;i<t&&(a=e.charCodeAt(i),a>=48&&a<=57);i++);if(i==B){D()}B=i}a=e.charCodeAt(B);if(a==101||a==69){a=e.charCodeAt(++B);if(a==43||a==45){B++}for(i=B;i<t&&(a=e.charCodeAt(i),a>=48&&a<=57);i++);if(i==B){D()}B=i}return+e.slice(n,B)}if(o){D()}if(e.slice(B,B+4)=="true"){B+=4;return true}else if(e.slice(B,B+5)=="false"){B+=5;return false}else if(e.slice(B,B+4)=="null"){B+=4;return null}D()}}return"$"};var $=function(e){var t,r;if(e=="$"){D()}if(typeof e=="string"){if((_?e.charAt(0):e[0])=="@"){return e.slice(1)}if(e=="["){t=[];for(;;r||(r=true)){e=U();if(e=="]"){break}if(r){if(e==","){e=U();if(e=="]"){D()}}else{D()}}if(e==","){D()}t.push($(e))}return t}else if(e=="{"){t={};for(;;r||(r=true)){e=U();if(e=="}"){break}if(r){if(e==","){e=U();if(e=="}"){D()}}else{D()}}if(e==","||typeof e!="string"||(_?e.charAt(0):e[0])!="@"||U()!=":"){D()}t[e.slice(1)]=$(U())}return t}D()}return e};var V=function(e,t,r){var n=G(e,t,r);if(n===g){delete e[t]}else{e[t]=n}};var G=function(e,t,r){var n=e[t],i;if(typeof n=="object"&&n){if(d.call(n)==x){for(i=n.length;i--;){V(n,i,r)}}else{E(n,function(e){V(n,e,r)})}}return r.call(e,t,n)};t.parse=function(e,t){var r,n;B=0;j=""+e;r=$(U());if(U()!="$"){D()}B=j=null;return t&&d.call(t)==b?G((n={},n[""]=r,n),"",t):r}}}t["runInContext"]=u;return t}if(a&&!i){u(s,a)}else{var l=s.JSON,h=s["JSON3"],f=false;var p=u(s,s["JSON3"]={noConflict:function(){if(!f){f=true;s.JSON=l;s["JSON3"]=h;l=h=null}return p}});s.JSON={parse:p.parse,stringify:p.stringify}}if(i){e(function(){return p})}}).call(this)}).call(this,typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:{})},{}],51:[function(e,t,r){t.exports=n;function n(e,t){var r=[];t=t||0;for(var n=t||0;n<e.length;n++){r[n-t]=e[n]}return r}},{}]},{},[31])(31)});"use strict";var THREE={REVISION:"74"};"function"===typeof define&&define.amd?define("three",THREE):"undefined"!==typeof exports&&"undefined"!==typeof module&&(module.exports=THREE);void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52));void 0===Math.sign&&(Math.sign=function(e){return 0>e?-1:0<e?1:+e});void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}});void 0===Object.assign&&Object.defineProperty(Object,"assign",{writable:!0,configurable:!0,value:function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),r=1,n=arguments.length;r!==n;++r){var i=arguments[r];if(void 0!==i&&null!==i)for(var i=Object(i),o=Object.keys(i),a=0,s=o.length;a!==s;++a){var c=o[a],u=Object.getOwnPropertyDescriptor(i,c);void 0!==u&&u.enumerable&&(t[c]=i[c])}}return t}});THREE.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.MinEquation=103;THREE.MaxEquation=104;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;THREE.SrcAlphaSaturateFactor=210;THREE.NeverDepth=0;THREE.AlwaysDepth=1;THREE.LessDepth=2;THREE.LessEqualDepth=3;THREE.EqualDepth=4;THREE.GreaterEqualDepth=5;THREE.GreaterDepth=6;THREE.NotEqualDepth=7;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=300;THREE.CubeReflectionMapping=301;THREE.CubeRefractionMapping=302;THREE.EquirectangularReflectionMapping=303;THREE.EquirectangularRefractionMapping=304;THREE.SphericalReflectionMapping=305;THREE.RepeatWrapping=1e3;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.HalfFloatType=1025;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;THREE.RGBEFormat=THREE.RGBAFormat;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.RGB_PVRTC_4BPPV1_Format=2100;THREE.RGB_PVRTC_2BPPV1_Format=2101;THREE.RGBA_PVRTC_4BPPV1_Format=2102;THREE.RGBA_PVRTC_2BPPV1_Format=2103;THREE.RGB_ETC1_Format=2151;THREE.LoopOnce=2200;THREE.LoopRepeat=2201;THREE.LoopPingPong=2202;THREE.InterpolateDiscrete=2300;THREE.InterpolateLinear=2301;THREE.InterpolateSmooth=2302;THREE.ZeroCurvatureEnding=2400;THREE.ZeroSlopeEnding=2401;THREE.WrapAroundEnding=2402;THREE.TrianglesDrawMode=0;THREE.TriangleStripDrawMode=1;THREE.TriangleFanDrawMode=2;THREE.Color=function(e){return 3===arguments.length?this.fromArray(arguments):this.set(e)};THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(e){e instanceof THREE.Color?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e);return this},setScalar:function(e){this.b=this.g=this.r=e},setHex:function(e){e=Math.floor(e);this.r=(e>>16&255)/255;this.g=(e>>8&255)/255;this.b=(e&255)/255;return this},setRGB:function(e,t,r){this.r=e;this.g=t;this.b=r;return this},setHSL:function(){function e(e,t,r){0>r&&(r+=1);1<r&&(r-=1);return r<1/6?e+6*(t-e)*r:.5>r?t:r<2/3?e+6*(t-e)*(2/3-r):e}return function(t,r,n){t=THREE.Math.euclideanModulo(t,1);r=THREE.Math.clamp(r,0,1);n=THREE.Math.clamp(n,0,1);0===r?this.r=this.g=this.b=n:(r=.5>=n?n*(1+r):n+r-n*r,n=2*n-r,this.r=e(n,r,t+1/3),this.g=e(n,r,t),this.b=e(n,r,t-1/3));return this}}(),setStyle:function(e){function t(t){void 0!==t&&1>parseFloat(t)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n=r[2];switch(r[1]){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(n)){var n=parseFloat(r[1])/360,i=parseInt(r[2],10)/100,o=parseInt(r[3],10)/100;t(r[5]);return this.setHSL(n,i,o)}}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(e)){r=r[1];n=r.length;if(3===n)return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,this;if(6===n)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,this}e&&0<e.length&&(r=THREE.ColorKeywords[e],void 0!==r?this.setHex(r):console.warn("THREE.Color: Unknown color "+e));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){this.r=e.r;this.g=e.g;this.b=e.b;return this},copyGammaToLinear:function(e,t){void 0===t&&(t=2);this.r=Math.pow(e.r,t);this.g=Math.pow(e.g,t);this.b=Math.pow(e.b,t);return this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var r=0<t?1/t:1;this.r=Math.pow(e.r,r);this.g=Math.pow(e.g,r);this.b=Math.pow(e.b,r);return this},convertGammaToLinear:function(){var e=this.r,t=this.g,r=this.b;this.r=e*e;this.g=t*t;this.b=r*r;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){e=e||{h:0,s:0,l:0};var t=this.r,r=this.g,n=this.b,i=Math.max(t,r,n),o=Math.min(t,r,n),a,s=(o+i)/2;if(o===i)o=a=0;else{var c=i-o,o=.5>=s?c/(i+o):c/(2-i-o);switch(i){case t:a=(r-n)/c+(r<n?6:0);break;case r:a=(n-t)/c+2;break;case n:a=(t-r)/c+4}a/=6}e.h=a;e.s=o;e.l=s;return e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,r){var n=this.getHSL();n.h+=e;n.s+=t;n.l+=r;this.setHSL(n.h,n.s,n.l);return this},add:function(e){this.r+=e.r;this.g+=e.g;this.b+=e.b;return this},addColors:function(e,t){this.r=e.r+t.r;this.g=e.g+t.g;this.b=e.b+t.b;return this},addScalar:function(e){this.r+=e;this.g+=e;this.b+=e;return this},multiply:function(e){this.r*=e.r;this.g*=e.g;this.b*=e.b;return this},multiplyScalar:function(e){this.r*=e;this.g*=e;this.b*=e;return this},lerp:function(e,t){this.r+=(e.r-this.r)*t;this.g+=(e.g-this.g)*t;this.b+=(e.b-this.b)*t;return this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){void 0===t&&(t=0);this.r=e[t];this.g=e[t+1];this.b=e[t+2];return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);e[t]=this.r;e[t+1]=this.g;e[t+2]=this.b;return e}};THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(e,t,r,n){this._x=e||0;this._y=t||0;this._z=r||0;this._w=void 0!==n?n:1};THREE.Quaternion.prototype={constructor:THREE.Quaternion,get x(){return this._x},set x(e){this._x=e;this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e;this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e;this.onChangeCallback()},get w(){return this._w},set w(e){this._w=e;this.onChangeCallback()},set:function(e,t,r,n){this._x=e;this._y=t;this._z=r;this._w=n;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){this._x=e.x;this._y=e.y;this._z=e.z;this._w=e.w;this.onChangeCallback();return this},setFromEuler:function(e,t){if(!1===e instanceof THREE.Euler)throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var r=Math.cos(e._x/2),n=Math.cos(e._y/2),i=Math.cos(e._z/2),o=Math.sin(e._x/2),a=Math.sin(e._y/2),s=Math.sin(e._z/2),c=e.order;"XYZ"===c?(this._x=o*n*i+r*a*s,this._y=r*a*i-o*n*s,this._z=r*n*s+o*a*i,this._w=r*n*i-o*a*s):"YXZ"===c?(this._x=o*n*i+r*a*s,this._y=r*a*i-o*n*s,this._z=r*n*s-o*a*i,this._w=r*n*i+o*a*s):"ZXY"===c?(this._x=o*n*i-r*a*s,this._y=r*a*i+o*n*s,this._z=r*n*s+o*a*i,this._w=r*n*i-o*a*s):"ZYX"===c?(this._x=o*n*i-r*a*s,this._y=r*a*i+o*n*s,this._z=r*n*s-o*a*i,this._w=r*n*i+o*a*s):"YZX"===c?(this._x=o*n*i+r*a*s,this._y=r*a*i+o*n*s,this._z=r*n*s-o*a*i,this._w=r*n*i-o*a*s):"XZY"===c&&(this._x=o*n*i-r*a*s,this._y=r*a*i-o*n*s,this._z=r*n*s+o*a*i,this._w=r*n*i+o*a*s);if(!1!==t)this.onChangeCallback();return this},setFromAxisAngle:function(e,t){var r=t/2,n=Math.sin(r);this._x=e.x*n;this._y=e.y*n;this._z=e.z*n;this._w=Math.cos(r);this.onChangeCallback();return this},setFromRotationMatrix:function(e){var t=e.elements,r=t[0];e=t[4];var n=t[8],i=t[1],o=t[5],a=t[9],s=t[2],c=t[6],t=t[10],u=r+o+t;0<u?(r=.5/Math.sqrt(u+1),this._w=.25/r,this._x=(c-a)*r,this._y=(n-s)*r,this._z=(i-e)*r):r>o&&r>t?(r=2*Math.sqrt(1+r-o-t),this._w=(c-a)/r,this._x=.25*r,this._y=(e+i)/r,this._z=(n+s)/r):o>t?(r=2*Math.sqrt(1+o-r-t),this._w=(n-s)/r,this._x=(e+i)/r,this._y=.25*r,this._z=(a+c)/r):(r=2*Math.sqrt(1+t-r-o),this._w=(i-e)/r,this._x=(n+s)/r,this._y=(a+c)/r,this._z=.25*r);this.onChangeCallback();return this},setFromUnitVectors:function(){var e,t;return function(r,n){void 0===e&&(e=new THREE.Vector3);t=r.dot(n)+1;1e-6>t?(t=0,Math.abs(r.x)>Math.abs(r.z)?e.set(-r.y,r.x,0):e.set(0,-r.z,r.y)):e.crossVectors(r,n);this._x=e.x;this._y=e.y;this._z=e.z;this._w=t;this.normalize();return this}}(),inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();0===e?(this._z=this._y=this._x=0,this._w=1):(e=1/e,this._x*=e,this._y*=e,this._z*=e,this._w*=e);this.onChangeCallback();return this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var r=e._x,n=e._y,i=e._z,o=e._w,a=t._x,s=t._y,c=t._z,u=t._w;this._x=r*u+o*a+n*c-i*s;this._y=n*u+o*s+i*a-r*c;this._z=i*u+o*c+r*s-n*a;this._w=o*u-r*a-n*s-i*c;this.onChangeCallback();return this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var r=this._x,n=this._y,i=this._z,o=this._w,a=o*e._w+r*e._x+n*e._y+i*e._z;0>a?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e);if(1<=a)return this._w=o,this._x=r,this._y=n,this._z=i,this;var s=Math.sqrt(1-a*a);if(.001>Math.abs(s))return this._w=.5*(o+this._w),this._x=.5*(r+this._x),this._y=.5*(n+this._y),this._z=.5*(i+this._z),this;var c=Math.atan2(s,a),a=Math.sin((1-t)*c)/s,s=Math.sin(t*c)/s;this._w=o*a+this._w*s;this._x=r*a+this._x*s;this._y=n*a+this._y*s;this._z=i*a+this._z*s;this.onChangeCallback();return this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){void 0===t&&(t=0);this._x=e[t];this._y=e[t+1];this._z=e[t+2];this._w=e[t+3];this.onChangeCallback();return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);e[t]=this._x;e[t+1]=this._y;e[t+2]=this._z;e[t+3]=this._w;return e},onChange:function(e){this.onChangeCallback=e;return this},onChangeCallback:function(){}};Object.assign(THREE.Quaternion,{slerp:function(e,t,r,n){return r.copy(e).slerp(t,n)},slerpFlat:function(e,t,r,n,i,o,a){var s=r[n+0],c=r[n+1],u=r[n+2];r=r[n+3];n=i[o+0];var l=i[o+1],h=i[o+2];i=i[o+3];if(r!==i||s!==n||c!==l||u!==h){o=1-a;var f=s*n+c*l+u*h+r*i,p=0<=f?1:-1,d=1-f*f;d>Number.EPSILON&&(d=Math.sqrt(d),f=Math.atan2(d,f*p),o=Math.sin(o*f)/d,a=Math.sin(a*f)/d);p*=a;s=s*o+n*p;c=c*o+l*p;u=u*o+h*p;r=r*o+i*p;o===1-a&&(a=1/Math.sqrt(s*s+c*c+u*u+r*r),s*=a,c*=a,u*=a,r*=a)}e[t]=s;e[t+1]=c;e[t+2]=u;e[t+3]=r}});THREE.Vector2=function(e,t){this.x=e||0;this.y=t||0};THREE.Vector2.prototype={constructor:THREE.Vector2,get width(){return this.x},set width(e){this.x=e},get height(){return this.y},set height(e){this.y=e},set:function(e,t){this.x=e;this.y=t;return this},setScalar:function(e){this.y=this.x=e;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){this.x=e.x;this.y=e.y;return this},add:function(e,t){if(void 0!==t)return console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t);this.x+=e.x;this.y+=e.y;return this},addScalar:function(e){this.x+=e;this.y+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;return this},addScaledVector:function(e,t){this.x+=e.x*t;this.y+=e.y*t;return this},sub:function(e,t){if(void 0!==t)return console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t);this.x-=e.x;this.y-=e.y;return this},subScalar:function(e){this.x-=e;this.y-=e;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;return this},multiply:function(e){this.x*=e.x;this.y*=e.y;return this},multiplyScalar:function(e){isFinite(e)?(this.x*=e,this.y*=e):this.y=this.x=0;return this},divide:function(e){this.x/=e.x;this.y/=e.y;return this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);return this},max:function(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);return this},clamp:function(e,t){this.x=Math.max(e.x,Math.min(t.x,this.x));this.y=Math.max(e.y,Math.min(t.y,this.y));return this},clampScalar:function(){var e,t;return function(r,n){void 0===e&&(e=new THREE.Vector2,t=new THREE.Vector2);e.set(r,r);t.set(n,n);return this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();this.multiplyScalar(Math.max(e,Math.min(t,r))/r);return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var e=Math.atan2(this.y,this.x);0>e&&(e+=2*Math.PI);return e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x;e=this.y-e.y;return t*t+e*e},setLength:function(e){return this.multiplyScalar(e/this.length())},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;return this},lerpVectors:function(e,t,r){this.subVectors(t,e).multiplyScalar(r).add(e);return this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){void 0===t&&(t=0);this.x=e[t];this.y=e[t+1];return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);e[t]=this.x;e[t+1]=this.y;return e},fromAttribute:function(e,t,r){void 0===r&&(r=0);t=t*e.itemSize+r;this.x=e.array[t];this.y=e.array[t+1];return this},rotateAround:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=this.x-e.x,o=this.y-e.y;this.x=i*r-o*n+e.x;this.y=i*n+o*r+e.y;return this}};THREE.Vector3=function(e,t,r){this.x=e||0;this.y=t||0;this.z=r||0};THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(e,t,r){this.x=e;this.y=t;this.z=r;return this},setScalar:function(e){this.z=this.y=this.x=e;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setZ:function(e){this.z=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;return this},add:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t);this.x+=e.x;this.y+=e.y;this.z+=e.z;return this},addScalar:function(e){this.x+=e;this.y+=e;this.z+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;this.z=e.z+t.z;return this},addScaledVector:function(e,t){this.x+=e.x*t;this.y+=e.y*t;this.z+=e.z*t;return this},sub:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t);this.x-=e.x;this.y-=e.y;this.z-=e.z;return this},subScalar:function(e){this.x-=e;this.y-=e;this.z-=e;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;this.z=e.z-t.z;return this},multiply:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t);this.x*=e.x;this.y*=e.y;this.z*=e.z;return this},multiplyScalar:function(e){isFinite(e)?(this.x*=e,this.y*=e,this.z*=e):this.z=this.y=this.x=0;return this},multiplyVectors:function(e,t){this.x=e.x*t.x;this.y=e.y*t.y;this.z=e.z*t.z;return this},applyEuler:function(){var e;return function(t){!1===t instanceof THREE.Euler&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");void 0===e&&(e=new THREE.Quaternion);this.applyQuaternion(e.setFromEuler(t));return this}}(),applyAxisAngle:function(){var e;return function(t,r){void 0===e&&(e=new THREE.Quaternion);this.applyQuaternion(e.setFromAxisAngle(t,r));return this}}(),applyMatrix3:function(e){var t=this.x,r=this.y,n=this.z;e=e.elements;this.x=e[0]*t+e[3]*r+e[6]*n;this.y=e[1]*t+e[4]*r+e[7]*n;this.z=e[2]*t+e[5]*r+e[8]*n;return this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z;e=e.elements;this.x=e[0]*t+e[4]*r+e[8]*n+e[12];this.y=e[1]*t+e[5]*r+e[9]*n+e[13];this.z=e[2]*t+e[6]*r+e[10]*n+e[14];return this},applyProjection:function(e){var t=this.x,r=this.y,n=this.z;e=e.elements;var i=1/(e[3]*t+e[7]*r+e[11]*n+e[15]);this.x=(e[0]*t+e[4]*r+e[8]*n+e[12])*i;this.y=(e[1]*t+e[5]*r+e[9]*n+e[13])*i;this.z=(e[2]*t+e[6]*r+e[10]*n+e[14])*i;return this},applyQuaternion:function(e){var t=this.x,r=this.y,n=this.z,i=e.x,o=e.y,a=e.z;e=e.w;var s=e*t+o*n-a*r,c=e*r+a*t-i*n,u=e*n+i*r-o*t,t=-i*t-o*r-a*n;this.x=s*e+t*-i+c*-a-u*-o;this.y=c*e+t*-o+u*-i-s*-a;this.z=u*e+t*-a+s*-o-c*-i;return this},project:function(){var e;return function(t){void 0===e&&(e=new THREE.Matrix4);e.multiplyMatrices(t.projectionMatrix,e.getInverse(t.matrixWorld));return this.applyProjection(e)}}(),unproject:function(){var e;return function(t){void 0===e&&(e=new THREE.Matrix4);e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix));
return this.applyProjection(e)}}(),transformDirection:function(e){var t=this.x,r=this.y,n=this.z;e=e.elements;this.x=e[0]*t+e[4]*r+e[8]*n;this.y=e[1]*t+e[5]*r+e[9]*n;this.z=e[2]*t+e[6]*r+e[10]*n;this.normalize();return this},divide:function(e){this.x/=e.x;this.y/=e.y;this.z/=e.z;return this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);this.z=Math.min(this.z,e.z);return this},max:function(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);this.z=Math.max(this.z,e.z);return this},clamp:function(e,t){this.x=Math.max(e.x,Math.min(t.x,this.x));this.y=Math.max(e.y,Math.min(t.y,this.y));this.z=Math.max(e.z,Math.min(t.z,this.z));return this},clampScalar:function(){var e,t;return function(r,n){void 0===e&&(e=new THREE.Vector3,t=new THREE.Vector3);e.set(r,r,r);t.set(n,n,n);return this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();this.multiplyScalar(Math.max(e,Math.min(t,r))/r);return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){return this.multiplyScalar(e/this.length())},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;this.z+=(e.z-this.z)*t;return this},lerpVectors:function(e,t,r){this.subVectors(t,e).multiplyScalar(r).add(e);return this},cross:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var r=this.x,n=this.y,i=this.z;this.x=n*e.z-i*e.y;this.y=i*e.x-r*e.z;this.z=r*e.y-n*e.x;return this},crossVectors:function(e,t){var r=e.x,n=e.y,i=e.z,o=t.x,a=t.y,s=t.z;this.x=n*s-i*a;this.y=i*o-r*s;this.z=r*a-n*o;return this},projectOnVector:function(){var e,t;return function(r){void 0===e&&(e=new THREE.Vector3);e.copy(r).normalize();t=this.dot(e);return this.copy(e).multiplyScalar(t)}}(),projectOnPlane:function(){var e;return function(t){void 0===e&&(e=new THREE.Vector3);e.copy(this).projectOnVector(t);return this.sub(e)}}(),reflect:function(){var e;return function(t){void 0===e&&(e=new THREE.Vector3);return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){e=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(THREE.Math.clamp(e,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;e=this.z-e.z;return t*t+r*r+e*e},setFromMatrixPosition:function(e){this.x=e.elements[12];this.y=e.elements[13];this.z=e.elements[14];return this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),r=this.set(e.elements[4],e.elements[5],e.elements[6]).length();e=this.set(e.elements[8],e.elements[9],e.elements[10]).length();this.x=t;this.y=r;this.z=e;return this},setFromMatrixColumn:function(e,t){var r=4*e,n=t.elements;this.x=n[r];this.y=n[r+1];this.z=n[r+2];return this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){void 0===t&&(t=0);this.x=e[t];this.y=e[t+1];this.z=e[t+2];return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);e[t]=this.x;e[t+1]=this.y;e[t+2]=this.z;return e},fromAttribute:function(e,t,r){void 0===r&&(r=0);t=t*e.itemSize+r;this.x=e.array[t];this.y=e.array[t+1];this.z=e.array[t+2];return this}};THREE.Vector4=function(e,t,r,n){this.x=e||0;this.y=t||0;this.z=r||0;this.w=void 0!==n?n:1};THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(e,t,r,n){this.x=e;this.y=t;this.z=r;this.w=n;return this},setScalar:function(e){this.w=this.z=this.y=this.x=e;return this},setX:function(e){this.x=e;return this},setY:function(e){this.y=e;return this},setZ:function(e){this.z=e;return this},setW:function(e){this.w=e;return this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){this.x=e.x;this.y=e.y;this.z=e.z;this.w=void 0!==e.w?e.w:1;return this},add:function(e,t){if(void 0!==t)return console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t);this.x+=e.x;this.y+=e.y;this.z+=e.z;this.w+=e.w;return this},addScalar:function(e){this.x+=e;this.y+=e;this.z+=e;this.w+=e;return this},addVectors:function(e,t){this.x=e.x+t.x;this.y=e.y+t.y;this.z=e.z+t.z;this.w=e.w+t.w;return this},addScaledVector:function(e,t){this.x+=e.x*t;this.y+=e.y*t;this.z+=e.z*t;this.w+=e.w*t;return this},sub:function(e,t){if(void 0!==t)return console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t);this.x-=e.x;this.y-=e.y;this.z-=e.z;this.w-=e.w;return this},subScalar:function(e){this.x-=e;this.y-=e;this.z-=e;this.w-=e;return this},subVectors:function(e,t){this.x=e.x-t.x;this.y=e.y-t.y;this.z=e.z-t.z;this.w=e.w-t.w;return this},multiplyScalar:function(e){isFinite(e)?(this.x*=e,this.y*=e,this.z*=e,this.w*=e):this.w=this.z=this.y=this.x=0;return this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=this.w;e=e.elements;this.x=e[0]*t+e[4]*r+e[8]*n+e[12]*i;this.y=e[1]*t+e[5]*r+e[9]*n+e[13]*i;this.z=e[2]*t+e[6]*r+e[10]*n+e[14]*i;this.w=e[3]*t+e[7]*r+e[11]*n+e[15]*i;return this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);1e-4>t?(this.x=1,this.z=this.y=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t);return this},setAxisAngleFromRotationMatrix:function(e){var t,r,n;e=e.elements;var i=e[0];n=e[4];var o=e[8],a=e[1],s=e[5],c=e[9];r=e[2];t=e[6];var u=e[10];if(.01>Math.abs(n-a)&&.01>Math.abs(o-r)&&.01>Math.abs(c-t)){if(.1>Math.abs(n+a)&&.1>Math.abs(o+r)&&.1>Math.abs(c+t)&&.1>Math.abs(i+s+u-3))return this.set(1,0,0,0),this;e=Math.PI;i=(i+1)/2;s=(s+1)/2;u=(u+1)/2;n=(n+a)/4;o=(o+r)/4;c=(c+t)/4;i>s&&i>u?.01>i?(t=0,n=r=.707106781):(t=Math.sqrt(i),r=n/t,n=o/t):s>u?.01>s?(t=.707106781,r=0,n=.707106781):(r=Math.sqrt(s),t=n/r,n=c/r):.01>u?(r=t=.707106781,n=0):(n=Math.sqrt(u),t=o/n,r=c/n);this.set(t,r,n,e);return this}e=Math.sqrt((t-c)*(t-c)+(o-r)*(o-r)+(a-n)*(a-n));.001>Math.abs(e)&&(e=1);this.x=(t-c)/e;this.y=(o-r)/e;this.z=(a-n)/e;this.w=Math.acos((i+s+u-1)/2);return this},min:function(e){this.x=Math.min(this.x,e.x);this.y=Math.min(this.y,e.y);this.z=Math.min(this.z,e.z);this.w=Math.min(this.w,e.w);return this},max:function(e){this.x=Math.max(this.x,e.x);this.y=Math.max(this.y,e.y);this.z=Math.max(this.z,e.z);this.w=Math.max(this.w,e.w);return this},clamp:function(e,t){this.x=Math.max(e.x,Math.min(t.x,this.x));this.y=Math.max(e.y,Math.min(t.y,this.y));this.z=Math.max(e.z,Math.min(t.z,this.z));this.w=Math.max(e.w,Math.min(t.w,this.w));return this},clampScalar:function(){var e,t;return function(r,n){void 0===e&&(e=new THREE.Vector4,t=new THREE.Vector4);e.set(r,r,r,r);t.set(n,n,n,n);return this.clamp(e,t)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){return this.multiplyScalar(e/this.length())},lerp:function(e,t){this.x+=(e.x-this.x)*t;this.y+=(e.y-this.y)*t;this.z+=(e.z-this.z)*t;this.w+=(e.w-this.w)*t;return this},lerpVectors:function(e,t,r){this.subVectors(t,e).multiplyScalar(r).add(e);return this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){void 0===t&&(t=0);this.x=e[t];this.y=e[t+1];this.z=e[t+2];this.w=e[t+3];return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);e[t]=this.x;e[t+1]=this.y;e[t+2]=this.z;e[t+3]=this.w;return e},fromAttribute:function(e,t,r){void 0===r&&(r=0);t=t*e.itemSize+r;this.x=e.array[t];this.y=e.array[t+1];this.z=e.array[t+2];this.w=e.array[t+3];return this}};THREE.Euler=function(e,t,r,n){this._x=e||0;this._y=t||0;this._z=r||0;this._order=n||THREE.Euler.DefaultOrder};THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");THREE.Euler.DefaultOrder="XYZ";THREE.Euler.prototype={constructor:THREE.Euler,get x(){return this._x},set x(e){this._x=e;this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e;this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e;this.onChangeCallback()},get order(){return this._order},set order(e){this._order=e;this.onChangeCallback()},set:function(e,t,r,n){this._x=e;this._y=t;this._z=r;this._order=n||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){this._x=e._x;this._y=e._y;this._z=e._z;this._order=e._order;this.onChangeCallback();return this},setFromRotationMatrix:function(e,t,r){var n=THREE.Math.clamp,i=e.elements;e=i[0];var o=i[4],a=i[8],s=i[1],c=i[5],u=i[9],l=i[2],h=i[6],i=i[10];t=t||this._order;"XYZ"===t?(this._y=Math.asin(n(a,-1,1)),.99999>Math.abs(a)?(this._x=Math.atan2(-u,i),this._z=Math.atan2(-o,e)):(this._x=Math.atan2(h,c),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(u,-1,1)),.99999>Math.abs(u)?(this._y=Math.atan2(a,i),this._z=Math.atan2(s,c)):(this._y=Math.atan2(-l,e),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(h,-1,1)),.99999>Math.abs(h)?(this._y=Math.atan2(-l,i),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(s,e))):"ZYX"===t?(this._y=Math.asin(-n(l,-1,1)),.99999>Math.abs(l)?(this._x=Math.atan2(h,i),this._z=Math.atan2(s,e)):(this._x=0,this._z=Math.atan2(-o,c))):"YZX"===t?(this._z=Math.asin(n(s,-1,1)),.99999>Math.abs(s)?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-l,e)):(this._x=0,this._y=Math.atan2(a,i))):"XZY"===t?(this._z=Math.asin(-n(o,-1,1)),.99999>Math.abs(o)?(this._x=Math.atan2(h,c),this._y=Math.atan2(a,e)):(this._x=Math.atan2(-u,i),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t);this._order=t;if(!1!==r)this.onChangeCallback();return this},setFromQuaternion:function(){var e;return function(t,r,n){void 0===e&&(e=new THREE.Matrix4);e.makeRotationFromQuaternion(t);this.setFromRotationMatrix(e,r,n);return this}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new THREE.Quaternion;return function(t){e.setFromEuler(this);this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){this._x=e[0];this._y=e[1];this._z=e[2];void 0!==e[3]&&(this._order=e[3]);this.onChangeCallback();return this},toArray:function(e,t){void 0===e&&(e=[]);void 0===t&&(t=0);e[t]=this._x;e[t+1]=this._y;e[t+2]=this._z;e[t+3]=this._order;return e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new THREE.Vector3(this._x,this._y,this._z)},onChange:function(e){this.onChangeCallback=e;return this},onChangeCallback:function(){}};THREE.Line3=function(e,t){this.start=void 0!==e?e:new THREE.Vector3;this.end=void 0!==t?t:new THREE.Vector3};THREE.Line3.prototype={constructor:THREE.Line3,set:function(e,t){this.start.copy(e);this.end.copy(t);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.start.copy(e.start);this.end.copy(e.end);return this},center:function(e){return(e||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return(e||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var r=t||new THREE.Vector3;return this.delta(r).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(r,n){e.subVectors(r,this.start);t.subVectors(this.end,this.start);var i=t.dot(t),i=t.dot(e)/i;n&&(i=THREE.Math.clamp(i,0,1));return i}}(),closestPointToPoint:function(e,t,r){e=this.closestPointToPointParameter(e,t);r=r||new THREE.Vector3;return this.delta(r).multiplyScalar(e).add(this.start)},applyMatrix4:function(e){this.start.applyMatrix4(e);this.end.applyMatrix4(e);return this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}};THREE.Box2=function(e,t){this.min=void 0!==e?e:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==t?t:new THREE.Vector2(-Infinity,-Infinity)};THREE.Box2.prototype={constructor:THREE.Box2,set:function(e,t){this.min.copy(e);this.max.copy(t);return this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new THREE.Vector2;return function(t,r){var n=e.copy(r).multiplyScalar(.5);this.min.copy(t).sub(n);this.max.copy(t).add(n);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.min.copy(e.min);this.max.copy(e.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){return(e||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(e){this.min.min(e);this.max.max(e);return this},expandByVector:function(e){this.min.sub(e);this.max.add(e);return this},expandByScalar:function(e){this.min.addScalar(-e);this.max.addScalar(e);return this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y?!0:!1},getParameter:function(e,t){return(t||new THREE.Vector2).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y?!1:!0},clampPoint:function(e,t){return(t||new THREE.Vector2).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector2;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){this.min.max(e.min);this.max.min(e.max);return this},union:function(e){this.min.min(e.min);this.max.max(e.max);return this},translate:function(e){this.min.add(e);this.max.add(e);return this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};THREE.Box3=function(e,t){this.min=void 0!==e?e:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==t?t:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};THREE.Box3.prototype={constructor:THREE.Box3,set:function(e,t){this.min.copy(e);this.max.copy(t);return this},setFromArray:function(e){this.makeEmpty();for(var t=Infinity,r=Infinity,n=Infinity,i=-Infinity,o=-Infinity,a=-Infinity,s=0,c=e.length;s<c;s+=3){var u=e[s],l=e[s+1],h=e[s+2];u<t&&(t=u);l<r&&(r=l);h<n&&(n=h);u>i&&(i=u);l>o&&(o=l);h>a&&(a=h)}this.min.set(t,r,n);this.max.set(i,o,a)},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new THREE.Vector3;return function(t,r){var n=e.copy(r).multiplyScalar(.5);this.min.copy(t).sub(n);this.max.copy(t).add(n);return this}}(),setFromObject:function(){var e;return function(t){void 0===e&&(e=new THREE.Box3);var r=this;this.makeEmpty();t.updateMatrixWorld(!0);t.traverse(function(t){var n=t.geometry;void 0!==n&&(null===n.boundingBox&&n.computeBoundingBox(),e.copy(n.boundingBox),e.applyMatrix4(t.matrixWorld),r.union(e))});return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.min.copy(e.min);this.max.copy(e.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){return(e||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(e){this.min.min(e);this.max.max(e);return this},expandByVector:function(e){this.min.sub(e);this.max.add(e);return this},expandByScalar:function(e){this.min.addScalar(-e);this.max.addScalar(e);return this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z?!0:!1},getParameter:function(e,t){return(t||new THREE.Vector3).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?!1:!0},intersectsSphere:function(){var e;return function(t){void 0===e&&(e=new THREE.Vector3);this.clampPoint(t.center,e);return e.distanceToSquared(t.center)<=t.radius*t.radius}}(),intersectsPlane:function(e){var t,r;0<e.normal.x?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x);0<e.normal.y?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y);0<e.normal.z?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z);return t<=e.constant&&r>=e.constant},clampPoint:function(e,t){return(t||new THREE.Vector3).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector3;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new THREE.Vector3;return function(t){t=t||new THREE.Sphere;t.center=this.center();t.radius=.5*this.size(e).length();return t}}(),intersect:function(e){this.min.max(e.min);this.max.min(e.max);return this},union:function(e){this.min.min(e.min);this.max.max(e.max);return this},applyMatrix4:function(){var e=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(t){e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t);e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t);e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t);e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t);e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t);e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t);e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t);e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t);this.makeEmpty();this.setFromPoints(e);return this}}(),translate:function(e){this.min.add(e);this.max.add(e);return this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};THREE.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]);0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")};THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(e,t,r,n,i,o,a,s,c){var u=this.elements;u[0]=e;u[3]=t;u[6]=r;u[1]=n;u[4]=i;u[7]=o;u[2]=a;u[5]=s;u[8]=c;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){e=e.elements;this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]);return this},applyToVector3Array:function(){var e;return function(t,r,n){void 0===e&&(e=new THREE.Vector3);void 0===r&&(r=0);void 0===n&&(n=t.length);for(var i=0;i<n;i+=3,r+=3)e.fromArray(t,r),e.applyMatrix3(this),e.toArray(t,r);return t}}(),applyToBuffer:function(){var e;return function(t,r,n){void 0===e&&(e=new THREE.Vector3);void 0===r&&(r=0);void 0===n&&(n=t.length/t.itemSize);for(var i=0;i<n;i++,r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix3(this),t.setXYZ(e.x,e.y,e.z);return t}}(),multiplyScalar:function(e){var t=this.elements;t[0]*=e;t[3]*=e;t[6]*=e;t[1]*=e;t[4]*=e;t[7]*=e;t[2]*=e;t[5]*=e;t[8]*=e;return this},determinant:function(){var e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],c=e[7],e=e[8];return t*o*e-t*a*c-r*i*e+r*a*s+n*i*c-n*o*s},getInverse:function(e,t){var r=e.elements,n=this.elements;n[0]=r[10]*r[5]-r[6]*r[9];n[1]=-r[10]*r[1]+r[2]*r[9];n[2]=r[6]*r[1]-r[2]*r[5];n[3]=-r[10]*r[4]+r[6]*r[8];n[4]=r[10]*r[0]-r[2]*r[8];n[5]=-r[6]*r[0]+r[2]*r[4];n[6]=r[9]*r[4]-r[5]*r[8];n[7]=-r[9]*r[0]+r[1]*r[8];n[8]=r[5]*r[0]-r[1]*r[4];r=r[0]*n[0]+r[1]*n[3]+r[2]*n[6];if(0===r){if(t)throw Error("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/r);return this},transpose:function(){var e,t=this.elements;e=t[1];t[1]=t[3];t[3]=e;e=t[2];t[2]=t[6];t[6]=e;e=t[5];t[5]=t[7];t[7]=e;return this},flattenToArrayOffset:function(e,t){var r=this.elements;e[t]=r[0];e[t+1]=r[1];e[t+2]=r[2];e[t+3]=r[3];e[t+4]=r[4];e[t+5]=r[5];e[t+6]=r[6];e[t+7]=r[7];e[t+8]=r[8];return e},getNormalMatrix:function(e){this.getInverse(e).transpose();return this},transposeIntoArray:function(e){var t=this.elements;e[0]=t[0];e[1]=t[3];e[2]=t[6];e[3]=t[1];e[4]=t[4];e[5]=t[7];e[6]=t[2];e[7]=t[5];e[8]=t[8];return this},fromArray:function(e){this.elements.set(e);return this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]}};THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")};THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(e,t,r,n,i,o,a,s,c,u,l,h,f,p,d,m){var E=this.elements;E[0]=e;E[4]=t;E[8]=r;E[12]=n;E[1]=i;E[5]=o;E[9]=a;E[13]=s;E[2]=c;E[6]=u;E[10]=l;E[14]=h;E[3]=f;E[7]=p;E[11]=d;E[15]=m;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new THREE.Matrix4).fromArray(this.elements)},copy:function(e){this.elements.set(e.elements);return this},copyPosition:function(e){var t=this.elements;e=e.elements;t[12]=e[12];t[13]=e[13];t[14]=e[14];return this},extractBasis:function(e,t,r){var n=this.elements;e.set(n[0],n[1],n[2]);t.set(n[4],n[5],n[6]);r.set(n[8],n[9],n[10]);return this},makeBasis:function(e,t,r){this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1);return this},extractRotation:function(){var e;return function(t){void 0===e&&(e=new THREE.Vector3);var r=this.elements;t=t.elements;var n=1/e.set(t[0],t[1],t[2]).length(),i=1/e.set(t[4],t[5],t[6]).length(),o=1/e.set(t[8],t[9],t[10]).length();r[0]=t[0]*n;r[1]=t[1]*n;r[2]=t[2]*n;r[4]=t[4]*i;r[5]=t[5]*i;r[6]=t[6]*i;r[8]=t[8]*o;r[9]=t[9]*o;r[10]=t[10]*o;return this}}(),makeRotationFromEuler:function(e){!1===e instanceof THREE.Euler&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,r=e.x,n=e.y,i=e.z,o=Math.cos(r),r=Math.sin(r),a=Math.cos(n),n=Math.sin(n),s=Math.cos(i),i=Math.sin(i);if("XYZ"===e.order){e=o*s;var c=o*i,u=r*s,l=r*i;t[0]=a*s;t[4]=-a*i;t[8]=n;t[1]=c+u*n;t[5]=e-l*n;t[9]=-r*a;t[2]=l-e*n;t[6]=u+c*n;t[10]=o*a}else"YXZ"===e.order?(e=a*s,c=a*i,u=n*s,l=n*i,t[0]=e+l*r,t[4]=u*r-c,t[8]=o*n,t[1]=o*i,t[5]=o*s,t[9]=-r,t[2]=c*r-u,t[6]=l+e*r,t[10]=o*a):"ZXY"===e.order?(e=a*s,c=a*i,u=n*s,l=n*i,t[0]=e-l*r,t[4]=-o*i,t[8]=u+c*r,t[1]=c+u*r,t[5]=o*s,t[9]=l-e*r,t[2]=-o*n,t[6]=r,t[10]=o*a):"ZYX"===e.order?(e=o*s,c=o*i,u=r*s,l=r*i,t[0]=a*s,t[4]=u*n-c,t[8]=e*n+l,t[1]=a*i,t[5]=l*n+e,t[9]=c*n-u,t[2]=-n,t[6]=r*a,t[10]=o*a):"YZX"===e.order?(e=o*a,c=o*n,u=r*a,l=r*n,t[0]=a*s,t[4]=l-e*i,t[8]=u*i+c,t[1]=i,t[5]=o*s,t[9]=-r*s,t[2]=-n*s,t[6]=c*i+u,t[10]=e-l*i):"XZY"===e.order&&(e=o*a,c=o*n,u=r*a,l=r*n,t[0]=a*s,t[4]=-i,t[8]=n*s,t[1]=e*i+l,t[5]=o*s,t[9]=c*i-u,t[2]=u*i-c,t[6]=r*s,t[10]=l*i+e);t[3]=0;t[7]=0;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this},makeRotationFromQuaternion:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z,o=e.w,a=r+r,s=n+n,c=i+i;e=r*a;var u=r*s,r=r*c,l=n*s,n=n*c,i=i*c,a=o*a,s=o*s,o=o*c;t[0]=1-(l+i);t[4]=u-o;t[8]=r+s;t[1]=u+o;t[5]=1-(e+i);t[9]=n-a;t[2]=r-s;t[6]=n+a;t[10]=1-(e+l);t[3]=0;t[7]=0;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return this},lookAt:function(){var e,t,r;return function(n,i,o){void 0===e&&(e=new THREE.Vector3);void 0===t&&(t=new THREE.Vector3);void 0===r&&(r=new THREE.Vector3);var a=this.elements;r.subVectors(n,i).normalize();0===r.lengthSq()&&(r.z=1);e.crossVectors(o,r).normalize();0===e.lengthSq()&&(r.x+=1e-4,e.crossVectors(o,r).normalize());t.crossVectors(r,e);a[0]=e.x;a[4]=t.x;a[8]=r.x;a[1]=e.y;a[5]=t.y;a[9]=r.y;a[2]=e.z;a[6]=t.z;a[10]=r.z;return this}}(),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,o=r[0],a=r[4],s=r[8],c=r[12],u=r[1],l=r[5],h=r[9],f=r[13],p=r[2],d=r[6],m=r[10],E=r[14],g=r[3],v=r[7],y=r[11],r=r[15],b=n[0],T=n[4],R=n[8],w=n[12],x=n[1],H=n[5],_=n[9],S=n[13],M=n[2],A=n[6],C=n[10],k=n[14],L=n[3],P=n[7],O=n[11],n=n[15];i[0]=o*b+a*x+s*M+c*L;i[4]=o*T+a*H+s*A+c*P;i[8]=o*R+a*_+s*C+c*O;i[12]=o*w+a*S+s*k+c*n;i[1]=u*b+l*x+h*M+f*L;i[5]=u*T+l*H+h*A+f*P;i[9]=u*R+l*_+h*C+f*O;i[13]=u*w+l*S+h*k+f*n;i[2]=p*b+d*x+m*M+E*L;i[6]=p*T+d*H+m*A+E*P;i[10]=p*R+d*_+m*C+E*O;i[14]=p*w+d*S+m*k+E*n;i[3]=g*b+v*x+y*M+r*L;i[7]=g*T+v*H+y*A+r*P;i[11]=g*R+v*_+y*C+r*O;i[15]=g*w+v*S+y*k+r*n;return this},multiplyToArray:function(e,t,r){var n=this.elements;this.multiplyMatrices(e,t);r[0]=n[0];r[1]=n[1];r[2]=n[2];r[3]=n[3];r[4]=n[4];r[5]=n[5];r[6]=n[6];r[7]=n[7];r[8]=n[8];r[9]=n[9];r[10]=n[10];r[11]=n[11];r[12]=n[12];r[13]=n[13];r[14]=n[14];r[15]=n[15];return this},multiplyScalar:function(e){var t=this.elements;t[0]*=e;t[4]*=e;t[8]*=e;t[12]*=e;t[1]*=e;t[5]*=e;t[9]*=e;t[13]*=e;t[2]*=e;t[6]*=e;t[10]*=e;t[14]*=e;t[3]*=e;t[7]*=e;t[11]*=e;t[15]*=e;return this},applyToVector3Array:function(){var e;return function(t,r,n){void 0===e&&(e=new THREE.Vector3);void 0===r&&(r=0);void 0===n&&(n=t.length);for(var i=0;i<n;i+=3,r+=3)e.fromArray(t,r),e.applyMatrix4(this),e.toArray(t,r);return t}}(),applyToBuffer:function(){var e;return function(t,r,n){void 0===e&&(e=new THREE.Vector3);void 0===r&&(r=0);void 0===n&&(n=t.length/t.itemSize);for(var i=0;i<n;i++,r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix4(this),t.setXYZ(e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],o=e[1],a=e[5],s=e[9],c=e[13],u=e[2],l=e[6],h=e[10],f=e[14];return e[3]*(+i*s*l-n*c*l-i*a*h+r*c*h+n*a*f-r*s*f)+e[7]*(+t*s*f-t*c*h+i*o*h-n*o*f+n*c*u-i*s*u)+e[11]*(+t*c*l-t*a*f-i*o*l+r*o*f+i*a*u-r*c*u)+e[15]*(-n*a*u-t*s*l+t*a*h+n*o*l-r*o*h+r*s*u)},transpose:function(){var e=this.elements,t;t=e[1];e[1]=e[4];e[4]=t;t=e[2];e[2]=e[8];e[8]=t;t=e[6];e[6]=e[9];e[9]=t;t=e[3];e[3]=e[12];e[12]=t;t=e[7];e[7]=e[13];e[13]=t;t=e[11];e[11]=e[14];e[14]=t;return this},flattenToArrayOffset:function(e,t){var r=this.elements;e[t]=r[0];e[t+1]=r[1];e[t+2]=r[2];e[t+3]=r[3];e[t+4]=r[4];e[t+5]=r[5];e[t+6]=r[6];e[t+7]=r[7];e[t+8]=r[8];e[t+9]=r[9];e[t+10]=r[10];e[t+11]=r[11];e[t+12]=r[12];e[t+13]=r[13];e[t+14]=r[14];e[t+15]=r[15];return e},getPosition:function(){var e;return function(){void 0===e&&(e=new THREE.Vector3);console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;t[12]=e.x;t[13]=e.y;t[14]=e.z;return this},getInverse:function(e,t){var r=this.elements,n=e.elements,i=n[0],o=n[4],a=n[8],s=n[12],c=n[1],u=n[5],l=n[9],h=n[13],f=n[2],p=n[6],d=n[10],m=n[14],E=n[3],g=n[7],v=n[11],n=n[15];r[0]=l*m*g-h*d*g+h*p*v-u*m*v-l*p*n+u*d*n;r[4]=s*d*g-a*m*g-s*p*v+o*m*v+a*p*n-o*d*n;r[8]=a*h*g-s*l*g+s*u*v-o*h*v-a*u*n+o*l*n;r[12]=s*l*p-a*h*p-s*u*d+o*h*d+a*u*m-o*l*m;r[1]=h*d*E-l*m*E-h*f*v+c*m*v+l*f*n-c*d*n;r[5]=a*m*E-s*d*E+s*f*v-i*m*v-a*f*n+i*d*n;r[9]=s*l*E-a*h*E-s*c*v+i*h*v+a*c*n-i*l*n;r[13]=a*h*f-s*l*f+s*c*d-i*h*d-a*c*m+i*l*m;r[2]=u*m*E-h*p*E+h*f*g-c*m*g-u*f*n+c*p*n;r[6]=s*p*E-o*m*E-s*f*g+i*m*g+o*f*n-i*p*n;r[10]=o*h*E-s*u*E+s*c*g-i*h*g-o*c*n+i*u*n;r[14]=s*u*f-o*h*f-s*c*p+i*h*p+o*c*m-i*u*m;r[3]=l*p*E-u*d*E-l*f*g+c*d*g+u*f*v-c*p*v;r[7]=o*d*E-a*p*E+a*f*g-i*d*g-o*f*v+i*p*v;r[11]=a*u*E-o*l*E-a*c*g+i*l*g+o*c*v-i*u*v;r[15]=o*l*f-a*u*f+a*c*p-i*l*p-o*c*d+i*u*d;r=i*r[0]+c*r[4]+f*r[8]+E*r[12];if(0===r){if(t)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/r);return this},scale:function(e){var t=this.elements,r=e.x,n=e.y;e=e.z;t[0]*=r;t[4]*=n;t[8]*=e;t[1]*=r;t[5]*=n;t[9]*=e;t[2]*=r;t[6]*=n;t[10]*=e;t[3]*=r;t[7]*=n;t[11]*=e;return this},getMaxScaleOnAxis:function(){var e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))},makeTranslation:function(e,t,r){this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1);return this},makeRotationX:function(e){var t=Math.cos(e);e=Math.sin(e);this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1);return this},makeRotationY:function(e){var t=Math.cos(e);e=Math.sin(e);this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1);return this},makeRotationZ:function(e){var t=Math.cos(e);e=Math.sin(e);this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=1-r,o=e.x,a=e.y,s=e.z,c=i*o,u=i*a;this.set(c*o+r,c*a-n*s,c*s+n*a,0,c*a+n*s,u*a+r,u*s-n*o,0,c*s-n*a,u*s+n*o,i*s*s+r,0,0,0,0,1);return this},makeScale:function(e,t,r){
this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1);return this},compose:function(e,t,r){this.makeRotationFromQuaternion(t);this.scale(r);this.setPosition(e);return this},decompose:function(){var e,t;return function(r,n,i){void 0===e&&(e=new THREE.Vector3);void 0===t&&(t=new THREE.Matrix4);var o=this.elements,a=e.set(o[0],o[1],o[2]).length(),s=e.set(o[4],o[5],o[6]).length(),c=e.set(o[8],o[9],o[10]).length();0>this.determinant()&&(a=-a);r.x=o[12];r.y=o[13];r.z=o[14];t.elements.set(this.elements);r=1/a;var o=1/s,u=1/c;t.elements[0]*=r;t.elements[1]*=r;t.elements[2]*=r;t.elements[4]*=o;t.elements[5]*=o;t.elements[6]*=o;t.elements[8]*=u;t.elements[9]*=u;t.elements[10]*=u;n.setFromRotationMatrix(t);i.x=a;i.y=s;i.z=c;return this}}(),makeFrustum:function(e,t,r,n,i,o){var a=this.elements;a[0]=2*i/(t-e);a[4]=0;a[8]=(t+e)/(t-e);a[12]=0;a[1]=0;a[5]=2*i/(n-r);a[9]=(n+r)/(n-r);a[13]=0;a[2]=0;a[6]=0;a[10]=-(o+i)/(o-i);a[14]=-2*o*i/(o-i);a[3]=0;a[7]=0;a[11]=-1;a[15]=0;return this},makePerspective:function(e,t,r,n){e=r*Math.tan(THREE.Math.degToRad(.5*e));var i=-e;return this.makeFrustum(i*t,e*t,i,e,r,n)},makeOrthographic:function(e,t,r,n,i,o){var a=this.elements,s=t-e,c=r-n,u=o-i;a[0]=2/s;a[4]=0;a[8]=0;a[12]=-((t+e)/s);a[1]=0;a[5]=2/c;a[9]=0;a[13]=-((r+n)/c);a[2]=0;a[6]=0;a[10]=-2/u;a[14]=-((o+i)/u);a[3]=0;a[7]=0;a[11]=0;a[15]=1;return this},equals:function(e){var t=this.elements;e=e.elements;for(var r=0;16>r;r++)if(t[r]!==e[r])return!1;return!0},fromArray:function(e){this.elements.set(e);return this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}};THREE.Ray=function(e,t){this.origin=void 0!==e?e:new THREE.Vector3;this.direction=void 0!==t?t:new THREE.Vector3};THREE.Ray.prototype={constructor:THREE.Ray,set:function(e,t){this.origin.copy(e);this.direction.copy(t);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.origin.copy(e.origin);this.direction.copy(e.direction);return this},at:function(e,t){return(t||new THREE.Vector3).copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){this.direction.copy(e).sub(this.origin).normalize()},recast:function(){var e=new THREE.Vector3;return function(t){this.origin.copy(this.at(t,e));return this}}(),closestPointToPoint:function(e,t){var r=t||new THREE.Vector3;r.subVectors(e,this.origin);var n=r.dot(this.direction);return 0>n?r.copy(this.origin):r.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new THREE.Vector3;return function(t){var r=e.subVectors(t,this.origin).dot(this.direction);if(0>r)return this.origin.distanceToSquared(t);e.copy(this.direction).multiplyScalar(r).add(this.origin);return e.distanceToSquared(t)}}(),distanceSqToSegment:function(){var e=new THREE.Vector3,t=new THREE.Vector3,r=new THREE.Vector3;return function(n,i,o,a){e.copy(n).add(i).multiplyScalar(.5);t.copy(i).sub(n).normalize();r.copy(this.origin).sub(e);var s=.5*n.distanceTo(i),c=-this.direction.dot(t),u=r.dot(this.direction),l=-r.dot(t),h=r.lengthSq(),f=Math.abs(1-c*c),p;0<f?(n=c*l-u,i=c*u-l,p=s*f,0<=n?i>=-p?i<=p?(s=1/f,n*=s,i*=s,c=n*(n+c*i+2*u)+i*(c*n+i+2*l)+h):(i=s,n=Math.max(0,-(c*i+u)),c=-n*n+i*(i+2*l)+h):(i=-s,n=Math.max(0,-(c*i+u)),c=-n*n+i*(i+2*l)+h):i<=-p?(n=Math.max(0,-(-c*s+u)),i=0<n?-s:Math.min(Math.max(-s,-l),s),c=-n*n+i*(i+2*l)+h):i<=p?(n=0,i=Math.min(Math.max(-s,-l),s),c=i*(i+2*l)+h):(n=Math.max(0,-(c*s+u)),i=0<n?s:Math.min(Math.max(-s,-l),s),c=-n*n+i*(i+2*l)+h)):(i=0<c?-s:s,n=Math.max(0,-(c*i+u)),c=-n*n+i*(i+2*l)+h);o&&o.copy(this.direction).multiplyScalar(n).add(this.origin);a&&a.copy(t).multiplyScalar(i).add(e);return c}}(),intersectSphere:function(){var e=new THREE.Vector3;return function(t,r){e.subVectors(t.center,this.origin);var n=e.dot(this.direction),i=e.dot(e)-n*n,o=t.radius*t.radius;if(i>o)return null;o=Math.sqrt(o-i);i=n-o;n+=o;return 0>i&&0>n?null:0>i?this.at(n,r):this.at(i,r)}}(),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;e=-(this.origin.dot(e.normal)+e.constant)/t;return 0<=e?e:null},intersectPlane:function(e,t){var r=this.distanceToPlane(e);return null===r?null:this.at(r,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||0>e.normal.dot(this.direction)*t?!0:!1},intersectBox:function(e,t){var r,n,i,o,a;n=1/this.direction.x;o=1/this.direction.y;a=1/this.direction.z;var s=this.origin;0<=n?(r=(e.min.x-s.x)*n,n*=e.max.x-s.x):(r=(e.max.x-s.x)*n,n*=e.min.x-s.x);0<=o?(i=(e.min.y-s.y)*o,o*=e.max.y-s.y):(i=(e.max.y-s.y)*o,o*=e.min.y-s.y);if(r>o||i>n)return null;if(i>r||r!==r)r=i;if(o<n||n!==n)n=o;0<=a?(i=(e.min.z-s.z)*a,a*=e.max.z-s.z):(i=(e.max.z-s.z)*a,a*=e.min.z-s.z);if(r>a||i>n)return null;if(i>r||r!==r)r=i;if(a<n||n!==n)n=a;return 0>n?null:this.at(0<=r?r:n,t)},intersectsBox:function(){var e=new THREE.Vector3;return function(t){return null!==this.intersectBox(t,e)}}(),intersectTriangle:function(){var e=new THREE.Vector3,t=new THREE.Vector3,r=new THREE.Vector3,n=new THREE.Vector3;return function(i,o,a,s,c){t.subVectors(o,i);r.subVectors(a,i);n.crossVectors(t,r);o=this.direction.dot(n);if(0<o){if(s)return null;s=1}else if(0>o)s=-1,o=-o;else return null;e.subVectors(this.origin,i);i=s*this.direction.dot(r.crossVectors(e,r));if(0>i)return null;a=s*this.direction.dot(t.cross(e));if(0>a||i+a>o)return null;i=-s*e.dot(n);return 0>i?null:this.at(i/o,c)}}(),applyMatrix4:function(e){this.direction.add(this.origin).applyMatrix4(e);this.origin.applyMatrix4(e);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}};THREE.Sphere=function(e,t){this.center=void 0!==e?e:new THREE.Vector3;this.radius=void 0!==t?t:0};THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(e,t){this.center.copy(e);this.radius=t;return this},setFromPoints:function(){var e=new THREE.Box3;return function(t,r){var n=this.center;void 0!==r?n.copy(r):e.setFromPoints(t).center(n);for(var i=0,o=0,a=t.length;o<a;o++)i=Math.max(i,n.distanceToSquared(t[o]));this.radius=Math.sqrt(i);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.center.copy(e.center);this.radius=e.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(this.center.dot(e.normal)-e.constant)<=this.radius},clampPoint:function(e,t){var r=this.center.distanceToSquared(e),n=t||new THREE.Vector3;n.copy(e);r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center));return n},getBoundingBox:function(e){e=e||new THREE.Box3;e.set(this.center,this.center);e.expandByScalar(this.radius);return e},applyMatrix4:function(e){this.center.applyMatrix4(e);this.radius*=e.getMaxScaleOnAxis();return this},translate:function(e){this.center.add(e);return this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}};THREE.Frustum=function(e,t,r,n,i,o){this.planes=[void 0!==e?e:new THREE.Plane,void 0!==t?t:new THREE.Plane,void 0!==r?r:new THREE.Plane,void 0!==n?n:new THREE.Plane,void 0!==i?i:new THREE.Plane,void 0!==o?o:new THREE.Plane]};THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(e,t,r,n,i,o){var a=this.planes;a[0].copy(e);a[1].copy(t);a[2].copy(r);a[3].copy(n);a[4].copy(i);a[5].copy(o);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,r=0;6>r;r++)t[r].copy(e.planes[r]);return this},setFromMatrix:function(e){var t=this.planes,r=e.elements;e=r[0];var n=r[1],i=r[2],o=r[3],a=r[4],s=r[5],c=r[6],u=r[7],l=r[8],h=r[9],f=r[10],p=r[11],d=r[12],m=r[13],E=r[14],r=r[15];t[0].setComponents(o-e,u-a,p-l,r-d).normalize();t[1].setComponents(o+e,u+a,p+l,r+d).normalize();t[2].setComponents(o+n,u+s,p+h,r+m).normalize();t[3].setComponents(o-n,u-s,p-h,r-m).normalize();t[4].setComponents(o-i,u-c,p-f,r-E).normalize();t[5].setComponents(o+i,u+c,p+f,r+E).normalize();return this},intersectsObject:function(){var e=new THREE.Sphere;return function(t){var r=t.geometry;null===r.boundingSphere&&r.computeBoundingSphere();e.copy(r.boundingSphere);e.applyMatrix4(t.matrixWorld);return this.intersectsSphere(e)}}(),intersectsSphere:function(e){var t=this.planes,r=e.center;e=-e.radius;for(var n=0;6>n;n++)if(t[n].distanceToPoint(r)<e)return!1;return!0},intersectsBox:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(r){for(var n=this.planes,i=0;6>i;i++){var o=n[i];e.x=0<o.normal.x?r.min.x:r.max.x;t.x=0<o.normal.x?r.max.x:r.min.x;e.y=0<o.normal.y?r.min.y:r.max.y;t.y=0<o.normal.y?r.max.y:r.min.y;e.z=0<o.normal.z?r.min.z:r.max.z;t.z=0<o.normal.z?r.max.z:r.min.z;var a=o.distanceToPoint(e),o=o.distanceToPoint(t);if(0>a&&0>o)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,r=0;6>r;r++)if(0>t[r].distanceToPoint(e))return!1;return!0}};THREE.Plane=function(e,t){this.normal=void 0!==e?e:new THREE.Vector3(1,0,0);this.constant=void 0!==t?t:0};THREE.Plane.prototype={constructor:THREE.Plane,set:function(e,t){this.normal.copy(e);this.constant=t;return this},setComponents:function(e,t,r,n){this.normal.set(e,t,r);this.constant=n;return this},setFromNormalAndCoplanarPoint:function(e,t){this.normal.copy(e);this.constant=-t.dot(this.normal);return this},setFromCoplanarPoints:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(r,n,i){n=e.subVectors(i,n).cross(t.subVectors(r,n)).normalize();this.setFromNormalAndCoplanarPoint(n,r);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.normal.copy(e.normal);this.constant=e.constant;return this},normalize:function(){var e=1/this.normal.length();this.normal.multiplyScalar(e);this.constant*=e;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var r=this.distanceToPoint(e);return(t||new THREE.Vector3).copy(this.normal).multiplyScalar(r)},intersectLine:function(){var e=new THREE.Vector3;return function(t,r){var n=r||new THREE.Vector3,i=t.delta(e),o=this.normal.dot(i);if(0===o){if(0===this.distanceToPoint(t.start))return n.copy(t.start)}else return o=-(t.start.dot(this.normal)+this.constant)/o,0>o||1<o?void 0:n.copy(i).multiplyScalar(o).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start);e=this.distanceToPoint(e.end);return 0>t&&0<e||0>e&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return(e||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new THREE.Vector3,t=new THREE.Vector3,r=new THREE.Matrix3;return function(n,i){var o=i||r.getNormalMatrix(n),o=e.copy(this.normal).applyMatrix3(o),a=this.coplanarPoint(t);a.applyMatrix4(n);this.setFromNormalAndCoplanarPoint(o,a);return this}}(),translate:function(e){this.constant-=e.dot(this.normal);return this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}};THREE.Math={generateUUID:function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),t=Array(36),r=0,n;return function(){for(var i=0;36>i;i++)8===i||13===i||18===i||23===i?t[i]="-":14===i?t[i]="4":(2>=r&&(r=33554432+16777216*Math.random()|0),n=r&15,r>>=4,t[i]=e[19===i?n&3|8:n]);return t.join("")}}(),clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},smoothstep:function(e,t,r){if(e<=t)return 0;if(e>=r)return 1;e=(e-t)/(r-t);return e*e*(3-2*e)},smootherstep:function(e,t,r){if(e<=t)return 0;if(e>=r)return 1;e=(e-t)/(r-t);return e*e*e*(e*(6*e-15)+10)},random16:function(){console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead.");return Math.random()},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(){var e=Math.PI/180;return function(t){return t*e}}(),radToDeg:function(){var e=180/Math.PI;return function(t){return t*e}}(),isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},nearestPowerOfTwo:function(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))},nextPowerOfTwo:function(e){e--;e|=e>>1;e|=e>>2;e|=e>>4;e|=e>>8;e|=e>>16;e++;return e}};THREE.Spline=function(e){function t(e,t,r,n,i,o,a){e=.5*(r-e);n=.5*(n-t);return(2*(t-r)+e+n)*a+(-3*(t-r)-2*e-n)*o+e*i+t}this.points=e;var r=[],n={x:0,y:0,z:0},i,o,a,s,c,u,l,h,f;this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}};this.getPoint=function(e){i=(this.points.length-1)*e;o=Math.floor(i);a=i-o;r[0]=0===o?o:o-1;r[1]=o;r[2]=o>this.points.length-2?this.points.length-1:o+1;r[3]=o>this.points.length-3?this.points.length-1:o+2;u=this.points[r[0]];l=this.points[r[1]];h=this.points[r[2]];f=this.points[r[3]];s=a*a;c=a*s;n.x=t(u.x,l.x,h.x,f.x,a,s,c);n.y=t(u.y,l.y,h.y,f.y,a,s,c);n.z=t(u.z,l.z,h.z,f.z,a,s,c);return n};this.getControlPointsArray=function(){var e,t,r=this.points.length,n=[];for(e=0;e<r;e++)t=this.points[e],n[e]=[t.x,t.y,t.z];return n};this.getLength=function(e){var t,r,n,i=t=t=0,o=new THREE.Vector3,a=new THREE.Vector3,s=[],c=0;s[0]=0;e||(e=100);r=this.points.length*e;o.copy(this.points[0]);for(e=1;e<r;e++)t=e/r,n=this.getPoint(t),a.copy(n),c+=a.distanceTo(o),o.copy(n),t*=this.points.length-1,t=Math.floor(t),t!==i&&(s[t]=c,i=t);s[s.length]=c;return{chunks:s,total:c}};this.reparametrizeByArcLength=function(e){var t,r,n,i,o,a,s=[],c=new THREE.Vector3,u=this.getLength();s.push(c.copy(this.points[0]).clone());for(t=1;t<this.points.length;t++){r=u.chunks[t]-u.chunks[t-1];a=Math.ceil(e*r/u.total);i=(t-1)/(this.points.length-1);o=t/(this.points.length-1);for(r=1;r<a-1;r++)n=i+1/a*r*(o-i),n=this.getPoint(n),s.push(c.copy(n).clone());s.push(c.copy(this.points[t]).clone())}this.points=s}};THREE.Triangle=function(e,t,r){this.a=void 0!==e?e:new THREE.Vector3;this.b=void 0!==t?t:new THREE.Vector3;this.c=void 0!==r?r:new THREE.Vector3};THREE.Triangle.normal=function(){var e=new THREE.Vector3;return function(t,r,n,i){i=i||new THREE.Vector3;i.subVectors(n,r);e.subVectors(t,r);i.cross(e);t=i.lengthSq();return 0<t?i.multiplyScalar(1/Math.sqrt(t)):i.set(0,0,0)}}();THREE.Triangle.barycoordFromPoint=function(){var e=new THREE.Vector3,t=new THREE.Vector3,r=new THREE.Vector3;return function(n,i,o,a,s){e.subVectors(a,i);t.subVectors(o,i);r.subVectors(n,i);n=e.dot(e);i=e.dot(t);o=e.dot(r);var c=t.dot(t);a=t.dot(r);var u=n*c-i*i;s=s||new THREE.Vector3;if(0===u)return s.set(-2,-1,-1);u=1/u;c=(c*o-i*a)*u;n=(n*a-i*o)*u;return s.set(1-c-n,n,c)}}();THREE.Triangle.containsPoint=function(){var e=new THREE.Vector3;return function(t,r,n,i){t=THREE.Triangle.barycoordFromPoint(t,r,n,i,e);return 0<=t.x&&0<=t.y&&1>=t.x+t.y}}();THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(e,t,r){this.a.copy(e);this.b.copy(t);this.c.copy(r);return this},setFromPointsAndIndices:function(e,t,r,n){this.a.copy(e[t]);this.b.copy(e[r]);this.c.copy(e[n]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a.copy(e.a);this.b.copy(e.b);this.c.copy(e.c);return this},area:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(){e.subVectors(this.c,this.b);t.subVectors(this.a,this.b);return.5*e.cross(t).length()}}(),midpoint:function(e){return(e||new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return THREE.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){return(e||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return THREE.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return THREE.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};THREE.Interpolant=function(e,t,r,n){this.parameterPositions=e;this._cachedIndex=0;this.resultBuffer=void 0!==n?n:new t.constructor(r);this.sampleValues=t;this.valueSize=r};THREE.Interpolant.prototype={constructor:THREE.Interpolant,evaluate:function(e){var t=this.parameterPositions,r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{r:{n:if(!(e<n)){for(var o=r+2;;){if(void 0===n){if(e<i)break n;this._cachedIndex=r=t.length;return this.afterEnd_(r-1,e,i)}if(r===o)break;i=n;n=t[++r];if(e<n)break t}n=t.length;break r}if(e>=i)break e;else{o=t[1];e<o&&(r=2,i=o);for(o=r-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(r===o)break;n=i;i=t[--r-1];if(e>=i)break t}n=r;r=0}}for(;r<n;)i=r+n>>>1,e<t[i]?n=i:r=i+1;n=t[r];i=t[r-1];if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return this._cachedIndex=r=t.length,this.afterEnd_(r-1,i,e)}this._cachedIndex=r;this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize;e*=n;for(var i=0;i!==n;++i)t[i]=r[e+i];return t},interpolate_:function(e,t,r,n){throw Error("call to abstract method")},intervalChanged_:function(e,t,r){}};Object.assign(THREE.Interpolant.prototype,{beforeStart_:THREE.Interpolant.prototype.copySampleValue_,afterEnd_:THREE.Interpolant.prototype.copySampleValue_});THREE.CubicInterpolant=function(e,t,r,n){THREE.Interpolant.call(this,e,t,r,n);this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0};THREE.CubicInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.CubicInterpolant,DefaultSettings_:{endingStart:THREE.ZeroCurvatureEnding,endingEnd:THREE.ZeroCurvatureEnding},intervalChanged_:function(e,t,r){var n=this.parameterPositions,i=e-2,o=e+1,a=n[i],s=n[o];if(void 0===a)switch(this.getSettings_().endingStart){case THREE.ZeroSlopeEnding:i=e;a=2*t-r;break;case THREE.WrapAroundEnding:i=n.length-2;a=t+n[i]-n[i+1];break;default:i=e,a=r}if(void 0===s)switch(this.getSettings_().endingEnd){case THREE.ZeroSlopeEnding:o=e;s=2*r-t;break;case THREE.WrapAroundEnding:o=1;s=r+n[1]-n[0];break;default:o=e-1,s=t}e=.5*(r-t);n=this.valueSize;this._weightPrev=e/(t-a);this._weightNext=e/(s-r);this._offsetPrev=i*n;this._offsetNext=o*n},interpolate_:function(e,t,r,n){var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize;e*=a;var s=e-a,c=this._offsetPrev,u=this._offsetNext,l=this._weightPrev,h=this._weightNext,f=(r-t)/(n-t);r=f*f;n=r*f;t=-l*n+2*l*r-l*f;l=(1+l)*n+(-1.5-2*l)*r+(-.5+l)*f+1;f=(-1-h)*n+(1.5+h)*r+.5*f;h=h*n-h*r;for(r=0;r!==a;++r)i[r]=t*o[c+r]+l*o[s+r]+f*o[e+r]+h*o[u+r];return i}});THREE.DiscreteInterpolant=function(e,t,r,n){THREE.Interpolant.call(this,e,t,r,n)};THREE.DiscreteInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.DiscreteInterpolant,interpolate_:function(e,t,r,n){return this.copySampleValue_(e-1)}});THREE.LinearInterpolant=function(e,t,r,n){THREE.Interpolant.call(this,e,t,r,n)};THREE.LinearInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.LinearInterpolant,interpolate_:function(e,t,r,n){var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize;e*=a;var s=e-a;t=(r-t)/(n-t);r=1-t;for(n=0;n!==a;++n)i[n]=o[s+n]*r+o[e+n]*t;return i}});THREE.QuaternionLinearInterpolant=function(e,t,r,n){THREE.Interpolant.call(this,e,t,r,n)};THREE.QuaternionLinearInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.QuaternionLinearInterpolant,interpolate_:function(e,t,r,n){var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize;e*=a;t=(r-t)/(n-t);for(r=e+a;e!==r;e+=4)THREE.Quaternion.slerpFlat(i,0,o,e-a,o,e,t);return i}});THREE.Clock=function(e){this.autoStart=void 0!==e?e:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=performance.now();this.running=!0},stop:function(){this.getElapsedTime();this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var e=0;this.autoStart&&!this.running&&this.start();if(this.running){var t=performance.now(),e=.001*(t-this.oldTime);this.oldTime=t;this.elapsedTime+=e}return e}};THREE.EventDispatcher=function(){};THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(e){e.addEventListener=THREE.EventDispatcher.prototype.addEventListener;e.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener;e.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener;e.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]);-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)?!0:!1},removeEventListener:function(e,t){if(void 0!==this._listeners){var r=this._listeners[e];if(void 0!==r){var n=r.indexOf(t);-1!==n&&r.splice(n,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var r=[],n=t.length,i=0;i<n;i++)r[i]=t[i];for(i=0;i<n;i++)r[i].call(this,e)}}}};THREE.Layers=function(){this.mask=1};THREE.Layers.prototype={constructor:THREE.Layers,set:function(e){this.mask=1<<e},enable:function(e){this.mask|=1<<e},toggle:function(e){this.mask^=1<<e},disable:function(e){this.mask&=~(1<<e)},test:function(e){return 0!==(this.mask&e.mask)}};(function(e){function t(e,t){return e.distance-t.distance}function r(e,t,n,i){if(!1!==e.visible&&(e.raycast(t,n),!0===i)){e=e.children;i=0;for(var o=e.length;i<o;i++)r(e[i],t,n,!0)}}e.Raycaster=function(t,r,n,i){this.ray=new e.Ray(t,r);this.near=n||0;this.far=i||Infinity;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})};e.Raycaster.prototype={constructor:e.Raycaster,linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(t,r){r instanceof e.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(r.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(r).sub(this.ray.origin).normalize()):r instanceof e.OrthographicCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(r),this.ray.direction.set(0,0,-1).transformDirection(r.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,n){var i=[];r(e,this,i,n);i.sort(t);return i},intersectObjects:function(e,n){var i=[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var o=0,a=e.length;o<a;o++)r(e[o],this,i,n);i.sort(t);return i}}})(THREE);THREE.Object3D=function(){Object.defineProperty(this,"id",{value:THREE.Object3DIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=THREE.Object3D.DefaultUp.clone();var e=new THREE.Vector3,t=new THREE.Euler,r=new THREE.Quaternion,n=new THREE.Vector3(1,1,1);t.onChange(function(){r.setFromEuler(t,!1)});r.onChange(function(){t.setFromQuaternion(r,void 0,!1)});Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:r},scale:{enumerable:!0,value:n},modelViewMatrix:{value:new THREE.Matrix4},normalMatrix:{value:new THREE.Matrix3}});this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixAutoUpdate=THREE.Object3D.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new THREE.Layers;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData={}};THREE.Object3D.DefaultUp=new THREE.Vector3(0,1,0);THREE.Object3D.DefaultMatrixAutoUpdate=!0;THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new THREE.Quaternion;return function(t,r){e.setFromAxisAngle(t,r);this.quaternion.multiply(e);return this}}(),rotateX:function(){var e=new THREE.Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new THREE.Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new THREE.Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new THREE.Vector3;return function(t,r){e.copy(t).applyQuaternion(this.quaternion);this.position.add(e.multiplyScalar(r));return this}}(),translateX:function(){var e=new THREE.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new THREE.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new THREE.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new THREE.Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new THREE.Matrix4;return function(t){e.lookAt(t,this.position,this.up);this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}if(e===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this;e instanceof THREE.Object3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e);return this},remove:function(e){if(1<arguments.length)for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);t=this.children.indexOf(e);-1!==t&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(t,1))},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){e=e||new THREE.Vector3;this.updateMatrixWorld(!0);return e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(r){r=r||new THREE.Quaternion;this.updateMatrixWorld(!0);this.matrixWorld.decompose(e,r,t);return r}}(),getWorldRotation:function(){var e=new THREE.Quaternion;return function(t){t=t||new THREE.Euler;this.getWorldQuaternion(e);return t.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new THREE.Vector3,t=new THREE.Quaternion;return function(r){r=r||new THREE.Vector3;this.updateMatrixWorld(!0);this.matrixWorld.decompose(e,t,r);return r}}(),getWorldDirection:function(){var e=new THREE.Quaternion;return function(t){t=t||new THREE.Vector3;this.getWorldQuaternion(e);return t.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===e)null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0;for(var t=0,r=this.children.length;t<r;t++)this.children[t].updateMatrixWorld(e)},toJSON:function(e){function t(e){var t=[],r;for(r in e){var n=e[r];delete n.metadata;t.push(n)}return t}var r=void 0===e,n={};r&&(e={geometries:{},materials:{},textures:{},images:{}},n.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var i={};i.uuid=this.uuid;i.type=this.type;""!==this.name&&(i.name=this.name);"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData);!0===this.castShadow&&(i.castShadow=!0);!0===this.receiveShadow&&(i.receiveShadow=!0);!1===this.visible&&(i.visible=!1);i.matrix=this.matrix.toArray();void 0!==this.geometry&&(void 0===e.geometries[this.geometry.uuid]&&(e.geometries[this.geometry.uuid]=this.geometry.toJSON(e)),i.geometry=this.geometry.uuid);void 0!==this.material&&(void 0===e.materials[this.material.uuid]&&(e.materials[this.material.uuid]=this.material.toJSON(e)),i.material=this.material.uuid);if(0<this.children.length){i.children=[];for(var o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(r){var r=t(e.geometries),o=t(e.materials),a=t(e.textures);e=t(e.images);0<r.length&&(n.geometries=r);0<o.length&&(n.materials=o);0<a.length&&(n.textures=a);0<e.length&&(n.images=e)}n.object=i;return n},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){void 0===t&&(t=!0);this.name=e.name;this.up.copy(e.up);this.position.copy(e.position);this.quaternion.copy(e.quaternion);this.scale.copy(e.scale);this.rotationAutoUpdate=e.rotationAutoUpdate;this.matrix.copy(e.matrix);this.matrixWorld.copy(e.matrixWorld);this.matrixAutoUpdate=e.matrixAutoUpdate;this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate;this.visible=e.visible;this.castShadow=e.castShadow;this.receiveShadow=e.receiveShadow;this.frustumCulled=e.frustumCulled;this.renderOrder=e.renderOrder;this.userData=JSON.parse(JSON.stringify(e.userData));if(!0===t)for(var r=0;r<e.children.length;r++)this.add(e.children[r].clone());return this}};THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);THREE.Object3DIdCount=0;THREE.Face3=function(e,t,r,n,i,o){this.a=e;this.b=t;this.c=r;this.normal=n instanceof THREE.Vector3?n:new THREE.Vector3;this.vertexNormals=Array.isArray(n)?n:[];this.color=i instanceof THREE.Color?i:new THREE.Color;this.vertexColors=Array.isArray(i)?i:[];this.materialIndex=void 0!==o?o:0};THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a;this.b=e.b;this.c=e.c;this.normal.copy(e.normal);this.color.copy(e.color);this.materialIndex=e.materialIndex;for(var t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();t=0;for(r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();
return this}};THREE.BufferAttribute=function(e,t){this.uuid=THREE.Math.generateUUID();this.array=e;this.itemSize=t;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0};THREE.BufferAttribute.prototype={constructor:THREE.BufferAttribute,get count(){return this.array.length/this.itemSize},set needsUpdate(e){!0===e&&this.version++},setDynamic:function(e){this.dynamic=e;return this},copy:function(e){this.array=new e.array.constructor(e.array);this.itemSize=e.itemSize;this.dynamic=e.dynamic;return this},copyAt:function(e,t,r){e*=this.itemSize;r*=t.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this},copyArray:function(e){this.array.set(e);return this},copyColorsArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),o=new THREE.Color);t[r++]=o.r;t[r++]=o.g;t[r++]=o.b}return this},copyIndicesArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];t[r++]=o.a;t[r++]=o.b;t[r++]=o.c}return this},copyVector2sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),o=new THREE.Vector2);t[r++]=o.x;t[r++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new THREE.Vector3);t[r++]=o.x;t[r++]=o.y;t[r++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new THREE.Vector4);t[r++]=o.x;t[r++]=o.y;t[r++]=o.z;t[r++]=o.w}return this},set:function(e,t){void 0===t&&(t=0);this.array.set(e,t);return this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){this.array[e*this.itemSize]=t;return this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){this.array[e*this.itemSize+1]=t;return this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){this.array[e*this.itemSize+2]=t;return this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){this.array[e*this.itemSize+3]=t;return this},setXY:function(e,t,r){e*=this.itemSize;this.array[e+0]=t;this.array[e+1]=r;return this},setXYZ:function(e,t,r,n){e*=this.itemSize;this.array[e+0]=t;this.array[e+1]=r;this.array[e+2]=n;return this},setXYZW:function(e,t,r,n,i){e*=this.itemSize;this.array[e+0]=t;this.array[e+1]=r;this.array[e+2]=n;this.array[e+3]=i;return this},clone:function(){return(new this.constructor).copy(this)}};THREE.Int8Attribute=function(e,t){return new THREE.BufferAttribute(new Int8Array(e),t)};THREE.Uint8Attribute=function(e,t){return new THREE.BufferAttribute(new Uint8Array(e),t)};THREE.Uint8ClampedAttribute=function(e,t){return new THREE.BufferAttribute(new Uint8ClampedArray(e),t)};THREE.Int16Attribute=function(e,t){return new THREE.BufferAttribute(new Int16Array(e),t)};THREE.Uint16Attribute=function(e,t){return new THREE.BufferAttribute(new Uint16Array(e),t)};THREE.Int32Attribute=function(e,t){return new THREE.BufferAttribute(new Int32Array(e),t)};THREE.Uint32Attribute=function(e,t){return new THREE.BufferAttribute(new Uint32Array(e),t)};THREE.Float32Attribute=function(e,t){return new THREE.BufferAttribute(new Float32Array(e),t)};THREE.Float64Attribute=function(e,t){return new THREE.BufferAttribute(new Float64Array(e),t)};THREE.DynamicBufferAttribute=function(e,t){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.");return new THREE.BufferAttribute(e,t).setDynamic(!0)};THREE.InstancedBufferAttribute=function(e,t,r){THREE.BufferAttribute.call(this,e,t);this.meshPerAttribute=r||1};THREE.InstancedBufferAttribute.prototype=Object.create(THREE.BufferAttribute.prototype);THREE.InstancedBufferAttribute.prototype.constructor=THREE.InstancedBufferAttribute;THREE.InstancedBufferAttribute.prototype.copy=function(e){THREE.BufferAttribute.prototype.copy.call(this,e);this.meshPerAttribute=e.meshPerAttribute;return this};THREE.InterleavedBuffer=function(e,t){this.uuid=THREE.Math.generateUUID();this.array=e;this.stride=t;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0};THREE.InterleavedBuffer.prototype={constructor:THREE.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(e){!0===e&&this.version++},setDynamic:function(e){this.dynamic=e;return this},copy:function(e){this.array=new e.array.constructor(e.array);this.stride=e.stride;this.dynamic=e.dynamic;return this},copyAt:function(e,t,r){e*=this.stride;r*=t.stride;for(var n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this},set:function(e,t){void 0===t&&(t=0);this.array.set(e,t);return this},clone:function(){return(new this.constructor).copy(this)}};THREE.InstancedInterleavedBuffer=function(e,t,r){THREE.InterleavedBuffer.call(this,e,t);this.meshPerAttribute=r||1};THREE.InstancedInterleavedBuffer.prototype=Object.create(THREE.InterleavedBuffer.prototype);THREE.InstancedInterleavedBuffer.prototype.constructor=THREE.InstancedInterleavedBuffer;THREE.InstancedInterleavedBuffer.prototype.copy=function(e){THREE.InterleavedBuffer.prototype.copy.call(this,e);this.meshPerAttribute=e.meshPerAttribute;return this};THREE.InterleavedBufferAttribute=function(e,t,r){this.uuid=THREE.Math.generateUUID();this.data=e;this.itemSize=t;this.offset=r};THREE.InterleavedBufferAttribute.prototype={constructor:THREE.InterleavedBufferAttribute,get length(){console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count.");return this.array.length},get count(){return this.data.count},setX:function(e,t){this.data.array[e*this.data.stride+this.offset]=t;return this},setY:function(e,t){this.data.array[e*this.data.stride+this.offset+1]=t;return this},setZ:function(e,t){this.data.array[e*this.data.stride+this.offset+2]=t;return this},setW:function(e,t){this.data.array[e*this.data.stride+this.offset+3]=t;return this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){e=e*this.data.stride+this.offset;this.data.array[e+0]=t;this.data.array[e+1]=r;return this},setXYZ:function(e,t,r,n){e=e*this.data.stride+this.offset;this.data.array[e+0]=t;this.data.array[e+1]=r;this.data.array[e+2]=n;return this},setXYZW:function(e,t,r,n,i){e=e*this.data.stride+this.offset;this.data.array[e+0]=t;this.data.array[e+1]=r;this.data.array[e+2]=n;this.data.array[e+3]=i;return this}};THREE.Geometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1};THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(e){for(var t=(new THREE.Matrix3).getNormalMatrix(e),r=0,n=this.vertices.length;r<n;r++)this.vertices[r].applyMatrix4(e);r=0;for(n=this.faces.length;r<n;r++){e=this.faces[r];e.normal.applyMatrix3(t).normalize();for(var i=0,o=e.vertexNormals.length;i<o;i++)e.vertexNormals[i].applyMatrix3(t).normalize()}null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();this.normalsNeedUpdate=this.verticesNeedUpdate=!0},rotateX:function(){var e;return function(t){void 0===e&&(e=new THREE.Matrix4);e.makeRotationX(t);this.applyMatrix(e);return this}}(),rotateY:function(){var e;return function(t){void 0===e&&(e=new THREE.Matrix4);e.makeRotationY(t);this.applyMatrix(e);return this}}(),rotateZ:function(){var e;return function(t){void 0===e&&(e=new THREE.Matrix4);e.makeRotationZ(t);this.applyMatrix(e);return this}}(),translate:function(){var e;return function(t,r,n){void 0===e&&(e=new THREE.Matrix4);e.makeTranslation(t,r,n);this.applyMatrix(e);return this}}(),scale:function(){var e;return function(t,r,n){void 0===e&&(e=new THREE.Matrix4);e.makeScale(t,r,n);this.applyMatrix(e);return this}}(),lookAt:function(){var e;return function(t){void 0===e&&(e=new THREE.Object3D);e.lookAt(t);e.updateMatrix();this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(e){function t(e,t,n){var i=void 0!==a?[l[e].clone(),l[t].clone(),l[n].clone()]:[],o=void 0!==s?[r.colors[e].clone(),r.colors[t].clone(),r.colors[n].clone()]:[],i=new THREE.Face3(e,t,n,i,o);r.faces.push(i);void 0!==c&&r.faceVertexUvs[0].push([h[e].clone(),h[t].clone(),h[n].clone()]);void 0!==u&&r.faceVertexUvs[1].push([f[e].clone(),f[t].clone(),f[n].clone()])}var r=this,n=null!==e.index?e.index.array:void 0,i=e.attributes,o=i.position.array,a=void 0!==i.normal?i.normal.array:void 0,s=void 0!==i.color?i.color.array:void 0,c=void 0!==i.uv?i.uv.array:void 0,u=void 0!==i.uv2?i.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var l=[],h=[],f=[],p=i=0;i<o.length;i+=3,p+=2)r.vertices.push(new THREE.Vector3(o[i],o[i+1],o[i+2])),void 0!==a&&l.push(new THREE.Vector3(a[i],a[i+1],a[i+2])),void 0!==s&&r.colors.push(new THREE.Color(s[i],s[i+1],s[i+2])),void 0!==c&&h.push(new THREE.Vector2(c[p],c[p+1])),void 0!==u&&f.push(new THREE.Vector2(u[p],u[p+1]));if(void 0!==n)if(o=e.groups,0<o.length)for(i=0;i<o.length;i++)for(var p=o[i],d=p.start,m=p.count,p=d,d=d+m;p<d;p+=3)t(n[p],n[p+1],n[p+2]);else for(i=0;i<n.length;i+=3)t(n[i],n[i+1],n[i+2]);else for(i=0;i<o.length/3;i+=3)t(i,i+1,i+2);this.computeFaceNormals();null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone());null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone());return this},center:function(){this.computeBoundingBox();var e=this.boundingBox.center().negate();this.translate(e.x,e.y,e.z);return e},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,t=0===t?1:1/t,r=new THREE.Matrix4;r.set(t,0,0,-t*e.x,0,t,0,-t*e.y,0,0,t,-t*e.z,0,0,0,1);this.applyMatrix(r);return this},computeFaceNormals:function(){for(var e=new THREE.Vector3,t=new THREE.Vector3,r=0,n=this.faces.length;r<n;r++){var i=this.faces[r],o=this.vertices[i.a],a=this.vertices[i.b];e.subVectors(this.vertices[i.c],a);t.subVectors(o,a);e.cross(t);e.normalize();i.normal.copy(e)}},computeVertexNormals:function(e){void 0===e&&(e=!0);var t,r,n;n=Array(this.vertices.length);t=0;for(r=this.vertices.length;t<r;t++)n[t]=new THREE.Vector3;if(e){var i,o,a,s=new THREE.Vector3,c=new THREE.Vector3;e=0;for(t=this.faces.length;e<t;e++)r=this.faces[e],i=this.vertices[r.a],o=this.vertices[r.b],a=this.vertices[r.c],s.subVectors(a,o),c.subVectors(i,o),s.cross(c),n[r.a].add(s),n[r.b].add(s),n[r.c].add(s)}else for(e=0,t=this.faces.length;e<t;e++)r=this.faces[e],n[r.a].add(r.normal),n[r.b].add(r.normal),n[r.c].add(r.normal);t=0;for(r=this.vertices.length;t<r;t++)n[t].normalize();e=0;for(t=this.faces.length;e<t;e++)r=this.faces[e],i=r.vertexNormals,3===i.length?(i[0].copy(n[r.a]),i[1].copy(n[r.b]),i[2].copy(n[r.c])):(i[0]=n[r.a].clone(),i[1]=n[r.b].clone(),i[2]=n[r.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,r,n,i;r=0;for(n=this.faces.length;r<n;r++)for(i=this.faces[r],i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var o=new THREE.Geometry;o.faces=this.faces;e=0;for(t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={};this.morphNormals[e].faceNormals=[];this.morphNormals[e].vertexNormals=[];i=this.morphNormals[e].faceNormals;var a=this.morphNormals[e].vertexNormals,s,c;r=0;for(n=this.faces.length;r<n;r++)s=new THREE.Vector3,c={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},i.push(s),a.push(c)}a=this.morphNormals[e];o.vertices=this.morphTargets[e].vertices;o.computeFaceNormals();o.computeVertexNormals();r=0;for(n=this.faces.length;r<n;r++)i=this.faces[r],s=a.faceNormals[r],c=a.vertexNormals[r],s.copy(i.normal),c.a.copy(i.vertexNormals[0]),c.b.copy(i.vertexNormals[1]),c.c.copy(i.vertexNormals[2])}r=0;for(n=this.faces.length;r<n;r++)i=this.faces[r],i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var e=0,t=this.vertices,r=0,n=t.length;r<n;r++)0<r&&(e+=t[r].distanceTo(t[r-1])),this.lineDistances[r]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,r){if(!1===e instanceof THREE.Geometry)console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);else{var n,i=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,c=e.faces,u=this.faceVertexUvs[0];e=e.faceVertexUvs[0];void 0===r&&(r=0);void 0!==t&&(n=(new THREE.Matrix3).getNormalMatrix(t));for(var l=0,h=a.length;l<h;l++){var f=a[l].clone();void 0!==t&&f.applyMatrix4(t);o.push(f)}l=0;for(h=c.length;l<h;l++){var a=c[l],p,d=a.vertexNormals,m=a.vertexColors,f=new THREE.Face3(a.a+i,a.b+i,a.c+i);f.normal.copy(a.normal);void 0!==n&&f.normal.applyMatrix3(n).normalize();t=0;for(o=d.length;t<o;t++)p=d[t].clone(),void 0!==n&&p.applyMatrix3(n).normalize(),f.vertexNormals.push(p);f.color.copy(a.color);t=0;for(o=m.length;t<o;t++)p=m[t],f.vertexColors.push(p.clone());f.materialIndex=a.materialIndex+r;s.push(f)}l=0;for(h=e.length;l<h;l++)if(r=e[l],n=[],void 0!==r){t=0;for(o=r.length;t<o;t++)n.push(r[t].clone());u.push(n)}}},mergeMesh:function(e){!1===e instanceof THREE.Mesh?console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e):(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix))},mergeVertices:function(){var e={},t=[],r=[],n,i=Math.pow(10,4),o,a;o=0;for(a=this.vertices.length;o<a;o++)n=this.vertices[o],n=Math.round(n.x*i)+"_"+Math.round(n.y*i)+"_"+Math.round(n.z*i),void 0===e[n]?(e[n]=o,t.push(this.vertices[o]),r[o]=t.length-1):r[o]=r[e[n]];e=[];o=0;for(a=this.faces.length;o<a;o++)for(i=this.faces[o],i.a=r[i.a],i.b=r[i.b],i.c=r[i.c],i=[i.a,i.b,i.c],n=0;3>n;n++)if(i[n]===i[(n+1)%3]){e.push(o);break}for(o=e.length-1;0<=o;o--)for(i=e[o],this.faces.splice(i,1),r=0,a=this.faceVertexUvs.length;r<a;r++)this.faceVertexUvs[r].splice(i,1);o=this.vertices.length-t.length;this.vertices=t;return o},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,r=0;r<t;r++)e[r]._id=r;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var n=this.faceVertexUvs[0],i=this.faceVertexUvs[1],o,a;n&&n.length===t&&(o=[]);i&&i.length===t&&(a=[]);for(r=0;r<t;r++){var s=e[r]._id;o&&o.push(n[s]);a&&a.push(i[s])}o&&(this.faceVertexUvs[0]=o);a&&(this.faceVertexUvs[1]=a)},toJSON:function(){function e(e,t,r){return r?e|1<<t:e&~(1<<t)}function t(e){var t=e.x.toString()+e.y.toString()+e.z.toString();if(void 0!==u[t])return u[t];u[t]=c.length/3;c.push(e.x,e.y,e.z);return u[t]}function r(e){var t=e.r.toString()+e.g.toString()+e.b.toString();if(void 0!==h[t])return h[t];h[t]=l.length;l.push(e.getHex());return h[t]}function n(e){var t=e.x.toString()+e.y.toString();if(void 0!==p[t])return p[t];p[t]=f.length/2;f.push(e.x,e.y);return p[t]}var i={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};i.uuid=this.uuid;i.type=this.type;""!==this.name&&(i.name=this.name);if(void 0!==this.parameters){var o=this.parameters,a;for(a in o)void 0!==o[a]&&(i[a]=o[a]);return i}o=[];for(a=0;a<this.vertices.length;a++){var s=this.vertices[a];o.push(s.x,s.y,s.z)}var s=[],c=[],u={},l=[],h={},f=[],p={};for(a=0;a<this.faces.length;a++){var d=this.faces[a],m=void 0!==this.faceVertexUvs[0][a],E=0<d.normal.length(),g=0<d.vertexNormals.length,v=1!==d.color.r||1!==d.color.g||1!==d.color.b,y=0<d.vertexColors.length,b=0,b=e(b,0,0),b=e(b,1,!0),b=e(b,2,!1),b=e(b,3,m),b=e(b,4,E),b=e(b,5,g),b=e(b,6,v),b=e(b,7,y);s.push(b);s.push(d.a,d.b,d.c);s.push(d.materialIndex);m&&(m=this.faceVertexUvs[0][a],s.push(n(m[0]),n(m[1]),n(m[2])));E&&s.push(t(d.normal));g&&(E=d.vertexNormals,s.push(t(E[0]),t(E[1]),t(E[2])));v&&s.push(r(d.color));y&&(d=d.vertexColors,s.push(r(d[0]),r(d[1]),r(d[2])))}i.data={};i.data.vertices=o;i.data.normals=c;0<l.length&&(i.data.colors=l);0<f.length&&(i.data.uvs=[f]);i.data.faces=s;return i},clone:function(){return(new THREE.Geometry).copy(this)},copy:function(e){this.vertices=[];this.faces=[];this.faceVertexUvs=[[]];for(var t=e.vertices,r=0,n=t.length;r<n;r++)this.vertices.push(t[r].clone());t=e.faces;r=0;for(n=t.length;r<n;r++)this.faces.push(t[r].clone());r=0;for(n=e.faceVertexUvs.length;r<n;r++){t=e.faceVertexUvs[r];void 0===this.faceVertexUvs[r]&&(this.faceVertexUvs[r]=[]);for(var i=0,o=t.length;i<o;i++){for(var a=t[i],s=[],c=0,u=a.length;c<u;c++)s.push(a[c].clone());this.faceVertexUvs[r].push(s)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);THREE.GeometryIdCount=0;THREE.DirectGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="DirectGeometry";this.indices=[];this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1};THREE.DirectGeometry.prototype={constructor:THREE.DirectGeometry,computeBoundingBox:THREE.Geometry.prototype.computeBoundingBox,computeBoundingSphere:THREE.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(e){var t,r=[],n;e=e.faces;for(var i=0;i<e.length;i++){var o=e[i];o.materialIndex!==n&&(n=o.materialIndex,void 0!==t&&(t.count=3*i-t.start,r.push(t)),t={start:3*i,materialIndex:n})}void 0!==t&&(t.count=3*i-t.start,r.push(t));this.groups=r},fromGeometry:function(e){var t=e.faces,r=e.vertices,n=e.faceVertexUvs,i=n[0]&&0<n[0].length,o=n[1]&&0<n[1].length,a=e.morphTargets,s=a.length,c;if(0<s){c=[];for(var u=0;u<s;u++)c[u]=[];this.morphTargets.position=c}var l=e.morphNormals,h=l.length,f;if(0<h){f=[];for(u=0;u<h;u++)f[u]=[];this.morphTargets.normal=f}for(var p=e.skinIndices,d=e.skinWeights,m=p.length===r.length,E=d.length===r.length,u=0;u<t.length;u++){var g=t[u];this.vertices.push(r[g.a],r[g.b],r[g.c]);var v=g.vertexNormals;3===v.length?this.normals.push(v[0],v[1],v[2]):(v=g.normal,this.normals.push(v,v,v));v=g.vertexColors;3===v.length?this.colors.push(v[0],v[1],v[2]):(v=g.color,this.colors.push(v,v,v));!0===i&&(v=n[0][u],void 0!==v?this.uvs.push(v[0],v[1],v[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new THREE.Vector2,new THREE.Vector2,new THREE.Vector2)));!0===o&&(v=n[1][u],void 0!==v?this.uvs2.push(v[0],v[1],v[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new THREE.Vector2,new THREE.Vector2,new THREE.Vector2)));for(v=0;v<s;v++){var y=a[v].vertices;c[v].push(y[g.a],y[g.b],y[g.c])}for(v=0;v<h;v++)y=l[v].vertexNormals[u],f[v].push(y.a,y.b,y.c);m&&this.skinIndices.push(p[g.a],p[g.b],p[g.c]);E&&this.skinWeights.push(d[g.a],d[g.b],d[g.c])}this.computeGroups(e);this.verticesNeedUpdate=e.verticesNeedUpdate;this.normalsNeedUpdate=e.normalsNeedUpdate;this.colorsNeedUpdate=e.colorsNeedUpdate;this.uvsNeedUpdate=e.uvsNeedUpdate;this.groupsNeedUpdate=e.groupsNeedUpdate;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.DirectGeometry.prototype);THREE.BufferGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity}};THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,getIndex:function(){return this.index},setIndex:function(e){this.index=e},addAttribute:function(e,t,r){if(!1===t instanceof THREE.BufferAttribute&&!1===t instanceof THREE.InterleavedBufferAttribute)console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new THREE.BufferAttribute(t,r));else if("index"===e)console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t);else return this.attributes[e]=t,this},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){delete this.attributes[e];return this},addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e;this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToVector3Array(t.array),t.needsUpdate=!0);t=this.attributes.normal;void 0!==t&&((new THREE.Matrix3).getNormalMatrix(e).applyToVector3Array(t.array),t.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere()},rotateX:function(){var e;return function(t){void 0===e&&(e=new THREE.Matrix4);e.makeRotationX(t);this.applyMatrix(e);return this}}(),rotateY:function(){var e;return function(t){void 0===e&&(e=new THREE.Matrix4);e.makeRotationY(t);this.applyMatrix(e);return this}}(),rotateZ:function(){var e;return function(t){void 0===e&&(e=new THREE.Matrix4);e.makeRotationZ(t);this.applyMatrix(e);return this}}(),translate:function(){var e;return function(t,r,n){void 0===e&&(e=new THREE.Matrix4);e.makeTranslation(t,r,n);this.applyMatrix(e);return this}}(),scale:function(){var e;return function(t,r,n){void 0===e&&(e=new THREE.Matrix4);e.makeScale(t,r,n);this.applyMatrix(e);return this}}(),lookAt:function(){var e;return function(t){void 0===e&&(e=new THREE.Object3D);e.lookAt(t);e.updateMatrix();this.applyMatrix(e.matrix)}}(),center:function(){this.computeBoundingBox();var e=this.boundingBox.center().negate();this.translate(e.x,e.y,e.z);return e},setFromObject:function(e){var t=e.geometry;if(e instanceof THREE.Points||e instanceof THREE.Line){e=new THREE.Float32Attribute(3*t.vertices.length,3);var r=new THREE.Float32Attribute(3*t.colors.length,3);this.addAttribute("position",e.copyVector3sArray(t.vertices));this.addAttribute("color",r.copyColorsArray(t.colors));t.lineDistances&&t.lineDistances.length===t.vertices.length&&(e=new THREE.Float32Attribute(t.lineDistances.length,1),this.addAttribute("lineDistance",e.copyArray(t.lineDistances)));null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone());null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e instanceof THREE.Mesh&&t instanceof THREE.Geometry&&this.fromGeometry(t);return this},updateFromObject:function(e){var t=e.geometry;if(e instanceof THREE.Mesh){var r=t.__directGeometry;if(void 0===r)return this.fromGeometry(t);r.verticesNeedUpdate=t.verticesNeedUpdate;r.normalsNeedUpdate=t.normalsNeedUpdate;r.colorsNeedUpdate=t.colorsNeedUpdate;r.uvsNeedUpdate=t.uvsNeedUpdate;r.groupsNeedUpdate=t.groupsNeedUpdate;t.verticesNeedUpdate=!1;t.normalsNeedUpdate=!1;t.colorsNeedUpdate=!1;t.uvsNeedUpdate=!1;t.groupsNeedUpdate=!1;t=r}!0===t.verticesNeedUpdate&&(r=this.attributes.position,void 0!==r&&(r.copyVector3sArray(t.vertices),r.needsUpdate=!0),t.verticesNeedUpdate=!1);!0===t.normalsNeedUpdate&&(r=this.attributes.normal,void 0!==r&&(r.copyVector3sArray(t.normals),r.needsUpdate=!0),t.normalsNeedUpdate=!1);!0===t.colorsNeedUpdate&&(r=this.attributes.color,void 0!==r&&(r.copyColorsArray(t.colors),r.needsUpdate=!0),t.colorsNeedUpdate=!1);t.uvsNeedUpdate&&(r=this.attributes.uv,void 0!==r&&(r.copyVector2sArray(t.uvs),r.needsUpdate=!0),t.uvsNeedUpdate=!1);t.lineDistancesNeedUpdate&&(r=this.attributes.lineDistance,void 0!==r&&(r.copyArray(t.lineDistances),r.needsUpdate=!0),t.lineDistancesNeedUpdate=!1);t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1);return this},fromGeometry:function(e){e.__directGeometry=(new THREE.DirectGeometry).fromGeometry(e);return this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);this.addAttribute("position",new THREE.BufferAttribute(t,3).copyVector3sArray(e.vertices));0<e.normals.length&&(t=new Float32Array(3*e.normals.length),this.addAttribute("normal",new THREE.BufferAttribute(t,3).copyVector3sArray(e.normals)));0<e.colors.length&&(t=new Float32Array(3*e.colors.length),this.addAttribute("color",new THREE.BufferAttribute(t,3).copyColorsArray(e.colors)));0<e.uvs.length&&(t=new Float32Array(2*e.uvs.length),this.addAttribute("uv",new THREE.BufferAttribute(t,2).copyVector2sArray(e.uvs)));0<e.uvs2.length&&(t=new Float32Array(2*e.uvs2.length),this.addAttribute("uv2",new THREE.BufferAttribute(t,2).copyVector2sArray(e.uvs2)));0<e.indices.length&&(t=new(65535<e.vertices.length?Uint32Array:Uint16Array)(3*e.indices.length),this.setIndex(new THREE.BufferAttribute(t,1).copyIndicesArray(e.indices)));this.groups=e.groups;for(var r in e.morphTargets){for(var t=[],n=e.morphTargets[r],i=0,o=n.length;i<o;i++){var a=n[i],s=new THREE.Float32Attribute(3*a.length,3);t.push(s.copyVector3sArray(a))}this.morphAttributes[r]=t}0<e.skinIndices.length&&(r=new THREE.Float32Attribute(4*e.skinIndices.length,4),this.addAttribute("skinIndex",r.copyVector4sArray(e.skinIndices)));0<e.skinWeights.length&&(r=new THREE.Float32Attribute(4*e.skinWeights.length,4),this.addAttribute("skinWeight",r.copyVector4sArray(e.skinWeights)));null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone());null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone());return this},computeBoundingBox:function(){new THREE.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var e=this.attributes.position.array;e&&this.boundingBox.setFromArray(e);if(void 0===e||0===e.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0);(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}(),computeBoundingSphere:function(){var e=new THREE.Box3,t=new THREE.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var r=this.attributes.position.array;if(r){var n=this.boundingSphere.center;e.setFromArray(r);e.center(n);for(var i=0,o=0,a=r.length;o<a;o+=3)t.fromArray(r,o),i=Math.max(i,n.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(i);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,r=this.groups;if(t.position){var n=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(n.length),3));else for(var i=t.normal.array,o=0,a=i.length;o<a;o++)i[o]=0;var i=t.normal.array,s,c,u,l=new THREE.Vector3,h=new THREE.Vector3,f=new THREE.Vector3,p=new THREE.Vector3,d=new THREE.Vector3;if(e){e=e.array;0===r.length&&this.addGroup(0,e.length);for(var m=0,E=r.length;m<E;++m)for(o=r[m],a=o.start,s=o.count,o=a,a+=s;o<a;o+=3)s=3*e[o+0],c=3*e[o+1],u=3*e[o+2],l.fromArray(n,s),h.fromArray(n,c),f.fromArray(n,u),p.subVectors(f,h),d.subVectors(l,h),p.cross(d),i[s]+=p.x,i[s+1]+=p.y,i[s+2]+=p.z,i[c]+=p.x,i[c+1]+=p.y,i[c+2]+=p.z,i[u]+=p.x,i[u+1]+=p.y,i[u+2]+=p.z}else for(o=0,a=n.length;o<a;o+=9)l.fromArray(n,o),h.fromArray(n,o+3),f.fromArray(n,o+6),p.subVectors(f,h),d.subVectors(l,h),p.cross(d),i[o]=p.x,i[o+1]=p.y,i[o+2]=p.z,i[o+3]=p.x,i[o+4]=p.y,i[o+5]=p.z,i[o+6]=p.x,i[o+7]=p.y,i[o+8]=p.z;this.normalizeNormals();t.normal.needsUpdate=!0}},merge:function(e,t){if(!1===e instanceof THREE.BufferGeometry)console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);else{void 0===t&&(t=0);var r=this.attributes,n;for(n in r)if(void 0!==e.attributes[n])for(var i=r[n].array,o=e.attributes[n],a=o.array,s=0,o=o.itemSize*t;s<a.length;s++,o++)i[o]=a[s];return this}},normalizeNormals:function(){for(var e=this.attributes.normal.array,t,r,n,i=0,o=e.length;i<o;i+=3)t=e[i],r=e[i+1],n=e[i+2],t=1/Math.sqrt(t*t+r*r+n*n),e[i]*=t,e[i+1]*=t,e[i+2]*=t},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new THREE.BufferGeometry,t=this.index.array,r=this.attributes,n;for(n in r){for(var i=r[n],o=i.array,i=i.itemSize,a=new o.constructor(t.length*i),s=0,c=0,u=0,l=t.length;u<l;u++)for(var s=t[u]*i,h=0;h<i;h++)a[c++]=o[s++];e.addAttribute(n,new THREE.BufferAttribute(a,i))}return e},toJSON:function(){var e={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};e.uuid=this.uuid;e.type=this.type;""!==this.name&&(e.name=this.name);if(void 0!==this.parameters){var t=this.parameters,r;for(r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};var n=this.index;null!==n&&(t=Array.prototype.slice.call(n.array),e.data.index={type:n.array.constructor.name,array:t});n=this.attributes;for(r in n){var i=n[r],t=Array.prototype.slice.call(i.array);e.data.attributes[r]={itemSize:i.itemSize,type:i.array.constructor.name,array:t}}r=this.groups;0<r.length&&(e.data.groups=JSON.parse(JSON.stringify(r)));r=this.boundingSphere;null!==r&&(e.data.boundingSphere={center:r.center.toArray(),radius:r.radius});return e},clone:function(){return(new THREE.BufferGeometry).copy(this)},copy:function(e){var t=e.index;null!==t&&this.setIndex(t.clone());var t=e.attributes,r;for(r in t)this.addAttribute(r,t[r].clone());e=e.groups;r=0;for(t=e.length;r<t;r++){var n=e[r];this.addGroup(n.start,n.count)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);THREE.BufferGeometry.MaxIndex=65535;THREE.InstancedBufferGeometry=function(){THREE.BufferGeometry.call(this);this.type="InstancedBufferGeometry";this.maxInstancedCount=void 0};THREE.InstancedBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.InstancedBufferGeometry.prototype.constructor=THREE.InstancedBufferGeometry;THREE.InstancedBufferGeometry.prototype.addGroup=function(e,t,r){this.groups.push({start:e,count:t,instances:r})};THREE.InstancedBufferGeometry.prototype.copy=function(e){var t=e.index;null!==t&&this.setIndex(t.clone());var t=e.attributes,r;for(r in t)this.addAttribute(r,t[r].clone());
e=e.groups;r=0;for(t=e.length;r<t;r++){var n=e[r];this.addGroup(n.start,n.count,n.instances)}return this};THREE.EventDispatcher.prototype.apply(THREE.InstancedBufferGeometry.prototype);THREE.Uniform=function(e,t){this.type=e;this.value=t;this.dynamic=!1};THREE.Uniform.prototype={constructor:THREE.Uniform,onUpdate:function(e){this.dynamic=!0;this.onUpdateCallback=e;return this}};THREE.AnimationClip=function(e,t,r){this.name=e||THREE.Math.generateUUID();this.tracks=r;this.duration=void 0!==t?t:-1;0>this.duration&&this.resetDuration();this.trim();this.optimize()};THREE.AnimationClip.prototype={constructor:THREE.AnimationClip,resetDuration:function(){for(var e=0,t=0,r=this.tracks.length;t!==r;++t)var n=this.tracks[t],e=Math.max(e,n.times[n.times.length-1]);this.duration=e},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}};Object.assign(THREE.AnimationClip,{parse:function(e){for(var t=[],r=e.tracks,n=1/(e.fps||1),i=0,o=r.length;i!==o;++i)t.push(THREE.KeyframeTrack.parse(r[i]).scale(n));return new THREE.AnimationClip(e.name,e.duration,t)},toJSON:function(e){var t=[],r=e.tracks;e={name:e.name,duration:e.duration,tracks:t};for(var n=0,i=r.length;n!==i;++n)t.push(THREE.KeyframeTrack.toJSON(r[n]));return e},CreateFromMorphTargetSequence:function(e,t,r){for(var n=t.length,i=[],o=0;o<n;o++){var a=[],s=[];a.push((o+n-1)%n,o,(o+1)%n);s.push(0,1,0);var c=THREE.AnimationUtils.getKeyframeOrder(a),a=THREE.AnimationUtils.sortedArray(a,1,c),s=THREE.AnimationUtils.sortedArray(s,1,c);0===a[0]&&(a.push(n),s.push(s[0]));i.push(new THREE.NumberKeyframeTrack(".morphTargetInfluences["+t[o].name+"]",a,s).scale(1/r))}return new THREE.AnimationClip(e,-1,i)},findByName:function(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t)return e[r];return null},CreateClipsFromMorphTargetSequences:function(e,t){for(var r={},n=/^([\w-]*?)([\d]+)$/,i=0,o=e.length;i<o;i++){var a=e[i],s=a.name.match(n);if(s&&1<s.length){var c=s[1];(s=r[c])||(r[c]=s=[]);s.push(a)}}n=[];for(c in r)n.push(THREE.AnimationClip.CreateFromMorphTargetSequence(c,r[c],t));return n},parseAnimation:function(e,t,r){if(!e)return console.error("  no animation in JSONLoader data"),null;r=function(e,t,r,n,i){if(0!==r.length){var o=[],a=[];THREE.AnimationUtils.flattenJSON(r,o,a,n);0!==o.length&&i.push(new e(t,o,a))}};var n=[],i=e.name||"default",o=e.length||-1,a=e.fps||30;e=e.hierarchy||[];for(var s=0;s<e.length;s++){var c=e[s].keys;if(c&&0!=c.length)if(c[0].morphTargets){for(var o={},u=0;u<c.length;u++)if(c[u].morphTargets)for(var l=0;l<c[u].morphTargets.length;l++)o[c[u].morphTargets[l]]=-1;for(var h in o){for(var f=[],p=[],l=0;l!==c[u].morphTargets.length;++l){var d=c[u];f.push(d.time);p.push(d.morphTarget===h?1:0)}n.push(new THREE.NumberKeyframeTrack(".morphTargetInfluence["+h+"]",f,p))}o=o.length*(a||1)}else u=".bones["+t[s].name+"]",r(THREE.VectorKeyframeTrack,u+".position",c,"pos",n),r(THREE.QuaternionKeyframeTrack,u+".quaternion",c,"rot",n),r(THREE.VectorKeyframeTrack,u+".scale",c,"scl",n)}return 0===n.length?null:new THREE.AnimationClip(i,o,n)}});THREE.AnimationMixer=function(e){this._root=e;this._initMemoryManager();this.time=this._accuIndex=0;this.timeScale=1};THREE.AnimationMixer.prototype={constructor:THREE.AnimationMixer,clipAction:function(e,t){var r=(t||this._root).uuid,n="string"===typeof e?e:e.name,i=e!==n?e:null,o=this._actionsByClip[n],a;if(void 0!==o){a=o.actionByRoot[r];if(void 0!==a)return a;a=o.knownActions[0];i=a._clip;if(e!==n&&e!==i)throw Error("Different clips with the same name detected!")}if(null===i)return null;o=new THREE.AnimationMixer._Action(this,i,t);this._bindAction(o,a);this._addInactiveAction(o,n,r);return o},existingAction:function(e,t){var r=(t||this._root).uuid,n=this._actionsByClip["string"===typeof e?e:e.name];return void 0!==n?n.actionByRoot[r]||null:null},stopAllAction:function(){for(var e=this._actions,t=this._nActiveActions,r=this._bindings,n=this._nActiveBindings,i=this._nActiveBindings=this._nActiveActions=0;i!==t;++i)e[i].reset();for(i=0;i!==n;++i)r[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1,a=0;a!==r;++a){var s=t[a];s.enabled&&s._update(n,e,i,o)}e=this._bindings;t=this._nActiveBindings;for(a=0;a!==t;++a)e[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions;e=e.name;var r=this._actionsByClip,n=r[e];if(void 0!==n){for(var n=n.knownActions,i=0,o=n.length;i!==o;++i){var a=n[i];this._deactivateAction(a);var s=a._cacheIndex,c=t[t.length-1];a._cacheIndex=null;a._byClipCacheIndex=null;c._cacheIndex=s;t[s]=c;t.pop();this._removeInactiveBindingsForAction(a)}delete r[e]}},uncacheRoot:function(e){e=e.uuid;var t=this._actionsByClip,r;for(r in t){var n=t[r].actionByRoot[e];void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}r=this._bindingsByRootAndName[e];if(void 0!==r)for(var i in r)e=r[i],e.restoreOriginalState(),this._removeInactiveBinding(e)},uncacheAction:function(e,t){var r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}};THREE.EventDispatcher.prototype.apply(THREE.AnimationMixer.prototype);THREE.AnimationMixer._Action=function(e,t,r){this._mixer=e;this._clip=t;this._localRoot=r||null;e=t.tracks;t=e.length;r=Array(t);for(var n={endingStart:THREE.ZeroCurvatureEnding,endingEnd:THREE.ZeroCurvatureEnding},i=0;i!==t;++i){var o=e[i].createInterpolant(null);r[i]=o;o.settings=n}this._interpolantSettings=n;this._interpolants=r;this._propertyBindings=Array(t);this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null;this.loop=THREE.LoopRepeat;this._loopCount=-1;this._startTime=null;this.time=0;this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1;this.repetitions=Infinity;this.paused=!1;this.enabled=!0;this.clampWhenFinished=!1;this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0};THREE.AnimationMixer._Action.prototype={constructor:THREE.AnimationMixer._Action,play:function(){this._mixer._activateAction(this);return this},stop:function(){this._mixer._deactivateAction(this);return this.reset()},reset:function(){this.paused=!1;this.enabled=!0;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){this._startTime=e;return this},setLoop:function(e,t){this.loop=e;this.repetitions=t;return this},setEffectiveWeight:function(e){this.weight=e;this._effectiveWeight=this.enabled?e:0;return this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,r){e.fadeOut(t);this.fadeIn(t);if(r){r=this._clip.duration;var n=e._clip.duration,i=r/n;e.warp(1,n/r,t);this.warp(i,1,t)}return this},crossFadeTo:function(e,t,r){return e.crossFadeFrom(this,t,r)},stopFading:function(){var e=this._weightInterpolant;null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e));return this},setEffectiveTimeScale:function(e){this.timeScale=e;this._effectiveTimeScale=this.paused?0:e;return this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){this.timeScale=this._clip.duration/e;return this.stopWarping()},syncWith:function(e){this.time=e.time;this.timeScale=e.timeScale;return this.stopWarping()},halt:function(e){return this.warp(this._currentTimeScale,0,e)},warp:function(e,t,r){var n=this._mixer,i=n.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(this._timeScaleInterpolant=o=n._lendControlInterpolant());n=o.parameterPositions;o=o.sampleValues;n[0]=i;n[1]=i+r;o[0]=e/a;o[1]=t/a;return this},stopWarping:function(){var e=this._timeScaleInterpolant;null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e));return this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,r,n){var i=this._startTime;if(null!==i){t=(e-i)*r;if(0>t||0===r)return;this._startTime=null;t*=r}t*=this._updateTimeScale(e);r=this._updateTime(t);e=this._updateWeight(e);if(0<e){t=this._interpolants;for(var i=this._propertyBindings,o=0,a=t.length;o!==a;++o)t[o].evaluate(r),i[o].accumulate(n,e)}},_updateWeight:function(e){var t=0;if(this.enabled){var t=this.weight,r=this._weightInterpolant;if(null!==r){var n=r.evaluate(e)[0],t=t*n;e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t},_updateTimeScale:function(e){var t=0;if(!this.paused){var t=this.timeScale,r=this._timeScaleInterpolant;if(null!==r){var n=r.evaluate(e)[0],t=t*n;e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.pause=!0:this.timeScale=t)}}return this._effectiveTimeScale=t},_updateTime:function(e){var t=this.time+e;if(0===e)return t;var r=this._clip.duration,n=this.loop,i=this._loopCount,o=!1;switch(n){case THREE.LoopOnce:-1===i&&(this.loopCount=0,this._setEndings(!0,!0,!1));if(t>=r)t=r;else if(0>t)t=0;else break;this.clampWhenFinished?this.pause=!0:this.enabled=!1;this._mixer.dispatchEvent({type:"finished",action:this,direction:0>e?-1:1});break;case THREE.LoopPingPong:o=!0;case THREE.LoopRepeat:-1===i&&(0<e?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o));if(t>=r||0>t){var a=Math.floor(t/r),t=t-r*a,i=i+Math.abs(a),s=this.repetitions-i;if(0>s){this.clampWhenFinished?this.paused=!0:this.enabled=!1;t=0<e?r:0;this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1});break}else 0===s?(e=0>e,this._setEndings(e,!e,o)):this._setEndings(!1,!1,o);this._loopCount=i;this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}if(n===THREE.LoopPingPong&&1===(i&1))return this.time=t,r-t}return this.time=t},_setEndings:function(e,t,r){var n=this._interpolantSettings;r?(n.endingStart=THREE.ZeroSlopeEnding,n.endingEnd=THREE.ZeroSlopeEnding):(n.endingStart=e?this.zeroSlopeAtStart?THREE.ZeroSlopeEnding:THREE.ZeroCurvatureEnding:THREE.WrapAroundEnding,n.endingEnd=t?this.zeroSlopeAtEnd?THREE.ZeroSlopeEnding:THREE.ZeroCurvatureEnding:THREE.WrapAroundEnding)},_scheduleFading:function(e,t,r){var n=this._mixer,i=n.time,o=this._weightInterpolant;null===o&&(this._weightInterpolant=o=n._lendControlInterpolant());n=o.parameterPositions;o=o.sampleValues;n[0]=i;o[0]=t;n[1]=i+e;o[1]=r;return this}};Object.assign(THREE.AnimationMixer.prototype,{_bindAction:function(e,t){var r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,o=e._propertyBindings,a=e._interpolants,s=r.uuid,c=this._bindingsByRootAndName,u=c[s];void 0===u&&(u={},c[s]=u);for(c=0;c!==i;++c){var l=n[c],h=l.name,f=u[h];if(void 0===f){f=o[c];if(void 0!==f){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,h));continue}f=new THREE.PropertyMixer(THREE.PropertyBinding.create(r,h,t&&t._propertyBindings[c].binding.parsedPath),l.ValueTypeName,l.getValueSize());++f.referenceCount;this._addInactiveBinding(f,s,h)}o[c]=f;a[c].resultBuffer=f.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,r=e._clip.name,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]);this._addInactiveAction(e,r,t)}t=e._propertyBindings;r=0;for(n=t.length;r!==n;++r){var i=t[r];0===i.useCount++&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,r=0,n=t.length;r!==n;++r){var i=t[r];0===--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[];this._nActiveActions=0;this._actionsByClip={};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){e=e._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(e,t,r){var n=this._actions,i=this._actionsByClip,o=i[t];void 0===o?(o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o):(t=o.knownActions,e._byClipCacheIndex=t.length,t.push(e));e._cacheIndex=n.length;n.push(e);o.actionByRoot[r]=e},_removeInactiveAction:function(e){var t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n;t[n]=r;t.pop();e._cacheIndex=null;var r=e._clip.name,n=this._actionsByClip,i=n[r],o=i.knownActions,a=o[o.length-1],s=e._byClipCacheIndex;a._byClipCacheIndex=s;o[s]=a;o.pop();e._byClipCacheIndex=null;delete i.actionByRoot[(t._localRoot||this._root).uuid];0===o.length&&delete n[r];this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){e=e._propertyBindings;for(var t=0,r=e.length;t!==r;++t){var n=e[t];0===--n.referenceCount&&this._removeInactiveBinding(n)}},_lendAction:function(e){var t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n;t[n]=e;i._cacheIndex=r;t[r]=i},_takeBackAction:function(e){var t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n;t[n]=e;i._cacheIndex=r;t[r]=i},_addInactiveBinding:function(e,t,r){var n=this._bindingsByRootAndName,i=n[t],o=this._bindings;void 0===i&&(i={},n[t]=i);i[r]=e;e._cacheIndex=o.length;o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,r=e.binding,n=r.rootNode.uuid,r=r.path,i=this._bindingsByRootAndName,o=i[n],a=t[t.length-1];e=e._cacheIndex;a._cacheIndex=e;t[e]=a;t.pop();delete o[r];e:{for(var s in o)break e;delete i[n]}},_lendBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n;t[n]=e;i._cacheIndex=r;t[r]=i},_takeBackBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n;t[n]=e;i._cacheIndex=r;t[r]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];void 0===r&&(r=new THREE.LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),r.__cacheIndex=t,e[t]=r);return r},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n;t[n]=e;i.__cacheIndex=r;t[r]=i},_controlInterpolantsResultBuffer:new Float32Array(1)});THREE.AnimationObjectGroup=function(e){this.uuid=THREE.Math.generateUUID();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var r=0,n=arguments.length;r!==n;++r)t[arguments[r].uuid]=r;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}};THREE.AnimationObjectGroup.prototype={constructor:THREE.AnimationObjectGroup,add:function(e){for(var t=this._objects,r=t.length,n=this.nCachedObjects_,i=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,c=s.length,u=0,l=arguments.length;u!==l;++u){var h=arguments[u],f=h.uuid,p=i[f];if(void 0===p){p=r++;i[f]=p;t.push(h);for(var f=0,d=c;f!==d;++f)s[f].push(new THREE.PropertyBinding(h,o[f],a[f]))}else if(p<n){var m=t[p],E=--n,d=t[E];i[d.uuid]=p;t[p]=d;i[f]=E;t[E]=h;f=0;for(d=c;f!==d;++f){var g=s[f],v=g[p];g[p]=g[E];void 0===v&&(v=new THREE.PropertyBinding(h,o[f],a[f]));g[E]=v}}else t[p]!==m&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")}this.nCachedObjects_=n},remove:function(e){for(var t=this._objects,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a],u=c.uuid,l=n[u];if(void 0!==l&&l>=r){var h=r++,f=t[h];n[f.uuid]=l;t[l]=f;n[u]=h;t[h]=c;c=0;for(u=o;c!==u;++c){var f=i[c],p=f[l];f[l]=f[h];f[h]=p}}}this.nCachedObjects_=r},uncache:function(e){for(var t=this._objects,r=t.length,n=this.nCachedObjects_,i=this._indicesByUUID,o=this._bindings,a=o.length,s=0,c=arguments.length;s!==c;++s){var u=arguments[s].uuid,l=i[u];if(void 0!==l)if(delete i[u],l<n){var u=--n,h=t[u],f=--r,p=t[f];i[h.uuid]=l;t[l]=h;i[p.uuid]=u;t[u]=p;t.pop();h=0;for(p=a;h!==p;++h){var d=o[h],m=d[f];d[l]=d[u];d[u]=m;d.pop()}}else for(f=--r,p=t[f],i[p.uuid]=l,t[l]=p,t.pop(),h=0,p=a;h!==p;++h)d=o[h],d[l]=d[f],d.pop()}this.nCachedObjects_=n},subscribe_:function(e,t){var r=this._bindingsIndicesByPath,n=r[e],i=this._bindings;if(void 0!==n)return i[n];var o=this._paths,a=this._parsedPaths,s=this._objects,c=this.nCachedObjects_,u=Array(s.length),n=i.length;r[e]=n;o.push(e);a.push(t);i.push(u);r=c;for(n=s.length;r!==n;++r)u[r]=new THREE.PropertyBinding(s[r],e,t);return u},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){var n=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=r;o[r]=s;o.pop();i[r]=i[a];i.pop();n[r]=n[a];n.pop()}}};THREE.AnimationUtils={arraySlice:function(e,t,r){return THREE.AnimationUtils.isTypedArray(e)?new e.constructor(e.subarray(t,r)):e.slice(t,r)},convertArray:function(e,t,r){return!e||!r&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,r=Array(t),n=0;n!==t;++n)r[n]=n;r.sort(function(t,r){return e[t]-e[r]});return r},sortedArray:function(e,t,r){for(var n=e.length,i=new e.constructor(n),o=0,a=0;a!==n;++o)for(var s=r[o]*t,c=0;c!==t;++c)i[a++]=e[s+c];return i},flattenJSON:function(e,t,r,n){for(var i=1,o=e[0];void 0!==o&&void 0===o[n];)o=e[i++];if(void 0!==o){var a=o[n];if(void 0!==a)if(Array.isArray(a)){do a=o[n],void 0!==a&&(t.push(o.time),r.push.apply(r,a)),o=e[i++];while(void 0!==o)}else if(void 0!==a.toArray){do a=o[n],void 0!==a&&(t.push(o.time),a.toArray(r,r.length)),o=e[i++];while(void 0!==o)}else{do a=o[n],void 0!==a&&(t.push(o.time),r.push(a)),o=e[i++];while(void 0!==o)}}}};THREE.KeyframeTrack=function(e,t,r,n){if(void 0===e)throw Error("track name is undefined");if(void 0===t||0===t.length)throw Error("no keyframes in track named "+e);this.name=e;this.times=THREE.AnimationUtils.convertArray(t,this.TimeBufferType);this.values=THREE.AnimationUtils.convertArray(r,this.ValueBufferType);this.setInterpolation(n||this.DefaultInterpolation);this.validate();this.optimize()};THREE.KeyframeTrack.prototype={constructor:THREE.KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:THREE.InterpolateLinear,InterpolantFactoryMethodDiscrete:function(e){return new THREE.DiscreteInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new THREE.LinearInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new THREE.CubicInterpolant(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t=void 0;switch(e){case THREE.InterpolateDiscrete:t=this.InterpolantFactoryMethodDiscrete;break;case THREE.InterpolateLinear:t=this.InterpolantFactoryMethodLinear;break;case THREE.InterpolateSmooth:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(t);console.warn(t)}else this.createInterpolant=t},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return THREE.InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return THREE.InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return THREE.InterpolateSmooth}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]*=e;return this},trim:function(e,t){for(var r=this.times,n=r.length,i=0,o=n-1;i!==n&&r[i]<e;)++i;for(;-1!==o&&r[o]>t;)--o;++o;if(0!==i||o!==n)i>=o&&(o=Math.max(o,1),i=o-1),n=this.getValueSize(),this.times=THREE.AnimationUtils.arraySlice(r,i,o),this.values=THREE.AnimationUtils.arraySlice(this.values,i*n,o*n);return this},validate:function(){var e=!0,t=this.getValueSize();0!==t-Math.floor(t)&&(console.error("invalid value size in track",this),e=!1);var r=this.times,t=this.values,n=r.length;0===n&&(console.error("track is empty",this),e=!1);for(var i=null,o=0;o!==n;o++){var a=r[o];if("number"===typeof a&&isNaN(a)){console.error("time is not a valid number",this,o,a);e=!1;break}if(null!==i&&i>a){console.error("out of order keys",this,o,a,i);e=!1;break}i=a}if(void 0!==t&&THREE.AnimationUtils.isTypedArray(t))for(o=0,r=t.length;o!==r;++o)if(n=t[o],isNaN(n)){console.error("value is not a valid number",this,o,n);e=!1;break}return e},optimize:function(){for(var e=this.times,t=this.values,r=this.getValueSize(),n=1,i=1,o=e.length-1;i<=o;++i){var a=!1,s=e[i];if(s!==e[i+1]&&(1!==i||s!==s[0]))for(var c=i*r,u=c-r,l=c+r,s=0;s!==r;++s){var h=t[c+s];if(h!==t[u+s]||h!==t[l+s]){a=!0;break}}if(a){if(i!==n)for(e[n]=e[i],a=i*r,c=n*r,s=0;s!==r;++s)t[c+s]=t[a+s];++n}}n!==e.length&&(this.times=THREE.AnimationUtils.arraySlice(e,0,n),this.values=THREE.AnimationUtils.arraySlice(t,0,n*r));return this}};Object.assign(THREE.KeyframeTrack,{parse:function(e){if(void 0===e.type)throw Error("track type undefined, can not parse");var t=THREE.KeyframeTrack._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){console.warn("legacy JSON format detected, converting");var r=[],n=[];THREE.AnimationUtils.flattenJSON(e.keys,r,n,"value");e.times=r;e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var t=e.constructor;if(void 0!==t.toJSON)t=t.toJSON(e);else{var t={name:e.name,times:THREE.AnimationUtils.convertArray(e.times,Array),values:THREE.AnimationUtils.convertArray(e.values,Array)},r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}t.type=e.ValueTypeName;return t},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return THREE.NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return THREE.VectorKeyframeTrack;case"color":return THREE.ColorKeyframeTrack;case"quaternion":return THREE.QuaternionKeyframeTrack;case"bool":case"boolean":return THREE.BooleanKeyframeTrack;case"string":return THREE.StringKeyframeTrack}throw Error("Unsupported typeName: "+e)}});THREE.PropertyBinding=function(e,t,r){this.path=t;this.parsedPath=r||THREE.PropertyBinding.parseTrackName(t);this.node=THREE.PropertyBinding.findNode(e,this.parsedPath.nodeName)||e;this.rootNode=e};THREE.PropertyBinding.prototype={constructor:THREE.PropertyBinding,getValue:function(e,t){this.bind();this.getValue(e,t)},setValue:function(e,t){this.bind();this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,i=t.propertyIndex;e||(this.node=e=THREE.PropertyBinding.findNode(this.rootNode,t.nodeName)||this.rootNode);this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(e){if(r){var o=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("  can not bind to material as node does not have a material",this);return}if(!e.material.materials){console.error("  can not bind to material.materials as node.material does not have a materials array",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("  can not bind to bones as node does not have a skeleton",this);return}e=e.skeleton.bones;for(r=0;r<e.length;r++)if(e[r].name===o){o=r;break}break;default:if(void 0===e[r]){console.error("  can not bind to objectName of node, undefined",this);return}e=e[r]}if(void 0!==o){if(void 0===e[o]){console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,e);return}e=e[o]}}if(o=e[n]){t=this.Versioning.None;void 0!==e.needsUpdate?(t=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(t=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e);r=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!e.geometry){console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);return}if(!e.geometry.morphTargets){console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);return}for(r=0;r<this.node.geometry.morphTargets.length;r++)if(e.geometry.morphTargets[r].name===i){i=r;break}}r=this.BindingType.ArrayElement;this.resolvedProperty=o;this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(r=this.BindingType.HasFromToArray,this.resolvedProperty=o):void 0!==o.length?(r=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=n;this.getValue=this.GetterByBindingType[r];this.setValue=this.SetterByBindingTypeAndVersioning[r][t]}else console.error("  trying to update property for track: "+t.nodeName+"."+n+" but it wasn't found.",e)}else console.error("  trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}};Object.assign(THREE.PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:THREE.PropertyBinding.prototype.getValue,_setValue_unbound:THREE.PropertyBinding.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)e[t++]=r[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.node[this.propertyName]=e[t]},function(e,t){this.node[this.propertyName]=e[t];this.targetObject.needsUpdate=!0},function(e,t){this.node[this.propertyName]=e[t];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t];this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t);this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t);this.targetObject.matrixWorldNeedsUpdate=!0}]]});THREE.PropertyBinding.Composite=function(e,t,r){r=r||THREE.PropertyBinding.parseTrackName(t);this._targetGroup=e;this._bindings=e.subscribe_(t,r)};THREE.PropertyBinding.Composite.prototype={constructor:THREE.PropertyBinding.Composite,getValue:function(e,t){this.bind();var r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}};THREE.PropertyBinding.create=function(e,t,r){return e instanceof THREE.AnimationObjectGroup?new THREE.PropertyBinding.Composite(e,t,r):new THREE.PropertyBinding(e,t,r)};THREE.PropertyBinding.parseTrackName=function(e){var t=/^(([\w]+\/)*)([\w-\d]+)?(\.([\w]+)(\[([\w\d\[\]\_. ]+)\])?)?(\.([\w.]+)(\[([\w\d\[\]\_. ]+)\])?)$/,r=t.exec(e);if(!r)throw Error("cannot parse trackName at all: "+e);r.index===t.lastIndex&&t.lastIndex++;t={nodeName:r[3],objectName:r[5],objectIndex:r[7],propertyName:r[9],propertyIndex:r[11]};if(null===t.propertyName||0===t.propertyName.length)throw Error("can not parse propertyName from trackName: "+e);return t};THREE.PropertyBinding.findNode=function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var r=function(e){for(var r=0;r<e.bones.length;r++){var n=e.bones[r];if(n.name===t)return n}return null}(e.skeleton);if(r)return r}if(e.children){var n=function(e){for(var r=0;r<e.length;r++){var i=e[r];if(i.name===t||i.uuid===t||(i=n(i.children)))return i}return null};if(r=n(e.children))return r}return null};THREE.PropertyMixer=function(e,t,r){this.binding=e;this.valueSize=r;e=Float64Array;switch(t){case"quaternion":t=this._slerp;break;case"string":case"bool":e=Array;t=this._select;break;default:t=this._lerp}this.buffer=new e(4*r);this._mixBufferRegion=t;this.referenceCount=this.useCount=this.cumulativeWeight=0};THREE.PropertyMixer.prototype={constructor:THREE.PropertyMixer,accumulate:function(e,t){var r=this.buffer,n=this.valueSize,i=e*n+n,o=this.cumulativeWeight;if(0===o){for(o=0;o!==n;++o)r[i+o]=r[o];o=t}else o+=t,this._mixBufferRegion(r,i,0,t/o,n);this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,r=this.buffer;e=e*t+t;var n=this.cumulativeWeight,i=this.binding;this.cumulativeWeight=0;1>n&&this._mixBufferRegion(r,e,3*t,1-n,t);for(var n=t,o=t+t;n!==o;++n)if(r[n]!==r[n+t]){i.setValue(r,e);break}},saveOriginalState:function(){var e=this.buffer,t=this.valueSize,r=3*t;this.binding.getValue(e,r);for(var n=t;n!==r;++n)e[n]=e[r+n%t];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(e,t,r,n,i){if(.5<=n)for(n=0;n!==i;++n)e[t+n]=e[r+n]},_slerp:function(e,t,r,n,i){THREE.Quaternion.slerpFlat(e,t,e,t,e,r,n)},_lerp:function(e,t,r,n,i){for(var o=1-n,a=0;a!==i;++a){var s=t+a;e[s]=e[s]*o+e[r+a]*n}}};THREE.BooleanKeyframeTrack=function(e,t,r){THREE.KeyframeTrack.call(this,e,t,r)};THREE.BooleanKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:THREE.IntepolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});THREE.NumberKeyframeTrack=function(e,t,r,n){THREE.KeyframeTrack.call(this,e,t,r,n)};THREE.NumberKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.NumberKeyframeTrack,ValueTypeName:"number"});THREE.QuaternionKeyframeTrack=function(e,t,r,n){THREE.KeyframeTrack.call(this,e,t,r,n)};THREE.QuaternionKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:THREE.InterpolateLinear,InterpolantFactoryMethodLinear:function(e){return new THREE.QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),e);
},InterpolantFactoryMethodSmooth:void 0});THREE.StringKeyframeTrack=function(e,t,r,n){THREE.KeyframeTrack.call(this,e,t,r,n)};THREE.StringKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:THREE.IntepolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});THREE.VectorKeyframeTrack=function(e,t,r,n){THREE.KeyframeTrack.call(this,e,t,r,n)};THREE.VectorKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.VectorKeyframeTrack,ValueTypeName:"vector"});THREE.Audio=function(e){THREE.Object3D.call(this);this.type="Audio";this.context=e.context;this.source=this.context.createBufferSource();this.source.onended=this.onEnded.bind(this);this.gain=this.context.createGain();this.gain.connect(e.getInput());this.autoplay=!1;this.startTime=0;this.playbackRate=1;this.isPlaying=!1;this.hasPlaybackControl=!0;this.sourceType="empty";this.filter=null};THREE.Audio.prototype=Object.create(THREE.Object3D.prototype);THREE.Audio.prototype.constructor=THREE.Audio;THREE.Audio.prototype.getOutput=function(){return this.gain};THREE.Audio.prototype.load=function(e){var t=new THREE.AudioBuffer(this.context);t.load(e);this.setBuffer(t);return this};THREE.Audio.prototype.setNodeSource=function(e){this.hasPlaybackControl=!1;this.sourceType="audioNode";this.source=e;this.connect();return this};THREE.Audio.prototype.setBuffer=function(e){var t=this;e.onReady(function(e){t.source.buffer=e;t.sourceType="buffer";t.autoplay&&t.play()});return this};THREE.Audio.prototype.play=function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else{var e=this.context.createBufferSource();e.buffer=this.source.buffer;e.loop=this.source.loop;e.onended=this.source.onended;e.start(0,this.startTime);e.playbackRate.value=this.playbackRate;this.isPlaying=!0;this.source=e;this.connect()}};THREE.Audio.prototype.pause=function(){!1===this.hasPlaybackControl?console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=this.context.currentTime)};THREE.Audio.prototype.stop=function(){!1===this.hasPlaybackControl?console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.startTime=0)};THREE.Audio.prototype.connect=function(){null!==this.filter?(this.source.connect(this.filter),this.filter.connect(this.getOutput())):this.source.connect(this.getOutput())};THREE.Audio.prototype.disconnect=function(){null!==this.filter?(this.source.disconnect(this.filter),this.filter.disconnect(this.getOutput())):this.source.disconnect(this.getOutput())};THREE.Audio.prototype.getFilter=function(){return this.filter};THREE.Audio.prototype.setFilter=function(e){void 0===e&&(e=null);!0===this.isPlaying?(this.disconnect(),this.filter=e,this.connect()):this.filter=e};THREE.Audio.prototype.setPlaybackRate=function(e){!1===this.hasPlaybackControl?console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=e,!0===this.isPlaying&&(this.source.playbackRate.value=this.playbackRate))};THREE.Audio.prototype.getPlaybackRate=function(){return this.playbackRate};THREE.Audio.prototype.onEnded=function(){this.isPlaying=!1};THREE.Audio.prototype.setLoop=function(e){!1===this.hasPlaybackControl?console.warn("THREE.Audio: this Audio has no playback control."):this.source.loop=e};THREE.Audio.prototype.getLoop=function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.source.loop};THREE.Audio.prototype.setVolume=function(e){this.gain.gain.value=e};THREE.Audio.prototype.getVolume=function(){return this.gain.gain.value};THREE.AudioAnalyser=function(e,t){this.analyser=e.context.createAnalyser();this.analyser.fftSize=void 0!==t?t:2048;this.data=new Uint8Array(this.analyser.frequencyBinCount);e.getOutput().connect(this.analyser)};THREE.AudioAnalyser.prototype={constructor:THREE.AudioAnalyser,getData:function(){this.analyser.getByteFrequencyData(this.data);return this.data}};THREE.AudioBuffer=function(e){this.context=e;this.ready=!1;this.readyCallbacks=[]};THREE.AudioBuffer.prototype.load=function(e){var t=this,r=new XMLHttpRequest;r.open("GET",e,!0);r.responseType="arraybuffer";r.onload=function(e){t.context.decodeAudioData(this.response,function(e){t.buffer=e;t.ready=!0;for(e=0;e<t.readyCallbacks.length;e++)t.readyCallbacks[e](t.buffer);t.readyCallbacks=[]})};r.send();return this};THREE.AudioBuffer.prototype.onReady=function(e){this.ready?e(this.buffer):this.readyCallbacks.push(e)};THREE.PositionalAudio=function(e){THREE.Audio.call(this,e);this.panner=this.context.createPanner();this.panner.connect(this.gain)};THREE.PositionalAudio.prototype=Object.create(THREE.Audio.prototype);THREE.PositionalAudio.prototype.constructor=THREE.PositionalAudio;THREE.PositionalAudio.prototype.getOutput=function(){return this.panner};THREE.PositionalAudio.prototype.setRefDistance=function(e){this.panner.refDistance=e};THREE.PositionalAudio.prototype.getRefDistance=function(){return this.panner.refDistance};THREE.PositionalAudio.prototype.setRolloffFactor=function(e){this.panner.rolloffFactor=e};THREE.PositionalAudio.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor};THREE.PositionalAudio.prototype.setDistanceModel=function(e){this.panner.distanceModel=e};THREE.PositionalAudio.prototype.getDistanceModel=function(){return this.panner.distanceModel};THREE.PositionalAudio.prototype.setMaxDistance=function(e){this.panner.maxDistance=e};THREE.PositionalAudio.prototype.getMaxDistance=function(){return this.panner.maxDistance};THREE.PositionalAudio.prototype.updateMatrixWorld=function(){var e=new THREE.Vector3;return function(t){THREE.Object3D.prototype.updateMatrixWorld.call(this,t);e.setFromMatrixPosition(this.matrixWorld);this.panner.setPosition(e.x,e.y,e.z)}}();THREE.AudioListener=function(){THREE.Object3D.call(this);this.type="AudioListener";this.context=new(window.AudioContext||window.webkitAudioContext);this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.filter=null};THREE.AudioListener.prototype=Object.create(THREE.Object3D.prototype);THREE.AudioListener.prototype.constructor=THREE.AudioListener;THREE.AudioListener.prototype.getInput=function(){return this.gain};THREE.AudioListener.prototype.removeFilter=function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)};THREE.AudioListener.prototype.setFilter=function(e){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination);this.filter=e;this.gain.connect(this.filter);this.filter.connect(this.context.destination)};THREE.AudioListener.prototype.getFilter=function(){return this.filter};THREE.AudioListener.prototype.setMasterVolume=function(e){this.gain.gain.value=e};THREE.AudioListener.prototype.getMasterVolume=function(){return this.gain.gain.value};THREE.AudioListener.prototype.updateMatrixWorld=function(){var e=new THREE.Vector3,t=new THREE.Quaternion,r=new THREE.Vector3,n=new THREE.Vector3;return function(i){THREE.Object3D.prototype.updateMatrixWorld.call(this,i);i=this.context.listener;var o=this.up;this.matrixWorld.decompose(e,t,r);n.set(0,0,-1).applyQuaternion(t);i.setPosition(e.x,e.y,e.z);i.setOrientation(n.x,n.y,n.z,o.x,o.y,o.z)}}();THREE.Camera=function(){THREE.Object3D.call(this);this.type="Camera";this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.constructor=THREE.Camera;THREE.Camera.prototype.getWorldDirection=function(){var e=new THREE.Quaternion;return function(t){t=t||new THREE.Vector3;this.getWorldQuaternion(e);return t.set(0,0,-1).applyQuaternion(e)}}();THREE.Camera.prototype.lookAt=function(){var e=new THREE.Matrix4;return function(t){e.lookAt(this.position,t,this.up);this.quaternion.setFromRotationMatrix(e)}}();THREE.Camera.prototype.clone=function(){return(new this.constructor).copy(this)};THREE.Camera.prototype.copy=function(e){THREE.Object3D.prototype.copy.call(this,e);this.matrixWorldInverse.copy(e.matrixWorldInverse);this.projectionMatrix.copy(e.projectionMatrix);return this};THREE.CubeCamera=function(e,t,r){THREE.Object3D.call(this);this.type="CubeCamera";var n=new THREE.PerspectiveCamera(90,1,e,t);n.up.set(0,-1,0);n.lookAt(new THREE.Vector3(1,0,0));this.add(n);var i=new THREE.PerspectiveCamera(90,1,e,t);i.up.set(0,-1,0);i.lookAt(new THREE.Vector3(-1,0,0));this.add(i);var o=new THREE.PerspectiveCamera(90,1,e,t);o.up.set(0,0,1);o.lookAt(new THREE.Vector3(0,1,0));this.add(o);var a=new THREE.PerspectiveCamera(90,1,e,t);a.up.set(0,0,-1);a.lookAt(new THREE.Vector3(0,-1,0));this.add(a);var s=new THREE.PerspectiveCamera(90,1,e,t);s.up.set(0,-1,0);s.lookAt(new THREE.Vector3(0,0,1));this.add(s);var c=new THREE.PerspectiveCamera(90,1,e,t);c.up.set(0,-1,0);c.lookAt(new THREE.Vector3(0,0,-1));this.add(c);this.renderTarget=new THREE.WebGLRenderTargetCube(r,r,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(e,t){null===this.parent&&this.updateMatrixWorld();var r=this.renderTarget,u=r.texture.generateMipmaps;r.texture.generateMipmaps=!1;r.activeCubeFace=0;e.render(t,n,r);r.activeCubeFace=1;e.render(t,i,r);r.activeCubeFace=2;e.render(t,o,r);r.activeCubeFace=3;e.render(t,a,r);r.activeCubeFace=4;e.render(t,s,r);r.texture.generateMipmaps=u;r.activeCubeFace=5;e.render(t,c,r);e.setRenderTarget(null)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);THREE.CubeCamera.prototype.constructor=THREE.CubeCamera;THREE.OrthographicCamera=function(e,t,r,n,i,o){THREE.Camera.call(this);this.type="OrthographicCamera";this.zoom=1;this.left=e;this.right=t;this.top=r;this.bottom=n;this.near=void 0!==i?i:.1;this.far=void 0!==o?o:2e3;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.constructor=THREE.OrthographicCamera;THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(r-e,r+e,n+t,n-t,this.near,this.far)};THREE.OrthographicCamera.prototype.copy=function(e){THREE.Camera.prototype.copy.call(this,e);this.left=e.left;this.right=e.right;this.top=e.top;this.bottom=e.bottom;this.near=e.near;this.far=e.far;this.zoom=e.zoom;return this};THREE.OrthographicCamera.prototype.toJSON=function(e){e=THREE.Object3D.prototype.toJSON.call(this,e);e.object.zoom=this.zoom;e.object.left=this.left;e.object.right=this.right;e.object.top=this.top;e.object.bottom=this.bottom;e.object.near=this.near;e.object.far=this.far;return e};THREE.PerspectiveCamera=function(e,t,r,n){THREE.Camera.call(this);this.type="PerspectiveCamera";this.focalLength=10;this.zoom=1;this.fov=void 0!==e?e:50;this.aspect=void 0!==t?t:1;this.near=void 0!==r?r:.1;this.far=void 0!==n?n:2e3;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.constructor=THREE.PerspectiveCamera;THREE.PerspectiveCamera.prototype.setLens=function(e,t){void 0===t&&(t=24);this.fov=2*THREE.Math.radToDeg(Math.atan(t/(2*e)));this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.setViewOffset=function(e,t,r,n,i,o){this.fullWidth=e;this.fullHeight=t;this.x=r;this.y=n;this.width=i;this.height=o;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var e=THREE.Math.radToDeg(2*Math.atan(Math.tan(.5*THREE.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var t=this.fullWidth/this.fullHeight,e=Math.tan(THREE.Math.degToRad(.5*e))*this.near,r=-e,n=t*r,t=Math.abs(t*e-n),r=Math.abs(e-r);this.projectionMatrix.makeFrustum(n+this.x*t/this.fullWidth,n+(this.x+this.width)*t/this.fullWidth,e-(this.y+this.height)*r/this.fullHeight,e-this.y*r/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(e,this.aspect,this.near,this.far)};THREE.PerspectiveCamera.prototype.copy=function(e){THREE.Camera.prototype.copy.call(this,e);this.focalLength=e.focalLength;this.zoom=e.zoom;this.fov=e.fov;this.aspect=e.aspect;this.near=e.near;this.far=e.far;return this};THREE.PerspectiveCamera.prototype.toJSON=function(e){e=THREE.Object3D.prototype.toJSON.call(this,e);e.object.focalLength=this.focalLength;e.object.zoom=this.zoom;e.object.fov=this.fov;e.object.aspect=this.aspect;e.object.near=this.near;e.object.far=this.far;return e};THREE.StereoCamera=function(){this.type="StereoCamera";this.aspect=1;this.cameraL=new THREE.PerspectiveCamera;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=!1;this.cameraR=new THREE.PerspectiveCamera;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=!1};THREE.StereoCamera.prototype={constructor:THREE.StereoCamera,update:function(){var e,t,r,n,i,o=new THREE.Matrix4,a=new THREE.Matrix4;return function(s){if(e!==s.focalLength||t!==s.fov||r!==s.aspect*this.aspect||n!==s.near||i!==s.far){e=s.focalLength;t=s.fov;r=s.aspect*this.aspect;n=s.near;i=s.far;var c=s.projectionMatrix.clone(),u=.032*n/e,l=n*Math.tan(THREE.Math.degToRad(.5*t)),h,f;a.elements[12]=-.032;o.elements[12]=.032;h=-l*r+u;f=l*r+u;c.elements[0]=2*n/(f-h);c.elements[8]=(f+h)/(f-h);this.cameraL.projectionMatrix.copy(c);h=-l*r-u;f=l*r-u;c.elements[0]=2*n/(f-h);c.elements[8]=(f+h)/(f-h);this.cameraR.projectionMatrix.copy(c)}this.cameraL.matrixWorld.copy(s.matrixWorld).multiply(a);this.cameraR.matrixWorld.copy(s.matrixWorld).multiply(o)}}()};THREE.Light=function(e,t){THREE.Object3D.call(this);this.type="Light";this.color=new THREE.Color(e);this.intensity=void 0!==t?t:1;this.receiveShadow=void 0};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.Light.prototype.constructor=THREE.Light;THREE.Light.prototype.copy=function(e){THREE.Object3D.prototype.copy.call(this,e);this.color.copy(e.color);this.intensity=e.intensity;return this};THREE.Light.prototype.toJSON=function(e){e=THREE.Object3D.prototype.toJSON.call(this,e);e.object.color=this.color.getHex();e.object.intensity=this.intensity;void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex());void 0!==this.distance&&(e.object.distance=this.distance);void 0!==this.angle&&(e.object.angle=this.angle);void 0!==this.decay&&(e.object.decay=this.decay);void 0!==this.penumbra&&(e.object.penumbra=this.penumbra);return e};THREE.LightShadow=function(e){this.camera=e;this.bias=0;this.radius=1;this.mapSize=new THREE.Vector2(512,512);this.map=null;this.matrix=new THREE.Matrix4};THREE.LightShadow.prototype={constructor:THREE.LightShadow,copy:function(e){this.camera=e.camera.clone();this.bias=e.bias;this.radius=e.radius;this.mapSize.copy(e.mapSize);return this},clone:function(){return(new this.constructor).copy(this)}};THREE.AmbientLight=function(e,t){THREE.Light.call(this,e,t);this.type="AmbientLight";this.castShadow=void 0};THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);THREE.AmbientLight.prototype.constructor=THREE.AmbientLight;THREE.DirectionalLight=function(e,t){THREE.Light.call(this,e,t);this.type="DirectionalLight";this.position.set(0,1,0);this.updateMatrix();this.target=new THREE.Object3D;this.shadow=new THREE.LightShadow(new THREE.OrthographicCamera(-5,5,5,-5,.5,500))};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);THREE.DirectionalLight.prototype.constructor=THREE.DirectionalLight;THREE.DirectionalLight.prototype.copy=function(e){THREE.Light.prototype.copy.call(this,e);this.target=e.target.clone();this.shadow=e.shadow.clone();return this};THREE.HemisphereLight=function(e,t,r){THREE.Light.call(this,e,r);this.type="HemisphereLight";this.castShadow=void 0;this.position.set(0,1,0);this.updateMatrix();this.groundColor=new THREE.Color(t)};THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype);THREE.HemisphereLight.prototype.constructor=THREE.HemisphereLight;THREE.HemisphereLight.prototype.copy=function(e){THREE.Light.prototype.copy.call(this,e);this.groundColor.copy(e.groundColor);return this};THREE.PointLight=function(e,t,r,n){THREE.Light.call(this,e,t);this.type="PointLight";this.distance=void 0!==r?r:0;this.decay=void 0!==n?n:1;this.shadow=new THREE.LightShadow(new THREE.PerspectiveCamera(90,1,.5,500))};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);THREE.PointLight.prototype.constructor=THREE.PointLight;THREE.PointLight.prototype.copy=function(e){THREE.Light.prototype.copy.call(this,e);this.distance=e.distance;this.decay=e.decay;this.shadow=e.shadow.clone();return this};THREE.SpotLight=function(e,t,r,n,i,o){THREE.Light.call(this,e,t);this.type="SpotLight";this.position.set(0,1,0);this.updateMatrix();this.target=new THREE.Object3D;this.distance=void 0!==r?r:0;this.angle=void 0!==n?n:Math.PI/3;this.penumbra=void 0!==i?i:0;this.decay=void 0!==o?o:1;this.shadow=new THREE.LightShadow(new THREE.PerspectiveCamera(50,1,.5,500))};THREE.SpotLight.prototype=Object.create(THREE.Light.prototype);THREE.SpotLight.prototype.constructor=THREE.SpotLight;THREE.SpotLight.prototype.copy=function(e){THREE.Light.prototype.copy.call(this,e);this.distance=e.distance;this.angle=e.angle;this.penumbra=e.penumbra;this.decay=e.decay;this.target=e.target.clone();this.shadow=e.shadow.clone();return this};THREE.Cache={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};THREE.Loader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,extractUrlBase:function(e){e=e.split("/");if(1===e.length)return"./";e.pop();return e.join("/")+"/"},initMaterials:function(e,t,r){for(var n=[],i=0;i<e.length;++i)n[i]=this.createMaterial(e[i],t,r);return n},createMaterial:function(){var e,t,r;return function(n,i,o){function a(e,r,n,a,c){e=i+e;var u=THREE.Loader.Handlers.get(e);null!==u?e=u.load(e):(t.setCrossOrigin(o),e=t.load(e));void 0!==r&&(e.repeat.fromArray(r),1!==r[0]&&(e.wrapS=THREE.RepeatWrapping),1!==r[1]&&(e.wrapT=THREE.RepeatWrapping));void 0!==n&&e.offset.fromArray(n);void 0!==a&&("repeat"===a[0]&&(e.wrapS=THREE.RepeatWrapping),"mirror"===a[0]&&(e.wrapS=THREE.MirroredRepeatWrapping),"repeat"===a[1]&&(e.wrapT=THREE.RepeatWrapping),"mirror"===a[1]&&(e.wrapT=THREE.MirroredRepeatWrapping));void 0!==c&&(e.anisotropy=c);r=THREE.Math.generateUUID();s[r]=e;return r}void 0===e&&(e=new THREE.Color);void 0===t&&(t=new THREE.TextureLoader);void 0===r&&(r=new THREE.MaterialLoader);var s={},c={uuid:THREE.Math.generateUUID(),type:"MeshLambertMaterial"},u;for(u in n){var l=n[u];switch(u){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":c.name=l;break;case"blending":c.blending=THREE[l];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",u,"is no longer supported.");break;case"colorDiffuse":c.color=e.fromArray(l).getHex();break;case"colorSpecular":c.specular=e.fromArray(l).getHex();break;case"colorEmissive":c.emissive=e.fromArray(l).getHex();break;case"specularCoef":c.shininess=l;break;case"shading":"basic"===l.toLowerCase()&&(c.type="MeshBasicMaterial");"phong"===l.toLowerCase()&&(c.type="MeshPhongMaterial");break;case"mapDiffuse":c.map=a(l,n.mapDiffuseRepeat,n.mapDiffuseOffset,n.mapDiffuseWrap,n.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapLight":c.lightMap=a(l,n.mapLightRepeat,n.mapLightOffset,n.mapLightWrap,n.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":c.aoMap=a(l,n.mapAORepeat,n.mapAOOffset,n.mapAOWrap,n.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":c.bumpMap=a(l,n.mapBumpRepeat,n.mapBumpOffset,n.mapBumpWrap,n.mapBumpAnisotropy);break;case"mapBumpScale":c.bumpScale=l;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":c.normalMap=a(l,n.mapNormalRepeat,n.mapNormalOffset,n.mapNormalWrap,n.mapNormalAnisotropy);break;case"mapNormalFactor":c.normalScale=[l,l];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":c.specularMap=a(l,n.mapSpecularRepeat,n.mapSpecularOffset,n.mapSpecularWrap,n.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapAlpha":c.alphaMap=a(l,n.mapAlphaRepeat,n.mapAlphaOffset,n.mapAlphaWrap,n.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":c.side=THREE.BackSide;break;case"doubleSided":c.side=THREE.DoubleSide;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity");c.opacity=l;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":c[u]=l;break;case"vertexColors":!0===l&&(c.vertexColors=THREE.VertexColors);"face"===l&&(c.vertexColors=THREE.FaceColors);break;default:console.error("THREE.Loader.createMaterial: Unsupported",u,l)}}"MeshBasicMaterial"===c.type&&delete c.emissive;"MeshPhongMaterial"!==c.type&&delete c.specular;1>c.opacity&&(c.transparent=!0);r.setTextures(s);return r.parse(c)}}()};THREE.Loader.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,r=0,n=t.length;r<n;r+=2){var i=t[r+1];if(t[r].test(e))return i}return null}};THREE.XHRLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(e,t,r,n){void 0!==this.path&&(e=this.path+e);var i=this,o=THREE.Cache.get(e);if(void 0!==o)return t&&setTimeout(function(){t(o)},0),o;var a=new XMLHttpRequest;a.overrideMimeType("text/plain");a.open("GET",e,!0);a.addEventListener("load",function(r){var o=r.target.response;THREE.Cache.add(e,o);200===this.status?(t&&t(o),i.manager.itemEnd(e)):0===this.status?(console.warn("THREE.XHRLoader: HTTP Status 0 received."),t&&t(o),i.manager.itemEnd(e)):(n&&n(r),i.manager.itemError(e))},!1);void 0!==r&&a.addEventListener("progress",function(e){r(e)},!1);a.addEventListener("error",function(t){n&&n(t);i.manager.itemError(e)},!1);void 0!==this.responseType&&(a.responseType=this.responseType);void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials);a.send(null);i.manager.itemStart(e);return a},setPath:function(e){this.path=e},setResponseType:function(e){this.responseType=e},setWithCredentials:function(e){this.withCredentials=e}};THREE.FontLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.FontLoader.prototype={constructor:THREE.FontLoader,load:function(e,t,r,n){new THREE.XHRLoader(this.manager).load(e,function(e){t(new THREE.Font(JSON.parse(e.substring(65,e.length-2))))},r,n)}};THREE.ImageLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(e,t,r,n){void 0!==this.path&&(e=this.path+e);var i=this,o=THREE.Cache.get(e);if(void 0!==o)return i.manager.itemStart(e),t?setTimeout(function(){t(o);i.manager.itemEnd(e)},0):i.manager.itemEnd(e),o;var a=document.createElement("img");a.addEventListener("load",function(r){THREE.Cache.add(e,this);t&&t(this);i.manager.itemEnd(e)},!1);void 0!==r&&a.addEventListener("progress",function(e){r(e)},!1);a.addEventListener("error",function(t){n&&n(t);i.manager.itemError(e)},!1);void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin);i.manager.itemStart(e);a.src=e;return a},setCrossOrigin:function(e){this.crossOrigin=e},setPath:function(e){this.path=e}};THREE.JSONLoader=function(e){"boolean"===typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0);this.manager=void 0!==e?e:THREE.DefaultLoadingManager;this.withCredentials=!1};THREE.JSONLoader.prototype={constructor:THREE.JSONLoader,get statusDomElement(){void 0===this._statusDomElement&&(this._statusDomElement=document.createElement("div"));console.warn("THREE.JSONLoader: .statusDomElement has been removed.");return this._statusDomElement},load:function(e,t,r,n){var i=this,o=this.texturePath&&"string"===typeof this.texturePath?this.texturePath:THREE.Loader.prototype.extractUrlBase(e),a=new THREE.XHRLoader(this.manager);a.setWithCredentials(this.withCredentials);a.load(e,function(r){r=JSON.parse(r);var n=r.metadata;if(void 0!==n&&(n=n.type,void 0!==n)){if("object"===n.toLowerCase()){console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.");return}if("scene"===n.toLowerCase()){console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.SceneLoader instead.");return}}r=i.parse(r,o);t(r.geometry,r.materials)},r,n)},setTexturePath:function(e){this.texturePath=e},parse:function(e,t){var r=new THREE.Geometry,n=void 0!==e.scale?1/e.scale:1;(function(t){var n,i,o,a,s,c,u,l,h,f,p,d,m,E=e.faces;c=e.vertices;var g=e.normals,v=e.colors,y=0;if(void 0!==e.uvs){for(n=0;n<e.uvs.length;n++)e.uvs[n].length&&y++;for(n=0;n<y;n++)r.faceVertexUvs[n]=[]}a=0;for(s=c.length;a<s;)n=new THREE.Vector3,n.x=c[a++]*t,n.y=c[a++]*t,n.z=c[a++]*t,r.vertices.push(n);a=0;for(s=E.length;a<s;)if(t=E[a++],h=t&1,o=t&2,n=t&8,u=t&16,f=t&32,c=t&64,t&=128,h){h=new THREE.Face3;h.a=E[a];h.b=E[a+1];h.c=E[a+3];p=new THREE.Face3;p.a=E[a+1];p.b=E[a+2];p.c=E[a+3];a+=4;o&&(o=E[a++],h.materialIndex=o,p.materialIndex=o);o=r.faces.length;if(n)for(n=0;n<y;n++)for(d=e.uvs[n],r.faceVertexUvs[n][o]=[],r.faceVertexUvs[n][o+1]=[],i=0;4>i;i++)l=E[a++],m=d[2*l],l=d[2*l+1],m=new THREE.Vector2(m,l),2!==i&&r.faceVertexUvs[n][o].push(m),0!==i&&r.faceVertexUvs[n][o+1].push(m);u&&(u=3*E[a++],h.normal.set(g[u++],g[u++],g[u]),p.normal.copy(h.normal));if(f)for(n=0;4>n;n++)u=3*E[a++],f=new THREE.Vector3(g[u++],g[u++],g[u]),2!==n&&h.vertexNormals.push(f),0!==n&&p.vertexNormals.push(f);c&&(c=E[a++],c=v[c],h.color.setHex(c),p.color.setHex(c));if(t)for(n=0;4>n;n++)c=E[a++],c=v[c],2!==n&&h.vertexColors.push(new THREE.Color(c)),0!==n&&p.vertexColors.push(new THREE.Color(c));r.faces.push(h);r.faces.push(p)}else{h=new THREE.Face3;h.a=E[a++];h.b=E[a++];h.c=E[a++];o&&(o=E[a++],h.materialIndex=o);o=r.faces.length;if(n)for(n=0;n<y;n++)for(d=e.uvs[n],r.faceVertexUvs[n][o]=[],i=0;3>i;i++)l=E[a++],m=d[2*l],l=d[2*l+1],m=new THREE.Vector2(m,l),r.faceVertexUvs[n][o].push(m);u&&(u=3*E[a++],h.normal.set(g[u++],g[u++],g[u]));if(f)for(n=0;3>n;n++)u=3*E[a++],f=new THREE.Vector3(g[u++],g[u++],g[u]),h.vertexNormals.push(f);c&&(c=E[a++],h.color.setHex(v[c]));if(t)for(n=0;3>n;n++)c=E[a++],h.vertexColors.push(new THREE.Color(v[c]));r.faces.push(h)}})(n);(function(){var t=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var n=0,i=e.skinWeights.length;n<i;n+=t)r.skinWeights.push(new THREE.Vector4(e.skinWeights[n],1<t?e.skinWeights[n+1]:0,2<t?e.skinWeights[n+2]:0,3<t?e.skinWeights[n+3]:0));if(e.skinIndices)for(n=0,i=e.skinIndices.length;n<i;n+=t)r.skinIndices.push(new THREE.Vector4(e.skinIndices[n],1<t?e.skinIndices[n+1]:0,2<t?e.skinIndices[n+2]:0,3<t?e.skinIndices[n+3]:0));r.bones=e.bones;r.bones&&0<r.bones.length&&(r.skinWeights.length!==r.skinIndices.length||r.skinIndices.length!==r.vertices.length)&&console.warn("When skinning, number of vertices ("+r.vertices.length+"), skinIndices ("+r.skinIndices.length+"), and skinWeights ("+r.skinWeights.length+") should match.")})();(function(t){if(void 0!==e.morphTargets)for(var n=0,i=e.morphTargets.length;n<i;n++){r.morphTargets[n]={};r.morphTargets[n].name=e.morphTargets[n].name;r.morphTargets[n].vertices=[];for(var o=r.morphTargets[n].vertices,a=e.morphTargets[n].vertices,s=0,c=a.length;s<c;s+=3){var u=new THREE.Vector3;u.x=a[s]*t;u.y=a[s+1]*t;u.z=a[s+2]*t;o.push(u)}}if(void 0!==e.morphColors&&0<e.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),t=r.faces,o=e.morphColors[0].colors,n=0,i=t.length;n<i;n++)t[n].color.fromArray(o,3*n)})(n);(function(){var t=[],n=[];void 0!==e.animation&&n.push(e.animation);void 0!==e.animations&&(e.animations.length?n=n.concat(e.animations):n.push(e.animations));for(var i=0;i<n.length;i++){var o=THREE.AnimationClip.parseAnimation(n[i],r.bones);o&&t.push(o)}r.morphTargets&&(n=THREE.AnimationClip.CreateClipsFromMorphTargetSequences(r.morphTargets,10),t=t.concat(n));0<t.length&&(r.animations=t)})();r.computeFaceNormals();r.computeBoundingSphere();if(void 0===e.materials||0===e.materials.length)return{geometry:r};n=THREE.Loader.prototype.initMaterials(e.materials,t,this.crossOrigin);return{geometry:r,materials:n}}};THREE.LoadingManager=function(e,t,r){var n=this,i=!1,o=0,a=0;this.onStart=void 0;this.onLoad=e;this.onProgress=t;this.onError=r;this.itemStart=function(e){a++;if(!1===i&&void 0!==n.onStart)n.onStart(e,o,a);i=!0};this.itemEnd=function(e){o++;if(void 0!==n.onProgress)n.onProgress(e,o,a);if(o===a&&(i=!1,void 0!==n.onLoad))n.onLoad()};this.itemError=function(e){if(void 0!==n.onError)n.onError(e)}};THREE.DefaultLoadingManager=new THREE.LoadingManager;THREE.BufferGeometryLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(e,t,r,n){var i=this;new THREE.XHRLoader(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){var t=new THREE.BufferGeometry,r=e.data.index,n={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};void 0!==r&&(r=new n[r.type](r.array),t.setIndex(new THREE.BufferAttribute(r,1)));var i=e.data.attributes,o;for(o in i){var a=i[o],r=new n[a.type](a.array);t.addAttribute(o,new THREE.BufferAttribute(r,a.itemSize))}n=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==n)for(o=0,r=n.length;o!==r;++o)i=n[o],t.addGroup(i.start,i.count,i.materialIndex);e=e.data.boundingSphere;void 0!==e&&(n=new THREE.Vector3,void 0!==e.center&&n.fromArray(e.center),t.boundingSphere=new THREE.Sphere(n,e.radius));return t}};THREE.MaterialLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager;this.textures={}};THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(e,t,r,n){var i=this;new THREE.XHRLoader(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},setTextures:function(e){this.textures=e},getTexture:function(e){var t=this.textures;void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e);return t[e]},parse:function(e){var t=new THREE[e.type];void 0!==e.uuid&&(t.uuid=e.uuid);void 0!==e.name&&(t.name=e.name);void 0!==e.color&&t.color.setHex(e.color);void 0!==e.roughness&&(t.roughness=e.roughness);void 0!==e.metalness&&(t.metalness=e.metalness);void 0!==e.emissive&&t.emissive.setHex(e.emissive);void 0!==e.specular&&t.specular.setHex(e.specular);void 0!==e.shininess&&(t.shininess=e.shininess);void 0!==e.uniforms&&(t.uniforms=e.uniforms);void 0!==e.vertexShader&&(t.vertexShader=e.vertexShader);void 0!==e.fragmentShader&&(t.fragmentShader=e.fragmentShader);void 0!==e.vertexColors&&(t.vertexColors=e.vertexColors);void 0!==e.shading&&(t.shading=e.shading);
void 0!==e.blending&&(t.blending=e.blending);void 0!==e.side&&(t.side=e.side);void 0!==e.opacity&&(t.opacity=e.opacity);void 0!==e.transparent&&(t.transparent=e.transparent);void 0!==e.alphaTest&&(t.alphaTest=e.alphaTest);void 0!==e.depthTest&&(t.depthTest=e.depthTest);void 0!==e.depthWrite&&(t.depthWrite=e.depthWrite);void 0!==e.colorWrite&&(t.colorWrite=e.colorWrite);void 0!==e.wireframe&&(t.wireframe=e.wireframe);void 0!==e.wireframeLinewidth&&(t.wireframeLinewidth=e.wireframeLinewidth);void 0!==e.size&&(t.size=e.size);void 0!==e.sizeAttenuation&&(t.sizeAttenuation=e.sizeAttenuation);void 0!==e.map&&(t.map=this.getTexture(e.map));void 0!==e.alphaMap&&(t.alphaMap=this.getTexture(e.alphaMap),t.transparent=!0);void 0!==e.bumpMap&&(t.bumpMap=this.getTexture(e.bumpMap));void 0!==e.bumpScale&&(t.bumpScale=e.bumpScale);void 0!==e.normalMap&&(t.normalMap=this.getTexture(e.normalMap));if(void 0!==e.normalScale){var r=e.normalScale;!1===Array.isArray(r)&&(r=[r,r]);t.normalScale=(new THREE.Vector2).fromArray(r)}void 0!==e.displacementMap&&(t.displacementMap=this.getTexture(e.displacementMap));void 0!==e.displacementScale&&(t.displacementScale=e.displacementScale);void 0!==e.displacementBias&&(t.displacementBias=e.displacementBias);void 0!==e.roughnessMap&&(t.roughnessMap=this.getTexture(e.roughnessMap));void 0!==e.metalnessMap&&(t.metalnessMap=this.getTexture(e.metalnessMap));void 0!==e.emissiveMap&&(t.emissiveMap=this.getTexture(e.emissiveMap));void 0!==e.emissiveIntensity&&(t.emissiveIntensity=e.emissiveIntensity);void 0!==e.specularMap&&(t.specularMap=this.getTexture(e.specularMap));void 0!==e.envMap&&(t.envMap=this.getTexture(e.envMap),t.combine=THREE.MultiplyOperation);e.reflectivity&&(t.reflectivity=e.reflectivity);void 0!==e.lightMap&&(t.lightMap=this.getTexture(e.lightMap));void 0!==e.lightMapIntensity&&(t.lightMapIntensity=e.lightMapIntensity);void 0!==e.aoMap&&(t.aoMap=this.getTexture(e.aoMap));void 0!==e.aoMapIntensity&&(t.aoMapIntensity=e.aoMapIntensity);if(void 0!==e.materials)for(var r=0,n=e.materials.length;r<n;r++)t.materials.push(this.parse(e.materials[r]));return t}};THREE.ObjectLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager;this.texturePath=""};THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(e,t,r,n){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var i=this;new THREE.XHRLoader(i.manager).load(e,function(e){i.parse(JSON.parse(e),t)},r,n)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var r=this.parseGeometries(e.geometries),n=this.parseImages(e.images,function(){void 0!==t&&t(i)}),n=this.parseTextures(e.textures,n),n=this.parseMaterials(e.materials,n),i=this.parseObject(e.object,r,n);e.animations&&(i.animations=this.parseAnimations(e.animations));void 0!==e.images&&0!==e.images.length||void 0===t||t(i);return i},parseGeometries:function(e){var t={};if(void 0!==e)for(var r=new THREE.JSONLoader,n=new THREE.BufferGeometryLoader,i=0,o=e.length;i<o;i++){var a,s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new THREE[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"CubeGeometry":a=new THREE.BoxGeometry(s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleBufferGeometry":a=new THREE.CircleBufferGeometry(s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CircleGeometry":a=new THREE.CircleGeometry(s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":a=new THREE.CylinderGeometry(s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":a=new THREE.SphereGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"SphereBufferGeometry":a=new THREE.SphereBufferGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":a=new THREE.DodecahedronGeometry(s.radius,s.detail);break;case"IcosahedronGeometry":a=new THREE.IcosahedronGeometry(s.radius,s.detail);break;case"OctahedronGeometry":a=new THREE.OctahedronGeometry(s.radius,s.detail);break;case"TetrahedronGeometry":a=new THREE.TetrahedronGeometry(s.radius,s.detail);break;case"RingGeometry":a=new THREE.RingGeometry(s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":a=new THREE.TorusGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":a=new THREE.TorusKnotGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.p,s.q,s.heightScale);break;case"LatheGeometry":a=new THREE.LatheGeometry(s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":a=n.parse(s);break;case"Geometry":a=r.parse(s.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid;void 0!==s.name&&(a.name=s.name);t[s.uuid]=a}return t},parseMaterials:function(e,t){var r={};if(void 0!==e){var n=new THREE.MaterialLoader;n.setTextures(t);for(var i=0,o=e.length;i<o;i++){var a=n.parse(e[i]);r[a.uuid]=a}}return r},parseAnimations:function(e){for(var t=[],r=0;r<e.length;r++){var n=THREE.AnimationClip.parse(e[r]);t.push(n)}return t},parseImages:function(e,t){function r(e){n.manager.itemStart(e);return a.load(e,function(){n.manager.itemEnd(e)})}var n=this,i={};if(void 0!==e&&0<e.length){var o=new THREE.LoadingManager(t),a=new THREE.ImageLoader(o);a.setCrossOrigin(this.crossOrigin);for(var o=0,s=e.length;o<s;o++){var c=e[o],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.texturePath+c.url;i[c.uuid]=r(u)}}return i},parseTextures:function(e,t){function r(e){if("number"===typeof e)return e;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e);return THREE[e]}var n={};if(void 0!==e)for(var i=0,o=e.length;i<o;i++){var a=e[i];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid);void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new THREE.Texture(t[a.image]);s.needsUpdate=!0;s.uuid=a.uuid;void 0!==a.name&&(s.name=a.name);void 0!==a.mapping&&(s.mapping=r(a.mapping));void 0!==a.offset&&(s.offset=new THREE.Vector2(a.offset[0],a.offset[1]));void 0!==a.repeat&&(s.repeat=new THREE.Vector2(a.repeat[0],a.repeat[1]));void 0!==a.minFilter&&(s.minFilter=r(a.minFilter));void 0!==a.magFilter&&(s.magFilter=r(a.magFilter));void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy);Array.isArray(a.wrap)&&(s.wrapS=r(a.wrap[0]),s.wrapT=r(a.wrap[1]));n[a.uuid]=s}return n},parseObject:function(){var e=new THREE.Matrix4;return function(t,r,n){function i(e){void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e);return r[e]}function o(e){if(void 0!==e)return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}var a;switch(t.type){case"Scene":a=new THREE.Scene;break;case"PerspectiveCamera":a=new THREE.PerspectiveCamera(t.fov,t.aspect,t.near,t.far);break;case"OrthographicCamera":a=new THREE.OrthographicCamera(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":a=new THREE.AmbientLight(t.color,t.intensity);break;case"DirectionalLight":a=new THREE.DirectionalLight(t.color,t.intensity);break;case"PointLight":a=new THREE.PointLight(t.color,t.intensity,t.distance,t.decay);break;case"SpotLight":a=new THREE.SpotLight(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":a=new THREE.HemisphereLight(t.color,t.groundColor,t.intensity);break;case"Mesh":a=i(t.geometry);var s=o(t.material);a=a.bones&&0<a.bones.length?new THREE.SkinnedMesh(a,s):new THREE.Mesh(a,s);break;case"LOD":a=new THREE.LOD;break;case"Line":a=new THREE.Line(i(t.geometry),o(t.material),t.mode);break;case"PointCloud":case"Points":a=new THREE.Points(i(t.geometry),o(t.material));break;case"Sprite":a=new THREE.Sprite(o(t.material));break;case"Group":a=new THREE.Group;break;default:a=new THREE.Object3D}a.uuid=t.uuid;void 0!==t.name&&(a.name=t.name);void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(a.position,a.quaternion,a.scale)):(void 0!==t.position&&a.position.fromArray(t.position),void 0!==t.rotation&&a.rotation.fromArray(t.rotation),void 0!==t.scale&&a.scale.fromArray(t.scale));void 0!==t.castShadow&&(a.castShadow=t.castShadow);void 0!==t.receiveShadow&&(a.receiveShadow=t.receiveShadow);void 0!==t.visible&&(a.visible=t.visible);void 0!==t.userData&&(a.userData=t.userData);if(void 0!==t.children)for(var c in t.children)a.add(this.parseObject(t.children[c],r,n));if("LOD"===t.type)for(t=t.levels,s=0;s<t.length;s++){var u=t[s];c=a.getObjectByProperty("uuid",u.object);void 0!==c&&a.addLevel(c,u.distance)}return a}}()};THREE.TextureLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(e,t,r,n){var i=new THREE.Texture,o=new THREE.ImageLoader(this.manager);o.setCrossOrigin(this.crossOrigin);o.setPath(this.path);o.load(e,function(e){i.image=e;i.needsUpdate=!0;void 0!==t&&t(i)},r,n);return i},setCrossOrigin:function(e){this.crossOrigin=e},setPath:function(e){this.path=e}};THREE.CubeTextureLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager};THREE.CubeTextureLoader.prototype={constructor:THREE.CubeTextureLoader,load:function(e,t,r,n){function i(r){a.load(e[r],function(e){o.images[r]=e;s++;6===s&&(o.needsUpdate=!0,t&&t(o))},void 0,n)}var o=new THREE.CubeTexture([]),a=new THREE.ImageLoader(this.manager);a.setCrossOrigin(this.crossOrigin);a.setPath(this.path);var s=0;for(r=0;r<e.length;++r)i(r);return o},setCrossOrigin:function(e){this.crossOrigin=e},setPath:function(e){this.path=e}};THREE.DataTextureLoader=THREE.BinaryTextureLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager;this._parser=null};THREE.BinaryTextureLoader.prototype={constructor:THREE.BinaryTextureLoader,load:function(e,t,r,n){var i=this,o=new THREE.DataTexture,a=new THREE.XHRLoader(this.manager);a.setResponseType("arraybuffer");a.load(e,function(e){if(e=i._parser(e))void 0!==e.image?o.image=e.image:void 0!==e.data&&(o.image.width=e.width,o.image.height=e.height,o.image.data=e.data),o.wrapS=void 0!==e.wrapS?e.wrapS:THREE.ClampToEdgeWrapping,o.wrapT=void 0!==e.wrapT?e.wrapT:THREE.ClampToEdgeWrapping,o.magFilter=void 0!==e.magFilter?e.magFilter:THREE.LinearFilter,o.minFilter=void 0!==e.minFilter?e.minFilter:THREE.LinearMipMapLinearFilter,o.anisotropy=void 0!==e.anisotropy?e.anisotropy:1,void 0!==e.format&&(o.format=e.format),void 0!==e.type&&(o.type=e.type),void 0!==e.mipmaps&&(o.mipmaps=e.mipmaps),1===e.mipmapCount&&(o.minFilter=THREE.LinearFilter),o.needsUpdate=!0,t&&t(o,e)},r,n);return o}};THREE.CompressedTextureLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager;this._parser=null};THREE.CompressedTextureLoader.prototype={constructor:THREE.CompressedTextureLoader,load:function(e,t,r,n){function i(i){c.load(e[i],function(e){e=o._parser(e,!0);a[i]={width:e.width,height:e.height,format:e.format,mipmaps:e.mipmaps};u+=1;6===u&&(1===e.mipmapCount&&(s.minFilter=THREE.LinearFilter),s.format=e.format,s.needsUpdate=!0,t&&t(s))},r,n)}var o=this,a=[],s=new THREE.CompressedTexture;s.image=a;var c=new THREE.XHRLoader(this.manager);c.setPath(this.path);c.setResponseType("arraybuffer");if(Array.isArray(e))for(var u=0,l=0,h=e.length;l<h;++l)i(l);else c.load(e,function(e){e=o._parser(e,!0);if(e.isCubemap)for(var r=e.mipmaps.length/e.mipmapCount,n=0;n<r;n++){a[n]={mipmaps:[]};for(var i=0;i<e.mipmapCount;i++)a[n].mipmaps.push(e.mipmaps[n*e.mipmapCount+i]),a[n].format=e.format,a[n].width=e.width,a[n].height=e.height}else s.image.width=e.width,s.image.height=e.height,s.mipmaps=e.mipmaps;1===e.mipmapCount&&(s.minFilter=THREE.LinearFilter);s.format=e.format;s.needsUpdate=!0;t&&t(s)},r,n);return s},setPath:function(e){this.path=e}};THREE.Material=function(){Object.defineProperty(this,"id",{value:THREE.MaterialIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Material";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.depthFunc=THREE.LessEqualDepth;this.colorWrite=this.depthWrite=this.depthTest=!0;this.precision=null;this.polygonOffset=!1;this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this._needsUpdate=this.visible=!0};THREE.Material.prototype={constructor:THREE.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){!0===e&&this.update();this._needsUpdate=e},setValues:function(e){if(void 0!==e)for(var t in e){var r=e[t];if(void 0===r)console.warn("THREE.Material: '"+t+"' parameter is undefined.");else{var n=this[t];void 0===n?console.warn("THREE."+this.type+": '"+t+"' is not a property of this material."):n instanceof THREE.Color?n.set(r):n instanceof THREE.Vector3&&r instanceof THREE.Vector3?n.copy(r):this[t]="overdraw"===t?Number(r):r}}},toJSON:function(e){function t(e){var t=[],r;for(r in e){var n=e[r];delete n.metadata;t.push(n)}return t}var r=void 0===e;r&&(e={textures:{},images:{}});var n={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid;n.type=this.type;""!==this.name&&(n.name=this.name);this.color instanceof THREE.Color&&(n.color=this.color.getHex());.5!==this.roughness&&(n.roughness=this.roughness);.5!==this.metalness&&(n.metalness=this.metalness);this.emissive instanceof THREE.Color&&(n.emissive=this.emissive.getHex());this.specular instanceof THREE.Color&&(n.specular=this.specular.getHex());void 0!==this.shininess&&(n.shininess=this.shininess);this.map instanceof THREE.Texture&&(n.map=this.map.toJSON(e).uuid);this.alphaMap instanceof THREE.Texture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid);this.lightMap instanceof THREE.Texture&&(n.lightMap=this.lightMap.toJSON(e).uuid);this.bumpMap instanceof THREE.Texture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale);this.normalMap instanceof THREE.Texture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalScale=this.normalScale.toArray());this.displacementMap instanceof THREE.Texture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias);this.roughnessMap instanceof THREE.Texture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid);this.metalnessMap instanceof THREE.Texture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid);this.emissiveMap instanceof THREE.Texture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid);this.specularMap instanceof THREE.Texture&&(n.specularMap=this.specularMap.toJSON(e).uuid);this.envMap instanceof THREE.Texture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity);void 0!==this.size&&(n.size=this.size);void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation);void 0!==this.vertexColors&&this.vertexColors!==THREE.NoColors&&(n.vertexColors=this.vertexColors);void 0!==this.shading&&this.shading!==THREE.SmoothShading&&(n.shading=this.shading);void 0!==this.blending&&this.blending!==THREE.NormalBlending&&(n.blending=this.blending);void 0!==this.side&&this.side!==THREE.FrontSide&&(n.side=this.side);1>this.opacity&&(n.opacity=this.opacity);!0===this.transparent&&(n.transparent=this.transparent);0<this.alphaTest&&(n.alphaTest=this.alphaTest);!0===this.wireframe&&(n.wireframe=this.wireframe);1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth);r&&(r=t(e.textures),e=t(e.images),0<r.length&&(n.textures=r),0<e.length&&(n.images=e));return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name;this.side=e.side;this.opacity=e.opacity;this.transparent=e.transparent;this.blending=e.blending;this.blendSrc=e.blendSrc;this.blendDst=e.blendDst;this.blendEquation=e.blendEquation;this.blendSrcAlpha=e.blendSrcAlpha;this.blendDstAlpha=e.blendDstAlpha;this.blendEquationAlpha=e.blendEquationAlpha;this.depthFunc=e.depthFunc;this.depthTest=e.depthTest;this.depthWrite=e.depthWrite;this.colorWrite=e.colorWrite;this.precision=e.precision;this.polygonOffset=e.polygonOffset;this.polygonOffsetFactor=e.polygonOffsetFactor;this.polygonOffsetUnits=e.polygonOffsetUnits;this.alphaTest=e.alphaTest;this.overdraw=e.overdraw;this.visible=e.visible;return this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Material.prototype);THREE.MaterialIdCount=0;THREE.LineBasicMaterial=function(e){THREE.Material.call(this);this.type="LineBasicMaterial";this.color=new THREE.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=THREE.NoColors;this.fog=!0;this.setValues(e)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial;THREE.LineBasicMaterial.prototype.copy=function(e){THREE.Material.prototype.copy.call(this,e);this.color.copy(e.color);this.linewidth=e.linewidth;this.linecap=e.linecap;this.linejoin=e.linejoin;this.vertexColors=e.vertexColors;this.fog=e.fog;return this};THREE.LineDashedMaterial=function(e){THREE.Material.call(this);this.type="LineDashedMaterial";this.color=new THREE.Color(16777215);this.scale=this.linewidth=1;this.dashSize=3;this.gapSize=1;this.vertexColors=THREE.NoColors;this.fog=!0;this.setValues(e)};THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.constructor=THREE.LineDashedMaterial;THREE.LineDashedMaterial.prototype.copy=function(e){THREE.Material.prototype.copy.call(this,e);this.color.copy(e.color);this.linewidth=e.linewidth;this.scale=e.scale;this.dashSize=e.dashSize;this.gapSize=e.gapSize;this.vertexColors=e.vertexColors;this.fog=e.fog;return this};THREE.MeshBasicMaterial=function(e){THREE.Material.call(this);this.type="MeshBasicMaterial";this.color=new THREE.Color(16777215);this.aoMap=this.map=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphTargets=this.skinning=!1;this.setValues(e)};THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial;THREE.MeshBasicMaterial.prototype.copy=function(e){THREE.Material.prototype.copy.call(this,e);this.color.copy(e.color);this.map=e.map;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.specularMap=e.specularMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.combine=e.combine;this.reflectivity=e.reflectivity;this.refractionRatio=e.refractionRatio;this.fog=e.fog;this.shading=e.shading;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.vertexColors=e.vertexColors;this.skinning=e.skinning;this.morphTargets=e.morphTargets;return this};THREE.MeshLambertMaterial=function(e){THREE.Material.call(this);this.type="MeshLambertMaterial";this.color=new THREE.Color(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new THREE.Color(0);this.emissiveIntensity=1;this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(e)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial;THREE.MeshLambertMaterial.prototype.copy=function(e){THREE.Material.prototype.copy.call(this,e);this.color.copy(e.color);this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.emissive.copy(e.emissive);this.emissiveMap=e.emissiveMap;this.emissiveIntensity=e.emissiveIntensity;this.specularMap=e.specularMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.combine=e.combine;this.reflectivity=e.reflectivity;this.refractionRatio=e.refractionRatio;this.fog=e.fog;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.vertexColors=e.vertexColors;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;return this};THREE.MeshPhongMaterial=function(e){THREE.Material.call(this);this.type="MeshPhongMaterial";this.color=new THREE.Color(16777215);this.specular=new THREE.Color(1118481);this.shininess=30;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new THREE.Color(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(e)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial;THREE.MeshPhongMaterial.prototype.copy=function(e){THREE.Material.prototype.copy.call(this,e);this.color.copy(e.color);this.specular.copy(e.specular);this.shininess=e.shininess;this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.emissive.copy(e.emissive);this.emissiveMap=e.emissiveMap;this.emissiveIntensity=e.emissiveIntensity;this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.specularMap=e.specularMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.combine=e.combine;this.reflectivity=e.reflectivity;this.refractionRatio=e.refractionRatio;this.fog=e.fog;this.shading=e.shading;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.vertexColors=e.vertexColors;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;return this};THREE.MeshStandardMaterial=function(e){THREE.Material.call(this);this.type="MeshStandardMaterial";this.color=new THREE.Color(16777215);this.metalness=this.roughness=.5;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new THREE.Color(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null;this.envMapIntensity=1;this.refractionRatio=.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(e)};THREE.MeshStandardMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshStandardMaterial.prototype.constructor=THREE.MeshStandardMaterial;THREE.MeshStandardMaterial.prototype.copy=function(e){THREE.Material.prototype.copy.call(this,e);this.color.copy(e.color);this.roughness=e.roughness;this.metalness=e.metalness;this.map=e.map;this.lightMap=e.lightMap;this.lightMapIntensity=e.lightMapIntensity;this.aoMap=e.aoMap;this.aoMapIntensity=e.aoMapIntensity;this.emissive.copy(e.emissive);this.emissiveMap=e.emissiveMap;this.emissiveIntensity=e.emissiveIntensity;this.bumpMap=e.bumpMap;this.bumpScale=e.bumpScale;this.normalMap=e.normalMap;this.normalScale.copy(e.normalScale);this.displacementMap=e.displacementMap;this.displacementScale=e.displacementScale;this.displacementBias=e.displacementBias;this.roughnessMap=e.roughnessMap;this.metalnessMap=e.metalnessMap;this.alphaMap=e.alphaMap;this.envMap=e.envMap;this.envMapIntensity=e.envMapIntensity;this.refractionRatio=e.refractionRatio;this.fog=e.fog;this.shading=e.shading;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.wireframeLinecap=e.wireframeLinecap;this.wireframeLinejoin=e.wireframeLinejoin;this.vertexColors=e.vertexColors;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;return this};THREE.MeshDepthMaterial=function(e){THREE.Material.call(this);this.type="MeshDepthMaterial";this.wireframe=this.morphTargets=!1;this.wireframeLinewidth=1;this.setValues(e)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial;THREE.MeshDepthMaterial.prototype.copy=function(e){THREE.Material.prototype.copy.call(this,e);this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;return this};THREE.MeshNormalMaterial=function(e){THREE.Material.call(this,e);this.type="MeshNormalMaterial";this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(e)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial;THREE.MeshNormalMaterial.prototype.copy=function(e){THREE.Material.prototype.copy.call(this,e);this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;return this};THREE.MultiMaterial=function(e){this.uuid=THREE.Math.generateUUID();this.type="MultiMaterial";this.materials=e instanceof Array?e:[];this.visible=!0};THREE.MultiMaterial.prototype={constructor:THREE.MultiMaterial,toJSON:function(e){for(var t={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},r=this.materials,n=0,i=r.length;n<i;n++){var o=r[n].toJSON(e);delete o.metadata;t.materials.push(o)}t.visible=this.visible;return t},clone:function(){for(var e=new this.constructor,t=0;t<this.materials.length;t++)e.materials.push(this.materials[t].clone());e.visible=this.visible;return e}};THREE.PointsMaterial=function(e){THREE.Material.call(this);this.type="PointsMaterial";this.color=new THREE.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=!0;this.vertexColors=THREE.NoColors;this.fog=!0;this.setValues(e)};THREE.PointsMaterial.prototype=Object.create(THREE.Material.prototype);THREE.PointsMaterial.prototype.constructor=THREE.PointsMaterial;THREE.PointsMaterial.prototype.copy=function(e){THREE.Material.prototype.copy.call(this,e);this.color.copy(e.color);this.map=e.map;this.size=e.size;this.sizeAttenuation=e.sizeAttenuation;this.vertexColors=e.vertexColors;this.fog=e.fog;return this};THREE.ShaderMaterial=function(e){THREE.Material.call(this);this.type="ShaderMaterial";this.defines={};this.uniforms={};this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.shading=THREE.SmoothShading;this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))};THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ShaderMaterial.prototype.constructor=THREE.ShaderMaterial;THREE.ShaderMaterial.prototype.copy=function(e){THREE.Material.prototype.copy.call(this,e);this.fragmentShader=e.fragmentShader;this.vertexShader=e.vertexShader;this.uniforms=THREE.UniformsUtils.clone(e.uniforms);this.defines=e.defines;this.shading=e.shading;this.wireframe=e.wireframe;this.wireframeLinewidth=e.wireframeLinewidth;this.fog=e.fog;this.lights=e.lights;this.vertexColors=e.vertexColors;this.skinning=e.skinning;this.morphTargets=e.morphTargets;this.morphNormals=e.morphNormals;this.extensions=e.extensions;return this};THREE.ShaderMaterial.prototype.toJSON=function(e){e=THREE.Material.prototype.toJSON.call(this,e);e.uniforms=this.uniforms;e.vertexShader=this.vertexShader;e.fragmentShader=this.fragmentShader;return e};THREE.RawShaderMaterial=function(e){THREE.ShaderMaterial.call(this,e);this.type="RawShaderMaterial"};THREE.RawShaderMaterial.prototype=Object.create(THREE.ShaderMaterial.prototype);THREE.RawShaderMaterial.prototype.constructor=THREE.RawShaderMaterial;THREE.SpriteMaterial=function(e){THREE.Material.call(this);this.type="SpriteMaterial";this.color=new THREE.Color(16777215);this.map=null;this.rotation=0;this.fog=!1;this.setValues(e)};THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype);THREE.SpriteMaterial.prototype.constructor=THREE.SpriteMaterial;THREE.SpriteMaterial.prototype.copy=function(e){THREE.Material.prototype.copy.call(this,e);this.color.copy(e.color);this.map=e.map;this.rotation=e.rotation;this.fog=e.fog;return this};THREE.Texture=function(e,t,r,n,i,o,a,s,c){Object.defineProperty(this,"id",{value:THREE.TextureIdCount++});this.uuid=THREE.Math.generateUUID();this.sourceFile=this.name="";this.image=void 0!==e?e:THREE.Texture.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==t?t:THREE.Texture.DEFAULT_MAPPING;this.wrapS=void 0!==r?r:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==n?n:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==i?i:THREE.LinearFilter;this.minFilter=void 0!==o?o:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==c?c:1;this.format=void 0!==a?a:THREE.RGBAFormat;this.type=void 0!==s?s:THREE.UnsignedByteType;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.version=0;this.onUpdate=null};THREE.Texture.DEFAULT_IMAGE=void 0;THREE.Texture.DEFAULT_MAPPING=THREE.UVMapping;THREE.Texture.prototype={constructor:THREE.Texture,set needsUpdate(e){!0===e&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.image=e.image;this.mipmaps=e.mipmaps.slice(0);this.mapping=e.mapping;this.wrapS=e.wrapS;this.wrapT=e.wrapT;this.magFilter=e.magFilter;this.minFilter=e.minFilter;this.anisotropy=e.anisotropy;this.format=e.format;this.type=e.type;this.offset.copy(e.offset);this.repeat.copy(e.repeat);this.generateMipmaps=e.generateMipmaps;this.premultiplyAlpha=e.premultiplyAlpha;this.flipY=e.flipY;this.unpackAlignment=e.unpackAlignment;return this},toJSON:function(e){if(void 0!==e.textures[this.uuid])return e.textures[this.uuid];var t={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],
offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var r=this.image;void 0===r.uuid&&(r.uuid=THREE.Math.generateUUID());if(void 0===e.images[r.uuid]){var n=e.images,i=r.uuid,o=r.uuid,a;void 0!==r.toDataURL?a=r:(a=document.createElement("canvas"),a.width=r.width,a.height=r.height,a.getContext("2d").drawImage(r,0,0,r.width,r.height));a=2048<a.width||2048<a.height?a.toDataURL("image/jpeg",.6):a.toDataURL("image/png");n[i]={uuid:o,url:a}}t.image=r.uuid}return e.textures[this.uuid]=t},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping===THREE.UVMapping){e.multiply(this.repeat);e.add(this.offset);if(0>e.x||1<e.x)switch(this.wrapS){case THREE.RepeatWrapping:e.x-=Math.floor(e.x);break;case THREE.ClampToEdgeWrapping:e.x=0>e.x?0:1;break;case THREE.MirroredRepeatWrapping:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x-=Math.floor(e.x)}if(0>e.y||1<e.y)switch(this.wrapT){case THREE.RepeatWrapping:e.y-=Math.floor(e.y);break;case THREE.ClampToEdgeWrapping:e.y=0>e.y?0:1;break;case THREE.MirroredRepeatWrapping:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y-=Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}};THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);THREE.TextureIdCount=0;THREE.CanvasTexture=function(e,t,r,n,i,o,a,s,c){THREE.Texture.call(this,e,t,r,n,i,o,a,s,c);this.needsUpdate=!0};THREE.CanvasTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CanvasTexture.prototype.constructor=THREE.CanvasTexture;THREE.CubeTexture=function(e,t,r,n,i,o,a,s,c){t=void 0!==t?t:THREE.CubeReflectionMapping;THREE.Texture.call(this,e,t,r,n,i,o,a,s,c);this.images=e;this.flipY=!1};THREE.CubeTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CubeTexture.prototype.constructor=THREE.CubeTexture;THREE.CubeTexture.prototype.copy=function(e){THREE.Texture.prototype.copy.call(this,e);this.images=e.images;return this};THREE.CompressedTexture=function(e,t,r,n,i,o,a,s,c,u,l){THREE.Texture.call(this,null,o,a,s,c,u,n,i,l);this.image={width:t,height:r};this.mipmaps=e;this.generateMipmaps=this.flipY=!1};THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CompressedTexture.prototype.constructor=THREE.CompressedTexture;THREE.DataTexture=function(e,t,r,n,i,o,a,s,c,u,l){THREE.Texture.call(this,null,o,a,s,c,u,n,i,l);this.image={data:e,width:t,height:r};this.magFilter=void 0!==c?c:THREE.NearestFilter;this.minFilter=void 0!==u?u:THREE.NearestFilter;this.generateMipmaps=this.flipY=!1};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DataTexture.prototype.constructor=THREE.DataTexture;THREE.VideoTexture=function(e,t,r,n,i,o,a,s,c){function u(){requestAnimationFrame(u);e.readyState===e.HAVE_ENOUGH_DATA&&(l.needsUpdate=!0)}THREE.Texture.call(this,e,t,r,n,i,o,a,s,c);this.generateMipmaps=!1;var l=this;u()};THREE.VideoTexture.prototype=Object.create(THREE.Texture.prototype);THREE.VideoTexture.prototype.constructor=THREE.VideoTexture;THREE.Group=function(){THREE.Object3D.call(this);this.type="Group"};THREE.Group.prototype=Object.create(THREE.Object3D.prototype);THREE.Group.prototype.constructor=THREE.Group;THREE.Points=function(e,t){THREE.Object3D.call(this);this.type="Points";this.geometry=void 0!==e?e:new THREE.Geometry;this.material=void 0!==t?t:new THREE.PointsMaterial({color:16777215*Math.random()})};THREE.Points.prototype=Object.create(THREE.Object3D.prototype);THREE.Points.prototype.constructor=THREE.Points;THREE.Points.prototype.raycast=function(){var e=new THREE.Matrix4,t=new THREE.Ray,r=new THREE.Sphere;return function(n,i){function o(e,r){var o=t.distanceSqToPoint(e);if(o<l){var s=t.closestPointToPoint(e);s.applyMatrix4(c);var u=n.ray.origin.distanceTo(s);u<n.near||u>n.far||i.push({distance:u,distanceToRay:Math.sqrt(o),point:s.clone(),index:r,face:null,object:a})}}var a=this,s=this.geometry,c=this.matrixWorld,u=n.params.Points.threshold;null===s.boundingSphere&&s.computeBoundingSphere();r.copy(s.boundingSphere);r.applyMatrix4(c);if(!1!==n.ray.intersectsSphere(r)){e.getInverse(c);t.copy(n.ray).applyMatrix4(e);var u=u/((this.scale.x+this.scale.y+this.scale.z)/3),l=u*u,u=new THREE.Vector3;if(s instanceof THREE.BufferGeometry){var h=s.index,s=s.attributes.position.array;if(null!==h)for(var f=h.array,h=0,p=f.length;h<p;h++){var d=f[h];u.fromArray(s,3*d);o(u,d)}else for(h=0,f=s.length/3;h<f;h++)u.fromArray(s,3*h),o(u,h)}else for(u=s.vertices,h=0,f=u.length;h<f;h++)o(u[h],h)}}}();THREE.Points.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)};THREE.Line=function(e,t,r){if(1===r)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new THREE.LineSegments(e,t);THREE.Object3D.call(this);this.type="Line";this.geometry=void 0!==e?e:new THREE.Geometry;this.material=void 0!==t?t:new THREE.LineBasicMaterial({color:16777215*Math.random()})};THREE.Line.prototype=Object.create(THREE.Object3D.prototype);THREE.Line.prototype.constructor=THREE.Line;THREE.Line.prototype.raycast=function(){var e=new THREE.Matrix4,t=new THREE.Ray,r=new THREE.Sphere;return function(n,i){var o=n.linePrecision,o=o*o,a=this.geometry,s=this.matrixWorld;null===a.boundingSphere&&a.computeBoundingSphere();r.copy(a.boundingSphere);r.applyMatrix4(s);if(!1!==n.ray.intersectsSphere(r)){e.getInverse(s);t.copy(n.ray).applyMatrix4(e);var c=new THREE.Vector3,u=new THREE.Vector3,s=new THREE.Vector3,l=new THREE.Vector3,h=this instanceof THREE.LineSegments?2:1;if(a instanceof THREE.BufferGeometry){var f=a.index,p=a.attributes.position.array;if(null!==f)for(var f=f.array,a=0,d=f.length-1;a<d;a+=h){var m=f[a+1];c.fromArray(p,3*f[a]);u.fromArray(p,3*m);m=t.distanceSqToSegment(c,u,l,s);m>o||(l.applyMatrix4(this.matrixWorld),m=n.ray.origin.distanceTo(l),m<n.near||m>n.far||i.push({distance:m,point:s.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}))}else for(a=0,d=p.length/3-1;a<d;a+=h)c.fromArray(p,3*a),u.fromArray(p,3*a+3),m=t.distanceSqToSegment(c,u,l,s),m>o||(l.applyMatrix4(this.matrixWorld),m=n.ray.origin.distanceTo(l),m<n.near||m>n.far||i.push({distance:m,point:s.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}))}else if(a instanceof THREE.Geometry)for(c=a.vertices,u=c.length,a=0;a<u-1;a+=h)m=t.distanceSqToSegment(c[a],c[a+1],l,s),m>o||(l.applyMatrix4(this.matrixWorld),m=n.ray.origin.distanceTo(l),m<n.near||m>n.far||i.push({distance:m,point:s.clone().applyMatrix4(this.matrixWorld),index:a,face:null,faceIndex:null,object:this}))}}}();THREE.Line.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)};THREE.LineStrip=0;THREE.LinePieces=1;THREE.LineSegments=function(e,t){THREE.Line.call(this,e,t);this.type="LineSegments"};THREE.LineSegments.prototype=Object.create(THREE.Line.prototype);THREE.LineSegments.prototype.constructor=THREE.LineSegments;THREE.Mesh=function(e,t){THREE.Object3D.call(this);this.type="Mesh";this.geometry=void 0!==e?e:new THREE.Geometry;this.material=void 0!==t?t:new THREE.MeshBasicMaterial({color:16777215*Math.random()});this.drawMode=THREE.TrianglesDrawMode;this.updateMorphTargets()};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);THREE.Mesh.prototype.constructor=THREE.Mesh;THREE.Mesh.prototype.setDrawMode=function(e){this.drawMode=e};THREE.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;e<t;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}};THREE.Mesh.prototype.getMorphTargetIndexByName=function(e){if(void 0!==this.morphTargetDictionary[e])return this.morphTargetDictionary[e];console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0.");return 0};THREE.Mesh.prototype.raycast=function(){function e(e,t,r,n,i,o,a){THREE.Triangle.barycoordFromPoint(e,t,r,n,m);i.multiplyScalar(m.x);o.multiplyScalar(m.y);a.multiplyScalar(m.z);i.add(o).add(a);return i.clone()}function t(e,t,r,n,i,o,a){var s=e.material;if(null===(s.side===THREE.BackSide?r.intersectTriangle(o,i,n,!0,a):r.intersectTriangle(n,i,o,s.side!==THREE.DoubleSide,a)))return null;g.copy(a);g.applyMatrix4(e.matrixWorld);r=t.ray.origin.distanceTo(g);return r<t.near||r>t.far?null:{distance:r,point:g.clone(),object:e}}function r(r,n,i,o,u,l,h,m){a.fromArray(o,3*l);s.fromArray(o,3*h);c.fromArray(o,3*m);if(r=t(r,n,i,a,s,c,E))u&&(f.fromArray(u,2*l),p.fromArray(u,2*h),d.fromArray(u,2*m),r.uv=e(E,a,s,c,f,p,d)),r.face=new THREE.Face3(l,h,m,THREE.Triangle.normal(a,s,c)),r.faceIndex=l;return r}var n=new THREE.Matrix4,i=new THREE.Ray,o=new THREE.Sphere,a=new THREE.Vector3,s=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Vector3,l=new THREE.Vector3,h=new THREE.Vector3,f=new THREE.Vector2,p=new THREE.Vector2,d=new THREE.Vector2,m=new THREE.Vector3,E=new THREE.Vector3,g=new THREE.Vector3;return function(m,g){var v=this.geometry,y=this.material,b=this.matrixWorld;if(void 0!==y&&(null===v.boundingSphere&&v.computeBoundingSphere(),o.copy(v.boundingSphere),o.applyMatrix4(b),!1!==m.ray.intersectsSphere(o)&&(n.getInverse(b),i.copy(m.ray).applyMatrix4(n),null===v.boundingBox||!1!==i.intersectsBox(v.boundingBox)))){var T,R;if(v instanceof THREE.BufferGeometry){var w,x,y=v.index,b=v.attributes,v=b.position.array;void 0!==b.uv&&(T=b.uv.array);if(null!==y)for(var b=y.array,H=0,_=b.length;H<_;H+=3){if(y=b[H],w=b[H+1],x=b[H+2],R=r(this,m,i,v,T,y,w,x))R.faceIndex=Math.floor(H/3),g.push(R)}else for(H=0,_=v.length;H<_;H+=9)if(y=H/3,w=y+1,x=y+2,R=r(this,m,i,v,T,y,w,x))R.index=y,g.push(R)}else if(v instanceof THREE.Geometry){var S,M,b=y instanceof THREE.MultiMaterial,H=!0===b?y.materials:null,_=v.vertices;w=v.faces;x=v.faceVertexUvs[0];0<x.length&&(T=x);for(var A=0,C=w.length;A<C;A++){var k=w[A];R=!0===b?H[k.materialIndex]:y;if(void 0!==R){x=_[k.a];S=_[k.b];M=_[k.c];if(!0===R.morphTargets){R=v.morphTargets;var L=this.morphTargetInfluences;a.set(0,0,0);s.set(0,0,0);c.set(0,0,0);for(var P=0,O=R.length;P<O;P++){var N=L[P];if(0!==N){var F=R[P].vertices;a.addScaledVector(u.subVectors(F[k.a],x),N);s.addScaledVector(l.subVectors(F[k.b],S),N);c.addScaledVector(h.subVectors(F[k.c],M),N)}}a.add(x);s.add(S);c.add(M);x=a;S=s;M=c}if(R=t(this,m,i,x,S,M,E))T&&(L=T[A],f.copy(L[0]),p.copy(L[1]),d.copy(L[2]),R.uv=e(E,x,S,M,f,p,d)),R.face=k,R.faceIndex=A,g.push(R)}}}}}}();THREE.Mesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)};THREE.Bone=function(e){THREE.Object3D.call(this);this.type="Bone";this.skin=e};THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.constructor=THREE.Bone;THREE.Bone.prototype.copy=function(e){THREE.Object3D.prototype.copy.call(this,e);this.skin=e.skin;return this};THREE.Skeleton=function(e,t,r){this.useVertexTexture=void 0!==r?r:!0;this.identityMatrix=new THREE.Matrix4;e=e||[];this.bones=e.slice(0);this.useVertexTexture?(e=Math.sqrt(4*this.bones.length),e=THREE.Math.nextPowerOfTwo(Math.ceil(e)),this.boneTextureHeight=this.boneTextureWidth=e=Math.max(e,4),this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType)):this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else for(console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[],t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new THREE.Matrix4)};THREE.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var r=new THREE.Matrix4;this.bones[e]&&r.getInverse(this.bones[e].matrixWorld);this.boneInverses.push(r)}};THREE.Skeleton.prototype.pose=function(){for(var e,t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);t=0;for(r=this.bones.length;t<r;t++)if(e=this.bones[t])e.parent?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale)};THREE.Skeleton.prototype.update=function(){var e=new THREE.Matrix4;return function(){for(var t=0,r=this.bones.length;t<r;t++)e.multiplyMatrices(this.bones[t]?this.bones[t].matrixWorld:this.identityMatrix,this.boneInverses[t]),e.flattenToArrayOffset(this.boneMatrices,16*t);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}();THREE.Skeleton.prototype.clone=function(){return new THREE.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)};THREE.SkinnedMesh=function(e,t,r){THREE.Mesh.call(this,e,t);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new THREE.Matrix4;this.bindMatrixInverse=new THREE.Matrix4;e=[];if(this.geometry&&void 0!==this.geometry.bones){for(var n,i=0,o=this.geometry.bones.length;i<o;++i)n=this.geometry.bones[i],t=new THREE.Bone(this),e.push(t),t.name=n.name,t.position.fromArray(n.pos),t.quaternion.fromArray(n.rotq),void 0!==n.scl&&t.scale.fromArray(n.scl);i=0;for(o=this.geometry.bones.length;i<o;++i)n=this.geometry.bones[i],-1!==n.parent&&null!==n.parent?e[n.parent].add(e[i]):this.add(e[i])}this.normalizeSkinWeights();this.updateMatrixWorld(!0);this.bind(new THREE.Skeleton(e,void 0,r),this.matrixWorld)};THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.SkinnedMesh.prototype.constructor=THREE.SkinnedMesh;THREE.SkinnedMesh.prototype.bind=function(e,t){this.skeleton=e;void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld);this.bindMatrix.copy(t);this.bindMatrixInverse.getInverse(t)};THREE.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()};THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry)for(var e=0;e<this.geometry.skinWeights.length;e++){var t=this.geometry.skinWeights[e],r=1/t.lengthManhattan();Infinity!==r?t.multiplyScalar(r):t.set(1,0,0,0)}else if(this.geometry instanceof THREE.BufferGeometry)for(var t=new THREE.Vector4,n=this.geometry.attributes.skinWeight,e=0;e<n.count;e++)t.x=n.getX(e),t.y=n.getY(e),t.z=n.getZ(e),t.w=n.getW(e),r=1/t.lengthManhattan(),Infinity!==r?t.multiplyScalar(r):t.set(1,0,0,0),n.setXYZW(e,t.x,t.y,t.z,t.w)};THREE.SkinnedMesh.prototype.updateMatrixWorld=function(e){THREE.Mesh.prototype.updateMatrixWorld.call(this,!0);"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)};THREE.SkinnedMesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material,this.useVertexTexture).copy(this)};THREE.LOD=function(){THREE.Object3D.call(this);this.type="LOD";Object.defineProperties(this,{levels:{enumerable:!0,value:[]},objects:{get:function(){console.warn("THREE.LOD: .objects has been renamed to .levels.");return this.levels}}})};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);THREE.LOD.prototype.constructor=THREE.LOD;THREE.LOD.prototype.addLevel=function(e,t){void 0===t&&(t=0);t=Math.abs(t);for(var r=this.levels,n=0;n<r.length&&!(t<r[n].distance);n++);r.splice(n,0,{distance:t,object:e});this.add(e)};THREE.LOD.prototype.getObjectForDistance=function(e){for(var t=this.levels,r=1,n=t.length;r<n&&!(e<t[r].distance);r++);return t[r-1].object};THREE.LOD.prototype.raycast=function(){var e=new THREE.Vector3;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(e);this.getObjectForDistance(n).raycast(t,r)}}();THREE.LOD.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(r){var n=this.levels;if(1<n.length){e.setFromMatrixPosition(r.matrixWorld);t.setFromMatrixPosition(this.matrixWorld);r=e.distanceTo(t);n[0].object.visible=!0;for(var i=1,o=n.length;i<o;i++)if(r>=n[i].distance)n[i-1].object.visible=!1,n[i].object.visible=!0;else break;for(;i<o;i++)n[i].object.visible=!1}}}();THREE.LOD.prototype.copy=function(e){THREE.Object3D.prototype.copy.call(this,e,!1);e=e.levels;for(var t=0,r=e.length;t<r;t++){var n=e[t];this.addLevel(n.object.clone(),n.distance)}return this};THREE.LOD.prototype.toJSON=function(e){e=THREE.Object3D.prototype.toJSON.call(this,e);e.object.levels=[];for(var t=this.levels,r=0,n=t.length;r<n;r++){var i=t[r];e.object.levels.push({object:i.object.uuid,distance:i.distance})}return e};THREE.Sprite=function(){var e=new Uint16Array([0,1,2,0,2,3]),t=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),r=new Float32Array([0,0,1,0,1,1,0,1]),n=new THREE.BufferGeometry;n.setIndex(new THREE.BufferAttribute(e,1));n.addAttribute("position",new THREE.BufferAttribute(t,3));n.addAttribute("uv",new THREE.BufferAttribute(r,2));return function(e){THREE.Object3D.call(this);this.type="Sprite";this.geometry=n;this.material=void 0!==e?e:new THREE.SpriteMaterial}}();THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);THREE.Sprite.prototype.constructor=THREE.Sprite;THREE.Sprite.prototype.raycast=function(){var e=new THREE.Vector3;return function(t,r){e.setFromMatrixPosition(this.matrixWorld);var n=t.ray.distanceSqToPoint(e);n>this.scale.x*this.scale.y||r.push({distance:Math.sqrt(n),point:this.position,face:null,object:this})}}();THREE.Sprite.prototype.clone=function(){return new this.constructor(this.material).copy(this)};THREE.Particle=THREE.Sprite;THREE.LensFlare=function(e,t,r,n,i){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=void 0;void 0!==e&&this.add(e,t,r,n,i)};THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare.prototype.constructor=THREE.LensFlare;THREE.LensFlare.prototype.add=function(e,t,r,n,i,o){void 0===t&&(t=-1);void 0===r&&(r=0);void 0===o&&(o=1);void 0===i&&(i=new THREE.Color(16777215));void 0===n&&(n=THREE.NormalBlending);r=Math.min(r,Math.max(0,r));this.lensFlares.push({texture:e,size:t,distance:r,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:i,blending:n})};THREE.LensFlare.prototype.updateLensFlares=function(){var e,t=this.lensFlares.length,r,n=2*-this.positionScreen.x,i=2*-this.positionScreen.y;for(e=0;e<t;e++)r=this.lensFlares[e],r.x=this.positionScreen.x+n*r.distance,r.y=this.positionScreen.y+i*r.distance,r.wantedRotation=r.x*Math.PI*.25,r.rotation+=.25*(r.wantedRotation-r.rotation)};THREE.LensFlare.prototype.copy=function(e){THREE.Object3D.prototype.copy.call(this,e);this.positionScreen.copy(e.positionScreen);this.customUpdateCallback=e.customUpdateCallback;for(var t=0,r=e.lensFlares.length;t<r;t++)this.lensFlares.push(e.lensFlares[t]);return this};THREE.Scene=function(){THREE.Object3D.call(this);this.type="Scene";this.overrideMaterial=this.fog=null;this.autoUpdate=!0};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);THREE.Scene.prototype.constructor=THREE.Scene;THREE.Scene.prototype.copy=function(e,t){THREE.Object3D.prototype.copy.call(this,e,t);null!==e.fog&&(this.fog=e.fog.clone());null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone());this.autoUpdate=e.autoUpdate;this.matrixAutoUpdate=e.matrixAutoUpdate;return this};THREE.Fog=function(e,t,r){this.name="";this.color=new THREE.Color(e);this.near=void 0!==t?t:1;this.far=void 0!==r?r:1e3};THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};THREE.FogExp2=function(e,t){this.name="";this.color=new THREE.Color(e);this.density=void 0!==t?t:25e-5};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};THREE.ShaderChunk={};THREE.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n";THREE.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n";THREE.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n";THREE.ShaderChunk.ambient_pars="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\treturn PI * ambientLightColor;\n}\n";THREE.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\n\treflectedLight.indirectDiffuse *= ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n#endif\n";THREE.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif";THREE.ShaderChunk.begin_vertex="\nvec3 transformed = vec3( position );\n";THREE.ShaderChunk.beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n";THREE.ShaderChunk.bsdfs="bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat calcLightAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif ( decayExponent > 0.0 ) {\n\t  return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = alpha * alpha;\n\tfloat gl = dotNL + pow( a2 + ( 1.0 - a2 ) * dotNL * dotNL, 0.5 );\n\tfloat gv = dotNV + pow( a2 + ( 1.0 - a2 ) * dotNV * dotNV, 0.5 );\n\treturn 1.0 / ( gl * gv );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = alpha * alpha;\n\tfloat denom = dotNH * dotNH * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / ( denom * denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = roughness * roughness;\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_Smith( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / square( ggxRoughness + 0.0001 ) - 2.0 );\n}\n";THREE.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n";THREE.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif";THREE.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n";THREE.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif";THREE.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif";THREE.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat square( const in float x ) { return x*x; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nvec3 inputToLinear( in vec3 a ) {\n\t#ifdef GAMMA_INPUT\n\t\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\n\t#else\n\t\treturn a;\n\t#endif\n}\nvec3 linearToOutput( in vec3 a ) {\n\t#ifdef GAMMA_OUTPUT\n\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n\t#else\n\t\treturn a;\n\t#endif\n}\n";THREE.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n";THREE.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n";THREE.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n";THREE.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = inputToLinear( emissiveColor.rgb );\n\ttotalEmissiveLight *= emissiveColor.rgb;\n#endif\n";THREE.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n";THREE.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\tenvColor.xyz = inputToLinear( envColor.xyz );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n";THREE.ShaderChunk.envmap_pars_fragment="#if defined( USE_ENVMAP ) || defined( STANDARD )\n\tuniform float reflectivity;\n\tuniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( STANDARD )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n";THREE.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG ) && ! defined( STANDARD )\n\tvarying vec3 vReflect;\n\tuniform float refractionRatio;\n#endif\n";THREE.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG ) && ! defined( STANDARD )\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t#ifdef ENVMAP_MODE_REFLECTION\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t#else\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t#endif\n#endif\n";THREE.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\t\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\n#endif";THREE.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif";THREE.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n";
THREE.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif";THREE.ShaderChunk.lights_lambert_vertex="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tdirectLight = getPointDirectLight( pointLights[ i ], geometry );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tdirectLight = getSpotDirectLight( spotLights[ i ], geometry );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectLight = getDirectionalDirectLight( directionalLights[ i ], geometry );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n";THREE.ShaderChunk.lights_pars="#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tIncidentLight getDirectionalDirectLight( const in DirectionalLight directionalLight, const in GeometricContext geometry ) {\n\t\tIncidentLight directLight;\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t\treturn directLight;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tIncidentLight getPointDirectLight( const in PointLight pointLight, const in GeometricContext geometry ) {\n\t\tIncidentLight directLight;\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\n\t\t\tdirectLight.color = pointLight.color;\n\t\t\tdirectLight.color *= calcLightAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t\treturn directLight;\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat angleCos;\n\t\tfloat penumbra;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tIncidentLight getSpotDirectLight( const in SpotLight spotLight, const in GeometricContext geometry ) {\n\t\tIncidentLight directLight;\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat spotEffect = dot( directLight.direction, spotLight.direction );\n\t\tif ( all( bvec2( spotEffect > spotLight.angleCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n\t\t\tfloat spotEffect = dot( spotLight.direction, directLight.direction );\n\t\t\tspotEffect *= clamp( ( spotEffect - spotLight.angleCos ) / spotLight.penumbra, 0.0, 1.0 );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= ( spotEffect * calcLightAttenuation( lightDistance, spotLight.distance, spotLight.decay ) );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t\treturn directLight;\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\treturn PI * mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( STANDARD )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t#else\n\t\t\tvec3 envMapColor = vec3( 0.0 );\n\t\t#endif\n\t\tenvMapColor.rgb = inputToLinear( envMapColor.rgb );\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( square( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t#endif\n\t\tenvMapColor.rgb = inputToLinear( envMapColor.rgb );\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n";THREE.ShaderChunk.lights_phong_fragment="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n";THREE.ShaderChunk.lights_phong_pars_fragment="#ifdef USE_ENVMAP\n\tvarying vec3 vWorldPosition;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * PI * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n";THREE.ShaderChunk.lights_phong_pars_vertex="#ifdef USE_ENVMAP\n\tvarying vec3 vWorldPosition;\n#endif\n";THREE.ShaderChunk.lights_phong_vertex="#ifdef USE_ENVMAP\n\tvWorldPosition = worldPosition.xyz;\n#endif\n";THREE.ShaderChunk.lights_standard_fragment="StandardMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\nmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n";THREE.ShaderChunk.lights_standard_pars_fragment="struct StandardMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n};\nvoid RE_Direct_Standard( const in IncidentLight directLight, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * PI * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n}\nvoid RE_IndirectDiffuse_Standard( const in vec3 irradiance, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Standard( const in vec3 radiance, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectSpecular += radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Standard\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Standard\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Standard\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n";THREE.ShaderChunk.lights_template="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tdirectLight = getPointDirectLight( pointLight, geometry );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tdirectLight = getSpotDirectLight( spotLight, geometry );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tdirectLight = getDirectionalDirectLight( directionalLight, geometry );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tirradiance += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\tRE_IndirectSpecular( radiance, geometry, material, reflectedLight );\n#endif\n";THREE.ShaderChunk.linear_to_gamma_fragment="\n\toutgoingLight = linearToOutput( outgoingLight );\n";THREE.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif";THREE.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n";THREE.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif";THREE.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n";THREE.ShaderChunk.map_fragment="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\n\tdiffuseColor *= texelColor;\n#endif\n";THREE.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif";THREE.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n#endif\n";THREE.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n";THREE.ShaderChunk.metalnessmap_fragment="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n";THREE.ShaderChunk.metalnessmap_pars_fragment="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif";THREE.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n";THREE.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif";THREE.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n";THREE.ShaderChunk.normal_fragment="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n";THREE.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n";THREE.ShaderChunk.project_vertex="#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n";THREE.ShaderChunk.roughnessmap_fragment="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n";THREE.ShaderChunk.roughnessmap_pars_fragment="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif";THREE.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\treturn dot( rgba_depth, bit_shift );\n\t}\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n";THREE.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n";THREE.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n";THREE.ShaderChunk.shadowmask_pars_fragment="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n";THREE.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif";THREE.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n";THREE.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n";THREE.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n";THREE.ShaderChunk.specularmap_fragment="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif";
THREE.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif";THREE.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif";THREE.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif";THREE.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif";THREE.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif";THREE.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n";THREE.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif";THREE.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( STANDARD ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n";THREE.UniformsUtils={merge:function(e){for(var t={},r=0;r<e.length;r++){var n=this.clone(e[r]),i;for(i in n)t[i]=n[i]}return t},clone:function(e){var t={},r;for(r in e){t[r]={};for(var n in e[r]){var i=e[r][n];i instanceof THREE.Color||i instanceof THREE.Vector2||i instanceof THREE.Vector3||i instanceof THREE.Vector4||i instanceof THREE.Matrix3||i instanceof THREE.Matrix4||i instanceof THREE.Texture?t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}}return t}};THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98}},aomap:{aoMap:{type:"t",value:null},aoMapIntensity:{type:"f",value:1}},lightmap:{lightMap:{type:"t",value:null},lightMapIntensity:{type:"f",value:1}},emissivemap:{emissiveMap:{type:"t",value:null}},bumpmap:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},displacementmap:{displacementMap:{type:"t",value:null},displacementScale:{type:"f",value:1},displacementBias:{type:"f",value:0}},roughnessmap:{roughnessMap:{type:"t",value:null}},metalnessmap:{metalnessMap:{type:"t",value:null}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},ambient:{ambientLightColor:{type:"fv",value:[]}},lights:{directionalLights:{type:"sa",value:[],properties:{direction:{type:"v3"},color:{type:"c"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},directionalShadowMap:{type:"tv",value:[]},directionalShadowMatrix:{type:"m4v",value:[]},spotLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},direction:{type:"v3"},distance:{type:"f"},angleCos:{type:"f"},penumbra:{type:"f"},decay:{type:"f"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},spotShadowMap:{type:"tv",value:[]},spotShadowMatrix:{type:"m4v",value:[]},pointLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},decay:{type:"f"},distance:{type:"f"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},pointShadowMap:{type:"tv",value:[]},pointShadowMatrix:{type:"m4v",value:[]},hemisphereLights:{type:"sa",value:[],properties:{direction:{type:"v3"},skyColor:{type:"c"},groundColor:{type:"c"}}}},points:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)}}};THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.fog]),vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.uv_pars_vertex,THREE.ShaderChunk.uv2_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.uv_vertex,THREE.ShaderChunk.uv2_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"\t#ifdef USE_ENVMAP",THREE.ShaderChunk.beginnormal_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"\t#endif",THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.uv_pars_fragment,THREE.ShaderChunk.uv2_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.aomap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"\tReflectedLight reflectedLight;\n\treflectedLight.directDiffuse = vec3( 0.0 );\n\treflectedLight.directSpecular = vec3( 0.0 );\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\n\treflectedLight.indirectSpecular = vec3( 0.0 );",THREE.ShaderChunk.aomap_fragment,"\tvec3 outgoingLight = reflectedLight.indirectDiffuse;",THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.lightmap,THREE.UniformsLib.emissivemap,THREE.UniformsLib.fog,THREE.UniformsLib.ambient,THREE.UniformsLib.lights,{emissive:{type:"c",value:new THREE.Color(0)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.uv_pars_vertex,THREE.ShaderChunk.uv2_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.bsdfs,THREE.ShaderChunk.lights_pars,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.uv_vertex,THREE.ShaderChunk.uv2_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.beginnormal_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.uv_pars_fragment,THREE.ShaderChunk.uv2_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.aomap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.emissivemap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.bsdfs,THREE.ShaderChunk.ambient_pars,THREE.ShaderChunk.lights_pars,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.shadowmask_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveLight = emissive;",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.emissivemap_fragment,"\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );",THREE.ShaderChunk.lightmap_fragment,"\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();",THREE.ShaderChunk.aomap_fragment,"\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveLight;",THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.lightmap,THREE.UniformsLib.emissivemap,THREE.UniformsLib.bumpmap,THREE.UniformsLib.normalmap,THREE.UniformsLib.displacementmap,THREE.UniformsLib.fog,THREE.UniformsLib.ambient,THREE.UniformsLib.lights,{emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.uv_pars_vertex,THREE.ShaderChunk.uv2_pars_vertex,THREE.ShaderChunk.displacementmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.uv_vertex,THREE.ShaderChunk.uv2_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.beginnormal_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif",THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.displacementmap_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"\tvViewPosition = - mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.uv_pars_fragment,THREE.ShaderChunk.uv2_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.aomap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.emissivemap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.bsdfs,THREE.ShaderChunk.ambient_pars,THREE.ShaderChunk.lights_pars,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveLight = emissive;",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.normal_fragment,THREE.ShaderChunk.emissivemap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lights_template,THREE.ShaderChunk.aomap_fragment,"vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveLight;",THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},standard:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.lightmap,THREE.UniformsLib.emissivemap,THREE.UniformsLib.bumpmap,THREE.UniformsLib.normalmap,THREE.UniformsLib.displacementmap,THREE.UniformsLib.roughnessmap,THREE.UniformsLib.metalnessmap,THREE.UniformsLib.fog,THREE.UniformsLib.ambient,THREE.UniformsLib.lights,{emissive:{type:"c",value:new THREE.Color(0)},roughness:{type:"f",value:.5},metalness:{type:"f",value:0},envMapIntensity:{type:"f",value:1}}]),vertexShader:["#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.uv_pars_vertex,THREE.ShaderChunk.uv2_pars_vertex,THREE.ShaderChunk.displacementmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.uv_vertex,THREE.ShaderChunk.uv2_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.beginnormal_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif",THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.displacementmap_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"\tvViewPosition = - mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define STANDARD\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.uv_pars_fragment,THREE.ShaderChunk.uv2_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.aomap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.emissivemap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.bsdfs,THREE.ShaderChunk.ambient_pars,THREE.ShaderChunk.lights_pars,THREE.ShaderChunk.lights_standard_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.roughnessmap_pars_fragment,THREE.ShaderChunk.metalnessmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveLight = emissive;",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.roughnessmap_fragment,THREE.ShaderChunk.metalnessmap_fragment,THREE.ShaderChunk.normal_fragment,THREE.ShaderChunk.emissivemap_fragment,THREE.ShaderChunk.lights_standard_fragment,THREE.ShaderChunk.lights_template,THREE.ShaderChunk.aomap_fragment,"vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveLight;",THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},points:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.points,THREE.UniformsLib.fog]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.project_vertex,"\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif",THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphatest_fragment,"\toutgoingLight = diffuseColor.rgb;",THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.color_fragment,"\toutgoingLight = diffuseColor.rgb;",THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;\nuniform float mFar;\nuniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",THREE.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\n\tgl_FragColor = vec4( vec3( color ), opacity );\n}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vNormal;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\nvec3 direction = normalize( vWorldPosition );\nvec2 sampleUV;\nsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\nsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\ngl_FragColor = texture2D( tEquirect, sampleUV );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nvoid main() {",THREE.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\n\t#else\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n\t#endif\n}"].join("\n")},distanceRGBA:{uniforms:{lightPos:{type:"v3",value:new THREE.Vector3(0,0,0)}},vertexShader:["varying vec4 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.worldpos_vertex,"vWorldPosition = worldPosition;\n}"].join("\n"),fragmentShader:["uniform vec3 lightPos;\nvarying vec4 vWorldPosition;",THREE.ShaderChunk.common,"vec4 pack1K ( float depth ) {\n\tdepth /= 1000.0;\n\tconst vec4 bitSh = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bitMsk = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( depth * bitSh * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bitMsk;\n\treturn res; \n}\nfloat unpack1K ( vec4 color ) {\n\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\treturn dot( color, bitSh ) * 1000.0;\n}\nvoid main () {\n\tgl_FragColor = pack1K( length( vWorldPosition.xyz - lightPos.xyz ) );\n}"].join("\n")}};THREE.WebGLRenderer=function(e){function t(e,t,r,n){!0===O&&(e*=n,t*=n,r*=n);ve.clearColor(e,t,r,n)}function r(){ve.init();ve.scissor(Q.copy(ae).multiplyScalar(oe));ve.viewport(Z.copy(ce).multiplyScalar(oe));t(te.r,te.g,te.b,re)}function n(){K=z=null;Y="";X=-1;ve.reset()}function i(e){e.preventDefault();n();r();ye.clear()}function o(e){e=e.target;e.removeEventListener("dispose",o);e:{var t=ye.get(e);if(e.image&&t.__image__webglTextureCube)me.deleteTexture(t.__image__webglTextureCube);else{if(void 0===t.__webglInit)break e;me.deleteTexture(t.__webglTexture)}ye.delete(e)}pe.textures--}function a(e){e=e.target;e.removeEventListener("dispose",a);var t=ye.get(e),r=ye.get(e.texture);if(e&&void 0!==r.__webglTexture){me.deleteTexture(r.__webglTexture);if(e instanceof THREE.WebGLRenderTargetCube)for(r=0;6>r;r++)me.deleteFramebuffer(t.__webglFramebuffer[r]),me.deleteRenderbuffer(t.__webglDepthbuffer[r]);else me.deleteFramebuffer(t.__webglFramebuffer),me.deleteRenderbuffer(t.__webglDepthbuffer);ye.delete(e.texture);ye.delete(e)}pe.textures--}function s(e){e=e.target;e.removeEventListener("dispose",s);c(e);ye.delete(e)}function c(e){var t=ye.get(e).program;e.program=void 0;void 0!==t&&Te.releaseProgram(t)}function u(e,t){return Math.abs(t[0])-Math.abs(e[0])}function l(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function h(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function f(e,t,r,n,i){var o;r.transparent?(n=j,o=++D):(n=I,o=++B);o=n[o];void 0!==o?(o.id=e.id,o.object=e,o.geometry=t,o.material=r,o.z=he.z,o.group=i):(o={id:e.id,object:e,geometry:t,material:r,z:he.z,group:i},n.push(o))}function p(e,t){if(!1!==e.visible){if(e.layers.test(t.layers))if(e instanceof THREE.Light)F.push(e);else if(e instanceof THREE.Sprite)!1!==e.frustumCulled&&!0!==ue.intersectsObject(e)||$.push(e);else if(e instanceof THREE.LensFlare)V.push(e);else if(e instanceof THREE.ImmediateRenderObject)!0===G.sortObjects&&(he.setFromMatrixPosition(e.matrixWorld),he.applyProjection(le)),f(e,null,e.material,he.z,null);else if(e instanceof THREE.Mesh||e instanceof THREE.Line||e instanceof THREE.Points)if(e instanceof THREE.SkinnedMesh&&e.skeleton.update(),!1===e.frustumCulled||!0===ue.intersectsObject(e)){var r=e.material;if(!0===r.visible){!0===G.sortObjects&&(he.setFromMatrixPosition(e.matrixWorld),he.applyProjection(le));var n=be.update(e);if(r instanceof THREE.MultiMaterial)for(var i=n.groups,o=r.materials,r=0,a=i.length;r<a;r++){var s=i[r],c=o[s.materialIndex];!0===c.visible&&f(e,n,c,he.z,s)}else f(e,n,r,he.z,null)}}n=e.children;r=0;for(a=n.length;r<a;r++)p(n[r],t)}}function d(e,t,r,n){for(var i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,c=a.geometry,u=void 0===n?a.material:n,a=a.group;s.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,s.matrixWorld);s.normalMatrix.getNormalMatrix(s.modelViewMatrix);if(s instanceof THREE.ImmediateRenderObject){m(u);var l=E(t,r,u,s);Y="";s.render(function(e){G.renderBufferImmediate(e,l,u)})}else G.renderBufferDirect(t,r,c,u,s,a)}}function m(e){e.side!==THREE.DoubleSide?ve.enable(me.CULL_FACE):ve.disable(me.CULL_FACE);ve.setFlipSided(e.side===THREE.BackSide);!0===e.transparent?ve.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha):ve.setBlending(THREE.NoBlending);ve.setDepthFunc(e.depthFunc);ve.setDepthTest(e.depthTest);ve.setDepthWrite(e.depthWrite);ve.setColorWrite(e.colorWrite);ve.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function E(e,t,r,n){ee=0;var i=ye.get(r);void 0===i.program&&(r.needsUpdate=!0);void 0!==i.lightsHash&&i.lightsHash!==fe.hash&&(r.needsUpdate=!0);if(r.needsUpdate){e:{var o=ye.get(r),a=Te.getParameters(r,fe,t,n),u=Te.getProgramCode(r,a),l=o.program,h=!0;if(void 0===l)r.addEventListener("dispose",s);else if(l.code!==u)c(r);else if(void 0!==a.shaderID)break e;else h=!1;h&&(a.shaderID?(l=THREE.ShaderLib[a.shaderID],o.__webglShader={name:r.type,uniforms:THREE.UniformsUtils.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}):o.__webglShader={name:r.type,uniforms:r.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader},r.__webglShader=o.__webglShader,l=Te.acquireProgram(r,a,u),o.program=l,r.program=l);a=l.getAttributes();if(r.morphTargets)for(u=r.numSupportedMorphTargets=0;u<G.maxMorphTargets;u++)0<=a["morphTarget"+u]&&r.numSupportedMorphTargets++;if(r.morphNormals)for(u=r.numSupportedMorphNormals=0;u<G.maxMorphNormals;u++)0<=a["morphNormal"+u]&&r.numSupportedMorphNormals++;o.uniformsList=[];var a=o.__webglShader.uniforms,u=o.program.getUniforms(),f;for(f in a)(l=u[f])&&o.uniformsList.push([o.__webglShader.uniforms[f],l]);if(r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.MeshStandardMaterial||r.lights)o.lightsHash=fe.hash,a.ambientLightColor.value=fe.ambient,a.directionalLights.value=fe.directional,a.spotLights.value=fe.spot,a.pointLights.value=fe.point,a.hemisphereLights.value=fe.hemi,a.directionalShadowMap.value=fe.directionalShadowMap,a.directionalShadowMatrix.value=fe.directionalShadowMatrix,a.spotShadowMap.value=fe.spotShadowMap,a.spotShadowMatrix.value=fe.spotShadowMatrix,a.pointShadowMap.value=fe.pointShadowMap,a.pointShadowMatrix.value=fe.pointShadowMatrix;o.hasDynamicUniforms=!1;f=0;for(a=o.uniformsList.length;f<a;f++)if(!0===o.uniformsList[f][0].dynamic){o.hasDynamicUniforms=!0;break}}r.needsUpdate=!1}l=u=h=!1;o=i.program;f=o.getUniforms();a=i.__webglShader.uniforms;o.id!==z&&(me.useProgram(o.program),z=o.id,l=u=h=!0);r.id!==X&&(X=r.id,u=!0);if(h||e!==K)me.uniformMatrix4fv(f.projectionMatrix,!1,e.projectionMatrix.elements),ge.logarithmicDepthBuffer&&me.uniform1f(f.logDepthBufFC,2/(Math.log(e.far+1)/Math.LN2)),e!==K&&(K=e,l=u=!0),(r instanceof THREE.ShaderMaterial||r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshStandardMaterial||r.envMap)&&void 0!==f.cameraPosition&&(he.setFromMatrixPosition(e.matrixWorld),
me.uniform3f(f.cameraPosition,he.x,he.y,he.z)),(r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.MeshBasicMaterial||r instanceof THREE.MeshStandardMaterial||r instanceof THREE.ShaderMaterial||r.skinning)&&void 0!==f.viewMatrix&&me.uniformMatrix4fv(f.viewMatrix,!1,e.matrixWorldInverse.elements);r.skinning&&(n.bindMatrix&&void 0!==f.bindMatrix&&me.uniformMatrix4fv(f.bindMatrix,!1,n.bindMatrix.elements),n.bindMatrixInverse&&void 0!==f.bindMatrixInverse&&me.uniformMatrix4fv(f.bindMatrixInverse,!1,n.bindMatrixInverse.elements),ge.floatVertexTextures&&n.skeleton&&n.skeleton.useVertexTexture?(void 0!==f.boneTexture&&(h=g(),me.uniform1i(f.boneTexture,h),G.setTexture(n.skeleton.boneTexture,h)),void 0!==f.boneTextureWidth&&me.uniform1i(f.boneTextureWidth,n.skeleton.boneTextureWidth),void 0!==f.boneTextureHeight&&me.uniform1i(f.boneTextureHeight,n.skeleton.boneTextureHeight)):n.skeleton&&n.skeleton.boneMatrices&&void 0!==f.boneGlobalMatrices&&me.uniformMatrix4fv(f.boneGlobalMatrices,!1,n.skeleton.boneMatrices));if(u){if(r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.MeshStandardMaterial||r.lights)u=l,a.ambientLightColor.needsUpdate=u,a.directionalLights.needsUpdate=u,a.pointLights.needsUpdate=u,a.spotLights.needsUpdate=u,a.hemisphereLights.needsUpdate=u;t&&r.fog&&(a.fogColor.value=t.color,t instanceof THREE.Fog?(a.fogNear.value=t.near,a.fogFar.value=t.far):t instanceof THREE.FogExp2&&(a.fogDensity.value=t.density));if(r instanceof THREE.MeshBasicMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshStandardMaterial){a.opacity.value=r.opacity;a.diffuse.value=r.color;r.emissive&&a.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity);a.map.value=r.map;a.specularMap.value=r.specularMap;a.alphaMap.value=r.alphaMap;r.aoMap&&(a.aoMap.value=r.aoMap,a.aoMapIntensity.value=r.aoMapIntensity);var p;r.map?p=r.map:r.specularMap?p=r.specularMap:r.displacementMap?p=r.displacementMap:r.normalMap?p=r.normalMap:r.bumpMap?p=r.bumpMap:r.roughnessMap?p=r.roughnessMap:r.metalnessMap?p=r.metalnessMap:r.alphaMap?p=r.alphaMap:r.emissiveMap&&(p=r.emissiveMap);void 0!==p&&(p instanceof THREE.WebGLRenderTarget&&(p=p.texture),t=p.offset,p=p.repeat,a.offsetRepeat.value.set(t.x,t.y,p.x,p.y));a.envMap.value=r.envMap;a.flipEnvMap.value=r.envMap instanceof THREE.WebGLRenderTargetCube?1:-1;a.reflectivity.value=r.reflectivity;a.refractionRatio.value=r.refractionRatio}r instanceof THREE.LineBasicMaterial?(a.diffuse.value=r.color,a.opacity.value=r.opacity):r instanceof THREE.LineDashedMaterial?(a.diffuse.value=r.color,a.opacity.value=r.opacity,a.dashSize.value=r.dashSize,a.totalSize.value=r.dashSize+r.gapSize,a.scale.value=r.scale):r instanceof THREE.PointsMaterial?(a.diffuse.value=r.color,a.opacity.value=r.opacity,a.size.value=r.size*oe,a.scale.value=M.clientHeight/2,a.map.value=r.map,null!==r.map&&(p=r.map.offset,r=r.map.repeat,a.offsetRepeat.value.set(p.x,p.y,r.x,r.y))):r instanceof THREE.MeshLambertMaterial?(r.lightMap&&(a.lightMap.value=r.lightMap,a.lightMapIntensity.value=r.lightMapIntensity),r.emissiveMap&&(a.emissiveMap.value=r.emissiveMap)):r instanceof THREE.MeshPhongMaterial?(a.specular.value=r.specular,a.shininess.value=Math.max(r.shininess,1e-4),r.lightMap&&(a.lightMap.value=r.lightMap,a.lightMapIntensity.value=r.lightMapIntensity),r.emissiveMap&&(a.emissiveMap.value=r.emissiveMap),r.bumpMap&&(a.bumpMap.value=r.bumpMap,a.bumpScale.value=r.bumpScale),r.normalMap&&(a.normalMap.value=r.normalMap,a.normalScale.value.copy(r.normalScale)),r.displacementMap&&(a.displacementMap.value=r.displacementMap,a.displacementScale.value=r.displacementScale,a.displacementBias.value=r.displacementBias)):r instanceof THREE.MeshStandardMaterial?(a.roughness.value=r.roughness,a.metalness.value=r.metalness,r.roughnessMap&&(a.roughnessMap.value=r.roughnessMap),r.metalnessMap&&(a.metalnessMap.value=r.metalnessMap),r.lightMap&&(a.lightMap.value=r.lightMap,a.lightMapIntensity.value=r.lightMapIntensity),r.emissiveMap&&(a.emissiveMap.value=r.emissiveMap),r.bumpMap&&(a.bumpMap.value=r.bumpMap,a.bumpScale.value=r.bumpScale),r.normalMap&&(a.normalMap.value=r.normalMap,a.normalScale.value.copy(r.normalScale)),r.displacementMap&&(a.displacementMap.value=r.displacementMap,a.displacementScale.value=r.displacementScale,a.displacementBias.value=r.displacementBias),r.envMap&&(a.envMapIntensity.value=r.envMapIntensity)):r instanceof THREE.MeshDepthMaterial?(a.mNear.value=e.near,a.mFar.value=e.far,a.opacity.value=r.opacity):r instanceof THREE.MeshNormalMaterial&&(a.opacity.value=r.opacity);v(i.uniformsList)}me.uniformMatrix4fv(f.modelViewMatrix,!1,n.modelViewMatrix.elements);f.normalMatrix&&me.uniformMatrix3fv(f.normalMatrix,!1,n.normalMatrix.elements);void 0!==f.modelMatrix&&me.uniformMatrix4fv(f.modelMatrix,!1,n.matrixWorld.elements);if(!0===i.hasDynamicUniforms){i=i.uniformsList;r=[];p=0;for(t=i.length;p<t;p++)f=i[p][0],a=f.onUpdateCallback,void 0!==a&&(a.bind(f)(n,e),r.push(i[p]));v(r)}return o}function g(){var e=ee;e>=ge.maxTextures&&console.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+ge.maxTextures);ee+=1;return e}function v(e){for(var t,r,n=0,i=e.length;n<i;n++){var o=e[n][0];if(!1!==o.needsUpdate){var a=o.type;t=o.value;var s=e[n][1];switch(a){case"1i":me.uniform1i(s,t);break;case"1f":me.uniform1f(s,t);break;case"2f":me.uniform2f(s,t[0],t[1]);break;case"3f":me.uniform3f(s,t[0],t[1],t[2]);break;case"4f":me.uniform4f(s,t[0],t[1],t[2],t[3]);break;case"1iv":me.uniform1iv(s,t);break;case"3iv":me.uniform3iv(s,t);break;case"1fv":me.uniform1fv(s,t);break;case"2fv":me.uniform2fv(s,t);break;case"3fv":me.uniform3fv(s,t);break;case"4fv":me.uniform4fv(s,t);break;case"Matrix2fv":me.uniformMatrix2fv(s,!1,t);break;case"Matrix3fv":me.uniformMatrix3fv(s,!1,t);break;case"Matrix4fv":me.uniformMatrix4fv(s,!1,t);break;case"i":me.uniform1i(s,t);break;case"f":me.uniform1f(s,t);break;case"v2":me.uniform2f(s,t.x,t.y);break;case"v3":me.uniform3f(s,t.x,t.y,t.z);break;case"v4":me.uniform4f(s,t.x,t.y,t.z,t.w);break;case"c":me.uniform3f(s,t.r,t.g,t.b);break;case"sa":for(a=0;a<t.length;a++)for(var c in o.properties){var u=s[a][c];r=t[a][c];switch(o.properties[c].type){case"i":me.uniform1i(u,r);break;case"f":me.uniform1f(u,r);break;case"v2":me.uniform2f(u,r.x,r.y);break;case"v3":me.uniform3f(u,r.x,r.y,r.z);break;case"v4":me.uniform4f(u,r.x,r.y,r.z,r.w);break;case"c":me.uniform3f(u,r.r,r.g,r.b);break;case"m4":me.uniformMatrix4fv(u,!1,r.elements)}}break;case"iv1":me.uniform1iv(s,t);break;case"iv":me.uniform3iv(s,t);break;case"fv1":me.uniform1fv(s,t);break;case"fv":me.uniform3fv(s,t);break;case"v2v":void 0===o._array&&(o._array=new Float32Array(2*t.length));r=a=0;for(u=t.length;a<u;a++,r+=2)o._array[r+0]=t[a].x,o._array[r+1]=t[a].y;me.uniform2fv(s,o._array);break;case"v3v":void 0===o._array&&(o._array=new Float32Array(3*t.length));r=a=0;for(u=t.length;a<u;a++,r+=3)o._array[r+0]=t[a].x,o._array[r+1]=t[a].y,o._array[r+2]=t[a].z;me.uniform3fv(s,o._array);break;case"v4v":void 0===o._array&&(o._array=new Float32Array(4*t.length));r=a=0;for(u=t.length;a<u;a++,r+=4)o._array[r+0]=t[a].x,o._array[r+1]=t[a].y,o._array[r+2]=t[a].z,o._array[r+3]=t[a].w;me.uniform4fv(s,o._array);break;case"m2":me.uniformMatrix2fv(s,!1,t.elements);break;case"m3":me.uniformMatrix3fv(s,!1,t.elements);break;case"m3v":void 0===o._array&&(o._array=new Float32Array(9*t.length));a=0;for(u=t.length;a<u;a++)t[a].flattenToArrayOffset(o._array,9*a);me.uniformMatrix3fv(s,!1,o._array);break;case"m4":me.uniformMatrix4fv(s,!1,t.elements);break;case"m4v":void 0===o._array&&(o._array=new Float32Array(16*t.length));a=0;for(u=t.length;a<u;a++)t[a].flattenToArrayOffset(o._array,16*a);me.uniformMatrix4fv(s,!1,o._array);break;case"t":r=g();me.uniform1i(s,r);if(!t)continue;t instanceof THREE.CubeTexture||Array.isArray(t.image)&&6===t.image.length?R(t,r):t instanceof THREE.WebGLRenderTargetCube?w(t.texture,r):t instanceof THREE.WebGLRenderTarget?G.setTexture(t.texture,r):G.setTexture(t,r);break;case"tv":void 0===o._array&&(o._array=[]);a=0;for(u=o.value.length;a<u;a++)o._array[a]=g();me.uniform1iv(s,o._array);a=0;for(u=o.value.length;a<u;a++)t=o.value[a],r=o._array[a],t&&(t instanceof THREE.CubeTexture||t.image instanceof Array&&6===t.image.length?R(t,r):t instanceof THREE.WebGLRenderTarget?G.setTexture(t.texture,r):t instanceof THREE.WebGLRenderTargetCube?w(t.texture,r):G.setTexture(t,r));break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+a)}}}}function y(e,t,r){r?(me.texParameteri(e,me.TEXTURE_WRAP_S,S(t.wrapS)),me.texParameteri(e,me.TEXTURE_WRAP_T,S(t.wrapT)),me.texParameteri(e,me.TEXTURE_MAG_FILTER,S(t.magFilter)),me.texParameteri(e,me.TEXTURE_MIN_FILTER,S(t.minFilter))):(me.texParameteri(e,me.TEXTURE_WRAP_S,me.CLAMP_TO_EDGE),me.texParameteri(e,me.TEXTURE_WRAP_T,me.CLAMP_TO_EDGE),t.wrapS===THREE.ClampToEdgeWrapping&&t.wrapT===THREE.ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",t),me.texParameteri(e,me.TEXTURE_MAG_FILTER,_(t.magFilter)),me.texParameteri(e,me.TEXTURE_MIN_FILTER,_(t.minFilter)),t.minFilter!==THREE.NearestFilter&&t.minFilter!==THREE.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",t));!(r=Ee.get("EXT_texture_filter_anisotropic"))||t.type===THREE.FloatType&&null===Ee.get("OES_texture_float_linear")||t.type===THREE.HalfFloatType&&null===Ee.get("OES_texture_half_float_linear")||!(1<t.anisotropy||ye.get(t).__currentAnisotropy)||(me.texParameterf(e,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,G.getMaxAnisotropy())),ye.get(t).__currentAnisotropy=t.anisotropy)}function b(e,t){if(e.width>t||e.height>t){var r=t/Math.max(e.width,e.height),n=document.createElement("canvas");n.width=Math.floor(e.width*r);n.height=Math.floor(e.height*r);n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height);console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height,e);return n}return e}function T(e){return THREE.Math.isPowerOfTwo(e.width)&&THREE.Math.isPowerOfTwo(e.height)}function R(e,t){var r=ye.get(e);if(6===e.image.length)if(0<e.version&&r.__version!==e.version){r.__image__webglTextureCube||(e.addEventListener("dispose",o),r.__image__webglTextureCube=me.createTexture(),pe.textures++);ve.activeTexture(me.TEXTURE0+t);ve.bindTexture(me.TEXTURE_CUBE_MAP,r.__image__webglTextureCube);me.pixelStorei(me.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var n=e instanceof THREE.CompressedTexture,i=e.image[0]instanceof THREE.DataTexture,a=[],s=0;6>s;s++)a[s]=!G.autoScaleCubemaps||n||i?i?e.image[s].image:e.image[s]:b(e.image[s],ge.maxCubemapSize);var c=T(a[0]),u=S(e.format),l=S(e.type);y(me.TEXTURE_CUBE_MAP,e,c);for(s=0;6>s;s++)if(n)for(var h,f=a[s].mipmaps,p=0,d=f.length;p<d;p++)h=f[p],e.format!==THREE.RGBAFormat&&e.format!==THREE.RGBFormat?-1<ve.getCompressedTextureFormats().indexOf(u)?ve.compressedTexImage2D(me.TEXTURE_CUBE_MAP_POSITIVE_X+s,p,u,h.width,h.height,0,h.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):ve.texImage2D(me.TEXTURE_CUBE_MAP_POSITIVE_X+s,p,u,h.width,h.height,0,u,l,h.data);else i?ve.texImage2D(me.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,u,a[s].width,a[s].height,0,u,l,a[s].data):ve.texImage2D(me.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,u,u,l,a[s]);e.generateMipmaps&&c&&me.generateMipmap(me.TEXTURE_CUBE_MAP);r.__version=e.version;if(e.onUpdate)e.onUpdate(e)}else ve.activeTexture(me.TEXTURE0+t),ve.bindTexture(me.TEXTURE_CUBE_MAP,r.__image__webglTextureCube)}function w(e,t){ve.activeTexture(me.TEXTURE0+t);ve.bindTexture(me.TEXTURE_CUBE_MAP,ye.get(e).__webglTexture)}function x(e,t,r,n){var i=S(t.texture.format),o=S(t.texture.type);ve.texImage2D(n,0,i,t.width,t.height,0,i,o,null);me.bindFramebuffer(me.FRAMEBUFFER,e);me.framebufferTexture2D(me.FRAMEBUFFER,r,n,ye.get(t.texture).__webglTexture,0);me.bindFramebuffer(me.FRAMEBUFFER,null)}function H(e,t){me.bindRenderbuffer(me.RENDERBUFFER,e);t.depthBuffer&&!t.stencilBuffer?(me.renderbufferStorage(me.RENDERBUFFER,me.DEPTH_COMPONENT16,t.width,t.height),me.framebufferRenderbuffer(me.FRAMEBUFFER,me.DEPTH_ATTACHMENT,me.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(me.renderbufferStorage(me.RENDERBUFFER,me.DEPTH_STENCIL,t.width,t.height),me.framebufferRenderbuffer(me.FRAMEBUFFER,me.DEPTH_STENCIL_ATTACHMENT,me.RENDERBUFFER,e)):me.renderbufferStorage(me.RENDERBUFFER,me.RGBA4,t.width,t.height);me.bindRenderbuffer(me.RENDERBUFFER,null)}function _(e){return e===THREE.NearestFilter||e===THREE.NearestMipMapNearestFilter||e===THREE.NearestMipMapLinearFilter?me.NEAREST:me.LINEAR}function S(e){var t;if(e===THREE.RepeatWrapping)return me.REPEAT;if(e===THREE.ClampToEdgeWrapping)return me.CLAMP_TO_EDGE;if(e===THREE.MirroredRepeatWrapping)return me.MIRRORED_REPEAT;if(e===THREE.NearestFilter)return me.NEAREST;if(e===THREE.NearestMipMapNearestFilter)return me.NEAREST_MIPMAP_NEAREST;if(e===THREE.NearestMipMapLinearFilter)return me.NEAREST_MIPMAP_LINEAR;if(e===THREE.LinearFilter)return me.LINEAR;if(e===THREE.LinearMipMapNearestFilter)return me.LINEAR_MIPMAP_NEAREST;if(e===THREE.LinearMipMapLinearFilter)return me.LINEAR_MIPMAP_LINEAR;if(e===THREE.UnsignedByteType)return me.UNSIGNED_BYTE;if(e===THREE.UnsignedShort4444Type)return me.UNSIGNED_SHORT_4_4_4_4;if(e===THREE.UnsignedShort5551Type)return me.UNSIGNED_SHORT_5_5_5_1;if(e===THREE.UnsignedShort565Type)return me.UNSIGNED_SHORT_5_6_5;if(e===THREE.ByteType)return me.BYTE;if(e===THREE.ShortType)return me.SHORT;if(e===THREE.UnsignedShortType)return me.UNSIGNED_SHORT;if(e===THREE.IntType)return me.INT;if(e===THREE.UnsignedIntType)return me.UNSIGNED_INT;if(e===THREE.FloatType)return me.FLOAT;t=Ee.get("OES_texture_half_float");if(null!==t&&e===THREE.HalfFloatType)return t.HALF_FLOAT_OES;if(e===THREE.AlphaFormat)return me.ALPHA;if(e===THREE.RGBFormat)return me.RGB;if(e===THREE.RGBAFormat)return me.RGBA;if(e===THREE.LuminanceFormat)return me.LUMINANCE;if(e===THREE.LuminanceAlphaFormat)return me.LUMINANCE_ALPHA;if(e===THREE.AddEquation)return me.FUNC_ADD;if(e===THREE.SubtractEquation)return me.FUNC_SUBTRACT;if(e===THREE.ReverseSubtractEquation)return me.FUNC_REVERSE_SUBTRACT;if(e===THREE.ZeroFactor)return me.ZERO;if(e===THREE.OneFactor)return me.ONE;if(e===THREE.SrcColorFactor)return me.SRC_COLOR;if(e===THREE.OneMinusSrcColorFactor)return me.ONE_MINUS_SRC_COLOR;if(e===THREE.SrcAlphaFactor)return me.SRC_ALPHA;if(e===THREE.OneMinusSrcAlphaFactor)return me.ONE_MINUS_SRC_ALPHA;if(e===THREE.DstAlphaFactor)return me.DST_ALPHA;if(e===THREE.OneMinusDstAlphaFactor)return me.ONE_MINUS_DST_ALPHA;if(e===THREE.DstColorFactor)return me.DST_COLOR;if(e===THREE.OneMinusDstColorFactor)return me.ONE_MINUS_DST_COLOR;if(e===THREE.SrcAlphaSaturateFactor)return me.SRC_ALPHA_SATURATE;t=Ee.get("WEBGL_compressed_texture_s3tc");if(null!==t){if(e===THREE.RGB_S3TC_DXT1_Format)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT1_Format)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT3_Format)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===THREE.RGBA_S3TC_DXT5_Format)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}t=Ee.get("WEBGL_compressed_texture_pvrtc");if(null!==t){if(e===THREE.RGB_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===THREE.RGB_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===THREE.RGBA_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===THREE.RGBA_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}t=Ee.get("WEBGL_compressed_texture_etc1");if(null!==t&&e===THREE.RGB_ETC1_Format)return t.COMPRESSED_RGB_ETC1_WEBGL;t=Ee.get("EXT_blend_minmax");if(null!==t){if(e===THREE.MinEquation)return t.MIN_EXT;if(e===THREE.MaxEquation)return t.MAX_EXT}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION);e=e||{};var M=void 0!==e.canvas?e.canvas:document.createElement("canvas"),A=void 0!==e.context?e.context:null,C=void 0!==e.alpha?e.alpha:!1,k=void 0!==e.depth?e.depth:!0,L=void 0!==e.stencil?e.stencil:!0,P=void 0!==e.antialias?e.antialias:!1,O=void 0!==e.premultipliedAlpha?e.premultipliedAlpha:!0,N=void 0!==e.preserveDrawingBuffer?e.preserveDrawingBuffer:!1,F=[],I=[],B=-1,j=[],D=-1,U=new Float32Array(8),$=[],V=[];this.domElement=M;this.context=null;this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.gammaFactor=2;this.gammaOutput=this.gammaInput=!1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;var G=this,z=null,W=null,q=null,X=-1,Y="",K=null,Q=new THREE.Vector4,J=null,Z=new THREE.Vector4,ee=0,te=new THREE.Color(0),re=0,ne=M.width,ie=M.height,oe=1,ae=new THREE.Vector4(0,0,ne,ie),se=!1,ce=new THREE.Vector4(0,0,ne,ie),ue=new THREE.Frustum,le=new THREE.Matrix4,he=new THREE.Vector3,fe={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[],shadowsPointLight:0},pe={geometries:0,textures:0},de={calls:0,vertices:0,faces:0,points:0};this.info={render:de,memory:pe,programs:null};var me;try{C={alpha:C,depth:k,stencil:L,antialias:P,premultipliedAlpha:O,preserveDrawingBuffer:N};me=A||M.getContext("webgl",C)||M.getContext("experimental-webgl",C);if(null===me){if(null!==M.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";throw"Error creating WebGL context."}M.addEventListener("webglcontextlost",i,!1)}catch(e){console.error("THREE.WebGLRenderer: "+e)}var Ee=new THREE.WebGLExtensions(me);Ee.get("OES_texture_float");Ee.get("OES_texture_float_linear");Ee.get("OES_texture_half_float");Ee.get("OES_texture_half_float_linear");Ee.get("OES_standard_derivatives");Ee.get("ANGLE_instanced_arrays");Ee.get("OES_element_index_uint")&&(THREE.BufferGeometry.MaxIndex=4294967296);var ge=new THREE.WebGLCapabilities(me,Ee,e),ve=new THREE.WebGLState(me,Ee,S),ye=new THREE.WebGLProperties,be=new THREE.WebGLObjects(me,ye,this.info),Te=new THREE.WebGLPrograms(this,ge),Re=new THREE.WebGLLights;this.info.programs=Te.programs;var we=new THREE.WebGLBufferRenderer(me,Ee,de),xe=new THREE.WebGLIndexedBufferRenderer(me,Ee,de);r();this.context=me;this.capabilities=ge;this.extensions=Ee;this.properties=ye;this.state=ve;var He=new THREE.WebGLShadowMap(this,fe,be);this.shadowMap=He;var _e=new THREE.SpritePlugin(this,$),Se=new THREE.LensFlarePlugin(this,V);this.getContext=function(){return me};this.getContextAttributes=function(){return me.getContextAttributes()};this.forceContextLoss=function(){Ee.get("WEBGL_lose_context").loseContext()};this.getMaxAnisotropy=function(){var e;return function(){if(void 0!==e)return e;var t=Ee.get("EXT_texture_filter_anisotropic");return e=null!==t?me.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}();this.getPrecision=function(){return ge.precision};this.getPixelRatio=function(){return oe};this.setPixelRatio=function(e){void 0!==e&&(oe=e,this.setSize(ce.z,ce.w,!1))};this.getSize=function(){return{width:ne,height:ie}};this.setSize=function(e,t,r){ne=e;ie=t;M.width=e*oe;M.height=t*oe;!1!==r&&(M.style.width=e+"px",M.style.height=t+"px");this.setViewport(0,0,e,t)};this.setViewport=function(e,t,r,n){ve.viewport(ce.set(e,t,r,n))};this.setScissor=function(e,t,r,n){ve.scissor(ae.set(e,t,r,n))};this.setScissorTest=function(e){ve.setScissorTest(se=e)};this.getClearColor=function(){return te};this.setClearColor=function(e,r){te.set(e);re=void 0!==r?r:1;t(te.r,te.g,te.b,re)};this.getClearAlpha=function(){return re};this.setClearAlpha=function(e){re=e;t(te.r,te.g,te.b,re)};this.clear=function(e,t,r){var n=0;if(void 0===e||e)n|=me.COLOR_BUFFER_BIT;if(void 0===t||t)n|=me.DEPTH_BUFFER_BIT;if(void 0===r||r)n|=me.STENCIL_BUFFER_BIT;me.clear(n)};this.clearColor=function(){this.clear(!0,!1,!1)};this.clearDepth=function(){this.clear(!1,!0,!1)};this.clearStencil=function(){this.clear(!1,!1,!0)};this.clearTarget=function(e,t,r,n){this.setRenderTarget(e);this.clear(t,r,n)};this.resetGLState=n;this.dispose=function(){M.removeEventListener("webglcontextlost",i,!1)};this.renderBufferImmediate=function(e,t,r){ve.initAttributes();var n=ye.get(e);e.hasPositions&&!n.position&&(n.position=me.createBuffer());e.hasNormals&&!n.normal&&(n.normal=me.createBuffer());e.hasUvs&&!n.uv&&(n.uv=me.createBuffer());e.hasColors&&!n.color&&(n.color=me.createBuffer());t=t.getAttributes();e.hasPositions&&(me.bindBuffer(me.ARRAY_BUFFER,n.position),me.bufferData(me.ARRAY_BUFFER,e.positionArray,me.DYNAMIC_DRAW),ve.enableAttribute(t.position),me.vertexAttribPointer(t.position,3,me.FLOAT,!1,0,0));if(e.hasNormals){me.bindBuffer(me.ARRAY_BUFFER,n.normal);if("MeshPhongMaterial"!==r.type&&"MeshStandardMaterial"!==r.type&&r.shading===THREE.FlatShading)for(var i=0,o=3*e.count;i<o;i+=9){var a=e.normalArray,s=(a[i+0]+a[i+3]+a[i+6])/3,c=(a[i+1]+a[i+4]+a[i+7])/3,u=(a[i+2]+a[i+5]+a[i+8])/3;a[i+0]=s;a[i+1]=c;a[i+2]=u;a[i+3]=s;a[i+4]=c;a[i+5]=u;a[i+6]=s;a[i+7]=c;a[i+8]=u}me.bufferData(me.ARRAY_BUFFER,e.normalArray,me.DYNAMIC_DRAW);ve.enableAttribute(t.normal);me.vertexAttribPointer(t.normal,3,me.FLOAT,!1,0,0)}e.hasUvs&&r.map&&(me.bindBuffer(me.ARRAY_BUFFER,n.uv),me.bufferData(me.ARRAY_BUFFER,e.uvArray,me.DYNAMIC_DRAW),ve.enableAttribute(t.uv),me.vertexAttribPointer(t.uv,2,me.FLOAT,!1,0,0));e.hasColors&&r.vertexColors!==THREE.NoColors&&(me.bindBuffer(me.ARRAY_BUFFER,n.color),me.bufferData(me.ARRAY_BUFFER,e.colorArray,me.DYNAMIC_DRAW),ve.enableAttribute(t.color),me.vertexAttribPointer(t.color,3,me.FLOAT,!1,0,0));ve.disableUnusedAttributes();me.drawArrays(me.TRIANGLES,0,e.count);e.count=0};this.renderBufferDirect=function(e,t,r,n,i,o){m(n);var a=E(e,t,n,i),s=!1;e=r.id+"_"+a.id+"_"+n.wireframe;e!==Y&&(Y=e,s=!0);t=i.morphTargetInfluences;if(void 0!==t){e=[];for(var c=0,s=t.length;c<s;c++){var l=t[c];e.push([l,c])}e.sort(u);8<e.length&&(e.length=8);for(var h=r.morphAttributes,c=0,s=e.length;c<s;c++)l=e[c],U[c]=l[0],0!==l[0]?(t=l[1],!0===n.morphTargets&&h.position&&r.addAttribute("morphTarget"+c,h.position[t]),!0===n.morphNormals&&h.normal&&r.addAttribute("morphNormal"+c,h.normal[t])):(!0===n.morphTargets&&r.removeAttribute("morphTarget"+c),!0===n.morphNormals&&r.removeAttribute("morphNormal"+c));e=a.getUniforms();null!==e.morphTargetInfluences&&me.uniform1fv(e.morphTargetInfluences,U);s=!0}t=r.index;c=r.attributes.position;!0===n.wireframe&&(t=be.getWireframeAttribute(r));null!==t?(e=xe,e.setIndex(t)):e=we;if(s){e:{var s=void 0,f;if(r instanceof THREE.InstancedBufferGeometry&&(f=Ee.get("ANGLE_instanced_arrays"),null===f)){console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");break e}void 0===s&&(s=0);ve.initAttributes();var l=r.attributes,a=a.getAttributes(),h=n.defaultAttributeValues,p;for(p in a){var d=a[p];if(0<=d){var g=l[p];if(void 0!==g){var v=g.itemSize,y=be.getAttributeBuffer(g);if(g instanceof THREE.InterleavedBufferAttribute){var b=g.data,T=b.stride,g=g.offset;b instanceof THREE.InstancedInterleavedBuffer?(ve.enableAttributeAndDivisor(d,b.meshPerAttribute,f),void 0===r.maxInstancedCount&&(r.maxInstancedCount=b.meshPerAttribute*b.count)):ve.enableAttribute(d);me.bindBuffer(me.ARRAY_BUFFER,y);me.vertexAttribPointer(d,v,me.FLOAT,!1,T*b.array.BYTES_PER_ELEMENT,(s*T+g)*b.array.BYTES_PER_ELEMENT)}else g instanceof THREE.InstancedBufferAttribute?(ve.enableAttributeAndDivisor(d,g.meshPerAttribute,f),void 0===r.maxInstancedCount&&(r.maxInstancedCount=g.meshPerAttribute*g.count)):ve.enableAttribute(d),me.bindBuffer(me.ARRAY_BUFFER,y),me.vertexAttribPointer(d,v,me.FLOAT,!1,0,s*v*4)}else if(void 0!==h&&(v=h[p],void 0!==v))switch(v.length){case 2:me.vertexAttrib2fv(d,v);break;case 3:me.vertexAttrib3fv(d,v);break;case 4:me.vertexAttrib4fv(d,v);break;default:me.vertexAttrib1fv(d,v)}}}ve.disableUnusedAttributes()}null!==t&&me.bindBuffer(me.ELEMENT_ARRAY_BUFFER,be.getAttributeBuffer(t))}f=Infinity;null!==t?f=t.count:void 0!==c&&(f=c.count);p=r.drawRange.start;t=r.drawRange.count;c=null!==o?o.start:0;s=null!==o?o.count:Infinity;o=Math.max(0,p,c);f=Math.min(0+f,p+t,c+s)-1;f=Math.max(0,f-o+1);if(i instanceof THREE.Mesh)if(!0===n.wireframe)ve.setLineWidth(n.wireframeLinewidth*(null===W?oe:1)),e.setMode(me.LINES);else switch(i.drawMode){case THREE.TrianglesDrawMode:e.setMode(me.TRIANGLES);break;case THREE.TriangleStripDrawMode:e.setMode(me.TRIANGLE_STRIP);break;case THREE.TriangleFanDrawMode:e.setMode(me.TRIANGLE_FAN)}else i instanceof THREE.Line?(n=n.linewidth,void 0===n&&(n=1),ve.setLineWidth(n*(null===W?oe:1)),i instanceof THREE.LineSegments?e.setMode(me.LINES):e.setMode(me.LINE_STRIP)):i instanceof THREE.Points&&e.setMode(me.POINTS);r instanceof THREE.InstancedBufferGeometry&&0<r.maxInstancedCount?e.renderInstances(r,o,f):e.render(o,f)};this.render=function(e,t,r,n){if(!1===t instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var i=e.fog;Y="";X=-1;K=null;!0===e.autoUpdate&&e.updateMatrixWorld();null===t.parent&&t.updateMatrixWorld();t.matrixWorldInverse.getInverse(t.matrixWorld);le.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse);ue.setFromMatrix(le);F.length=0;D=B=-1;$.length=0;V.length=0;p(e,t);I.length=B+1;j.length=D+1;!0===G.sortObjects&&(I.sort(l),j.sort(h));var o=F,a,s,c,u=0,f=0,m=0,E,g,v,y=t.matrixWorldInverse,b=0,R=0,w=0,x=0,H=0;a=fe.shadowsPointLight=0;for(s=o.length;a<s;a++)if(c=o[a],E=c.color,g=c.intensity,v=c.distance,c instanceof THREE.AmbientLight)u+=E.r*g,f+=E.g*g,m+=E.b*g;else if(c instanceof THREE.DirectionalLight){var _=Re.get(c);_.color.copy(c.color).multiplyScalar(c.intensity);_.direction.setFromMatrixPosition(c.matrixWorld);he.setFromMatrixPosition(c.target.matrixWorld);_.direction.sub(he);_.direction.transformDirection(y);if(_.shadow=c.castShadow)_.shadowBias=c.shadow.bias,_.shadowRadius=c.shadow.radius,_.shadowMapSize=c.shadow.mapSize,fe.shadows[H++]=c;fe.directionalShadowMap[b]=c.shadow.map;fe.directionalShadowMatrix[b]=c.shadow.matrix;fe.directional[b++]=_}else if(c instanceof THREE.SpotLight){_=Re.get(c);_.position.setFromMatrixPosition(c.matrixWorld);_.position.applyMatrix4(y);_.color.copy(E).multiplyScalar(g);_.distance=v;_.direction.setFromMatrixPosition(c.matrixWorld);he.setFromMatrixPosition(c.target.matrixWorld);_.direction.sub(he);_.direction.transformDirection(y);_.angleCos=Math.cos(c.angle);_.penumbra=Math.cos(c.angle)*c.penumbra;_.decay=0===c.distance?0:c.decay;if(_.shadow=c.castShadow)_.shadowBias=c.shadow.bias,_.shadowRadius=c.shadow.radius,_.shadowMapSize=c.shadow.mapSize,fe.shadows[H++]=c;fe.spotShadowMap[w]=c.shadow.map;fe.spotShadowMatrix[w]=c.shadow.matrix;fe.spot[w++]=_}else if(c instanceof THREE.PointLight){_=Re.get(c);_.position.setFromMatrixPosition(c.matrixWorld);_.position.applyMatrix4(y);_.color.copy(c.color).multiplyScalar(c.intensity);_.distance=c.distance;_.decay=0===c.distance?0:c.decay;if(_.shadow=c.castShadow)_.shadowBias=c.shadow.bias,_.shadowRadius=c.shadow.radius,_.shadowMapSize=c.shadow.mapSize,fe.shadows[H++]=c;fe.pointShadowMap[R]=c.shadow.map;void 0===fe.pointShadowMatrix[R]&&(fe.pointShadowMatrix[R]=new THREE.Matrix4);he.setFromMatrixPosition(c.matrixWorld).negate();fe.pointShadowMatrix[R].identity().setPosition(he);fe.point[R++]=_}else c instanceof THREE.HemisphereLight&&(_=Re.get(c),_.direction.setFromMatrixPosition(c.matrixWorld),_.direction.transformDirection(y),_.direction.normalize(),_.skyColor.copy(c.color).multiplyScalar(g),_.groundColor.copy(c.groundColor).multiplyScalar(g),fe.hemi[x++]=_);fe.ambient[0]=u;fe.ambient[1]=f;fe.ambient[2]=m;fe.directional.length=b;fe.spot.length=w;fe.point.length=R;fe.hemi.length=x;fe.shadows.length=H;fe.hash=b+","+R+","+w+","+x+","+H;He.render(e,t);de.calls=0;de.vertices=0;de.faces=0;de.points=0;void 0===r&&(r=null);this.setRenderTarget(r);(this.autoClear||n)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);e.overrideMaterial?(n=e.overrideMaterial,d(I,t,i,n),d(j,t,i,n)):(ve.setBlending(THREE.NoBlending),d(I,t,i),d(j,t,i));_e.render(e,t);Se.render(e,t,Z);r&&(e=r.texture,e.generateMipmaps&&T(r)&&e.minFilter!==THREE.NearestFilter&&e.minFilter!==THREE.LinearFilter&&(e=r instanceof THREE.WebGLRenderTargetCube?me.TEXTURE_CUBE_MAP:me.TEXTURE_2D,r=ye.get(r.texture).__webglTexture,ve.bindTexture(e,r),me.generateMipmap(e),ve.bindTexture(e,null)));ve.setDepthTest(!0);ve.setDepthWrite(!0);ve.setColorWrite(!0)}};this.setFaceCulling=function(e,t){e===THREE.CullFaceNone?ve.disable(me.CULL_FACE):(t===THREE.FrontFaceDirectionCW?me.frontFace(me.CW):me.frontFace(me.CCW),e===THREE.CullFaceBack?me.cullFace(me.BACK):e===THREE.CullFaceFront?me.cullFace(me.FRONT):me.cullFace(me.FRONT_AND_BACK),ve.enable(me.CULL_FACE))};this.setTexture=function(e,t){var r=ye.get(e);if(0<e.version&&r.__version!==e.version){var n=e.image;if(void 0===n)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else if(!1===n.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e);else{void 0===r.__webglInit&&(r.__webglInit=!0,e.addEventListener("dispose",o),r.__webglTexture=me.createTexture(),pe.textures++);ve.activeTexture(me.TEXTURE0+t);ve.bindTexture(me.TEXTURE_2D,r.__webglTexture);me.pixelStorei(me.UNPACK_FLIP_Y_WEBGL,e.flipY);me.pixelStorei(me.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha);me.pixelStorei(me.UNPACK_ALIGNMENT,e.unpackAlignment);var i=b(e.image,ge.maxTextureSize);if((e.wrapS!==THREE.ClampToEdgeWrapping||e.wrapT!==THREE.ClampToEdgeWrapping||e.minFilter!==THREE.NearestFilter&&e.minFilter!==THREE.LinearFilter)&&!1===T(i))if(n=i,n instanceof HTMLImageElement||n instanceof HTMLCanvasElement){var a=document.createElement("canvas");a.width=THREE.Math.nearestPowerOfTwo(n.width);a.height=THREE.Math.nearestPowerOfTwo(n.height);a.getContext("2d").drawImage(n,0,0,a.width,a.height);console.warn("THREE.WebGLRenderer: image is not power of two ("+n.width+"x"+n.height+"). Resized to "+a.width+"x"+a.height,n);i=a}else i=n;var n=T(i),a=S(e.format),s=S(e.type);y(me.TEXTURE_2D,e,n);var c=e.mipmaps;if(e instanceof THREE.DataTexture)if(0<c.length&&n){for(var u=0,l=c.length;u<l;u++)i=c[u],ve.texImage2D(me.TEXTURE_2D,u,a,i.width,i.height,0,a,s,i.data);e.generateMipmaps=!1}else ve.texImage2D(me.TEXTURE_2D,0,a,i.width,i.height,0,a,s,i.data);else if(e instanceof THREE.CompressedTexture)for(u=0,l=c.length;u<l;u++)i=c[u],e.format!==THREE.RGBAFormat&&e.format!==THREE.RGBFormat?-1<ve.getCompressedTextureFormats().indexOf(a)?ve.compressedTexImage2D(me.TEXTURE_2D,u,a,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ve.texImage2D(me.TEXTURE_2D,u,a,i.width,i.height,0,a,s,i.data);else if(0<c.length&&n){u=0;for(l=c.length;u<l;u++)i=c[u],ve.texImage2D(me.TEXTURE_2D,u,a,a,s,i);e.generateMipmaps=!1}else ve.texImage2D(me.TEXTURE_2D,0,a,a,s,i);e.generateMipmaps&&n&&me.generateMipmap(me.TEXTURE_2D);r.__version=e.version;if(e.onUpdate)e.onUpdate(e)}}else ve.activeTexture(me.TEXTURE0+t),ve.bindTexture(me.TEXTURE_2D,r.__webglTexture)};this.setRenderTarget=function(e){if((W=e)&&void 0===ye.get(e).__webglFramebuffer){var t=ye.get(e),r=ye.get(e.texture);e.addEventListener("dispose",a);r.__webglTexture=me.createTexture();pe.textures++;var n=e instanceof THREE.WebGLRenderTargetCube,i=THREE.Math.isPowerOfTwo(e.width)&&THREE.Math.isPowerOfTwo(e.height);if(n){t.__webglFramebuffer=[];for(var o=0;6>o;o++)t.__webglFramebuffer[o]=me.createFramebuffer()}else t.__webglFramebuffer=me.createFramebuffer();if(n){ve.bindTexture(me.TEXTURE_CUBE_MAP,r.__webglTexture);y(me.TEXTURE_CUBE_MAP,e.texture,i);for(o=0;6>o;o++)x(t.__webglFramebuffer[o],e,me.COLOR_ATTACHMENT0,me.TEXTURE_CUBE_MAP_POSITIVE_X+o);e.texture.generateMipmaps&&i&&me.generateMipmap(me.TEXTURE_CUBE_MAP);
ve.bindTexture(me.TEXTURE_CUBE_MAP,null)}else ve.bindTexture(me.TEXTURE_2D,r.__webglTexture),y(me.TEXTURE_2D,e.texture,i),x(t.__webglFramebuffer,e,me.COLOR_ATTACHMENT0,me.TEXTURE_2D),e.texture.generateMipmaps&&i&&me.generateMipmap(me.TEXTURE_2D),ve.bindTexture(me.TEXTURE_2D,null);if(e.depthBuffer){t=ye.get(e);if(e instanceof THREE.WebGLRenderTargetCube)for(t.__webglDepthbuffer=[],r=0;6>r;r++)me.bindFramebuffer(me.FRAMEBUFFER,t.__webglFramebuffer[r]),t.__webglDepthbuffer[r]=me.createRenderbuffer(),H(t.__webglDepthbuffer[r],e);else me.bindFramebuffer(me.FRAMEBUFFER,t.__webglFramebuffer),t.__webglDepthbuffer=me.createRenderbuffer(),H(t.__webglDepthbuffer,e);me.bindFramebuffer(me.FRAMEBUFFER,null)}}t=e instanceof THREE.WebGLRenderTargetCube;e?(r=ye.get(e),r=t?r.__webglFramebuffer[e.activeCubeFace]:r.__webglFramebuffer,Q.copy(e.scissor),J=e.scissorTest,Z.copy(e.viewport)):(r=null,Q.copy(ae).multiplyScalar(oe),J=se,Z.copy(ce).multiplyScalar(oe));q!==r&&(me.bindFramebuffer(me.FRAMEBUFFER,r),q=r);ve.scissor(Q);ve.setScissorTest(J);ve.viewport(Z);t&&(t=ye.get(e.texture),me.framebufferTexture2D(me.FRAMEBUFFER,me.COLOR_ATTACHMENT0,me.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,t.__webglTexture,0))};this.readRenderTargetPixels=function(e,t,r,n,i,o){if(!1===e instanceof THREE.WebGLRenderTarget)console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");else{var a=ye.get(e).__webglFramebuffer;if(a){var s=!1;a!==q&&(me.bindFramebuffer(me.FRAMEBUFFER,a),s=!0);try{var c=e.texture;c.format!==THREE.RGBAFormat&&S(c.format)!==me.getParameter(me.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):c.type===THREE.UnsignedByteType||S(c.type)===me.getParameter(me.IMPLEMENTATION_COLOR_READ_TYPE)||c.type===THREE.FloatType&&Ee.get("WEBGL_color_buffer_float")||c.type===THREE.HalfFloatType&&Ee.get("EXT_color_buffer_half_float")?me.checkFramebufferStatus(me.FRAMEBUFFER)===me.FRAMEBUFFER_COMPLETE?me.readPixels(t,r,n,i,S(c.format),S(c.type),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{s&&me.bindFramebuffer(me.FRAMEBUFFER,q)}}}}};THREE.WebGLRenderTarget=function(e,t,r){this.uuid=THREE.Math.generateUUID();this.width=e;this.height=t;this.scissor=new THREE.Vector4(0,0,e,t);this.scissorTest=!1;this.viewport=new THREE.Vector4(0,0,e,t);r=r||{};void 0===r.minFilter&&(r.minFilter=THREE.LinearFilter);this.texture=new THREE.Texture(void 0,void 0,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy);this.depthBuffer=void 0!==r.depthBuffer?r.depthBuffer:!0;this.stencilBuffer=void 0!==r.stencilBuffer?r.stencilBuffer:!0};THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,setSize:function(e,t){if(this.width!==e||this.height!==t)this.width=e,this.height=t,this.dispose();this.viewport.set(0,0,e,t);this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.width=e.width;this.height=e.height;this.viewport.copy(e.viewport);this.texture=e.texture.clone();this.depthBuffer=e.depthBuffer;this.stencilBuffer=e.stencilBuffer;this.shareDepthFrom=e.shareDepthFrom;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube=function(e,t,r){THREE.WebGLRenderTarget.call(this,e,t,r);this.activeCubeFace=0};THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube;THREE.WebGLBufferRenderer=function(e,t,r){var n;this.setMode=function(e){n=e};this.render=function(t,i){e.drawArrays(n,t,i);r.calls++;r.vertices+=i;n===e.TRIANGLES&&(r.faces+=i/3)};this.renderInstances=function(i){var o=t.get("ANGLE_instanced_arrays");if(null===o)console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{var a=i.attributes.position,s=0,s=a instanceof THREE.InterleavedBufferAttribute?a.data.count:a.count;o.drawArraysInstancedANGLE(n,0,s,i.maxInstancedCount);r.calls++;r.vertices+=s*i.maxInstancedCount;n===e.TRIANGLES&&(r.faces+=i.maxInstancedCount*s/3)}}};THREE.WebGLIndexedBufferRenderer=function(e,t,r){var n,i,o;this.setMode=function(e){n=e};this.setIndex=function(r){r.array instanceof Uint32Array&&t.get("OES_element_index_uint")?(i=e.UNSIGNED_INT,o=4):(i=e.UNSIGNED_SHORT,o=2)};this.render=function(t,a){e.drawElements(n,a,i,t*o);r.calls++;r.vertices+=a;n===e.TRIANGLES&&(r.faces+=a/3)};this.renderInstances=function(a,s,c){var u=t.get("ANGLE_instanced_arrays");null===u?console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(u.drawElementsInstancedANGLE(n,c,i,s*o,a.maxInstancedCount),r.calls++,r.vertices+=c*a.maxInstancedCount,n===e.TRIANGLES&&(r.faces+=a.maxInstancedCount*c/3))}};THREE.WebGLExtensions=function(e){var t={};this.get=function(r){if(void 0!==t[r])return t[r];var n;switch(r){case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":n=e.getExtension("WEBGL_compressed_texture_etc1");break;default:n=e.getExtension(r)}null===n&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported.");return t[r]=n}};THREE.WebGLCapabilities=function(e,t,r){function n(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision&&0<e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision&&0<e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision?"mediump":"lowp"}this.getMaxPrecision=n;this.precision=void 0!==r.precision?r.precision:"highp";this.logarithmicDepthBuffer=void 0!==r.logarithmicDepthBuffer?r.logarithmicDepthBuffer:!1;this.maxTextures=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.maxVertexTextures=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE);this.maxCubemapSize=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE);this.maxAttributes=e.getParameter(e.MAX_VERTEX_ATTRIBS);this.maxVertexUniforms=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS);this.maxVaryings=e.getParameter(e.MAX_VARYING_VECTORS);this.maxFragmentUniforms=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS);this.vertexTextures=0<this.maxVertexTextures;this.floatFragmentTextures=!!t.get("OES_texture_float");this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;r=n(this.precision);r!==this.precision&&(console.warn("THREE.WebGLRenderer:",this.precision,"not supported, using",r,"instead."),this.precision=r);this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!t.get("EXT_frag_depth"))};THREE.WebGLGeometries=function(e,t,r){function n(e){var a=e.target;e=o[a.id];null!==e.index&&i(e.index);var s=e.attributes,c;for(c in s)i(s[c]);a.removeEventListener("dispose",n);delete o[a.id];c=t.get(a);c.wireframe&&i(c.wireframe);t.delete(a);a=t.get(e);a.wireframe&&i(a.wireframe);t.delete(e);r.memory.geometries--}function i(r){var n;n=r instanceof THREE.InterleavedBufferAttribute?t.get(r.data).__webglBuffer:t.get(r).__webglBuffer;void 0!==n&&(e.deleteBuffer(n),r instanceof THREE.InterleavedBufferAttribute?t.delete(r.data):t.delete(r))}var o={};this.get=function(e){var t=e.geometry;if(void 0!==o[t.id])return o[t.id];t.addEventListener("dispose",n);var i;t instanceof THREE.BufferGeometry?i=t:t instanceof THREE.Geometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new THREE.BufferGeometry).setFromObject(e)),i=t._bufferGeometry);o[t.id]=i;r.memory.geometries++;return i}};THREE.WebGLLights=function(){var e={};this.get=function(t){if(void 0!==e[t.id])return e[t.id];var r;switch(t.type){case"DirectionalLight":r={direction:new THREE.Vector3,color:new THREE.Color,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2};break;case"SpotLight":r={position:new THREE.Vector3,direction:new THREE.Vector3,color:new THREE.Color,distance:0,angleCos:0,penumbra:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2};break;case"PointLight":r={position:new THREE.Vector3,color:new THREE.Color,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2};break;case"HemisphereLight":r={direction:new THREE.Vector3,skyColor:new THREE.Color,groundColor:new THREE.Color}}return e[t.id]=r}};THREE.WebGLObjects=function(e,t,r){function n(r,n){var i=r instanceof THREE.InterleavedBufferAttribute?r.data:r,o=t.get(i);void 0===o.__webglBuffer?(o.__webglBuffer=e.createBuffer(),e.bindBuffer(n,o.__webglBuffer),e.bufferData(n,i.array,i.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW),o.version=i.version):o.version!==i.version&&(e.bindBuffer(n,o.__webglBuffer),!1===i.dynamic||-1===i.updateRange.count?e.bufferSubData(n,0,i.array):0===i.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(n,i.updateRange.offset*i.array.BYTES_PER_ELEMENT,i.array.subarray(i.updateRange.offset,i.updateRange.offset+i.updateRange.count)),i.updateRange.count=0),o.version=i.version)}function i(e,t,r){if(t>r){var n=t;t=r;r=n}n=e[t];return void 0===n?(e[t]=[r],!0):-1===n.indexOf(r)?(n.push(r),!0):!1}var o=new THREE.WebGLGeometries(e,t,r);this.getAttributeBuffer=function(e){return e instanceof THREE.InterleavedBufferAttribute?t.get(e.data).__webglBuffer:t.get(e).__webglBuffer};this.getWireframeAttribute=function(r){var o=t.get(r);if(void 0!==o.wireframe)return o.wireframe;var a=[],s=r.index,c=r.attributes;r=c.position;if(null!==s)for(var c={},s=s.array,u=0,l=s.length;u<l;u+=3){var h=s[u+0],f=s[u+1],p=s[u+2];i(c,h,f)&&a.push(h,f);i(c,f,p)&&a.push(f,p);i(c,p,h)&&a.push(p,h)}else for(s=c.position.array,u=0,l=s.length/3-1;u<l;u+=3)h=u+0,f=u+1,p=u+2,a.push(h,f,f,p,p,h);a=new THREE.BufferAttribute(new(65535<r.count?Uint32Array:Uint16Array)(a),1);n(a,e.ELEMENT_ARRAY_BUFFER);return o.wireframe=a};this.update=function(t){var r=o.get(t);t.geometry instanceof THREE.Geometry&&r.updateFromObject(t);t=r.index;var i=r.attributes;null!==t&&n(t,e.ELEMENT_ARRAY_BUFFER);for(var a in i)n(i[a],e.ARRAY_BUFFER);t=r.morphAttributes;for(a in t)for(var i=t[a],s=0,c=i.length;s<c;s++)n(i[s],e.ARRAY_BUFFER);return r}};THREE.WebGLProgram=function(){function e(e,t,n){e=e||{};return[e.derivatives||t.bumpMap||t.normalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(r).join("\n")}function t(e){var t=[],r;for(r in e){var n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}function r(e){return""!==e}function n(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function i(e){return e.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,r,n){e="";for(t=parseInt(t);t<parseInt(r);t++)e+=n.replace(/\[ i \]/g,"[ "+t+" ]");return e})}var o=0,a=/^([\w\d_]+)\.([\w\d_]+)$/,s=/^([\w\d_]+)\[(\d+)\]\.([\w\d_]+)$/,c=/^([\w\d_]+)\[0\]$/;return function(u,l,h,f){var p=u.context,d=h.extensions,m=h.defines,E=h.__webglShader.vertexShader,g=h.__webglShader.fragmentShader,v="SHADOWMAP_TYPE_BASIC";f.shadowMapType===THREE.PCFShadowMap?v="SHADOWMAP_TYPE_PCF":f.shadowMapType===THREE.PCFSoftShadowMap&&(v="SHADOWMAP_TYPE_PCF_SOFT");var y="ENVMAP_TYPE_CUBE",b="ENVMAP_MODE_REFLECTION",T="ENVMAP_BLENDING_MULTIPLY";if(f.envMap){switch(h.envMap.mapping){case THREE.CubeReflectionMapping:case THREE.CubeRefractionMapping:y="ENVMAP_TYPE_CUBE";break;case THREE.EquirectangularReflectionMapping:case THREE.EquirectangularRefractionMapping:y="ENVMAP_TYPE_EQUIREC";break;case THREE.SphericalReflectionMapping:y="ENVMAP_TYPE_SPHERE"}switch(h.envMap.mapping){case THREE.CubeRefractionMapping:case THREE.EquirectangularRefractionMapping:b="ENVMAP_MODE_REFRACTION"}switch(h.combine){case THREE.MultiplyOperation:T="ENVMAP_BLENDING_MULTIPLY";break;case THREE.MixOperation:T="ENVMAP_BLENDING_MIX";break;case THREE.AddOperation:T="ENVMAP_BLENDING_ADD"}}var R=0<u.gammaFactor?u.gammaFactor:1,d=e(d,f,u.extensions),w=t(m),x=p.createProgram();h instanceof THREE.RawShaderMaterial?u=m="":(m=["precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+h.__webglShader.name,w,f.supportsVertexTextures?"#define VERTEX_TEXTURES":"",u.gammaInput?"#define GAMMA_INPUT":"",u.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+R,"#define MAX_BONES "+f.maxBones,f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+b:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.displacementMap&&f.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.flatShading?"#define FLAT_SHADED":"",f.skinning?"#define USE_SKINNING":"",f.useVertexTexture?"#define BONE_TEXTURE":"",f.morphTargets?"#define USE_MORPHTARGETS":"",f.morphNormals&&!1===f.flatShading?"#define USE_MORPHNORMALS":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+v:"",0<f.pointLightShadows?"#define POINT_LIGHT_SHADOWS":"",f.sizeAttenuation?"#define USE_SIZEATTENUATION":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&u.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(r).join("\n"),u=[d,"precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+h.__webglShader.name,w,f.alphaTest?"#define ALPHATEST "+f.alphaTest:"",u.gammaInput?"#define GAMMA_INPUT":"",u.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+R,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+y:"",f.envMap?"#define "+b:"",f.envMap?"#define "+T:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.flatShading?"#define FLAT_SHADED":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+v:"",0<f.pointLightShadows?"#define POINT_LIGHT_SHADOWS":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&u.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",f.envMap&&u.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","\n"].filter(r).join("\n"));E=n(E,f);g=n(g,f);!1===h instanceof THREE.ShaderMaterial&&(E=i(E),g=i(g));g=u+g;E=THREE.WebGLShader(p,p.VERTEX_SHADER,m+E);g=THREE.WebGLShader(p,p.FRAGMENT_SHADER,g);p.attachShader(x,E);p.attachShader(x,g);void 0!==h.index0AttributeName?p.bindAttribLocation(x,0,h.index0AttributeName):!0===f.morphTargets&&p.bindAttribLocation(x,0,"position");p.linkProgram(x);f=p.getProgramInfoLog(x);v=p.getShaderInfoLog(E);y=p.getShaderInfoLog(g);T=b=!0;if(!1===p.getProgramParameter(x,p.LINK_STATUS))b=!1,console.error("THREE.WebGLProgram: shader error: ",p.getError(),"gl.VALIDATE_STATUS",p.getProgramParameter(x,p.VALIDATE_STATUS),"gl.getProgramInfoLog",f,v,y);else if(""!==f)console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",f);else if(""===v||""===y)T=!1;T&&(this.diagnostics={runnable:b,material:h,programLog:f,vertexShader:{log:v,prefix:m},fragmentShader:{log:y,prefix:u}});p.deleteShader(E);p.deleteShader(g);var H;this.getUniforms=function(){if(void 0===H){for(var e={},t=p.getProgramParameter(x,p.ACTIVE_UNIFORMS),r=0;r<t;r++){var n=p.getActiveUniform(x,r).name,i=p.getUniformLocation(x,n),o=a.exec(n);if(o){var n=o[1],o=o[2],u=e[n];u||(u=e[n]={});u[o]=i}else if(o=s.exec(n)){var u=o[1],n=o[2],o=o[3],l=e[u];l||(l=e[u]=[]);(u=l[n])||(u=l[n]={});u[o]=i}else(o=c.exec(n))?(u=o[1],e[u]=i):e[n]=i}H=e}return H};var _;this.getAttributes=function(){if(void 0===_){for(var e={},t=p.getProgramParameter(x,p.ACTIVE_ATTRIBUTES),r=0;r<t;r++){var n=p.getActiveAttrib(x,r).name;e[n]=p.getAttribLocation(x,n)}_=e}return _};this.destroy=function(){p.deleteProgram(x);this.program=void 0};Object.defineProperties(this,{uniforms:{get:function(){console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms().");return this.getUniforms()}},attributes:{get:function(){console.warn("THREE.WebGLProgram: .attributes is now .getAttributes().");return this.getAttributes()}}});this.id=o++;this.code=l;this.usedTimes=1;this.program=x;this.vertexShader=E;this.fragmentShader=g;return this}}();THREE.WebGLPrograms=function(e,t){var r=[],n={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"standard",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},i="precision supportsVertexTextures map envMap envMapMode lightMap aoMap emissiveMap bumpMap normalMap displacementMap specularMap roughnessMap metalnessMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals numDirLights numPointLights numSpotLights numHemiLights shadowMapEnabled pointLightShadows shadowMapType alphaTest doubleSided flipSided".split(" ");this.getParameters=function(r,i,o,a){var s=n[r.type],c;t.floatVertexTextures&&a&&a.skeleton&&a.skeleton.useVertexTexture?c=1024:(c=Math.floor((t.maxVertexUniforms-20)/4),void 0!==a&&a instanceof THREE.SkinnedMesh&&(c=Math.min(a.skeleton.bones.length,c),c<a.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+a.skeleton.bones.length+", this GPU supports just "+c+" (try OpenGL instead of ANGLE)")));var u=e.getPrecision();null!==r.precision&&(u=t.getMaxPrecision(r.precision),u!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",u,"instead."));return{shaderID:s,precision:u,supportsVertexTextures:t.vertexTextures,map:!!r.map,envMap:!!r.envMap,envMapMode:r.envMap&&r.envMap.mapping,lightMap:!!r.lightMap,aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,combine:r.combine,vertexColors:r.vertexColors,fog:o,useFog:r.fog,fogExp:o instanceof THREE.FogExp2,flatShading:r.shading===THREE.FlatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:t.logarithmicDepthBuffer,skinning:r.skinning,maxBones:c,useVertexTexture:t.floatVertexTextures&&a&&a.skeleton&&a.skeleton.useVertexTexture,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:i.directional.length,numPointLights:i.point.length,numSpotLights:i.spot.length,numHemiLights:i.hemi.length,pointLightShadows:i.shadowsPointLight,shadowMapEnabled:e.shadowMap.enabled&&a.receiveShadow&&0<i.shadows.length,shadowMapType:e.shadowMap.type,alphaTest:r.alphaTest,doubleSided:r.side===THREE.DoubleSide,flipSided:r.side===THREE.BackSide}};this.getProgramCode=function(e,t){var r=[];t.shaderID?r.push(t.shaderID):(r.push(e.fragmentShader),r.push(e.vertexShader));if(void 0!==e.defines)for(var n in e.defines)r.push(n),r.push(e.defines[n]);for(n=0;n<i.length;n++){var o=i[n];r.push(o);r.push(t[o])}return r.join()};this.acquireProgram=function(t,n,i){for(var o,a=0,s=r.length;a<s;a++){var c=r[a];if(c.code===i){o=c;++o.usedTimes;break}}void 0===o&&(o=new THREE.WebGLProgram(e,i,t,n),r.push(o));return o};this.releaseProgram=function(e){if(0===--e.usedTimes){var t=r.indexOf(e);r[t]=r[r.length-1];r.pop();e.destroy()}};this.programs=r};THREE.WebGLProperties=function(){var e={};this.get=function(t){t=t.uuid;var r=e[t];void 0===r&&(r={},e[t]=r);return r};this.delete=function(t){delete e[t.uuid]};this.clear=function(){e={}}};THREE.WebGLShader=function(){function e(e){e=e.split("\n");for(var t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}return function(t,r,n){var i=t.createShader(r);t.shaderSource(i,n);t.compileShader(i);!1===t.getShaderParameter(i,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile.");""!==t.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",r===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(i),e(n));return i}}();THREE.WebGLShadowMap=function(e,t,r){function n(e,t,r,n){var i=e.geometry,o=null,o=p,a=e.customDepthMaterial;r&&(o=d,a=e.customDistanceMaterial);a?o=a:(e=e instanceof THREE.SkinnedMesh&&t.skinning,a=0,void 0!==i.morphTargets&&0<i.morphTargets.length&&t.morphTargets&&(a|=1),e&&(a|=2),o=o[a]);o.visible=t.visible;o.wireframe=t.wireframe;o.wireframeLinewidth=t.wireframeLinewidth;r&&void 0!==o.uniforms.lightPos&&o.uniforms.lightPos.value.copy(n);return o}function i(e,t,r){if(!1!==e.visible){e.layers.test(t.layers)&&(e instanceof THREE.Mesh||e instanceof THREE.Line||e instanceof THREE.Points)&&e.castShadow&&(!1===e.frustumCulled||!0===s.intersectsObject(e))&&!0===e.material.visible&&(e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),f.push(e));e=e.children;for(var n=0,o=e.length;n<o;n++)i(e[n],t,r)}}for(var o=e.context,a=e.state,s=new THREE.Frustum,c=new THREE.Matrix4,u=new THREE.Vector2,l=new THREE.Vector3,h=new THREE.Vector3,f=[],p=Array(4),d=Array(4),m=[new THREE.Vector3(1,0,0),new THREE.Vector3(-1,0,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,-1),new THREE.Vector3(0,1,0),new THREE.Vector3(0,-1,0)],E=[new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,-1)],g=[new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4],v=THREE.ShaderLib.depthRGBA,y=THREE.UniformsUtils.clone(v.uniforms),b=THREE.ShaderLib.distanceRGBA,T=THREE.UniformsUtils.clone(b.uniforms),R=0;4!==R;++R){var w=0!==(R&1),x=0!==(R&2),H=new THREE.ShaderMaterial({uniforms:y,vertexShader:v.vertexShader,fragmentShader:v.fragmentShader,morphTargets:w,skinning:x});H._shadowPass=!0;p[R]=H;w=new THREE.ShaderMaterial({uniforms:T,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,morphTargets:w,skinning:x});w._shadowPass=!0;d[R]=w}var _=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=THREE.PCFShadowMap;this.cullFace=THREE.CullFaceFront;this.render=function(p,d){var v,y;if(!1!==_.enabled&&(!1!==_.autoUpdate||!1!==_.needsUpdate)){a.clearColor(1,1,1,1);a.disable(o.BLEND);a.enable(o.CULL_FACE);o.frontFace(o.CCW);o.cullFace(_.cullFace===THREE.CullFaceFront?o.FRONT:o.BACK);a.setDepthTest(!0);a.setScissorTest(!1);for(var b=t.shadows,T=0,R=b.length;T<R;T++){var w=b[T],x=w.shadow,H=x.camera;u.copy(x.mapSize);if(w instanceof THREE.PointLight){v=6;y=!0;var S=u.x,M=u.y;g[0].set(2*S,M,S,M);g[1].set(0,M,S,M);g[2].set(3*S,M,S,M);g[3].set(S,M,S,M);g[4].set(3*S,0,S,M);g[5].set(S,0,S,M);u.x*=4;u.y*=2}else v=1,y=!1;null===x.map&&(x.map=new THREE.WebGLRenderTarget(u.x,u.y,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat}),w instanceof THREE.SpotLight&&(H.aspect=u.x/u.y),H.updateProjectionMatrix());S=x.map;x=x.matrix;h.setFromMatrixPosition(w.matrixWorld);H.position.copy(h);e.setRenderTarget(S);e.clear();for(S=0;S<v;S++){y?(l.copy(H.position),l.add(m[S]),H.up.copy(E[S]),H.lookAt(l),a.viewport(g[S])):(l.setFromMatrixPosition(w.target.matrixWorld),H.lookAt(l));H.updateMatrixWorld();H.matrixWorldInverse.getInverse(H.matrixWorld);x.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);x.multiply(H.projectionMatrix);x.multiply(H.matrixWorldInverse);c.multiplyMatrices(H.projectionMatrix,H.matrixWorldInverse);s.setFromMatrix(c);f.length=0;i(p,d,H);for(var M=0,A=f.length;M<A;M++){var C=f[M],k=r.update(C),L=C.material;if(L instanceof THREE.MultiMaterial)for(var P=k.groups,L=L.materials,O=0,N=P.length;O<N;O++){var F=P[O],I=L[F.materialIndex];!0===I.visible&&(I=n(C,I,y,h),e.renderBufferDirect(H,null,k,I,C,F))}else I=n(C,L,y,h),e.renderBufferDirect(H,null,k,I,C,null)}}e.resetGLState()}v=e.getClearColor();y=e.getClearAlpha();e.setClearColor(v,y);a.enable(o.BLEND);_.cullFace===THREE.CullFaceFront&&o.cullFace(o.BACK);e.resetGLState();_.needsUpdate=!1}}};THREE.WebGLState=function(e,t,r){var n=this,i=new THREE.Vector4,o=new Uint8Array(16),a=new Uint8Array(16),s=new Uint8Array(16),c={},u=null,l=null,h=null,f=null,p=null,d=null,m=null,E=null,g=null,v=null,y=null,b=null,T=null,R=null,w=null,x=null,H=null,_=null,S=null,M=null,A=null,C=null,k=null,L=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),P=void 0,O={},N=new THREE.Vector4,F=null,I=null,B=new THREE.Vector4,j=new THREE.Vector4;this.init=function(){this.clearColor(0,0,0,1);this.clearDepth(1);this.clearStencil(0);this.enable(e.DEPTH_TEST);e.depthFunc(e.LEQUAL);e.frontFace(e.CCW);e.cullFace(e.BACK);this.enable(e.CULL_FACE);this.enable(e.BLEND);e.blendEquation(e.FUNC_ADD);e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA)};this.initAttributes=function(){for(var e=0,t=o.length;e<t;e++)o[e]=0};this.enableAttribute=function(r){o[r]=1;0===a[r]&&(e.enableVertexAttribArray(r),a[r]=1);0!==s[r]&&(t.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(r,0),s[r]=0)};this.enableAttributeAndDivisor=function(t,r,n){o[t]=1;0===a[t]&&(e.enableVertexAttribArray(t),a[t]=1);s[t]!==r&&(n.vertexAttribDivisorANGLE(t,r),s[t]=r)};this.disableUnusedAttributes=function(){for(var t=0,r=a.length;t<r;t++)a[t]!==o[t]&&(e.disableVertexAttribArray(t),a[t]=0)};this.enable=function(t){!0!==c[t]&&(e.enable(t),c[t]=!0)};this.disable=function(t){!1!==c[t]&&(e.disable(t),c[t]=!1)};this.getCompressedTextureFormats=function(){if(null===u&&(u=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")))for(var r=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),n=0;n<r.length;n++)u.push(r[n]);return u};this.setBlending=function(t,n,i,o,a,s,c){t===THREE.NoBlending?this.disable(e.BLEND):this.enable(e.BLEND);t!==l&&(t===THREE.AdditiveBlending?(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)):t===THREE.SubtractiveBlending?(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR)):t===THREE.MultiplyBlending?(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR)):(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)),l=t);if(t===THREE.CustomBlending){a=a||n;s=s||i;c=c||o;if(n!==h||a!==d)e.blendEquationSeparate(r(n),r(a)),h=n,d=a;if(i!==f||o!==p||s!==m||c!==E)e.blendFuncSeparate(r(i),r(o),r(s),r(c)),f=i,p=o,m=s,E=c}else E=m=d=p=f=h=null};this.setDepthFunc=function(t){if(g!==t){if(t)switch(t){case THREE.NeverDepth:e.depthFunc(e.NEVER);break;case THREE.AlwaysDepth:e.depthFunc(e.ALWAYS);break;case THREE.LessDepth:e.depthFunc(e.LESS);break;case THREE.LessEqualDepth:e.depthFunc(e.LEQUAL);break;case THREE.EqualDepth:e.depthFunc(e.EQUAL);break;case THREE.GreaterEqualDepth:e.depthFunc(e.GEQUAL);break;case THREE.GreaterDepth:e.depthFunc(e.GREATER);break;case THREE.NotEqualDepth:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);g=t}};this.setDepthTest=function(t){t?this.enable(e.DEPTH_TEST):this.disable(e.DEPTH_TEST)};this.setDepthWrite=function(t){v!==t&&(e.depthMask(t),v=t)};this.setColorWrite=function(t){y!==t&&(e.colorMask(t,t,t,t),y=t)};this.setStencilFunc=function(t,r,n){if(T!==t||R!==r||w!==n)e.stencilFunc(t,r,n),T=t,R=r,w=n};this.setStencilOp=function(t,r,n){if(x!==t||H!==r||_!==n)e.stencilOp(t,r,n),x=t,H=r,_=n};this.setStencilTest=function(t){t?this.enable(e.STENCIL_TEST):this.disable(e.STENCIL_TEST)};this.setStencilWrite=function(t){b!==t&&(e.stencilMask(t),b=t)};this.setFlipSided=function(t){S!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),S=t)};this.setLineWidth=function(t){t!==M&&(e.lineWidth(t),M=t)};this.setPolygonOffset=function(t,r,n){t?this.enable(e.POLYGON_OFFSET_FILL):this.disable(e.POLYGON_OFFSET_FILL);!t||A===r&&C===n||(e.polygonOffset(r,n),A=r,C=n)};this.getScissorTest=function(){return k};this.setScissorTest=function(t){(k=t)?this.enable(e.SCISSOR_TEST):this.disable(e.SCISSOR_TEST)};this.activeTexture=function(t){void 0===t&&(t=e.TEXTURE0+L-1);P!==t&&(e.activeTexture(t),P=t)};this.bindTexture=function(t,r){void 0===P&&n.activeTexture();var i=O[P];void 0===i&&(i={type:void 0,texture:void 0},O[P]=i);if(i.type!==t||i.texture!==r)e.bindTexture(t,r),i.type=t,i.texture=r};this.compressedTexImage2D=function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error(e)}};this.texImage2D=function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error(e)}};this.clearColor=function(t,r,n,o){i.set(t,r,n,o);!1===N.equals(i)&&(e.clearColor(t,r,n,o),N.copy(i))};this.clearDepth=function(t){F!==t&&(e.clearDepth(t),F=t)};this.clearStencil=function(t){I!==t&&(e.clearStencil(t),I=t)};this.scissor=function(t){!1===B.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),B.copy(t))};this.viewport=function(t){!1===j.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),j.copy(t))};this.reset=function(){for(var t=0;t<a.length;t++)1===a[t]&&(e.disableVertexAttribArray(t),a[t]=0);c={};S=b=v=y=l=u=null}};THREE.LensFlarePlugin=function(e,t){
var r,n,i,o,a,s,c,u,l,h,f=e.context,p=e.state,d,m,E,g,v,y;this.render=function(b,T,R){if(0!==t.length){b=new THREE.Vector3;var w=R.w/R.z,x=.5*R.z,H=.5*R.w,_=16/R.w,S=new THREE.Vector2(_*w,_),M=new THREE.Vector3(1,1,0),A=new THREE.Vector2(1,1);if(void 0===E){var _=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),C=new Uint16Array([0,1,2,0,2,3]);d=f.createBuffer();m=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,d);f.bufferData(f.ARRAY_BUFFER,_,f.STATIC_DRAW);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,m);f.bufferData(f.ELEMENT_ARRAY_BUFFER,C,f.STATIC_DRAW);v=f.createTexture();y=f.createTexture();p.bindTexture(f.TEXTURE_2D,v);f.texImage2D(f.TEXTURE_2D,0,f.RGB,16,16,0,f.RGB,f.UNSIGNED_BYTE,null);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST);p.bindTexture(f.TEXTURE_2D,y);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,16,16,0,f.RGBA,f.UNSIGNED_BYTE,null);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST);var _=(g=0<f.getParameter(f.MAX_VERTEX_TEXTURE_IMAGE_UNITS))?{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},C=f.createProgram(),k=f.createShader(f.FRAGMENT_SHADER),L=f.createShader(f.VERTEX_SHADER),P="precision "+e.getPrecision()+" float;\n";f.shaderSource(k,P+_.fragmentShader);f.shaderSource(L,P+_.vertexShader);f.compileShader(k);f.compileShader(L);f.attachShader(C,k);f.attachShader(C,L);f.linkProgram(C);E=C;l=f.getAttribLocation(E,"position");h=f.getAttribLocation(E,"uv");r=f.getUniformLocation(E,"renderType");n=f.getUniformLocation(E,"map");i=f.getUniformLocation(E,"occlusionMap");o=f.getUniformLocation(E,"opacity");a=f.getUniformLocation(E,"color");s=f.getUniformLocation(E,"scale");c=f.getUniformLocation(E,"rotation");u=f.getUniformLocation(E,"screenPosition")}f.useProgram(E);p.initAttributes();p.enableAttribute(l);p.enableAttribute(h);p.disableUnusedAttributes();f.uniform1i(i,0);f.uniform1i(n,1);f.bindBuffer(f.ARRAY_BUFFER,d);f.vertexAttribPointer(l,2,f.FLOAT,!1,16,0);f.vertexAttribPointer(h,2,f.FLOAT,!1,16,8);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,m);p.disable(f.CULL_FACE);p.setDepthWrite(!1);C=0;for(k=t.length;C<k;C++)if(_=16/R.w,S.set(_*w,_),L=t[C],b.set(L.matrixWorld.elements[12],L.matrixWorld.elements[13],L.matrixWorld.elements[14]),b.applyMatrix4(T.matrixWorldInverse),b.applyProjection(T.projectionMatrix),M.copy(b),A.x=M.x*x+x,A.y=M.y*H+H,g||0<A.x&&A.x<R.z&&0<A.y&&A.y<R.w){p.activeTexture(f.TEXTURE0);p.bindTexture(f.TEXTURE_2D,null);p.activeTexture(f.TEXTURE1);p.bindTexture(f.TEXTURE_2D,v);f.copyTexImage2D(f.TEXTURE_2D,0,f.RGB,R.x+A.x-8,R.y+A.y-8,16,16,0);f.uniform1i(r,0);f.uniform2f(s,S.x,S.y);f.uniform3f(u,M.x,M.y,M.z);p.disable(f.BLEND);p.enable(f.DEPTH_TEST);f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0);p.activeTexture(f.TEXTURE0);p.bindTexture(f.TEXTURE_2D,y);f.copyTexImage2D(f.TEXTURE_2D,0,f.RGBA,R.x+A.x-8,R.y+A.y-8,16,16,0);f.uniform1i(r,1);p.disable(f.DEPTH_TEST);p.activeTexture(f.TEXTURE1);p.bindTexture(f.TEXTURE_2D,v);f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0);L.positionScreen.copy(M);L.customUpdateCallback?L.customUpdateCallback(L):L.updateLensFlares();f.uniform1i(r,2);p.enable(f.BLEND);for(var P=0,O=L.lensFlares.length;P<O;P++){var N=L.lensFlares[P];.001<N.opacity&&.001<N.scale&&(M.x=N.x,M.y=N.y,M.z=N.z,_=N.size*N.scale/R.w,S.x=_*w,S.y=_,f.uniform3f(u,M.x,M.y,M.z),f.uniform2f(s,S.x,S.y),f.uniform1f(c,N.rotation),f.uniform1f(o,N.opacity),f.uniform3f(a,N.color.r,N.color.g,N.color.b),p.setBlending(N.blending,N.blendEquation,N.blendSrc,N.blendDst),e.setTexture(N.texture,1),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0))}}p.enable(f.CULL_FACE);p.enable(f.DEPTH_TEST);p.setDepthWrite(!0);e.resetGLState()}}};THREE.SpritePlugin=function(e,t){var r,n,i,o,a,s,c,u,l,h,f,p,d,m,E,g,v;function y(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:t.id-e.id}var b=e.context,T=e.state,R,w,x,H,_=new THREE.Vector3,S=new THREE.Quaternion,M=new THREE.Vector3;this.render=function(A,C){if(0!==t.length){if(void 0===x){var k=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),L=new Uint16Array([0,1,2,0,2,3]);R=b.createBuffer();w=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,R);b.bufferData(b.ARRAY_BUFFER,k,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,w);b.bufferData(b.ELEMENT_ARRAY_BUFFER,L,b.STATIC_DRAW);var k=b.createProgram(),L=b.createShader(b.VERTEX_SHADER),P=b.createShader(b.FRAGMENT_SHADER);b.shaderSource(L,["precision "+e.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n"));b.shaderSource(P,["precision "+e.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n"));b.compileShader(L);b.compileShader(P);b.attachShader(k,L);b.attachShader(k,P);b.linkProgram(k);x=k;g=b.getAttribLocation(x,"position");v=b.getAttribLocation(x,"uv");r=b.getUniformLocation(x,"uvOffset");n=b.getUniformLocation(x,"uvScale");i=b.getUniformLocation(x,"rotation");o=b.getUniformLocation(x,"scale");a=b.getUniformLocation(x,"color");s=b.getUniformLocation(x,"map");c=b.getUniformLocation(x,"opacity");u=b.getUniformLocation(x,"modelViewMatrix");l=b.getUniformLocation(x,"projectionMatrix");h=b.getUniformLocation(x,"fogType");f=b.getUniformLocation(x,"fogDensity");p=b.getUniformLocation(x,"fogNear");d=b.getUniformLocation(x,"fogFar");m=b.getUniformLocation(x,"fogColor");E=b.getUniformLocation(x,"alphaTest");k=document.createElement("canvas");k.width=8;k.height=8;L=k.getContext("2d");L.fillStyle="white";L.fillRect(0,0,8,8);H=new THREE.Texture(k);H.needsUpdate=!0}b.useProgram(x);T.initAttributes();T.enableAttribute(g);T.enableAttribute(v);T.disableUnusedAttributes();T.disable(b.CULL_FACE);T.enable(b.BLEND);b.bindBuffer(b.ARRAY_BUFFER,R);b.vertexAttribPointer(g,2,b.FLOAT,!1,16,0);b.vertexAttribPointer(v,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,w);b.uniformMatrix4fv(l,!1,C.projectionMatrix.elements);T.activeTexture(b.TEXTURE0);b.uniform1i(s,0);L=k=0;(P=A.fog)?(b.uniform3f(m,P.color.r,P.color.g,P.color.b),P instanceof THREE.Fog?(b.uniform1f(p,P.near),b.uniform1f(d,P.far),b.uniform1i(h,1),L=k=1):P instanceof THREE.FogExp2&&(b.uniform1f(f,P.density),b.uniform1i(h,2),L=k=2)):(b.uniform1i(h,0),L=k=0);for(var P=0,O=t.length;P<O;P++){var N=t[P];N.modelViewMatrix.multiplyMatrices(C.matrixWorldInverse,N.matrixWorld);N.z=-N.modelViewMatrix.elements[14]}t.sort(y);for(var F=[],P=0,O=t.length;P<O;P++){var N=t[P],I=N.material;b.uniform1f(E,I.alphaTest);b.uniformMatrix4fv(u,!1,N.modelViewMatrix.elements);N.matrixWorld.decompose(_,S,M);F[0]=M.x;F[1]=M.y;N=0;A.fog&&I.fog&&(N=L);k!==N&&(b.uniform1i(h,N),k=N);null!==I.map?(b.uniform2f(r,I.map.offset.x,I.map.offset.y),b.uniform2f(n,I.map.repeat.x,I.map.repeat.y)):(b.uniform2f(r,0,0),b.uniform2f(n,1,1));b.uniform1f(c,I.opacity);b.uniform3f(a,I.color.r,I.color.g,I.color.b);b.uniform1f(i,I.rotation);b.uniform2fv(o,F);T.setBlending(I.blending,I.blendEquation,I.blendSrc,I.blendDst);T.setDepthTest(I.depthTest);T.setDepthWrite(I.depthWrite);I.map&&I.map.image&&I.map.image.width?e.setTexture(I.map,0):e.setTexture(H,0);b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0)}T.enable(b.CULL_FACE);e.resetGLState()}}};Object.defineProperties(THREE.Box2.prototype,{empty:{value:function(){console.warn("THREE.Box2: .empty() has been renamed to .isEmpty().");return this.isEmpty()}},isIntersectionBox:{value:function(e){console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(e)}}});Object.defineProperties(THREE.Box3.prototype,{empty:{value:function(){console.warn("THREE.Box3: .empty() has been renamed to .isEmpty().");return this.isEmpty()}},isIntersectionBox:{value:function(e){console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(e)}},isIntersectionSphere:{value:function(e){console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(e)}}});Object.defineProperties(THREE.Matrix3.prototype,{multiplyVector3:{value:function(e){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return e.applyMatrix3(this)}},multiplyVector3Array:{value:function(e){console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(e)}}});Object.defineProperties(THREE.Matrix4.prototype,{extractPosition:{value:function(e){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(e)}},setRotationFromQuaternion:{value:function(e){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");return this.makeRotationFromQuaternion(e)}},multiplyVector3:{value:function(e){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return e.applyProjection(this)}},multiplyVector4:{value:function(e){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)}},multiplyVector3Array:{value:function(e){console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(e)}},rotateAxis:{value:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");e.transformDirection(this)}},crossVector:{value:function(e){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return e.applyMatrix4(this)}},translate:{value:function(e){console.error("THREE.Matrix4: .translate() has been removed.")}},rotateX:{value:function(e){console.error("THREE.Matrix4: .rotateX() has been removed.")}},rotateY:{value:function(e){console.error("THREE.Matrix4: .rotateY() has been removed.")}},rotateZ:{value:function(e){console.error("THREE.Matrix4: .rotateZ() has been removed.")}},rotateByAxis:{value:function(e,t){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")}}});Object.defineProperties(THREE.Plane.prototype,{isIntersectionLine:{value:function(e){console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().");return this.intersectsLine(e)}}});Object.defineProperties(THREE.Quaternion.prototype,{multiplyVector3:{value:function(e){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return e.applyQuaternion(this)}}});Object.defineProperties(THREE.Ray.prototype,{isIntersectionBox:{value:function(e){console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(e)}},isIntersectionPlane:{value:function(e){console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().");return this.intersectsPlane(e)}},isIntersectionSphere:{value:function(e){console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(e)}}});Object.defineProperties(THREE.Vector3.prototype,{setEulerFromRotationMatrix:{value:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")}},setEulerFromQuaternion:{value:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")}},getPositionFromMatrix:{value:function(e){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(e)}},getScaleFromMatrix:{value:function(e){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(e)}},getColumnFromMatrix:{value:function(e,t){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(e,t)}}});THREE.Face4=function(e,t,r,n,i,o,a){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new THREE.Face3(e,t,r,i,o,a)};Object.defineProperties(THREE.Object3D.prototype,{eulerOrder:{get:function(){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");return this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");this.rotation.order=e}},getChildByName:{value:function(e){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(e)}},renderDepth:{set:function(e){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")}},translate:{value:function(e,t){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(t,e)}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(e){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});Object.defineProperties(THREE,{PointCloud:{value:function(e,t){console.warn("THREE.PointCloud has been renamed to THREE.Points.");return new THREE.Points(e,t)}},ParticleSystem:{value:function(e,t){console.warn("THREE.ParticleSystem has been renamed to THREE.Points.");return new THREE.Points(e,t)}}});Object.defineProperties(THREE.Light.prototype,{onlyShadow:{set:function(e){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov.");this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left.");this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right.");this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top.");this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.");this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near.");this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far.");this.shadow.camera.far=e}},shadowCameraVisible:{set:function(e){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias.");this.shadow.bias=e}},shadowDarkness:{set:function(e){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.");this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.");this.shadow.mapSize.height=e}}});Object.defineProperties(THREE.BufferAttribute.prototype,{length:{get:function(){console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count.");return this.array.length}}});Object.defineProperties(THREE.BufferGeometry.prototype,{drawcalls:{get:function(){console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups.");return this.groups}},offsets:{get:function(){console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups.");return this.groups}},addIndex:{value:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().");this.setIndex(e)}},addDrawCall:{value:function(e,t,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.");console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup().");this.addGroup(e,t)}},clearDrawCalls:{value:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().");this.clearGroups()}},computeTangents:{value:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")}},computeOffsets:{value:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}});Object.defineProperties(THREE.Material.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(e){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){console.warn("THREE."+this.type+": .wrapRGB has been removed.");return new THREE.Color}}});Object.defineProperties(THREE,{PointCloudMaterial:{value:function(e){console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.");return new THREE.PointsMaterial(e)}},ParticleBasicMaterial:{value:function(e){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.");return new THREE.PointsMaterial(e)}},ParticleSystemMaterial:{value:function(e){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.");return new THREE.PointsMaterial(e)}}});Object.defineProperties(THREE.MeshPhongMaterial.prototype,{metal:{get:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.");return!1},set:function(e){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});Object.defineProperties(THREE.ShaderMaterial.prototype,{derivatives:{get:function(){console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");return this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");this.extensions.derivatives=e}}});Object.defineProperties(THREE.WebGLRenderer.prototype,{supportsFloatTextures:{value:function(){console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).");return this.extensions.get("OES_texture_float")}},supportsHalfFloatTextures:{value:function(){console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).");return this.extensions.get("OES_texture_half_float")}},supportsStandardDerivatives:{value:function(){console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).");return this.extensions.get("OES_standard_derivatives")}},supportsCompressedTextureS3TC:{value:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).");return this.extensions.get("WEBGL_compressed_texture_s3tc")}},supportsCompressedTexturePVRTC:{value:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).");return this.extensions.get("WEBGL_compressed_texture_pvrtc")}},supportsBlendMinMax:{value:function(){console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).");return this.extensions.get("EXT_blend_minmax")}},supportsVertexTextures:{value:function(){return this.capabilities.vertexTextures}},supportsInstancedArrays:{value:function(){console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).");return this.extensions.get("ANGLE_instanced_arrays")}},enableScissorTest:{value:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().");this.setScissorTest(e)}},initMaterial:{value:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")}},addPrePlugin:{value:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")}},addPostPlugin:{value:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")}},updateShadowMap:{value:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}},shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.");this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.");this.shadowMap.type=e}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace.");this.shadowMap.cullFace=e}}});Object.defineProperties(THREE.WebGLRenderTarget.prototype,{wrapS:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");return this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");this.texture.wrapS=e}},wrapT:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");return this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");this.texture.wrapT=e}},magFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");return this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");this.texture.magFilter=e}},minFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");return this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");this.texture.minFilter=e}},anisotropy:{get:function(){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");return this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");this.texture.anisotropy=e}},offset:{get:function(){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");return this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");this.texture.offset=e}},repeat:{get:function(){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");return this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");this.texture.repeat=e}},format:{get:function(){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");return this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");this.texture.format=e}},type:{get:function(){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");return this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");this.texture.type=e}},generateMipmaps:{get:function(){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");return this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");this.texture.generateMipmaps=e}}});THREE.GeometryUtils={merge:function(e,t,r){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var n;t instanceof THREE.Mesh&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,t=t.geometry);e.merge(t,n,r)},center:function(e){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");return e.center()}};THREE.ImageUtils={crossOrigin:void 0,loadTexture:function(e,t,r,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new THREE.TextureLoader;i.setCrossOrigin(this.crossOrigin);e=i.load(e,r,void 0,n);t&&(e.mapping=t);return e},loadTextureCube:function(e,t,r,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new THREE.CubeTextureLoader;i.setCrossOrigin(this.crossOrigin);e=i.load(e,r,void 0,n);t&&(e.mapping=t);return e},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};THREE.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js.");this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project().");e.project(t)};this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");e.unproject(t)};this.pickingRay=function(e,t){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}};THREE.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js");this.domElement=document.createElement("canvas");this.clear=function(){};this.render=function(){};this.setClearColor=function(){};this.setSize=function(){}};THREE.MeshFaceMaterial=THREE.MultiMaterial;THREE.CurveUtils={tangentQuadraticBezier:function(e,t,r,n){return 2*(1-e)*(r-t)+2*e*(n-r)},tangentCubicBezier:function(e,t,r,n,i){return-3*t*(1-e)*(1-e)+3*r*(1-e)*(1-e)-6*e*r*(1-e)+6*e*n*(1-e)-3*e*e*n+3*e*e*i},tangentSpline:function(e,t,r,n,i){return 6*e*e-6*e+(3*e*e-4*e+1)+(-6*e*e+6*e)+(3*e*e-2*e)},interpolate:function(e,t,r,n,i){e=.5*(r-e);n=.5*(n-t);var o=i*i;return(2*t-2*r+e+n)*i*o+(-3*t+3*r-2*e-n)*o+e*i+t}};THREE.SceneUtils={createMultiMaterialObject:function(e,t){for(var r=new THREE.Group,n=0,i=t.length;n<i;n++)r.add(new THREE.Mesh(e,t[n]));return r},detach:function(e,t,r){e.applyMatrix(t.matrixWorld);t.remove(e);r.add(e)},attach:function(e,t,r){var n=new THREE.Matrix4;n.getInverse(r.matrixWorld);e.applyMatrix(n);t.remove(e);r.add(e)}};THREE.ShapeUtils={area:function(e){for(var t=e.length,r=0,n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return.5*r},triangulate:function(){return function(e,t){var r=e.length;if(3>r)return null;var n=[],i=[],o=[],a,s,c;if(0<THREE.ShapeUtils.area(e))for(s=0;s<r;s++)i[s]=s;else for(s=0;s<r;s++)i[s]=r-1-s;var u=2*r;for(s=r-1;2<r;){if(0>=u--){console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()");break}a=s;r<=a&&(a=0);s=a+1;r<=s&&(s=0);c=s+1;r<=c&&(c=0);var l;e:{var h=l=void 0,f=void 0,p=void 0,d=void 0,m=void 0,E=void 0,g=void 0,v=void 0,h=e[i[a]].x,f=e[i[a]].y,p=e[i[s]].x,d=e[i[s]].y,m=e[i[c]].x,E=e[i[c]].y;if(Number.EPSILON>(p-h)*(E-f)-(d-f)*(m-h))l=!1;else{var y=void 0,b=void 0,T=void 0,R=void 0,w=void 0,x=void 0,H=void 0,_=void 0,S=void 0,M=void 0,S=_=H=v=g=void 0,y=m-p,b=E-d,T=h-m,R=f-E,w=p-h,x=d-f;for(l=0;l<r;l++)if(g=e[i[l]].x,v=e[i[l]].y,!(g===h&&v===f||g===p&&v===d||g===m&&v===E)&&(H=g-h,_=v-f,S=g-p,M=v-d,g-=m,v-=E,S=y*M-b*S,H=w*_-x*H,_=T*v-R*g,S>=-Number.EPSILON&&_>=-Number.EPSILON&&H>=-Number.EPSILON)){l=!1;break e;
}l=!0}}if(l){n.push([e[i[a]],e[i[s]],e[i[c]]]);o.push([i[a],i[s],i[c]]);a=s;for(c=s+1;c<r;a++,c++)i[a]=i[c];r--;u=2*r}}return t?o:n}}(),triangulateShape:function(e,t){function r(e,t,r){return e.x!==t.x?e.x<t.x?e.x<=r.x&&r.x<=t.x:t.x<=r.x&&r.x<=e.x:e.y<t.y?e.y<=r.y&&r.y<=t.y:t.y<=r.y&&r.y<=e.y}function n(e,t,n,i,o){var a=t.x-e.x,s=t.y-e.y,c=i.x-n.x,u=i.y-n.y,l=e.x-n.x,h=e.y-n.y,f=s*c-a*u,p=s*l-a*h;if(Math.abs(f)>Number.EPSILON){if(0<f){if(0>p||p>f)return[];c=u*l-c*h;if(0>c||c>f)return[]}else{if(0<p||p<f)return[];c=u*l-c*h;if(0<c||c<f)return[]}if(0===c)return!o||0!==p&&p!==f?[e]:[];if(c===f)return!o||0!==p&&p!==f?[t]:[];if(0===p)return[n];if(p===f)return[i];o=c/f;return[{x:e.x+o*a,y:e.y+o*s}]}if(0!==p||u*l!==c*h)return[];s=0===a&&0===s;c=0===c&&0===u;if(s&&c)return e.x!==n.x||e.y!==n.y?[]:[e];if(s)return r(n,i,e)?[e]:[];if(c)return r(e,t,n)?[n]:[];0!==a?(e.x<t.x?(a=e,c=e.x,s=t,e=t.x):(a=t,c=t.x,s=e,e=e.x),n.x<i.x?(t=n,f=n.x,u=i,n=i.x):(t=i,f=i.x,u=n,n=n.x)):(e.y<t.y?(a=e,c=e.y,s=t,e=t.y):(a=t,c=t.y,s=e,e=e.y),n.y<i.y?(t=n,f=n.y,u=i,n=i.y):(t=i,f=i.y,u=n,n=n.y));return c<=f?e<f?[]:e===f?o?[]:[t]:e<=n?[t,s]:[t,u]:c>n?[]:c===n?o?[]:[a]:e<=n?[a,s]:[a,u]}function i(e,t,r,n){var i=t.x-e.x,o=t.y-e.y;t=r.x-e.x;r=r.y-e.y;var a=n.x-e.x;n=n.y-e.y;e=i*r-o*t;i=i*n-o*a;return Math.abs(e)>Number.EPSILON?(t=a*r-n*t,0<e?0<=i&&0<=t:0<=i||0<=t):0<i}var o,a,s,c,u,l={};s=e.concat();o=0;for(a=t.length;o<a;o++)Array.prototype.push.apply(s,t[o]);o=0;for(a=s.length;o<a;o++)u=s[o].x+":"+s[o].y,void 0!==l[u]&&console.warn("THREE.Shape: Duplicate point",u),l[u]=o;o=function(e,t){function r(e,t){var r=s.length-1,n=e-1;0>n&&(n=r);var o=e+1;o>r&&(o=0);r=i(s[e],s[n],s[o],c[t]);if(!r)return!1;r=c.length-1;n=t-1;0>n&&(n=r);o=t+1;o>r&&(o=0);return(r=i(c[t],c[n],c[o],s[e]))?!0:!1}function o(e,t){var r,i;for(r=0;r<s.length;r++)if(i=r+1,i%=s.length,i=n(e,t,s[r],s[i],!0),0<i.length)return!0;return!1}function a(e,r){var i,o,a,s;for(i=0;i<u.length;i++)for(o=t[u[i]],a=0;a<o.length;a++)if(s=a+1,s%=o.length,s=n(e,r,o[a],o[s],!0),0<s.length)return!0;return!1}var s=e.concat(),c,u=[],l,h,f,p,d,m=[],E,g,v,y=0;for(l=t.length;y<l;y++)u.push(y);E=0;for(var b=2*u.length;0<u.length;){b--;if(0>b){console.log("Infinite Loop! Holes left:"+u.length+", Probably Hole outside Shape!");break}for(h=E;h<s.length;h++){f=s[h];l=-1;for(y=0;y<u.length;y++)if(p=u[y],d=f.x+":"+f.y+":"+p,void 0===m[d]){c=t[p];for(g=0;g<c.length;g++)if(p=c[g],r(h,g)&&!o(f,p)&&!a(f,p)){l=g;u.splice(y,1);E=s.slice(0,h+1);p=s.slice(h);g=c.slice(l);v=c.slice(0,l+1);s=E.concat(g).concat(v).concat(p);E=h;break}if(0<=l)break;m[d]=!0}if(0<=l)break}}return s}(e,t);var h=THREE.ShapeUtils.triangulate(o,!1);o=0;for(a=h.length;o<a;o++)for(c=h[o],s=0;3>s;s++)u=c[s].x+":"+c[s].y,u=l[u],void 0!==u&&(c[s]=u);return h.concat()},isClockWise:function(e){return 0>THREE.ShapeUtils.area(e)},b2:function(){return function(e,t,r,n){var i=1-e;return i*i*t+2*(1-e)*e*r+e*e*n}}(),b3:function(){return function(e,t,r,n,i){var o=1-e,a=1-e;return o*o*o*t+3*a*a*e*r+3*(1-e)*e*e*n+e*e*e*i}}()};THREE.Curve=function(){};THREE.Curve.prototype={constructor:THREE.Curve,getPoint:function(e){console.warn("THREE.Curve: Warning, getPoint() not implemented!");return null},getPointAt:function(e){e=this.getUtoTmapping(e);return this.getPoint(e)},getPoints:function(e){e||(e=5);var t,r=[];for(t=0;t<=e;t++)r.push(this.getPoint(t/e));return r},getSpacedPoints:function(e){e||(e=5);var t,r=[];for(t=0;t<=e;t++)r.push(this.getPointAt(t/e));return r},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){e||(e=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t=[],r,n=this.getPoint(0),i,o=0;t.push(0);for(i=1;i<=e;i++)r=this.getPoint(i/e),o+=r.distanceTo(n),t.push(o),n=r;return this.cacheArcLengths=t},updateArcLengths:function(){this.needsUpdate=!0;this.getLengths()},getUtoTmapping:function(e,t){var r=this.getLengths(),n=0,i=r.length,o;o=t?t:e*r[i-1];for(var a=0,s=i-1,c;a<=s;)if(n=Math.floor(a+(s-a)/2),c=r[n]-o,0>c)a=n+1;else if(0<c)s=n-1;else{s=n;break}n=s;if(r[n]===o)return n/(i-1);a=r[n];return r=(n+(o-a)/(r[n+1]-a))/(i-1)},getTangent:function(e){var t=e-1e-4;e+=1e-4;0>t&&(t=0);1<e&&(e=1);t=this.getPoint(t);return this.getPoint(e).clone().sub(t).normalize()},getTangentAt:function(e){e=this.getUtoTmapping(e);return this.getTangent(e)}};THREE.Curve.create=function(e,t){e.prototype=Object.create(THREE.Curve.prototype);e.prototype.constructor=e;e.prototype.getPoint=t;return e};THREE.CurvePath=function(){this.curves=[];this.autoClose=!1};THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype);THREE.CurvePath.prototype.constructor=THREE.CurvePath;THREE.CurvePath.prototype.add=function(e){this.curves.push(e)};THREE.CurvePath.prototype.closePath=function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new THREE.LineCurve(t,e))};THREE.CurvePath.prototype.getPoint=function(e){for(var t=e*this.getLength(),r=this.getCurveLengths(),n=0;n<r.length;){if(r[n]>=t)return e=this.curves[n],t=1-(r[n]-t)/e.getLength(),e.getPointAt(t);n++}return null};THREE.CurvePath.prototype.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]};THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e};THREE.CurvePath.prototype.createPointsGeometry=function(e){e=this.getPoints(e);return this.createGeometry(e)};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(e){e=this.getSpacedPoints(e);return this.createGeometry(e)};THREE.CurvePath.prototype.createGeometry=function(e){for(var t=new THREE.Geometry,r=0,n=e.length;r<n;r++){var i=e[r];t.vertices.push(new THREE.Vector3(i.x,i.y,i.z||0))}return t};THREE.Font=function(e){this.data=e};THREE.Font.prototype={constructor:THREE.Font,generateShapes:function(e,t,r){void 0===t&&(t=100);void 0===r&&(r=4);var n=this.data;e=String(e).split("");var i=t/n.resolution,o=0;t=[];for(var a=0;a<e.length;a++){var s;s=i;var c=o,u=n.glyphs[e[a]]||n.glyphs["?"];if(u){var l=new THREE.Path,h=[],f=THREE.ShapeUtils.b2,p=THREE.ShapeUtils.b3,d=void 0,m=void 0,E=m=d=void 0,g=void 0,v=void 0,y=void 0,b=void 0,T=void 0,g=void 0;if(u.o)for(var R=u._cachedOutline||(u._cachedOutline=u.o.split(" ")),w=0,x=R.length;w<x;)switch(R[w++]){case"m":d=R[w++]*s+c;m=R[w++]*s;l.moveTo(d,m);break;case"l":d=R[w++]*s+c;m=R[w++]*s;l.lineTo(d,m);break;case"q":d=R[w++]*s+c;m=R[w++]*s;v=R[w++]*s+c;y=R[w++]*s;l.quadraticCurveTo(v,y,d,m);if(g=h[h.length-1])for(var E=g.x,g=g.y,H=1;H<=r;H++){var _=H/r;f(_,E,v,d);f(_,g,y,m)}break;case"b":if(d=R[w++]*s+c,m=R[w++]*s,v=R[w++]*s+c,y=R[w++]*s,b=R[w++]*s+c,T=R[w++]*s,l.bezierCurveTo(v,y,b,T,d,m),g=h[h.length-1])for(E=g.x,g=g.y,H=1;H<=r;H++)_=H/r,p(_,E,v,b,d),p(_,g,y,T,m)}s={offset:u.ha*s,path:l}}else s=void 0;o+=s.offset;t.push(s.path)}r=[];n=0;for(e=t.length;n<e;n++)Array.prototype.push.apply(r,t[n].toShapes());return r}};THREE.Path=function(e){THREE.CurvePath.call(this);this.actions=[];e&&this.fromPoints(e)};THREE.Path.prototype=Object.create(THREE.CurvePath.prototype);THREE.Path.prototype.constructor=THREE.Path;THREE.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y)};THREE.Path.prototype.moveTo=function(e,t){this.actions.push({action:"moveTo",args:[e,t]})};THREE.Path.prototype.lineTo=function(e,t){var r=this.actions[this.actions.length-1].args,r=new THREE.LineCurve(new THREE.Vector2(r[r.length-2],r[r.length-1]),new THREE.Vector2(e,t));this.curves.push(r);this.actions.push({action:"lineTo",args:[e,t]})};THREE.Path.prototype.quadraticCurveTo=function(e,t,r,n){var i=this.actions[this.actions.length-1].args,i=new THREE.QuadraticBezierCurve(new THREE.Vector2(i[i.length-2],i[i.length-1]),new THREE.Vector2(e,t),new THREE.Vector2(r,n));this.curves.push(i);this.actions.push({action:"quadraticCurveTo",args:[e,t,r,n]})};THREE.Path.prototype.bezierCurveTo=function(e,t,r,n,i,o){var a=this.actions[this.actions.length-1].args,a=new THREE.CubicBezierCurve(new THREE.Vector2(a[a.length-2],a[a.length-1]),new THREE.Vector2(e,t),new THREE.Vector2(r,n),new THREE.Vector2(i,o));this.curves.push(a);this.actions.push({action:"bezierCurveTo",args:[e,t,r,n,i,o]})};THREE.Path.prototype.splineThru=function(e){var t=Array.prototype.slice.call(arguments),r=this.actions[this.actions.length-1].args,r=[new THREE.Vector2(r[r.length-2],r[r.length-1])];Array.prototype.push.apply(r,e);r=new THREE.SplineCurve(r);this.curves.push(r);this.actions.push({action:"splineThru",args:t})};THREE.Path.prototype.arc=function(e,t,r,n,i,o){var a=this.actions[this.actions.length-1].args;this.absarc(e+a[a.length-2],t+a[a.length-1],r,n,i,o)};THREE.Path.prototype.absarc=function(e,t,r,n,i,o){this.absellipse(e,t,r,r,n,i,o)};THREE.Path.prototype.ellipse=function(e,t,r,n,i,o,a,s){var c=this.actions[this.actions.length-1].args;this.absellipse(e+c[c.length-2],t+c[c.length-1],r,n,i,o,a,s)};THREE.Path.prototype.absellipse=function(e,t,r,n,i,o,a,s){var c=[e,t,r,n,i,o,a,s||0];e=new THREE.EllipseCurve(e,t,r,n,i,o,a,s);this.curves.push(e);e=e.getPoint(1);c.push(e.x);c.push(e.y);this.actions.push({action:"ellipse",args:c})};THREE.Path.prototype.getSpacedPoints=function(e){e||(e=40);for(var t=[],r=0;r<e;r++)t.push(this.getPoint(r/e));this.autoClose&&t.push(t[0]);return t};THREE.Path.prototype.getPoints=function(e){e=e||12;for(var t=THREE.ShapeUtils.b2,r=THREE.ShapeUtils.b3,n=[],i,o,a,s,c,u,l,h,f,p,d=0,m=this.actions.length;d<m;d++){f=this.actions[d];var E=f.args;switch(f.action){case"moveTo":n.push(new THREE.Vector2(E[0],E[1]));break;case"lineTo":n.push(new THREE.Vector2(E[0],E[1]));break;case"quadraticCurveTo":i=E[2];o=E[3];c=E[0];u=E[1];0<n.length?(f=n[n.length-1],l=f.x,h=f.y):(f=this.actions[d-1].args,l=f[f.length-2],h=f[f.length-1]);for(E=1;E<=e;E++)p=E/e,f=t(p,l,c,i),p=t(p,h,u,o),n.push(new THREE.Vector2(f,p));break;case"bezierCurveTo":i=E[4];o=E[5];c=E[0];u=E[1];a=E[2];s=E[3];0<n.length?(f=n[n.length-1],l=f.x,h=f.y):(f=this.actions[d-1].args,l=f[f.length-2],h=f[f.length-1]);for(E=1;E<=e;E++)p=E/e,f=r(p,l,c,a,i),p=r(p,h,u,s,o),n.push(new THREE.Vector2(f,p));break;case"splineThru":f=this.actions[d-1].args;p=[new THREE.Vector2(f[f.length-2],f[f.length-1])];f=e*E[0].length;p=p.concat(E[0]);p=new THREE.SplineCurve(p);for(E=1;E<=f;E++)n.push(p.getPointAt(E/f));break;case"arc":i=E[0];o=E[1];u=E[2];a=E[3];f=E[4];c=!!E[5];l=f-a;h=2*e;for(E=1;E<=h;E++)p=E/h,c||(p=1-p),p=a+p*l,f=i+u*Math.cos(p),p=o+u*Math.sin(p),n.push(new THREE.Vector2(f,p));break;case"ellipse":i=E[0];o=E[1];u=E[2];s=E[3];a=E[4];f=E[5];c=!!E[6];var g=E[7];l=f-a;h=2*e;var v,y;0!==g&&(v=Math.cos(g),y=Math.sin(g));for(E=1;E<=h;E++){p=E/h;c||(p=1-p);p=a+p*l;f=i+u*Math.cos(p);p=o+s*Math.sin(p);if(0!==g){var b=f;f=(b-i)*v-(p-o)*y+i;p=(b-i)*y+(p-o)*v+o}n.push(new THREE.Vector2(f,p))}}}e=n[n.length-1];Math.abs(e.x-n[0].x)<Number.EPSILON&&Math.abs(e.y-n[0].y)<Number.EPSILON&&n.splice(n.length-1,1);this.autoClose&&n.push(n[0]);return n};THREE.Path.prototype.toShapes=function(e,t){function r(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r],o=new THREE.Shape;o.actions=i.actions;o.curves=i.curves;t.push(o)}return t}function n(e,t){for(var r=t.length,n=!1,i=r-1,o=0;o<r;i=o++){var a=t[i],s=t[o],c=s.x-a.x,u=s.y-a.y;if(Math.abs(u)>Number.EPSILON){if(0>u&&(a=t[o],c=-c,s=t[i],u=-u),!(e.y<a.y||e.y>s.y))if(e.y===a.y){if(e.x===a.x)return!0}else{i=u*(e.x-a.x)-c*(e.y-a.y);if(0===i)return!0;0>i||(n=!n)}}else if(e.y===a.y&&(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x))return!0}return n}var i=THREE.ShapeUtils.isClockWise,o=function(e){for(var t=[],r=new THREE.Path,n=0,i=e.length;n<i;n++){var o=e[n],a=o.args,o=o.action;"moveTo"===o&&0!==r.actions.length&&(t.push(r),r=new THREE.Path);r[o].apply(r,a)}0!==r.actions.length&&t.push(r);return t}(this.actions);if(0===o.length)return[];if(!0===t)return r(o);var a,s,c,u=[];if(1===o.length)return s=o[0],c=new THREE.Shape,c.actions=s.actions,c.curves=s.curves,u.push(c),u;var l=!i(o[0].getPoints()),l=e?!l:l;c=[];var h=[],f=[],p=0,d;h[p]=void 0;f[p]=[];for(var m=0,E=o.length;m<E;m++)s=o[m],d=s.getPoints(),a=i(d),(a=e?!a:a)?(!l&&h[p]&&p++,h[p]={s:new THREE.Shape,p:d},h[p].s.actions=s.actions,h[p].s.curves=s.curves,l&&p++,f[p]=[]):f[p].push({h:s,p:d[0]});if(!h[0])return r(o);if(1<h.length){m=!1;s=[];i=0;for(o=h.length;i<o;i++)c[i]=[];i=0;for(o=h.length;i<o;i++)for(a=f[i],l=0;l<a.length;l++){p=a[l];d=!0;for(E=0;E<h.length;E++)n(p.p,h[E].p)&&(i!==E&&s.push({froms:i,tos:E,hole:l}),d?(d=!1,c[E].push(p)):m=!0);d&&c[i].push(p)}0<s.length&&(m||(f=c))}m=0;for(i=h.length;m<i;m++)for(c=h[m].s,u.push(c),s=f[m],o=0,a=s.length;o<a;o++)c.holes.push(s[o].h);return u};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=Object.create(THREE.Path.prototype);THREE.Shape.prototype.constructor=THREE.Shape;THREE.Shape.prototype.extrude=function(e){return new THREE.ExtrudeGeometry(this,e)};THREE.Shape.prototype.makeGeometry=function(e){return new THREE.ShapeGeometry(this,e)};THREE.Shape.prototype.getPointsHoles=function(e){for(var t=[],r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t};THREE.Shape.prototype.extractAllPoints=function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}};THREE.Shape.prototype.extractPoints=function(e){return this.extractAllPoints(e)};THREE.LineCurve=function(e,t){this.v1=e;this.v2=t};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.LineCurve.prototype.constructor=THREE.LineCurve;THREE.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);t.multiplyScalar(e).add(this.v1);return t};THREE.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)};THREE.LineCurve.prototype.getTangent=function(e){return this.v2.clone().sub(this.v1).normalize()};THREE.QuadraticBezierCurve=function(e,t,r){this.v0=e;this.v1=t;this.v2=r};THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.QuadraticBezierCurve.prototype.constructor=THREE.QuadraticBezierCurve;THREE.QuadraticBezierCurve.prototype.getPoint=function(e){var t=THREE.ShapeUtils.b2;return new THREE.Vector2(t(e,this.v0.x,this.v1.x,this.v2.x),t(e,this.v0.y,this.v1.y,this.v2.y))};THREE.QuadraticBezierCurve.prototype.getTangent=function(e){var t=THREE.CurveUtils.tangentQuadraticBezier;return new THREE.Vector2(t(e,this.v0.x,this.v1.x,this.v2.x),t(e,this.v0.y,this.v1.y,this.v2.y)).normalize()};THREE.CubicBezierCurve=function(e,t,r,n){this.v0=e;this.v1=t;this.v2=r;this.v3=n};THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.CubicBezierCurve.prototype.constructor=THREE.CubicBezierCurve;THREE.CubicBezierCurve.prototype.getPoint=function(e){var t=THREE.ShapeUtils.b3;return new THREE.Vector2(t(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),t(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y))};THREE.CubicBezierCurve.prototype.getTangent=function(e){var t=THREE.CurveUtils.tangentCubicBezier;return new THREE.Vector2(t(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),t(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()};THREE.SplineCurve=function(e){this.points=void 0==e?[]:e};THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.SplineCurve.prototype.constructor=THREE.SplineCurve;THREE.SplineCurve.prototype.getPoint=function(e){var t=this.points;e*=t.length-1;var r=Math.floor(e);e-=r;var n=t[0===r?r:r-1],i=t[r],o=t[r>t.length-2?t.length-1:r+1],t=t[r>t.length-3?t.length-1:r+2],r=THREE.CurveUtils.interpolate;return new THREE.Vector2(r(n.x,i.x,o.x,t.x,e),r(n.y,i.y,o.y,t.y,e))};THREE.EllipseCurve=function(e,t,r,n,i,o,a,s){this.aX=e;this.aY=t;this.xRadius=r;this.yRadius=n;this.aStartAngle=i;this.aEndAngle=o;this.aClockwise=a;this.aRotation=s||0};THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);THREE.EllipseCurve.prototype.constructor=THREE.EllipseCurve;THREE.EllipseCurve.prototype.getPoint=function(e){var t=this.aEndAngle-this.aStartAngle;0>t&&(t+=2*Math.PI);t>2*Math.PI&&(t-=2*Math.PI);t=!0===this.aClockwise?this.aEndAngle+(1-e)*(2*Math.PI-t):this.aStartAngle+e*t;e=this.aX+this.xRadius*Math.cos(t);var r=this.aY+this.yRadius*Math.sin(t);if(0!==this.aRotation){var t=Math.cos(this.aRotation),n=Math.sin(this.aRotation),i=e;e=(i-this.aX)*t-(r-this.aY)*n+this.aX;r=(i-this.aX)*n+(r-this.aY)*t+this.aY}return new THREE.Vector2(e,r)};THREE.ArcCurve=function(e,t,r,n,i,o){THREE.EllipseCurve.call(this,e,t,r,r,n,i,o)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);THREE.ArcCurve.prototype.constructor=THREE.ArcCurve;THREE.LineCurve3=THREE.Curve.create(function(e,t){this.v1=e;this.v2=t},function(e){var t=new THREE.Vector3;t.subVectors(this.v2,this.v1);t.multiplyScalar(e);t.add(this.v1);return t});THREE.QuadraticBezierCurve3=THREE.Curve.create(function(e,t,r){this.v0=e;this.v1=t;this.v2=r},function(e){var t=THREE.ShapeUtils.b2;return new THREE.Vector3(t(e,this.v0.x,this.v1.x,this.v2.x),t(e,this.v0.y,this.v1.y,this.v2.y),t(e,this.v0.z,this.v1.z,this.v2.z))});THREE.CubicBezierCurve3=THREE.Curve.create(function(e,t,r,n){this.v0=e;this.v1=t;this.v2=r;this.v3=n},function(e){var t=THREE.ShapeUtils.b3;return new THREE.Vector3(t(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),t(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),t(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z))});THREE.SplineCurve3=THREE.Curve.create(function(e){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3");this.points=void 0==e?[]:e},function(e){var t=this.points;e*=t.length-1;var r=Math.floor(e);e-=r;var n=t[0==r?r:r-1],i=t[r],o=t[r>t.length-2?t.length-1:r+1],t=t[r>t.length-3?t.length-1:r+2],r=THREE.CurveUtils.interpolate;return new THREE.Vector3(r(n.x,i.x,o.x,t.x,e),r(n.y,i.y,o.y,t.y,e),r(n.z,i.z,o.z,t.z,e))});THREE.CatmullRomCurve3=function(){function e(){}var t=new THREE.Vector3,r=new e,n=new e,i=new e;e.prototype.init=function(e,t,r,n){this.c0=e;this.c1=r;this.c2=-3*e+3*t-2*r-n;this.c3=2*e-2*t+r+n};e.prototype.initNonuniformCatmullRom=function(e,t,r,n,i,o,a){e=((t-e)/i-(r-e)/(i+o)+(r-t)/o)*o;n=((r-t)/o-(n-t)/(o+a)+(n-r)/a)*o;this.init(t,r,e,n)};e.prototype.initCatmullRom=function(e,t,r,n,i){this.init(t,r,i*(r-e),i*(n-t))};e.prototype.calc=function(e){var t=e*e;return this.c0+this.c1*e+this.c2*t+this.c3*t*e};return THREE.Curve.create(function(e){this.points=e||[];this.closed=!1},function(e){var o=this.points,a,s;s=o.length;2>s&&console.log("duh, you need at least 2 points");e*=s-(this.closed?0:1);a=Math.floor(e);e-=a;this.closed?a+=0<a?0:(Math.floor(Math.abs(a)/o.length)+1)*o.length:0===e&&a===s-1&&(a=s-2,e=1);var c,u,l;this.closed||0<a?c=o[(a-1)%s]:(t.subVectors(o[0],o[1]).add(o[0]),c=t);u=o[a%s];l=o[(a+1)%s];this.closed||a+2<s?o=o[(a+2)%s]:(t.subVectors(o[s-1],o[s-2]).add(o[s-1]),o=t);if(void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var h="chordal"===this.type?.5:.25;s=Math.pow(c.distanceToSquared(u),h);a=Math.pow(u.distanceToSquared(l),h);h=Math.pow(l.distanceToSquared(o),h);1e-4>a&&(a=1);1e-4>s&&(s=a);1e-4>h&&(h=a);r.initNonuniformCatmullRom(c.x,u.x,l.x,o.x,s,a,h);n.initNonuniformCatmullRom(c.y,u.y,l.y,o.y,s,a,h);i.initNonuniformCatmullRom(c.z,u.z,l.z,o.z,s,a,h)}else"catmullrom"===this.type&&(s=void 0!==this.tension?this.tension:.5,r.initCatmullRom(c.x,u.x,l.x,o.x,s),n.initCatmullRom(c.y,u.y,l.y,o.y,s),i.initCatmullRom(c.z,u.z,l.z,o.z,s));return new THREE.Vector3(r.calc(e),n.calc(e),i.calc(e))})}();THREE.ClosedSplineCurve3=function(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3.");THREE.CatmullRomCurve3.call(this,e);this.type="catmullrom";this.closed=!0};THREE.ClosedSplineCurve3.prototype=Object.create(THREE.CatmullRomCurve3.prototype);THREE.BoxGeometry=function(e,t,r,n,i,o){function a(e,t,r,n,i,o,a,c){var u,l=s.widthSegments,h=s.heightSegments,f=i/2,p=o/2,d=s.vertices.length;if("x"===e&&"y"===t||"y"===e&&"x"===t)u="z";else if("x"===e&&"z"===t||"z"===e&&"x"===t)u="y",h=s.depthSegments;else if("z"===e&&"y"===t||"y"===e&&"z"===t)u="x",l=s.depthSegments;var m=l+1,E=h+1,g=i/l,v=o/h,y=new THREE.Vector3;y[u]=0<a?1:-1;for(i=0;i<E;i++)for(o=0;o<m;o++){var b=new THREE.Vector3;b[e]=(o*g-f)*r;b[t]=(i*v-p)*n;b[u]=a;s.vertices.push(b)}for(i=0;i<h;i++)for(o=0;o<l;o++)p=o+m*i,e=o+m*(i+1),t=o+1+m*(i+1),r=o+1+m*i,n=new THREE.Vector2(o/l,1-i/h),a=new THREE.Vector2(o/l,1-(i+1)/h),u=new THREE.Vector2((o+1)/l,1-(i+1)/h),f=new THREE.Vector2((o+1)/l,1-i/h),p=new THREE.Face3(p+d,e+d,r+d),p.normal.copy(y),p.vertexNormals.push(y.clone(),y.clone(),y.clone()),p.materialIndex=c,s.faces.push(p),s.faceVertexUvs[0].push([n,a,f]),p=new THREE.Face3(e+d,t+d,r+d),p.normal.copy(y),p.vertexNormals.push(y.clone(),y.clone(),y.clone()),p.materialIndex=c,s.faces.push(p),s.faceVertexUvs[0].push([a.clone(),u,f.clone()])}THREE.Geometry.call(this);this.type="BoxGeometry";this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:o};this.widthSegments=n||1;this.heightSegments=i||1;this.depthSegments=o||1;var s=this;n=e/2;i=t/2;o=r/2;a("z","y",-1,-1,r,t,n,0);a("z","y",1,-1,r,t,-n,1);a("x","z",1,1,e,r,i,2);a("x","z",1,-1,e,r,-i,3);a("x","y",1,-1,e,t,o,4);a("x","y",-1,-1,e,t,-o,5);this.mergeVertices()};THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.BoxGeometry.prototype.constructor=THREE.BoxGeometry;THREE.CubeGeometry=THREE.BoxGeometry;THREE.CircleGeometry=function(e,t,r,n){THREE.Geometry.call(this);this.type="CircleGeometry";this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n};this.fromBufferGeometry(new THREE.CircleBufferGeometry(e,t,r,n))};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CircleGeometry.prototype.constructor=THREE.CircleGeometry;THREE.CircleBufferGeometry=function(e,t,r,n){THREE.BufferGeometry.call(this);this.type="CircleBufferGeometry";this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n};e=e||50;t=void 0!==t?Math.max(3,t):8;r=void 0!==r?r:0;n=void 0!==n?n:2*Math.PI;var i=t+2,o=new Float32Array(3*i),a=new Float32Array(3*i),i=new Float32Array(2*i);a[2]=1;i[0]=.5;i[1]=.5;for(var s=0,c=3,u=2;s<=t;s++,c+=3,u+=2){var l=r+s/t*n;o[c]=e*Math.cos(l);o[c+1]=e*Math.sin(l);a[c+2]=1;i[u]=(o[c]/e+1)/2;i[u+1]=(o[c+1]/e+1)/2}r=[];for(c=1;c<=t;c++)r.push(c,c+1,0);this.setIndex(new THREE.BufferAttribute(new Uint16Array(r),1));this.addAttribute("position",new THREE.BufferAttribute(o,3));this.addAttribute("normal",new THREE.BufferAttribute(a,3));this.addAttribute("uv",new THREE.BufferAttribute(i,2));this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)};THREE.CircleBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.CircleBufferGeometry.prototype.constructor=THREE.CircleBufferGeometry;THREE.CylinderGeometry=function(e,t,r,n,i,o,a,s){THREE.Geometry.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};e=void 0!==e?e:20;t=void 0!==t?t:20;r=void 0!==r?r:100;n=n||8;i=i||1;o=void 0!==o?o:!1;a=void 0!==a?a:0;s=void 0!==s?s:2*Math.PI;var c=r/2,u,l,h=[],f=[];for(l=0;l<=i;l++){var p=[],d=[],m=l/i,E=m*(t-e)+e;for(u=0;u<=n;u++){var g=u/n,v=new THREE.Vector3;v.x=E*Math.sin(g*s+a);v.y=-m*r+c;v.z=E*Math.cos(g*s+a);this.vertices.push(v);p.push(this.vertices.length-1);d.push(new THREE.Vector2(g,1-m))}h.push(p);f.push(d)}r=(t-e)/r;for(u=0;u<n;u++)for(0!==e?(a=this.vertices[h[0][u]].clone(),s=this.vertices[h[0][u+1]].clone()):(a=this.vertices[h[1][u]].clone(),s=this.vertices[h[1][u+1]].clone()),a.setY(Math.sqrt(a.x*a.x+a.z*a.z)*r).normalize(),s.setY(Math.sqrt(s.x*s.x+s.z*s.z)*r).normalize(),l=0;l<i;l++){var p=h[l][u],d=h[l+1][u],m=h[l+1][u+1],E=h[l][u+1],g=a.clone(),v=a.clone(),y=s.clone(),b=s.clone(),T=f[l][u].clone(),R=f[l+1][u].clone(),w=f[l+1][u+1].clone(),x=f[l][u+1].clone();this.faces.push(new THREE.Face3(p,d,E,[g,v,b]));this.faceVertexUvs[0].push([T,R,x]);this.faces.push(new THREE.Face3(d,m,E,[v.clone(),y,b.clone()]));this.faceVertexUvs[0].push([R.clone(),w,x.clone()])}if(!1===o&&0<e)for(this.vertices.push(new THREE.Vector3(0,c,0)),u=0;u<n;u++)p=h[0][u],d=h[0][u+1],m=this.vertices.length-1,g=new THREE.Vector3(0,1,0),v=new THREE.Vector3(0,1,0),y=new THREE.Vector3(0,1,0),T=f[0][u].clone(),R=f[0][u+1].clone(),w=new THREE.Vector2(R.x,0),this.faces.push(new THREE.Face3(p,d,m,[g,v,y],void 0,1)),this.faceVertexUvs[0].push([T,R,w]);if(!1===o&&0<t)for(this.vertices.push(new THREE.Vector3(0,-c,0)),u=0;u<n;u++)p=h[i][u+1],d=h[i][u],m=this.vertices.length-1,g=new THREE.Vector3(0,-1,0),v=new THREE.Vector3(0,-1,0),y=new THREE.Vector3(0,-1,0),T=f[i][u+1].clone(),R=f[i][u].clone(),w=new THREE.Vector2(R.x,1),this.faces.push(new THREE.Face3(p,d,m,[g,v,y],void 0,2)),this.faceVertexUvs[0].push([T,R,w]);this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry;THREE.EdgesGeometry=function(e,t){function r(e,t){return e-t}THREE.BufferGeometry.call(this);var n=Math.cos(THREE.Math.degToRad(void 0!==t?t:1)),i=[0,0],o={},a=["a","b","c"],s;e instanceof THREE.BufferGeometry?(s=new THREE.Geometry,s.fromBufferGeometry(e)):s=e.clone();s.mergeVertices();s.computeFaceNormals();var c=s.vertices;s=s.faces;for(var u=0,l=s.length;u<l;u++)for(var h=s[u],f=0;3>f;f++){i[0]=h[a[f]];i[1]=h[a[(f+1)%3]];i.sort(r);var p=i.toString();void 0===o[p]?o[p]={vert1:i[0],vert2:i[1],face1:u,face2:void 0}:o[p].face2=u}i=[];for(p in o)if(a=o[p],void 0===a.face2||s[a.face1].normal.dot(s[a.face2].normal)<=n)u=c[a.vert1],i.push(u.x),i.push(u.y),i.push(u.z),u=c[a.vert2],i.push(u.x),i.push(u.y),i.push(u.z);this.addAttribute("position",new THREE.BufferAttribute(new Float32Array(i),3))};THREE.EdgesGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.EdgesGeometry.prototype.constructor=THREE.EdgesGeometry;THREE.ExtrudeGeometry=function(e,t){"undefined"!==typeof e&&(THREE.Geometry.call(this),this.type="ExtrudeGeometry",e=Array.isArray(e)?e:[e],this.addShapeList(e,t),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.constructor=THREE.ExtrudeGeometry;THREE.ExtrudeGeometry.prototype.addShapeList=function(e,t){for(var r=e.length,n=0;n<r;n++)this.addShape(e[n],t)};THREE.ExtrudeGeometry.prototype.addShape=function(e,t){function r(e,t,r){t||console.error("THREE.ExtrudeGeometry: vec does not exist");return t.clone().multiplyScalar(r).add(e)}function n(e,t,r){var n=1,n=e.x-t.x,i=e.y-t.y,o=r.x-e.x,a=r.y-e.y,s=n*n+i*i;if(Math.abs(n*a-i*o)>Number.EPSILON){var c=Math.sqrt(s),u=Math.sqrt(o*o+a*a),s=t.x-i/c;t=t.y+n/c;o=((r.x-a/u-s)*a-(r.y+o/u-t)*o)/(n*a-i*o);r=s+n*o-e.x;e=t+i*o-e.y;n=r*r+e*e;if(2>=n)return new THREE.Vector2(r,e);n=Math.sqrt(n/2)}else e=!1,n>Number.EPSILON?o>Number.EPSILON&&(e=!0):n<-Number.EPSILON?o<-Number.EPSILON&&(e=!0):Math.sign(i)===Math.sign(a)&&(e=!0),e?(r=-i,e=n,n=Math.sqrt(s)):(r=n,e=i,n=Math.sqrt(s/2));return new THREE.Vector2(r/n,e/n)}function i(e,t){var r,n;for(B=e.length;0<=--B;){r=B;n=B-1;0>n&&(n=e.length-1);for(var i=0,o=p+2*l,i=0;i<o;i++){var a=N*i,s=N*(i+1),c=t+r+a,a=t+n+a,u=t+n+s,s=t+r+s,c=c+_,a=a+_,u=u+_,s=s+_;H.faces.push(new THREE.Face3(c,a,s,null,null,1));H.faces.push(new THREE.Face3(a,u,s,null,null,1));c=g.generateSideWallUV(H,c,a,u,s);H.faceVertexUvs[0].push([c[0],c[1],c[3]]);H.faceVertexUvs[0].push([c[1],c[2],c[3]])}}}function o(e,t,r){H.vertices.push(new THREE.Vector3(e,t,r))}function a(e,t,r){e+=_;t+=_;r+=_;H.faces.push(new THREE.Face3(e,t,r,null,null,0));e=g.generateTopUV(H,e,t,r);H.faceVertexUvs[0].push(e)}var s=void 0!==t.amount?t.amount:100,c=void 0!==t.bevelThickness?t.bevelThickness:6,u=void 0!==t.bevelSize?t.bevelSize:c-2,l=void 0!==t.bevelSegments?t.bevelSegments:3,h=void 0!==t.bevelEnabled?t.bevelEnabled:!0,f=void 0!==t.curveSegments?t.curveSegments:12,p=void 0!==t.steps?t.steps:1,d=t.extrudePath,m,E=!1,g=void 0!==t.UVGenerator?t.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,v,y,b,T;d&&(m=d.getSpacedPoints(p),E=!0,h=!1,v=void 0!==t.frames?t.frames:new THREE.TubeGeometry.FrenetFrames(d,p,!1),y=new THREE.Vector3,b=new THREE.Vector3,T=new THREE.Vector3);h||(u=c=l=0);var R,w,x,H=this,_=this.vertices.length,d=e.extractPoints(f),f=d.shape,S=d.holes;if(d=!THREE.ShapeUtils.isClockWise(f)){f=f.reverse();w=0;for(x=S.length;w<x;w++)R=S[w],THREE.ShapeUtils.isClockWise(R)&&(S[w]=R.reverse());d=!1}var M=THREE.ShapeUtils.triangulateShape(f,S),A=f;w=0;for(x=S.length;w<x;w++)R=S[w],f=f.concat(R);var C,k,L,P,O,N=f.length,F,I=M.length,d=[],B=0;L=A.length;C=L-1;for(k=B+1;B<L;B++,C++,k++)C===L&&(C=0),k===L&&(k=0),d[B]=n(A[B],A[C],A[k]);var j=[],D,U=d.concat();w=0;for(x=S.length;w<x;w++){R=S[w];D=[];B=0;L=R.length;C=L-1;for(k=B+1;B<L;B++,C++,k++)C===L&&(C=0),k===L&&(k=0),D[B]=n(R[B],R[C],R[k]);j.push(D);U=U.concat(D)}for(C=0;C<l;C++){L=C/l;P=c*(1-L);k=u*Math.sin(L*Math.PI/2);B=0;for(L=A.length;B<L;B++)O=r(A[B],d[B],k),o(O.x,O.y,-P);w=0;for(x=S.length;w<x;w++)for(R=S[w],D=j[w],B=0,L=R.length;B<L;B++)O=r(R[B],D[B],k),o(O.x,O.y,-P)}k=u;for(B=0;B<N;B++)O=h?r(f[B],U[B],k):f[B],E?(b.copy(v.normals[0]).multiplyScalar(O.x),y.copy(v.binormals[0]).multiplyScalar(O.y),T.copy(m[0]).add(b).add(y),o(T.x,T.y,T.z)):o(O.x,O.y,0);for(L=1;L<=p;L++)for(B=0;B<N;B++)O=h?r(f[B],U[B],k):f[B],E?(b.copy(v.normals[L]).multiplyScalar(O.x),y.copy(v.binormals[L]).multiplyScalar(O.y),T.copy(m[L]).add(b).add(y),o(T.x,T.y,T.z)):o(O.x,O.y,s/p*L);for(C=l-1;0<=C;C--){L=C/l;P=c*(1-L);k=u*Math.sin(L*Math.PI/2);B=0;for(L=A.length;B<L;B++)O=r(A[B],d[B],k),o(O.x,O.y,s+P);w=0;for(x=S.length;w<x;w++)for(R=S[w],D=j[w],B=0,L=R.length;B<L;B++)O=r(R[B],D[B],k),E?o(O.x,O.y+m[p-1].y,m[p-1].x+P):o(O.x,O.y,s+P)}(function(){if(h){var e;e=0*N;for(B=0;B<I;B++)F=M[B],a(F[2]+e,F[1]+e,F[0]+e);e=p+2*l;e*=N;for(B=0;B<I;B++)F=M[B],a(F[0]+e,F[1]+e,F[2]+e)}else{for(B=0;B<I;B++)F=M[B],a(F[2],F[1],F[0]);for(B=0;B<I;B++)F=M[B],a(F[0]+N*p,F[1]+N*p,F[2]+N*p)}})();(function(){var e=0;i(A,e);e+=A.length;w=0;for(x=S.length;w<x;w++)R=S[w],i(R,e),e+=R.length})()};THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,t,r,n){e=e.vertices;t=e[t];r=e[r];n=e[n];return[new THREE.Vector2(t.x,t.y),new THREE.Vector2(r.x,r.y),new THREE.Vector2(n.x,n.y)]},generateSideWallUV:function(e,t,r,n,i){e=e.vertices;t=e[t];r=e[r];n=e[n];i=e[i];return.01>Math.abs(t.y-r.y)?[new THREE.Vector2(t.x,1-t.z),new THREE.Vector2(r.x,1-r.z),new THREE.Vector2(n.x,1-n.z),new THREE.Vector2(i.x,1-i.z)]:[new THREE.Vector2(t.y,1-t.z),new THREE.Vector2(r.y,1-r.z),new THREE.Vector2(n.y,1-n.z),new THREE.Vector2(i.y,1-i.z)]}};THREE.ShapeGeometry=function(e,t){THREE.Geometry.call(this);this.type="ShapeGeometry";!1===Array.isArray(e)&&(e=[e]);this.addShapeList(e,t);this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.constructor=THREE.ShapeGeometry;THREE.ShapeGeometry.prototype.addShapeList=function(e,t){for(var r=0,n=e.length;r<n;r++)this.addShape(e[r],t);return this};THREE.ShapeGeometry.prototype.addShape=function(e,t){void 0===t&&(t={});var r=t.material,n=void 0===t.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:t.UVGenerator,i,o,a,s=this.vertices.length;i=e.extractPoints(void 0!==t.curveSegments?t.curveSegments:12);var c=i.shape,u=i.holes;if(!THREE.ShapeUtils.isClockWise(c))for(c=c.reverse(),i=0,o=u.length;i<o;i++)a=u[i],THREE.ShapeUtils.isClockWise(a)&&(u[i]=a.reverse());var l=THREE.ShapeUtils.triangulateShape(c,u);i=0;for(o=u.length;i<o;i++)a=u[i],c=c.concat(a);u=c.length;o=l.length;for(i=0;i<u;i++)a=c[i],this.vertices.push(new THREE.Vector3(a.x,a.y,0));for(i=0;i<o;i++)u=l[i],c=u[0]+s,a=u[1]+s,u=u[2]+s,this.faces.push(new THREE.Face3(c,a,u,null,null,r)),this.faceVertexUvs[0].push(n.generateTopUV(this,c,a,u))};THREE.LatheGeometry=function(e,t,r,n){THREE.Geometry.call(this);
this.type="LatheGeometry";this.parameters={points:e,segments:t,phiStart:r,phiLength:n};t=t||12;r=r||0;n=n||2*Math.PI;for(var i=1/(e.length-1),o=1/t,a=0,s=t;a<=s;a++)for(var c=r+a*o*n,u=Math.sin(c),l=Math.cos(c),c=0,h=e.length;c<h;c++){var f=e[c],p=new THREE.Vector3;p.x=f.x*u;p.y=f.y;p.z=f.x*l;this.vertices.push(p)}r=e.length;a=0;for(s=t;a<s;a++)for(c=0,h=e.length-1;c<h;c++){t=c+r*a;n=t+r;var u=t+1+r,l=t+1,f=a*o,p=c*i,d=f+o,m=p+i;this.faces.push(new THREE.Face3(t,n,l));this.faceVertexUvs[0].push([new THREE.Vector2(f,p),new THREE.Vector2(d,p),new THREE.Vector2(f,m)]);this.faces.push(new THREE.Face3(n,u,l));this.faceVertexUvs[0].push([new THREE.Vector2(d,p),new THREE.Vector2(d,m),new THREE.Vector2(f,m)])}this.mergeVertices();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.LatheGeometry.prototype.constructor=THREE.LatheGeometry;THREE.PlaneGeometry=function(e,t,r,n){THREE.Geometry.call(this);this.type="PlaneGeometry";this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};this.fromBufferGeometry(new THREE.PlaneBufferGeometry(e,t,r,n))};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry;THREE.PlaneBufferGeometry=function(e,t,r,n){THREE.BufferGeometry.call(this);this.type="PlaneBufferGeometry";this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};var i=e/2,o=t/2;r=Math.floor(r)||1;n=Math.floor(n)||1;var a=r+1,s=n+1,c=e/r,u=t/n;t=new Float32Array(a*s*3);e=new Float32Array(a*s*3);for(var l=new Float32Array(a*s*2),h=0,f=0,p=0;p<s;p++)for(var d=p*u-o,m=0;m<a;m++)t[h]=m*c-i,t[h+1]=-d,e[h+2]=1,l[f]=m/r,l[f+1]=1-p/n,h+=3,f+=2;h=0;i=new(65535<t.length/3?Uint32Array:Uint16Array)(r*n*6);for(p=0;p<n;p++)for(m=0;m<r;m++)o=m+a*(p+1),s=m+1+a*(p+1),c=m+1+a*p,i[h]=m+a*p,i[h+1]=o,i[h+2]=c,i[h+3]=o,i[h+4]=s,i[h+5]=c,h+=6;this.setIndex(new THREE.BufferAttribute(i,1));this.addAttribute("position",new THREE.BufferAttribute(t,3));this.addAttribute("normal",new THREE.BufferAttribute(e,3));this.addAttribute("uv",new THREE.BufferAttribute(l,2))};THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.PlaneBufferGeometry.prototype.constructor=THREE.PlaneBufferGeometry;THREE.RingGeometry=function(e,t,r,n,i,o){THREE.Geometry.call(this);this.type="RingGeometry";this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o};e=e||0;t=t||50;i=void 0!==i?i:0;o=void 0!==o?o:2*Math.PI;r=void 0!==r?Math.max(3,r):8;n=void 0!==n?Math.max(1,n):8;var a,s=[],c=e,u=(t-e)/n;for(e=0;e<n+1;e++){for(a=0;a<r+1;a++){var l=new THREE.Vector3,h=i+a/r*o;l.x=c*Math.cos(h);l.y=c*Math.sin(h);this.vertices.push(l);s.push(new THREE.Vector2((l.x/t+1)/2,(l.y/t+1)/2))}c+=u}t=new THREE.Vector3(0,0,1);for(e=0;e<n;e++)for(i=e*(r+1),a=0;a<r;a++)o=h=a+i,u=h+r+1,l=h+r+2,this.faces.push(new THREE.Face3(o,u,l,[t.clone(),t.clone(),t.clone()])),this.faceVertexUvs[0].push([s[o].clone(),s[u].clone(),s[l].clone()]),o=h,u=h+r+2,l=h+1,this.faces.push(new THREE.Face3(o,u,l,[t.clone(),t.clone(),t.clone()])),this.faceVertexUvs[0].push([s[o].clone(),s[u].clone(),s[l].clone()]);this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,c)};THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.RingGeometry.prototype.constructor=THREE.RingGeometry;THREE.SphereGeometry=function(e,t,r,n,i,o,a){THREE.Geometry.call(this);this.type="SphereGeometry";this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:a};this.fromBufferGeometry(new THREE.SphereBufferGeometry(e,t,r,n,i,o,a))};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry;THREE.SphereBufferGeometry=function(e,t,r,n,i,o,a){THREE.BufferGeometry.call(this);this.type="SphereBufferGeometry";this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:a};e=e||50;t=Math.max(3,Math.floor(t)||8);r=Math.max(2,Math.floor(r)||6);n=void 0!==n?n:0;i=void 0!==i?i:2*Math.PI;o=void 0!==o?o:0;a=void 0!==a?a:Math.PI;for(var s=o+a,c=(t+1)*(r+1),u=new THREE.BufferAttribute(new Float32Array(3*c),3),l=new THREE.BufferAttribute(new Float32Array(3*c),3),c=new THREE.BufferAttribute(new Float32Array(2*c),2),h=0,f=[],p=new THREE.Vector3,d=0;d<=r;d++){for(var m=[],E=d/r,g=0;g<=t;g++){var v=g/t,y=-e*Math.cos(n+v*i)*Math.sin(o+E*a),b=e*Math.cos(o+E*a),T=e*Math.sin(n+v*i)*Math.sin(o+E*a);p.set(y,b,T).normalize();u.setXYZ(h,y,b,T);l.setXYZ(h,p.x,p.y,p.z);c.setXY(h,v,1-E);m.push(h);h++}f.push(m)}n=[];for(d=0;d<r;d++)for(g=0;g<t;g++)i=f[d][g+1],a=f[d][g],h=f[d+1][g],p=f[d+1][g+1],(0!==d||0<o)&&n.push(i,a,p),(d!==r-1||s<Math.PI)&&n.push(a,h,p);this.setIndex(new(65535<u.count?THREE.Uint32Attribute:THREE.Uint16Attribute)(n,1));this.addAttribute("position",u);this.addAttribute("normal",l);this.addAttribute("uv",c);this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)};THREE.SphereBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.SphereBufferGeometry.prototype.constructor=THREE.SphereBufferGeometry;THREE.TextGeometry=function(e,t){t=t||{};var r=t.font;if(!1===r instanceof THREE.Font)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new THREE.Geometry;r=r.generateShapes(e,t.size,t.curveSegments);t.amount=void 0!==t.height?t.height:50;void 0===t.bevelThickness&&(t.bevelThickness=10);void 0===t.bevelSize&&(t.bevelSize=8);void 0===t.bevelEnabled&&(t.bevelEnabled=!1);THREE.ExtrudeGeometry.call(this,r,t);this.type="TextGeometry"};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);THREE.TextGeometry.prototype.constructor=THREE.TextGeometry;THREE.TorusGeometry=function(e,t,r,n,i){THREE.Geometry.call(this);this.type="TorusGeometry";this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i};e=e||100;t=t||40;r=r||8;n=n||6;i=i||2*Math.PI;for(var o=new THREE.Vector3,a=[],s=[],c=0;c<=r;c++)for(var u=0;u<=n;u++){var l=u/n*i,h=c/r*Math.PI*2;o.x=e*Math.cos(l);o.y=e*Math.sin(l);var f=new THREE.Vector3;f.x=(e+t*Math.cos(h))*Math.cos(l);f.y=(e+t*Math.cos(h))*Math.sin(l);f.z=t*Math.sin(h);this.vertices.push(f);a.push(new THREE.Vector2(u/n,c/r));s.push(f.clone().sub(o).normalize())}for(c=1;c<=r;c++)for(u=1;u<=n;u++)e=(n+1)*c+u-1,t=(n+1)*(c-1)+u-1,i=(n+1)*(c-1)+u,o=(n+1)*c+u,l=new THREE.Face3(e,t,o,[s[e].clone(),s[t].clone(),s[o].clone()]),this.faces.push(l),this.faceVertexUvs[0].push([a[e].clone(),a[t].clone(),a[o].clone()]),l=new THREE.Face3(t,i,o,[s[t].clone(),s[i].clone(),s[o].clone()]),this.faces.push(l),this.faceVertexUvs[0].push([a[t].clone(),a[i].clone(),a[o].clone()]);this.computeFaceNormals()};THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TorusGeometry.prototype.constructor=THREE.TorusGeometry;THREE.TorusKnotGeometry=function(e,t,r,n,i,o,a){function s(e,t,r,n,i){var o=Math.cos(e),a=Math.sin(e);e*=t/r;t=Math.cos(e);o*=n*(2+t)*.5;a=n*(2+t)*a*.5;n=i*n*Math.sin(e)*.5;return new THREE.Vector3(o,a,n)}THREE.Geometry.call(this);this.type="TorusKnotGeometry";this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,p:i,q:o,heightScale:a};e=e||100;t=t||40;r=r||64;n=n||8;i=i||2;o=o||3;a=a||1;for(var c=Array(r),u=new THREE.Vector3,l=new THREE.Vector3,h=new THREE.Vector3,f=0;f<r;++f){c[f]=Array(n);var p=f/r*2*i*Math.PI,d=s(p,o,i,e,a),p=s(p+.01,o,i,e,a);u.subVectors(p,d);l.addVectors(p,d);h.crossVectors(u,l);l.crossVectors(h,u);h.normalize();l.normalize();for(p=0;p<n;++p){var m=p/n*2*Math.PI,E=-t*Math.cos(m),m=t*Math.sin(m),g=new THREE.Vector3;g.x=d.x+E*l.x+m*h.x;g.y=d.y+E*l.y+m*h.y;g.z=d.z+E*l.z+m*h.z;c[f][p]=this.vertices.push(g)-1}}for(f=0;f<r;++f)for(p=0;p<n;++p)i=(f+1)%r,o=(p+1)%n,e=c[f][p],t=c[i][p],i=c[i][o],o=c[f][o],a=new THREE.Vector2(f/r,p/n),u=new THREE.Vector2((f+1)/r,p/n),l=new THREE.Vector2((f+1)/r,(p+1)/n),h=new THREE.Vector2(f/r,(p+1)/n),this.faces.push(new THREE.Face3(e,t,o)),this.faceVertexUvs[0].push([a,u,h]),this.faces.push(new THREE.Face3(t,i,o)),this.faceVertexUvs[0].push([u.clone(),l,h.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TorusKnotGeometry.prototype.constructor=THREE.TorusKnotGeometry;THREE.TubeGeometry=function(e,t,r,n,i,o){THREE.Geometry.call(this);this.type="TubeGeometry";this.parameters={path:e,segments:t,radius:r,radialSegments:n,closed:i,taper:o};t=t||64;r=r||1;n=n||8;i=i||!1;o=o||THREE.TubeGeometry.NoTaper;var a=[],s,c,u=t+1,l,h,f,p,d,m=new THREE.Vector3,E,g,v;E=new THREE.TubeGeometry.FrenetFrames(e,t,i);g=E.normals;v=E.binormals;this.tangents=E.tangents;this.normals=g;this.binormals=v;for(E=0;E<u;E++)for(a[E]=[],l=E/(u-1),d=e.getPointAt(l),s=g[E],c=v[E],f=r*o(l),l=0;l<n;l++)h=l/n*2*Math.PI,p=-f*Math.cos(h),h=f*Math.sin(h),m.copy(d),m.x+=p*s.x+h*c.x,m.y+=p*s.y+h*c.y,m.z+=p*s.z+h*c.z,a[E][l]=this.vertices.push(new THREE.Vector3(m.x,m.y,m.z))-1;for(E=0;E<t;E++)for(l=0;l<n;l++)o=i?(E+1)%t:E+1,u=(l+1)%n,e=a[E][l],r=a[o][l],o=a[o][u],u=a[E][u],m=new THREE.Vector2(E/t,l/n),g=new THREE.Vector2((E+1)/t,l/n),v=new THREE.Vector2((E+1)/t,(l+1)/n),s=new THREE.Vector2(E/t,(l+1)/n),this.faces.push(new THREE.Face3(e,r,u)),this.faceVertexUvs[0].push([m,g,s]),this.faces.push(new THREE.Face3(r,o,u)),this.faceVertexUvs[0].push([g.clone(),v,s.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TubeGeometry.prototype.constructor=THREE.TubeGeometry;THREE.TubeGeometry.NoTaper=function(e){return 1};THREE.TubeGeometry.SinusoidalTaper=function(e){return Math.sin(Math.PI*e)};THREE.TubeGeometry.FrenetFrames=function(e,t,r){var n=new THREE.Vector3,i=[],o=[],a=[],s=new THREE.Vector3,c=new THREE.Matrix4;t+=1;var u,l,h;this.tangents=i;this.normals=o;this.binormals=a;for(u=0;u<t;u++)l=u/(t-1),i[u]=e.getTangentAt(l),i[u].normalize();o[0]=new THREE.Vector3;a[0]=new THREE.Vector3;e=Number.MAX_VALUE;u=Math.abs(i[0].x);l=Math.abs(i[0].y);h=Math.abs(i[0].z);u<=e&&(e=u,n.set(1,0,0));l<=e&&(e=l,n.set(0,1,0));h<=e&&n.set(0,0,1);s.crossVectors(i[0],n).normalize();o[0].crossVectors(i[0],s);a[0].crossVectors(i[0],o[0]);for(u=1;u<t;u++)o[u]=o[u-1].clone(),a[u]=a[u-1].clone(),s.crossVectors(i[u-1],i[u]),s.length()>Number.EPSILON&&(s.normalize(),n=Math.acos(THREE.Math.clamp(i[u-1].dot(i[u]),-1,1)),o[u].applyMatrix4(c.makeRotationAxis(s,n))),a[u].crossVectors(i[u],o[u]);if(r)for(n=Math.acos(THREE.Math.clamp(o[0].dot(o[t-1]),-1,1)),n/=t-1,0<i[0].dot(s.crossVectors(o[0],o[t-1]))&&(n=-n),u=1;u<t;u++)o[u].applyMatrix4(c.makeRotationAxis(i[u],n*u)),a[u].crossVectors(i[u],o[u])};THREE.PolyhedronGeometry=function(e,t,r,n){function i(e){var t=e.normalize().clone();t.index=c.vertices.push(t)-1;var r=Math.atan2(e.z,-e.x)/2/Math.PI+.5;e=Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5;t.uv=new THREE.Vector2(r,1-e);return t}function o(e,t,r,n){n=new THREE.Face3(e.index,t.index,r.index,[e.clone(),t.clone(),r.clone()],void 0,n);c.faces.push(n);E.copy(e).add(t).add(r).divideScalar(3);n=Math.atan2(E.z,-E.x);c.faceVertexUvs[0].push([s(e.uv,e,n),s(t.uv,t,n),s(r.uv,r,n)])}function a(e,t){for(var r=Math.pow(2,t),n=i(c.vertices[e.a]),a=i(c.vertices[e.b]),s=i(c.vertices[e.c]),u=[],l=e.materialIndex,h=0;h<=r;h++){u[h]=[];for(var f=i(n.clone().lerp(s,h/r)),p=i(a.clone().lerp(s,h/r)),d=r-h,m=0;m<=d;m++)u[h][m]=0===m&&h===r?f:i(f.clone().lerp(p,m/d))}for(h=0;h<r;h++)for(m=0;m<2*(r-h)-1;m++)n=Math.floor(m/2),0===m%2?o(u[h][n+1],u[h+1][n],u[h][n],l):o(u[h][n+1],u[h+1][n+1],u[h+1][n],l)}function s(e,t,r){0>r&&1===e.x&&(e=new THREE.Vector2(e.x-1,e.y));0===t.x&&0===t.z&&(e=new THREE.Vector2(r/2/Math.PI+.5,e.y));return e.clone()}THREE.Geometry.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:e,indices:t,radius:r,detail:n};r=r||1;n=n||0;for(var c=this,u=0,l=e.length;u<l;u+=3)i(new THREE.Vector3(e[u],e[u+1],e[u+2]));e=this.vertices;for(var h=[],f=u=0,l=t.length;u<l;u+=3,f++){var p=e[t[u]],d=e[t[u+1]],m=e[t[u+2]];h[f]=new THREE.Face3(p.index,d.index,m.index,[p.clone(),d.clone(),m.clone()],void 0,f)}for(var E=new THREE.Vector3,u=0,l=h.length;u<l;u++)a(h[u],n);u=0;for(l=this.faceVertexUvs[0].length;u<l;u++)t=this.faceVertexUvs[0][u],n=t[0].x,e=t[1].x,h=t[2].x,f=Math.max(n,e,h),p=Math.min(n,e,h),.9<f&&.1>p&&(.2>n&&(t[0].x+=1),.2>e&&(t[1].x+=1),.2>h&&(t[2].x+=1));u=0;for(l=this.vertices.length;u<l;u++)this.vertices[u].multiplyScalar(r);this.mergeVertices();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,r)};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.PolyhedronGeometry.prototype.constructor=THREE.PolyhedronGeometry;THREE.DodecahedronGeometry=function(e,t){var r=(1+Math.sqrt(5))/2,n=1/r;THREE.PolyhedronGeometry.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t);this.type="DodecahedronGeometry";this.parameters={radius:e,detail:t}};THREE.DodecahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype);THREE.DodecahedronGeometry.prototype.constructor=THREE.DodecahedronGeometry;THREE.IcosahedronGeometry=function(e,t){var r=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t);this.type="IcosahedronGeometry";this.parameters={radius:e,detail:t}};THREE.IcosahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype);THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry;THREE.OctahedronGeometry=function(e,t){THREE.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t);this.type="OctahedronGeometry";this.parameters={radius:e,detail:t}};THREE.OctahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype);THREE.OctahedronGeometry.prototype.constructor=THREE.OctahedronGeometry;THREE.TetrahedronGeometry=function(e,t){THREE.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t);this.type="TetrahedronGeometry";this.parameters={radius:e,detail:t}};THREE.TetrahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype);THREE.TetrahedronGeometry.prototype.constructor=THREE.TetrahedronGeometry;THREE.ParametricGeometry=function(e,t,r){THREE.Geometry.call(this);this.type="ParametricGeometry";this.parameters={func:e,slices:t,stacks:r};var n=this.vertices,i=this.faces,o=this.faceVertexUvs[0],a,s,c,u,l=t+1;for(a=0;a<=r;a++)for(u=a/r,s=0;s<=t;s++)c=s/t,c=e(c,u),n.push(c);var h,f,p,d;for(a=0;a<r;a++)for(s=0;s<t;s++)e=a*l+s,n=a*l+s+1,u=(a+1)*l+s+1,c=(a+1)*l+s,h=new THREE.Vector2(s/t,a/r),f=new THREE.Vector2((s+1)/t,a/r),p=new THREE.Vector2((s+1)/t,(a+1)/r),d=new THREE.Vector2(s/t,(a+1)/r),i.push(new THREE.Face3(e,n,c)),o.push([h,f,d]),i.push(new THREE.Face3(n,u,c)),o.push([f.clone(),p,d.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ParametricGeometry.prototype.constructor=THREE.ParametricGeometry;THREE.WireframeGeometry=function(e){function t(e,t){return e-t}THREE.BufferGeometry.call(this);var r=[0,0],n={},i=["a","b","c"];if(e instanceof THREE.Geometry){var o=e.vertices,a=e.faces,s=0,c=new Uint32Array(6*a.length);e=0;for(var u=a.length;e<u;e++)for(var l=a[e],h=0;3>h;h++){r[0]=l[i[h]];r[1]=l[i[(h+1)%3]];r.sort(t);var f=r.toString();void 0===n[f]&&(c[2*s]=r[0],c[2*s+1]=r[1],n[f]=!0,s++)}r=new Float32Array(6*s);e=0;for(u=s;e<u;e++)for(h=0;2>h;h++)n=o[c[2*e+h]],s=6*e+3*h,r[s+0]=n.x,r[s+1]=n.y,r[s+2]=n.z;this.addAttribute("position",new THREE.BufferAttribute(r,3))}else if(e instanceof THREE.BufferGeometry){if(null!==e.index){u=e.index.array;o=e.attributes.position;i=e.groups;s=0;0===i.length&&e.addGroup(0,u.length);c=new Uint32Array(2*u.length);a=0;for(l=i.length;a<l;++a){e=i[a];h=e.start;f=e.count;e=h;for(var p=h+f;e<p;e+=3)for(h=0;3>h;h++)r[0]=u[e+h],r[1]=u[e+(h+1)%3],r.sort(t),f=r.toString(),void 0===n[f]&&(c[2*s]=r[0],c[2*s+1]=r[1],n[f]=!0,s++)}r=new Float32Array(6*s);e=0;for(u=s;e<u;e++)for(h=0;2>h;h++)s=6*e+3*h,n=c[2*e+h],r[s+0]=o.getX(n),r[s+1]=o.getY(n),r[s+2]=o.getZ(n)}else for(o=e.attributes.position.array,s=o.length/3,c=s/3,r=new Float32Array(6*s),e=0,u=c;e<u;e++)for(h=0;3>h;h++)s=18*e+6*h,c=9*e+3*h,r[s+0]=o[c],r[s+1]=o[c+1],r[s+2]=o[c+2],n=9*e+(h+1)%3*3,r[s+3]=o[n],r[s+4]=o[n+1],r[s+5]=o[n+2];this.addAttribute("position",new THREE.BufferAttribute(r,3))}};THREE.WireframeGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.WireframeGeometry.prototype.constructor=THREE.WireframeGeometry;THREE.AxisHelper=function(e){e=e||1;var t=new Float32Array([0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e]),r=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]);e=new THREE.BufferGeometry;e.addAttribute("position",new THREE.BufferAttribute(t,3));e.addAttribute("color",new THREE.BufferAttribute(r,3));t=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.LineSegments.call(this,e,t)};THREE.AxisHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.AxisHelper.prototype.constructor=THREE.AxisHelper;THREE.ArrowHelper=function(){var e=new THREE.Geometry;e.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0));var t=new THREE.CylinderGeometry(0,.5,1,5,1);t.translate(0,-.5,0);return function(r,n,i,o,a,s){THREE.Object3D.call(this);void 0===o&&(o=16776960);void 0===i&&(i=1);void 0===a&&(a=.2*i);void 0===s&&(s=.2*a);this.position.copy(n);this.line=new THREE.Line(e,new THREE.LineBasicMaterial({color:o}));this.line.matrixAutoUpdate=!1;this.add(this.line);this.cone=new THREE.Mesh(t,new THREE.MeshBasicMaterial({color:o}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(r);this.setLength(i,a,s)}}();THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.constructor=THREE.ArrowHelper;THREE.ArrowHelper.prototype.setDirection=function(){var e=new THREE.Vector3,t;return function(r){.99999<r.y?this.quaternion.set(0,0,0,1):-.99999>r.y?this.quaternion.set(1,0,0,0):(e.set(r.z,0,-r.x).normalize(),t=Math.acos(r.y),this.quaternion.setFromAxisAngle(e,t))}}();THREE.ArrowHelper.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e);void 0===r&&(r=.2*t);this.line.scale.set(1,Math.max(0,e-t),1);this.line.updateMatrix();this.cone.scale.set(r,t,r);this.cone.position.y=e;this.cone.updateMatrix()};THREE.ArrowHelper.prototype.setColor=function(e){this.line.material.color.set(e);this.cone.material.color.set(e)};THREE.BoxHelper=function(e){var t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),n=new THREE.BufferGeometry;n.setIndex(new THREE.BufferAttribute(t,1));n.addAttribute("position",new THREE.BufferAttribute(r,3));THREE.LineSegments.call(this,n,new THREE.LineBasicMaterial({color:16776960}));void 0!==e&&this.update(e)};THREE.BoxHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.BoxHelper.prototype.constructor=THREE.BoxHelper;THREE.BoxHelper.prototype.update=function(){var e=new THREE.Box3;return function(t){e.setFromObject(t);if(!e.isEmpty()){t=e.min;var r=e.max,n=this.geometry.attributes.position,i=n.array;i[0]=r.x;i[1]=r.y;i[2]=r.z;i[3]=t.x;i[4]=r.y;i[5]=r.z;i[6]=t.x;i[7]=t.y;i[8]=r.z;i[9]=r.x;i[10]=t.y;i[11]=r.z;i[12]=r.x;i[13]=r.y;i[14]=t.z;i[15]=t.x;i[16]=r.y;i[17]=t.z;i[18]=t.x;i[19]=t.y;i[20]=t.z;i[21]=r.x;i[22]=t.y;i[23]=t.z;n.needsUpdate=!0;this.geometry.computeBoundingSphere()}}}();THREE.BoundingBoxHelper=function(e,t){var r=void 0!==t?t:8947848;this.object=e;this.box=new THREE.Box3;THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:r,wireframe:!0}))};THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.constructor=THREE.BoundingBoxHelper;THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};THREE.CameraHelper=function(e){function t(e,t,n){r(e,n);r(t,n)}function r(e,t){n.vertices.push(new THREE.Vector3);n.colors.push(new THREE.Color(t));void 0===o[e]&&(o[e]=[]);o[e].push(n.vertices.length-1)}var n=new THREE.Geometry,i=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),o={};t("n1","n2",16755200);t("n2","n4",16755200);t("n4","n3",16755200);t("n3","n1",16755200);t("f1","f2",16755200);t("f2","f4",16755200);t("f4","f3",16755200);t("f3","f1",16755200);t("n1","f1",16755200);t("n2","f2",16755200);t("n3","f3",16755200);t("n4","f4",16755200);t("p","n1",16711680);t("p","n2",16711680);t("p","n3",16711680);t("p","n4",16711680);t("u1","u2",43775);t("u2","u3",43775);t("u3","u1",43775);t("c","t",16777215);t("p","c",3355443);t("cn1","cn2",3355443);t("cn3","cn4",3355443);t("cf1","cf2",3355443);t("cf3","cf4",3355443);THREE.LineSegments.call(this,n,i);this.camera=e;this.camera.updateProjectionMatrix();this.matrix=e.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=o;this.update()};THREE.CameraHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.CameraHelper.prototype.constructor=THREE.CameraHelper;THREE.CameraHelper.prototype.update=function(){function e(e,o,a,s){n.set(o,a,s).unproject(i);e=r[e];if(void 0!==e)for(o=0,a=e.length;o<a;o++)t.vertices[e[o]].copy(n)}var t,r,n=new THREE.Vector3,i=new THREE.Camera;return function(){t=this.geometry;r=this.pointMap;i.projectionMatrix.copy(this.camera.projectionMatrix);e("c",0,0,-1);e("t",0,0,1);e("n1",-1,-1,-1);e("n2",1,-1,-1);e("n3",-1,1,-1);e("n4",1,1,-1);e("f1",-1,-1,1);e("f2",1,-1,1);e("f3",-1,1,1);e("f4",1,1,1);e("u1",.7,1.1,-1);e("u2",-.7,1.1,-1);e("u3",0,2,-1);e("cf1",-1,0,1);e("cf2",1,0,1);e("cf3",0,-1,1);e("cf4",0,1,1);e("cn1",-1,0,-1);e("cn2",1,0,-1);e("cn3",0,-1,-1);e("cn4",0,1,-1);t.verticesNeedUpdate=!0}}();THREE.DirectionalLightHelper=function(e,t){THREE.Object3D.call(this);this.light=e;this.light.updateMatrixWorld();this.matrix=e.matrixWorld;this.matrixAutoUpdate=!1;t=t||1;var r=new THREE.Geometry;r.vertices.push(new THREE.Vector3(-t,t,0),new THREE.Vector3(t,t,0),new THREE.Vector3(t,-t,0),new THREE.Vector3(-t,-t,0),new THREE.Vector3(-t,t,0));var n=new THREE.LineBasicMaterial({fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane=new THREE.Line(r,n);this.add(this.lightPlane);r=new THREE.Geometry;r.vertices.push(new THREE.Vector3,new THREE.Vector3);n=new THREE.LineBasicMaterial({fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(r,n);this.add(this.targetLine);this.update()};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.DirectionalLightHelper.prototype.constructor=THREE.DirectionalLightHelper;THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};THREE.DirectionalLightHelper.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Vector3,r=new THREE.Vector3;return function(){e.setFromMatrixPosition(this.light.matrixWorld);t.setFromMatrixPosition(this.light.target.matrixWorld);r.subVectors(t,e);this.lightPlane.lookAt(r);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(r);this.targetLine.geometry.verticesNeedUpdate=!0;this.targetLine.material.color.copy(this.lightPlane.material.color)}}();THREE.EdgesHelper=function(e,t,r){t=void 0!==t?t:16777215;THREE.LineSegments.call(this,new THREE.EdgesGeometry(e.geometry,r),new THREE.LineBasicMaterial({color:t}));this.matrix=e.matrixWorld;this.matrixAutoUpdate=!1};THREE.EdgesHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.EdgesHelper.prototype.constructor=THREE.EdgesHelper;THREE.FaceNormalsHelper=function(e,t,r,n){this.object=e;this.size=void 0!==t?t:1;e=void 0!==r?r:16776960;n=void 0!==n?n:1;t=0;r=this.object.geometry;r instanceof THREE.Geometry?t=r.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");r=new THREE.BufferGeometry;t=new THREE.Float32Attribute(6*t,3);r.addAttribute("position",t);THREE.LineSegments.call(this,r,new THREE.LineBasicMaterial({color:e,linewidth:n}));this.matrixAutoUpdate=!1;this.update()};THREE.FaceNormalsHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.FaceNormalsHelper.prototype.constructor=THREE.FaceNormalsHelper;THREE.FaceNormalsHelper.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Vector3,r=new THREE.Matrix3;return function(){this.object.updateMatrixWorld(!0);r.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,o=o.faces,s=0,c=0,u=o.length;c<u;c++){var l=o[c],h=l.normal;e.copy(a[l.a]).add(a[l.b]).add(a[l.c]).divideScalar(3).applyMatrix4(n);t.copy(h).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e);i.setXYZ(s,e.x,e.y,e.z);s+=1;i.setXYZ(s,t.x,t.y,t.z);s+=1}i.needsUpdate=!0;return this}}();THREE.GridHelper=function(e,t){var r=new THREE.Geometry,n=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924);this.color2=new THREE.Color(8947848);for(var i=-e;i<=e;i+=t){r.vertices.push(new THREE.Vector3(-e,0,i),new THREE.Vector3(e,0,i),new THREE.Vector3(i,0,-e),new THREE.Vector3(i,0,e));var o=0===i?this.color1:this.color2;r.colors.push(o,o,o,o)}THREE.LineSegments.call(this,r,n)};THREE.GridHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.GridHelper.prototype.constructor=THREE.GridHelper;THREE.GridHelper.prototype.setColors=function(e,t){this.color1.set(e);this.color2.set(t);this.geometry.colorsNeedUpdate=!0};THREE.HemisphereLightHelper=function(e,t){THREE.Object3D.call(this);this.light=e;this.light.updateMatrixWorld();this.matrix=e.matrixWorld;this.matrixAutoUpdate=!1;this.colors=[new THREE.Color,new THREE.Color];var r=new THREE.SphereGeometry(t,4,2);r.rotateX(-Math.PI/2);for(var n=0;8>n;n++)r.faces[n].color=this.colors[4>n?0:1];n=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(r,n);this.add(this.lightSphere);this.update()};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.constructor=THREE.HemisphereLightHelper;THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose();this.lightSphere.material.dispose()};THREE.HemisphereLightHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=!0}}();THREE.PointLightHelper=function(e,t){this.light=e;this.light.updateMatrixWorld();var r=new THREE.SphereGeometry(t,4,2),n=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,r,n);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1};THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.PointLightHelper.prototype.constructor=THREE.PointLightHelper;THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};THREE.SkeletonHelper=function(e){this.bones=this.getBoneList(e);for(var t=new THREE.Geometry,r=0;r<this.bones.length;r++)this.bones[r].parent instanceof THREE.Bone&&(t.vertices.push(new THREE.Vector3),t.vertices.push(new THREE.Vector3),t.colors.push(new THREE.Color(0,0,1)),t.colors.push(new THREE.Color(0,1,0)));t.dynamic=!0;r=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});THREE.LineSegments.call(this,t,r);this.root=e;this.matrix=e.matrixWorld;this.matrixAutoUpdate=!1;this.update()};THREE.SkeletonHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.SkeletonHelper.prototype.constructor=THREE.SkeletonHelper;THREE.SkeletonHelper.prototype.getBoneList=function(e){var t=[];e instanceof THREE.Bone&&t.push(e);for(var r=0;r<e.children.length;r++)t.push.apply(t,this.getBoneList(e.children[r]));return t};THREE.SkeletonHelper.prototype.update=function(){for(var e=this.geometry,t=(new THREE.Matrix4).getInverse(this.root.matrixWorld),r=new THREE.Matrix4,n=0,i=0;i<this.bones.length;i++){var o=this.bones[i];o.parent instanceof THREE.Bone&&(r.multiplyMatrices(t,o.matrixWorld),e.vertices[n].setFromMatrixPosition(r),r.multiplyMatrices(t,o.parent.matrixWorld),e.vertices[n+1].setFromMatrixPosition(r),n+=2)}e.verticesNeedUpdate=!0;e.computeBoundingSphere()};THREE.SpotLightHelper=function(e){THREE.Object3D.call(this);this.light=e;this.light.updateMatrixWorld();this.matrix=e.matrixWorld;this.matrixAutoUpdate=!1;e=new THREE.CylinderGeometry(0,1,1,8,1,!0);e.translate(0,-.5,0);e.rotateX(-Math.PI/2);var t=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(e,t);this.add(this.cone);this.update()};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.SpotLightHelper.prototype.constructor=THREE.SpotLightHelper;THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};THREE.SpotLightHelper.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(){var r=this.light.distance?this.light.distance:1e4,n=r*Math.tan(this.light.angle);this.cone.scale.set(n,n,r);e.setFromMatrixPosition(this.light.matrixWorld);t.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(t.sub(e));this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();THREE.VertexNormalsHelper=function(e,t,r,n){this.object=e;this.size=void 0!==t?t:1;e=void 0!==r?r:16711680;n=void 0!==n?n:1;t=0;r=this.object.geometry;r instanceof THREE.Geometry?t=3*r.faces.length:r instanceof THREE.BufferGeometry&&(t=r.attributes.normal.count);r=new THREE.BufferGeometry;t=new THREE.Float32Attribute(6*t,3);r.addAttribute("position",t);THREE.LineSegments.call(this,r,new THREE.LineBasicMaterial({color:e,linewidth:n}));this.matrixAutoUpdate=!1;this.update()};THREE.VertexNormalsHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.VertexNormalsHelper.prototype.constructor=THREE.VertexNormalsHelper;THREE.VertexNormalsHelper.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Vector3,r=new THREE.Matrix3;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0);r.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a instanceof THREE.Geometry)for(var s=a.vertices,c=a.faces,u=a=0,l=c.length;u<l;u++)for(var h=c[u],f=0,p=h.vertexNormals.length;f<p;f++){var d=h.vertexNormals[f];e.copy(s[h[n[f]]]).applyMatrix4(i);t.copy(d).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e);o.setXYZ(a,e.x,e.y,e.z);a+=1;o.setXYZ(a,t.x,t.y,t.z);a+=1}else if(a instanceof THREE.BufferGeometry)for(n=a.attributes.position,s=a.attributes.normal,
f=a=0,p=n.count;f<p;f++)e.set(n.getX(f),n.getY(f),n.getZ(f)).applyMatrix4(i),t.set(s.getX(f),s.getY(f),s.getZ(f)),t.applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),o.setXYZ(a,e.x,e.y,e.z),a+=1,o.setXYZ(a,t.x,t.y,t.z),a+=1;o.needsUpdate=!0;return this}}();THREE.WireframeHelper=function(e,t){var r=void 0!==t?t:16777215;THREE.LineSegments.call(this,new THREE.WireframeGeometry(e.geometry),new THREE.LineBasicMaterial({color:r}));this.matrix=e.matrixWorld;this.matrixAutoUpdate=!1};THREE.WireframeHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.WireframeHelper.prototype.constructor=THREE.WireframeHelper;THREE.ImmediateRenderObject=function(e){THREE.Object3D.call(this);this.material=e;this.render=function(e){}};THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);THREE.ImmediateRenderObject.prototype.constructor=THREE.ImmediateRenderObject;THREE.MorphBlendMesh=function(e,t){THREE.Mesh.call(this,e,t);this.animationsMap={};this.animationsList=[];var r=this.geometry.morphTargets.length;this.createAnimation("__default",0,r-1,r/1);this.setAnimationWeight("__default",1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphBlendMesh.prototype.constructor=THREE.MorphBlendMesh;THREE.MorphBlendMesh.prototype.createAnimation=function(e,t,r,n){t={start:t,end:r,length:r-t+1,fps:n,duration:(r-t)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=t;this.animationsList.push(t)};THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(e){for(var t=/([a-z]+)_?(\d+)/i,r,n={},i=this.geometry,o=0,a=i.morphTargets.length;o<a;o++){var s=i.morphTargets[o].name.match(t);if(s&&1<s.length){var c=s[1];n[c]||(n[c]={start:Infinity,end:-Infinity});s=n[c];o<s.start&&(s.start=o);o>s.end&&(s.end=o);r||(r=c)}}for(c in n)s=n[c],this.createAnimation(c,s.start,s.end,e);this.firstAnimation=r};THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){if(e=this.animationsMap[e])e.direction=1,e.directionBackwards=!1};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){if(e=this.animationsMap[e])e.direction=-1,e.directionBackwards=!0};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var r=this.animationsMap[e];r&&(r.fps=t,r.duration=(r.end-r.start)/r.fps)};THREE.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var r=this.animationsMap[e];r&&(r.duration=t,r.fps=(r.end-r.start)/r.duration)};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var r=this.animationsMap[e];r&&(r.weight=t)};THREE.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var r=this.animationsMap[e];r&&(r.time=t)};THREE.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0;if(e=this.animationsMap[e])t=e.time;return t};THREE.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1;if(e=this.animationsMap[e])t=e.duration;return t};THREE.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("THREE.MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")};THREE.MorphBlendMesh.prototype.stopAnimation=function(e){if(e=this.animationsMap[e])e.active=!1};THREE.MorphBlendMesh.prototype.update=function(e){for(var t=0,r=this.animationsList.length;t<r;t++){var n=this.animationsList[t];if(n.active){var i=n.duration/n.length;n.time+=n.direction*e;if(n.mirroredLoop){if(n.time>n.duration||0>n.time)n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),0>n.time&&(n.time=0,n.directionBackwards=!1)}else n.time%=n.duration,0>n.time&&(n.time+=n.duration);var o=n.start+THREE.Math.clamp(Math.floor(n.time/i),0,n.length-1),a=n.weight;o!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*a,this.morphTargetInfluences[o]=0,n.lastFrame=n.currentFrame,n.currentFrame=o);i=n.time%i/i;n.directionBackwards&&(i=1-i);n.currentFrame!==n.lastFrame?(this.morphTargetInfluences[n.currentFrame]=i*a,this.morphTargetInfluences[n.lastFrame]=(1-i)*a):this.morphTargetInfluences[n.currentFrame]=a}}};THREE.ColladaLoader=function(){var e=null;var t=null;var r;var n;var i=null;var o={};var a={};var s={};var c={};var u={};var l={};var h={};var f={};var p={};var d;var m;var E;var g;var v;var y;var b;var T=true;var R=THREE.SmoothShading;var w={centerGeometry:false,convertUpAxis:false,subdivideFaces:true,upAxis:"Y",defaultEnvMap:null};var x=1;var H="Y";var _=null;function S(e,t,r,n){var o=0;if(document.implementation&&document.implementation.createDocument){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState===4){if(a.status===0||a.status===200){if(a.response){i=t;M(a.response,undefined,e)}else{if(n){n()}else{console.error("ColladaLoader: Empty or non-existing file ("+e+")")}}}}else if(a.readyState===3){if(r){if(o===0){o=a.getResponseHeader("Content-Length")}r({total:o,loaded:a.responseText.length})}}};a.open("GET",e,true);a.send(null)}else{alert("Don't know how to parse XML!")}}function M(o,T,R){e=(new DOMParser).parseFromString(o,"text/xml");T=T||i;if(R!==undefined){var w=R.split("/");w.pop();v=(w.length<1?".":w.join("/"))+"/"}C();tt();a=k("library_images image",ne,"image");l=k("library_materials material",we,"material");h=k("library_effects effect",Me,"effect");u=k("library_geometries geometry",pe,"geometry");f=k("library_cameras camera",Oe,"camera");p=k("library_lights light",Fe,"light");c=k("library_controllers controller",ie,"controller");s=k("library_animations animation",Ce,"animation");E=k("library_visual_scenes visual_scene",se,"visual_scene");g=k("library_kinematics_models kinematics_model",Be,"kinematics_model");y=[];b=[];r=L();t=new THREE.Group;for(var H=0;H<r.nodes.length;H++){t.add(z(r.nodes[H]))}t.scale.multiplyScalar(x);O();n=P();G();var _={scene:t,morphs:y,skins:b,animations:d,kinematics:m,dae:{images:a,materials:l,cameras:f,lights:p,effects:h,geometries:u,controllers:c,animations:s,visualScenes:E,visualScene:r,scene:r,kinematicsModels:g,kinematicsModel:n}};if(T){T(_)}return _}function A(e){R=e}function C(){var t=e.querySelectorAll("asset");var r=t[0];if(r&&r.childNodes){for(var n=0;n<r.childNodes.length;n++){var i=r.childNodes[n];switch(i.nodeName){case"unit":var o=i.getAttribute("meter");if(o){x=parseFloat(o)}break;case"up_axis":H=i.textContent.charAt(0);break}}}}function k(t,r,n){var i=e.querySelectorAll(t);var o={};var a=0;var s=i.length;for(var c=0;c<s;c++){var u=i[c];var l=(new r).parse(u);if(!l.id||l.id.length===0)l.id=n+a++;o[l.id]=l}return o}function L(){var t=e.querySelectorAll("scene instance_visual_scene")[0];if(t){var r=t.getAttribute("url").replace(/^#/,"");return E[r.length>0?r:"visual_scene0"]}else{return null}}function P(){var t=e.querySelectorAll("instance_kinematics_model")[0];if(t){var r=t.getAttribute("url").replace(/^#/,"");return g[r.length>0?r:"kinematics_model0"]}else{return null}}function O(){d=[];N(t)}function N(e){var t=r.getChildById(e.colladaId,true),n=null;if(t&&t.keys){n={fps:60,hierarchy:[{node:t,keys:t.keys,sids:t.sids}],node:e,name:"animation_"+e.name,length:0};d.push(n);for(var i=0,o=t.keys.length;i<o;i++){n.length=Math.max(n.length,t.keys[i].time)}}else{n={hierarchy:[{keys:[],sids:[]}]}}for(var i=0,o=e.children.length;i<o;i++){var a=N(e.children[i]);for(var s=0,c=a.hierarchy.length;s<c;s++){n.hierarchy.push({keys:[],sids:[]})}}return n}function F(){var e=1e6;var t=-e;var r=0;var n;for(var i in s){var o=s[i];n=n||o.id;for(var a=0;a<o.sampler.length;a++){var c=o.sampler[a];c.create();e=Math.min(e,c.startTime);t=Math.max(t,c.endTime);r=Math.max(r,c.input.length)}}return{start:e,end:t,frames:r,ID:n}}function I(e,t){var r=t instanceof le?c[t.url]:t;if(!r||!r.morph){console.log("could not find morph controller!");return}var n=r.morph;for(var i=0;i<n.targets.length;i++){var o=n.targets[i];var a=u[o];if(!a.mesh||!a.mesh.primitives||!a.mesh.primitives.length){continue}var s=a.mesh.primitives[0].geometry;if(s.vertices.length===e.vertices.length){e.morphTargets.push({name:"target_1",vertices:s.vertices})}}e.morphTargets.push({name:"target_Z",vertices:e.vertices})}function B(e,t,n){var i=c[t.url];if(!i||!i.skin){console.log("could not find skin controller!");return}if(!t.skeleton||!t.skeleton.length){console.log("could not find the skeleton for the skin!");return}var o=i.skin;var a=r.getChildById(t.skeleton[0]);var s=[];n=n!==undefined?n:true;var u=[];e.skinWeights=[];e.skinIndices=[];if(n){for(var l=0;l<e.vertices.length;l++){e.vertices[l].applyMatrix4(o.bindShapeMatrix)}}}function j(e,t,r,n){e.world=e.world||new THREE.Matrix4;e.localworld=e.localworld||new THREE.Matrix4;e.world.copy(e.matrix);e.localworld.copy(e.matrix);if(e.channels&&e.channels.length){var i=e.channels[0];var o=i.sampler.output[r];if(o instanceof THREE.Matrix4){e.world.copy(o);e.localworld.copy(o);if(r===0)e.matrix.copy(o)}}if(n){e.world.multiplyMatrices(n,e.world)}t.push(e);for(var a=0;a<e.nodes.length;a++){j(e.nodes[a],t,r,e.world)}}function D(e,t){for(var r=0;r<e.length;r++){var n=e[r];var i=-1;if(n.type!="JOINT")continue;for(var o=0;o<t.joints.length;o++){if(n.sid===t.joints[o]){i=o;break}}if(i>=0){var a=t.invBindMatrices[i];n.invBindMatrix=a;n.skinningMatrix=new THREE.Matrix4;n.skinningMatrix.multiplyMatrices(n.world,a);n.animatrix=new THREE.Matrix4;n.animatrix.copy(n.localworld);n.weights=[];for(var o=0;o<t.weights.length;o++){for(var s=0;s<t.weights[o].length;s++){var c=t.weights[o][s];if(c.joint===i){n.weights.push(c)}}}}else{console.warn("ColladaLoader: Could not find joint '"+n.sid+"'.");n.skinningMatrix=new THREE.Matrix4;n.weights=[]}}}function U(e){var t=[];var r=function(e,t,n){var i={};i.name=t.sid;i.parent=e;i.matrix=t.matrix;var o=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];i.matrix.decompose(o[0],o[1],o[2]);i.pos=[o[0].x,o[0].y,o[0].z];i.scl=[o[2].x,o[2].y,o[2].z];i.rotq=[o[1].x,o[1].y,o[1].z,o[1].w];n.push(i);for(var a in t.nodes){r(t.sid,t.nodes[a],n)}};r(-1,e,t);return t}function $(e,t,r){var n=[];j(t,n,-1);D(n,r.skin);var i=new THREE.Vector3;var o=[];for(var a=0;a<e.vertices.length;a++){o.push(new THREE.Vector3)}for(a=0;a<n.length;a++){if(n[a].type!="JOINT")continue;for(var s=0;s<n[a].weights.length;s++){var c=n[a].weights[s];var u=c.index;var l=c.weight;var h=e.vertices[u];var f=o[u];i.x=h.x;i.y=h.y;i.z=h.z;i.applyMatrix4(n[a].skinningMatrix);f.x+=i.x*l;f.y+=i.y*l;f.z+=i.z*l}}for(var a=0;a<e.vertices.length;a++){e.vertices[a]=o[a]}}function V(e,t,n){var i=c[t.url];n=n!==undefined?n:40;if(!i||!i.skin){console.log("ColladaLoader: Could not find skin controller.");return}if(!t.skeleton||!t.skeleton.length){console.log("ColladaLoader: Could not find the skeleton for the skin. ");return}var o=F();var a=r.getChildById(t.skeleton[0],true)||r.getChildBySid(t.skeleton[0],true);var s=U(a);var u=i.skin.joints;var l=[];for(var h=0;h<u.length;h++){for(var f=0;f<s.length;f++){if(s[f].name===u[h]){l[h]=s[f]}}}for(var h=0;h<l.length;h++){for(var f=0;f<l.length;f++){if(l[h].parent===l[f].name){l[h].parent=f}}}var h,f,p,d,m;var E=new THREE.Vector3,g,v;for(h=0;h<e.vertices.length;h++){e.vertices[h].applyMatrix4(i.skin.bindShapeMatrix)}var y=[];var b=[];var T=i.skin.weights;for(var h=0;h<T.length;h++){var R=new THREE.Vector4(T[h][0]?T[h][0].joint:0,T[h][1]?T[h][1].joint:0,T[h][2]?T[h][2].joint:0,T[h][3]?T[h][3].joint:0);var m=new THREE.Vector4(T[h][0]?T[h][0].weight:0,T[h][1]?T[h][1].weight:0,T[h][2]?T[h][2].weight:0,T[h][3]?T[h][3].weight:0);y.push(R);b.push(m)}e.skinIndices=y;e.skinWeights=b;e.bones=l;var w={name:o.ID,fps:30,length:o.frames/30,hierarchy:[]};for(var f=0;f<l.length;f++){w.hierarchy.push({parent:l[f].parent,name:l[f].name,keys:[]})}console.log("ColladaLoader:",o.ID+" has "+l.length+" bones.");$(e,a,i);for(n=0;n<o.frames;n++){var x=[];var H=[];j(a,x,n);D(x,i.skin);for(var h=0;h<x.length;h++){for(var f=0;f<w.hierarchy.length;f++){if(w.hierarchy[f].name===x[h].sid){var _={};_.time=n/30;_.matrix=x[h].animatrix;if(n===0)x[h].matrix=_.matrix;var S=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];_.matrix.decompose(S[0],S[1],S[2]);_.pos=[S[0].x,S[0].y,S[0].z];_.scl=[S[2].x,S[2].y,S[2].z];_.rot=S[1];w.hierarchy[f].keys.push(_)}}}e.animation=w}}function G(){if(n&&n.joints.length===0){m=undefined;return}var i={};var o=function(e,o){var a=o.getAttribute("id");var s=r.getChildById(a,true);var c=n.joints[e];t.traverse(function(t){if(t.colladaId==a){i[e]={node:t,transforms:s.transforms,joint:c,position:c.zeroPosition}}})};m={joints:n&&n.joints,getJointValue:function(e){var t=i[e];if(t){return t.position}else{console.log("getJointValue: joint "+e+" doesn't exist")}},setJointValue:function(e,t){var r=i[e];if(r){var n=r.joint;if(t>n.limits.max||t<n.limits.min){console.log("setJointValue: joint "+e+" value "+t+" outside of limits (min: "+n.limits.min+", max: "+n.limits.max+")")}else if(n.static){console.log("setJointValue: joint "+e+" is static")}else{var o=r.node;var a=n.axis;var c=r.transforms;var u=new THREE.Matrix4;for(s=0;s<c.length;s++){var l=c[s];if(l.sid&&l.sid.indexOf("joint"+e)!==-1){switch(n.type){case"revolute":u.multiply(h.makeRotationAxis(a,THREE.Math.degToRad(t)));break;case"prismatic":u.multiply(h.makeTranslation(a.x*t,a.y*t,a.z*t));break;default:console.warn("setJointValue: unknown joint type: "+n.type);break}}else{var h=new THREE.Matrix4;switch(l.type){case"matrix":u.multiply(l.obj);break;case"translate":u.multiply(h.makeTranslation(l.obj.x,l.obj.y,l.obj.z));break;case"rotate":u.multiply(h.makeRotationAxis(l.obj,l.angle));break}}}var f=u.elements;var p=Array.prototype.slice.call(f);var d=[p[0],p[4],p[8],p[12],p[1],p[5],p[9],p[13],p[2],p[6],p[10],p[14],p[3],p[7],p[11],p[15]];o.matrix.set.apply(o.matrix,d);o.matrix.decompose(o.position,o.quaternion,o.scale)}}else{console.log("setJointValue: joint "+e+" doesn't exist")}}};var a=e.querySelector("scene instance_kinematics_scene");if(a){for(var s=0;s<a.childNodes.length;s++){var c=a.childNodes[s];if(c.nodeType!=1)continue;switch(c.nodeName){case"bind_joint_axis":var u=c.getAttribute("target").split("/").pop();var l=c.querySelector("axis param").textContent;var h=parseInt(l.split("joint").pop().split(".")[0]);var f=e.querySelector('[sid="'+u+'"]');if(f){var p=f.parentElement;o(h,p)}break;default:break}}}}function z(e,t){var r=new THREE.Object3D;var n=false;var i;var o;var a,s;for(a=0;a<e.controllers.length;a++){var d=c[e.controllers[a].url];switch(d.type){case"skin":if(u[d.skin.source]){var m=new fe;m.url=d.skin.source;m.instance_material=e.controllers[a].instance_material;e.geometries.push(m);n=true;i=e.controllers[a]}else if(c[d.skin.source]){var E=c[d.skin.source];o=E;if(E.morph&&u[E.morph.source]){var m=new fe;m.url=E.morph.source;m.instance_material=e.controllers[a].instance_material;e.geometries.push(m)}}break;case"morph":if(u[d.morph.source]){var m=new fe;m.url=d.morph.source;m.instance_material=e.controllers[a].instance_material;e.geometries.push(m);o=e.controllers[a]}console.log("ColladaLoader: Morph-controller partially supported.");default:break}}var g={};for(a=0;a<e.geometries.length;a++){var v=e.geometries[a];var T=v.instance_material;var R=u[v.url];var x={};var H=[];var _=0;var S;if(R){if(!R.mesh||!R.mesh.primitives)continue;if(r.name.length===0){r.name=R.id}if(T){for(s=0;s<T.length;s++){var M=T[s];var A=l[M.target];var C=A.instance_effect.url;var k=h[C].shader;var L=k.material;if(R.doubleSided){if(!(M.symbol in g)){var P=L.clone();P.side=THREE.DoubleSide;g[M.symbol]=P}L=g[M.symbol]}L.opacity=!L.opacity?1:L.opacity;x[M.symbol]=_;H.push(L);S=L;S.name=A.name===null||A.name===""?A.id:A.name;_++}}var O;var N=S||new THREE.MeshLambertMaterial({color:14540253,side:R.doubleSided?THREE.DoubleSide:THREE.FrontSide});var F=R.mesh.geometry3js;if(_>1){N=new THREE.MultiMaterial(H)}if(i!==undefined){V(F,i);if(F.morphTargets.length>0){N.morphTargets=true;N.skinning=false}else{N.morphTargets=false;N.skinning=true}O=new THREE.SkinnedMesh(F,N,false);O.name="skin_"+b.length;b.push(O)}else if(o!==undefined){I(F,o);N.morphTargets=true;O=new THREE.Mesh(F,N);O.name="morph_"+y.length;y.push(O)}else{if(F.isLineStrip===true){O=new THREE.Line(F)}else{O=new THREE.Mesh(F,N)}}r.add(O)}}for(a=0;a<e.cameras.length;a++){var B=e.cameras[a];var j=f[B.url];var D=new THREE.PerspectiveCamera(j.yfov,parseFloat(j.aspect_ratio),parseFloat(j.znear),parseFloat(j.zfar));r.add(D)}for(a=0;a<e.lights.length;a++){var U=null;var $=e.lights[a];var G=p[$.url];if(G&&G.technique){var W=G.color.getHex();var q=G.intensity;var X=G.distance;var Y=G.falloff_angle;switch(G.technique){case"directional":U=new THREE.DirectionalLight(W,q,X);U.position.set(0,0,1);break;case"point":U=new THREE.PointLight(W,q,X);break;case"spot":U=new THREE.SpotLight(W,q,X,Y);U.position.set(0,0,1);break;case"ambient":U=new THREE.AmbientLight(W);break}}if(U){r.add(U)}}r.name=e.name||e.id||"";r.colladaId=e.id||"";r.layer=e.layer||"";r.matrix=e.matrix;r.matrix.decompose(r.position,r.quaternion,r.scale);if(w.centerGeometry&&r.geometry){var K=r.geometry.center();K.multiply(r.scale);K.applyQuaternion(r.quaternion);r.position.sub(K)}for(a=0;a<e.nodes.length;a++){r.add(z(e.nodes[a],e))}return r}function W(e,t){for(var r=0;r<e.joints.length;r++){if(e.joints[r]===t){return r}}}function q(t){var r=e.querySelectorAll("library_nodes node");for(var n=0;n<r.length;n++){var i=r[n].attributes.getNamedItem("id");if(i&&i.value===t){return r[n]}}return undefined}function X(e){var t=[];var r=1e6;var n=-1e6;for(var i in s){var o=s[i];for(var a=0;a<o.channel.length;a++){var c=o.channel[a];var u=o.sampler[a];var i=c.target.split("/")[0];if(i==e.id){u.create();c.sampler=u;r=Math.min(r,u.startTime);n=Math.max(n,u.endTime);t.push(c)}}}if(t.length){e.startTime=r;e.endTime=n}return t}function Y(e){var t=1e7;for(var r=0;r<e.channels.length;r++){var n=e.channels[r].sampler;for(var i=0;i<n.input.length-1;i++){var o=n.input[i];var a=n.input[i+1];t=Math.min(t,a-o)}}return t}function K(e,t){var r={};var n,i;for(n=0;n<e.channels.length;n++){var o=e.channels[n];r[o.sid]=o}var a=new THREE.Matrix4;for(n=0;n<e.transforms.length;n++){var s=e.transforms[n];var o=r[s.sid];if(o!==undefined){var c=o.sampler;var u;for(i=0;i<c.input.length-1;i++){if(c.input[i+1]>t){u=c.output[i];break}}if(u!==undefined){if(u instanceof THREE.Matrix4){a.multiplyMatrices(a,u)}else{a.multiplyMatrices(a,s.matrix)}}else{a.multiplyMatrices(a,s.matrix)}}else{a.multiplyMatrices(a,s.matrix)}}return a}function Q(e){if(e.channels&&e.channels.length){var t=[],r=[];for(var n=0,i=e.channels.length;n<i;n++){var o=e.channels[n],a=o.fullSid,s=o.sampler,c=s.input,u=e.getTransformBySid(o.sid),l;if(o.arrIndices){l=[];for(var h=0,f=o.arrIndices.length;h<f;h++){l[h]=at(o.arrIndices[h])}}else{l=st(o.member)}if(u){if(r.indexOf(a)===-1){r.push(a)}for(var h=0,f=c.length;h<f;h++){var p=c[h],d=s.getData(u.type,h,l),m=J(t,p);if(!m){m=new Pe(p);var E=Z(t,p);t.splice(E===-1?t.length:E,0,m)}m.addTarget(a,u,l,d)}}else{console.log('Could not find transform "'+o.sid+'" in node '+e.id)}}for(var n=0;n<r.length;n++){var g=r[n];for(var h=0;h<t.length;h++){var m=t[h];if(!m.hasTarget(g)){ee(t,m,h,g)}}}e.keys=t;e.sids=r}}function J(e,t){var r=null;for(var n=0,i=e.length;n<i&&r===null;n++){var o=e[n];if(o.time===t){r=o}else if(o.time>t){break}}return r}function Z(e,t){var r=-1;for(var n=0,i=e.length;n<i&&r===-1;n++){var o=e[n];if(o.time>=t){r=n}}return r}function ee(e,t,r,n){var i=re(e,n,r?r-1:0),o=te(e,n,r+1);if(i&&o){var a=(t.time-i.time)/(o.time-i.time),s=i.getTarget(n),c=o.getTarget(n).data,u=s.data,l;if(s.type==="matrix"){l=u}else if(u.length){l=[];for(var h=0;h<u.length;++h){l[h]=u[h]+(c[h]-u[h])*a}}else{l=u+(c-u)*a}t.addTarget(n,s.transform,s.member,l)}}function te(e,t,r){for(;r<e.length;r++){var n=e[r];if(n.hasTarget(t)){return n}}return null}function re(e,t,r){r=r>=0?r:r+e.length;for(;r>=0;r--){var n=e[r];if(n.hasTarget(t)){return n}}return null}function ne(){this.id="";this.init_from=""}ne.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeName==="init_from"){this.init_from=r.textContent}}return this};function ie(){this.id="";this.name="";this.type="";this.skin=null;this.morph=null}ie.prototype.parse=function(e){this.id=e.getAttribute("id");this.name=e.getAttribute("name");this.type="none";for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"skin":this.skin=(new ae).parse(r);this.type=r.nodeName;break;case"morph":this.morph=(new oe).parse(r);this.type=r.nodeName;break;default:break}}return this};function oe(){this.method=null;this.source=null;this.targets=null;this.weights=null}oe.prototype.parse=function(e){var t={};var r=[];var n;this.method=e.getAttribute("method");this.source=e.getAttribute("source").replace(/^#/,"");for(n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];if(i.nodeType!=1)continue;switch(i.nodeName){case"source":var o=(new Re).parse(i);t[o.id]=o;break;case"targets":r=this.parseInputs(i);break;default:console.log(i.nodeName);break}}for(n=0;n<r.length;n++){var a=r[n];var o=t[a.source];switch(a.semantic){case"MORPH_TARGET":this.targets=o.read();break;case"MORPH_WEIGHT":this.weights=o.read();break;default:break}}return this};oe.prototype.parseInputs=function(e){var t=[];for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(n.nodeType!=1)continue;switch(n.nodeName){case"input":t.push((new Te).parse(n));break;default:break}}return t};function ae(){this.source="";this.bindShapeMatrix=null;this.invBindMatrices=[];this.joints=[];this.weights=[]}ae.prototype.parse=function(e){var t={};var r,n;this.source=e.getAttribute("source").replace(/^#/,"");this.invBindMatrices=[];this.joints=[];this.weights=[];for(var i=0;i<e.childNodes.length;i++){var o=e.childNodes[i];if(o.nodeType!=1)continue;switch(o.nodeName){case"bind_shape_matrix":var a=ze(o.textContent);this.bindShapeMatrix=ot(a);break;case"source":var s=(new Re).parse(o);t[s.id]=s;break;case"joints":r=o;break;case"vertex_weights":n=o;break;default:console.log(o.nodeName);break}}this.parseJoints(r,t);this.parseWeights(n,t);return this};ae.prototype.parseJoints=function(e,t){for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(n.nodeType!=1)continue;switch(n.nodeName){case"input":var i=(new Te).parse(n);var o=t[i.source];if(i.semantic==="JOINT"){this.joints=o.read()}else if(i.semantic==="INV_BIND_MATRIX"){this.invBindMatrices=o.read()}break;default:break}}};ae.prototype.parseWeights=function(e,t){var r,n,i=[];for(var o=0;o<e.childNodes.length;o++){var a=e.childNodes[o];if(a.nodeType!=1)continue;switch(a.nodeName){case"input":i.push((new Te).parse(a));break;case"v":r=We(a.textContent);break;case"vcount":n=We(a.textContent);break;default:break}}var s=0;for(var o=0;o<n.length;o++){var c=n[o];var u=[];for(var l=0;l<c;l++){var h={};for(var f=0;f<i.length;f++){var p=i[f];var d=r[s+p.offset];switch(p.semantic){case"JOINT":h.joint=d;break;case"WEIGHT":h.weight=t[p.source].data[d];break;default:break}}u.push(h);s+=i.length}for(var l=0;l<u.length;l++){u[l].index=o}this.weights.push(u)}};function se(){this.id="";this.name="";this.nodes=[];this.scene=new THREE.Group}se.prototype.getChildById=function(e,t){for(var r=0;r<this.nodes.length;r++){var n=this.nodes[r].getChildById(e,t);if(n){return n}}return null};se.prototype.getChildBySid=function(e,t){for(var r=0;r<this.nodes.length;r++){var n=this.nodes[r].getChildBySid(e,t);if(n){return n}}return null};se.prototype.parse=function(e){this.id=e.getAttribute("id");this.name=e.getAttribute("name");this.nodes=[];for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"node":this.nodes.push((new ce).parse(r));break;default:break}}return this};function ce(){this.id="";this.name="";this.sid="";this.nodes=[];this.controllers=[];this.transforms=[];this.geometries=[];this.channels=[];this.matrix=new THREE.Matrix4}ce.prototype.getChannelForTransform=function(e){for(var t=0;t<this.channels.length;t++){var r=this.channels[t];var n=r.target.split("/");var i=n.shift();var o=n.shift();var a=o.indexOf(".")>=0;var s=o.indexOf("(")>=0;var c;var u;if(a){n=o.split(".");o=n.shift();u=n.shift()}else if(s){c=o.split("(");o=c.shift();for(var l=0;l<c.length;l++){c[l]=parseInt(c[l].replace(/\)/,""))}}if(o===e){r.info={sid:o,dotSyntax:a,arrSyntax:s,arrIndices:c};return r}}return null};ce.prototype.getChildById=function(e,t){if(this.id===e){return this}if(t){for(var r=0;r<this.nodes.length;r++){var n=this.nodes[r].getChildById(e,t);if(n){return n}}}return null};ce.prototype.getChildBySid=function(e,t){if(this.sid===e){return this}if(t){for(var r=0;r<this.nodes.length;r++){var n=this.nodes[r].getChildBySid(e,t);if(n){return n}}}return null};ce.prototype.getTransformBySid=function(e){for(var t=0;t<this.transforms.length;t++){if(this.transforms[t].sid===e)return this.transforms[t]}return null};ce.prototype.parse=function(e){var t;this.id=e.getAttribute("id");this.sid=e.getAttribute("sid");this.name=e.getAttribute("name");this.type=e.getAttribute("type");this.layer=e.getAttribute("layer");this.type=this.type==="JOINT"?this.type:"NODE";this.nodes=[];this.transforms=[];this.geometries=[];this.cameras=[];this.lights=[];this.controllers=[];this.matrix=new THREE.Matrix4;for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(n.nodeType!=1)continue;switch(n.nodeName){case"node":this.nodes.push((new ce).parse(n));break;case"instance_camera":this.cameras.push((new Ne).parse(n));break;case"instance_controller":this.controllers.push((new le).parse(n));break;case"instance_geometry":this.geometries.push((new fe).parse(n));break;case"instance_light":this.lights.push((new Ie).parse(n));break;case"instance_node":t=n.getAttribute("url").replace(/^#/,"");var i=q(t);if(i){this.nodes.push((new ce).parse(i))}break;case"rotate":case"translate":case"scale":case"matrix":case"lookat":case"skew":this.transforms.push((new ue).parse(n));break;case"extra":break;default:console.log(n.nodeName);break}}this.channels=X(this);Q(this);this.updateMatrix();return this};ce.prototype.updateMatrix=function(){this.matrix.identity();for(var e=0;e<this.transforms.length;e++){this.transforms[e].apply(this.matrix)}};function ue(){this.sid="";this.type="";this.data=[];this.obj=null}ue.prototype.parse=function(e){this.sid=e.getAttribute("sid");this.type=e.nodeName;this.data=ze(e.textContent);this.convert();return this};ue.prototype.convert=function(){switch(this.type){case"matrix":this.obj=ot(this.data);break;case"rotate":this.angle=THREE.Math.degToRad(this.data[3]);case"translate":rt(this.data,-1);this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;case"scale":rt(this.data,1);this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;default:console.log("Can not convert Transform of type "+this.type);break}};ue.prototype.apply=function(){var e=new THREE.Matrix4;return function(t){switch(this.type){case"matrix":t.multiply(this.obj);break;case"translate":t.multiply(e.makeTranslation(this.obj.x,this.obj.y,this.obj.z));break;case"rotate":t.multiply(e.makeRotationAxis(this.obj,this.angle));break;case"scale":t.scale(this.obj);break}}}();ue.prototype.update=function(e,t){var r=["X","Y","Z","ANGLE"];switch(this.type){case"matrix":if(!t){this.obj.copy(e)}else if(t.length===1){switch(t[0]){case 0:this.obj.n11=e[0];this.obj.n21=e[1];this.obj.n31=e[2];this.obj.n41=e[3];break;case 1:this.obj.n12=e[0];this.obj.n22=e[1];this.obj.n32=e[2];this.obj.n42=e[3];break;case 2:this.obj.n13=e[0];this.obj.n23=e[1];this.obj.n33=e[2];this.obj.n43=e[3];break;case 3:this.obj.n14=e[0];this.obj.n24=e[1];this.obj.n34=e[2];this.obj.n44=e[3];break}}else if(t.length===2){var n="n"+(t[0]+1)+(t[1]+1);this.obj[n]=e}else{console.log("Incorrect addressing of matrix in transform.")}break;case"translate":case"scale":if(Object.prototype.toString.call(t)==="[object Array]"){t=r[t[0]]}switch(t){case"X":this.obj.x=e;break;case"Y":this.obj.y=e;break;case"Z":this.obj.z=e;break;default:this.obj.x=e[0];this.obj.y=e[1];this.obj.z=e[2];break}break;case"rotate":if(Object.prototype.toString.call(t)==="[object Array]"){t=r[t[0]]}switch(t){case"X":this.obj.x=e;break;case"Y":this.obj.y=e;break;case"Z":this.obj.z=e;break;case"ANGLE":this.angle=THREE.Math.degToRad(e);break;default:this.obj.x=e[0];this.obj.y=e[1];this.obj.z=e[2];this.angle=THREE.Math.degToRad(e[3]);break}break}};function le(){this.url="";this.skeleton=[];this.instance_material=[]}le.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,"");this.skeleton=[];this.instance_material=[];for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!==1)continue;switch(r.nodeName){case"skeleton":this.skeleton.push(r.textContent.replace(/^#/,""));break;case"bind_material":var n=r.querySelectorAll("instance_material");for(var i=0;i<n.length;i++){var o=n[i];this.instance_material.push((new he).parse(o))}break;case"extra":break;default:break}}return this};function he(){this.symbol="";this.target=""}he.prototype.parse=function(e){this.symbol=e.getAttribute("symbol");this.target=e.getAttribute("target").replace(/^#/,"");return this};function fe(){this.url="";this.instance_material=[]}fe.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,"");this.instance_material=[];for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;if(r.nodeName==="bind_material"){var n=r.querySelectorAll("instance_material");for(var i=0;i<n.length;i++){var o=n[i];this.instance_material.push((new he).parse(o))}break}}return this};function pe(){this.id="";this.mesh=null}pe.prototype.parse=function(e){this.id=e.getAttribute("id");et(this,e);for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"mesh":this.mesh=new de(this).parse(r);break;case"extra":break;default:break}}return this};function de(e){this.geometry=e.id;this.primitives=[];this.vertices=null;this.geometry3js=null}de.prototype.parse=function(e){this.primitives=[];for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"source":$e(r);break;case"vertices":this.vertices=(new be).parse(r);break;case"linestrips":this.primitives.push((new ge).parse(r));break;case"triangles":this.primitives.push((new ve).parse(r));break;case"polygons":this.primitives.push((new me).parse(r));break;case"polylist":this.primitives.push((new Ee).parse(r));break;default:break}}this.geometry3js=new THREE.Geometry;if(this.vertices===null){return this}var n=o[this.vertices.input["POSITION"].source].data;for(var t=0;t<n.length;t+=3){this.geometry3js.vertices.push(it(n,t).clone())}for(var t=0;t<this.primitives.length;t++){var i=this.primitives[t];i.setVertices(this.vertices);this.handlePrimitive(i,this.geometry3js)}if(this.geometry3js.calcNormals){this.geometry3js.computeVertexNormals();delete this.geometry3js.calcNormals}return this};de.prototype.handlePrimitive=function(e,t){if(e instanceof ge){t.isLineStrip=true;return}var r,n,i=e.p,a=e.inputs;var s,c,u;var l,h;var f=0,p=3,d=0;var m=[];for(r=0;r<a.length;r++){s=a[r];var E=s.offset+1;d=d<E?E:d;switch(s.semantic){case"TEXCOORD":m.push(s.set);break}}for(var g=0;g<i.length;++g){var v=i[g],y=0;while(y<v.length){var b=[];var T=[];var R=null;var x=[];if(e.vcount){p=e.vcount.length?e.vcount[f++]:e.vcount}else{p=v.length/d}for(r=0;r<p;r++){for(n=0;n<a.length;n++){s=a[n];l=o[s.source];c=v[y+r*d+s.offset];h=l.accessor.params.length;u=c*h;switch(s.semantic){case"VERTEX":b.push(c);break;case"NORMAL":T.push(it(l.data,u));break;case"TEXCOORD":R=R||{};if(R[s.set]===undefined)R[s.set]=[];R[s.set].push(new THREE.Vector2(l.data[u],l.data[u+1]));break;case"COLOR":x.push((new THREE.Color).setRGB(l.data[u],l.data[u+1],l.data[u+2]));break;default:break}}}if(T.length===0){s=this.vertices.input.NORMAL;if(s){l=o[s.source];h=l.accessor.params.length;for(var H=0,_=b.length;H<_;H++){T.push(it(l.data,b[H]*h))}}else{t.calcNormals=true}}if(!R){R={};s=this.vertices.input.TEXCOORD;if(s){m.push(s.set);l=o[s.source];h=l.accessor.params.length;for(var H=0,_=b.length;H<_;H++){u=b[H]*h;
if(R[s.set]===undefined)R[s.set]=[];R[s.set].push(new THREE.Vector2(l.data[u],1-l.data[u+1]))}}}if(x.length===0){s=this.vertices.input.COLOR;if(s){l=o[s.source];h=l.accessor.params.length;for(var H=0,_=b.length;H<_;H++){u=b[H]*h;x.push((new THREE.Color).setRGB(l.data[u],l.data[u+1],l.data[u+2]))}}}var S=null,M=[],A,C;if(p===3){M.push(new THREE.Face3(b[0],b[1],b[2],T,x.length?x:new THREE.Color))}else if(p===4){M.push(new THREE.Face3(b[0],b[1],b[3],T.length?[T[0].clone(),T[1].clone(),T[3].clone()]:[],x.length?[x[0],x[1],x[3]]:new THREE.Color));M.push(new THREE.Face3(b[1],b[2],b[3],T.length?[T[1].clone(),T[2].clone(),T[3].clone()]:[],x.length?[x[1],x[2],x[3]]:new THREE.Color))}else if(p>4&&w.subdivideFaces){var k=x.length?x:new THREE.Color,L,P,O,N,F,I;for(n=1;n<p-1;){M.push(new THREE.Face3(b[0],b[n],b[n+1],T.length?[T[0].clone(),T[n++].clone(),T[n].clone()]:[],k))}}if(M.length){for(var H=0,_=M.length;H<_;H++){S=M[H];S.daeMaterial=e.material;t.faces.push(S);for(n=0;n<m.length;n++){A=R[m[n]];if(p>4){C=[A[0],A[H+1],A[H+2]]}else if(p===4){if(H===0){C=[A[0],A[1],A[3]]}else{C=[A[1].clone(),A[2],A[3].clone()]}}else{C=[A[0],A[1],A[2]]}if(t.faceVertexUvs[n]===undefined){t.faceVertexUvs[n]=[]}t.faceVertexUvs[n].push(C)}}}else{console.log("dropped face with vcount "+p+" for geometry with id: "+t.id)}y+=d*p}}};function me(){this.material="";this.count=0;this.inputs=[];this.vcount=null;this.p=[];this.geometry=new THREE.Geometry}me.prototype.setVertices=function(e){for(var t=0;t<this.inputs.length;t++){if(this.inputs[t].source===e.id){this.inputs[t].source=e.input["POSITION"].source}}};me.prototype.parse=function(e){this.material=e.getAttribute("material");this.count=Ke(e,"count",0);for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"input":this.inputs.push((new Te).parse(e.childNodes[t]));break;case"vcount":this.vcount=We(r.textContent);break;case"p":this.p.push(We(r.textContent));break;case"ph":console.warn("polygon holes not yet supported!");break;default:break}}return this};function Ee(){me.call(this);this.vcount=[]}Ee.prototype=Object.create(me.prototype);Ee.prototype.constructor=Ee;function ge(){me.call(this);this.vcount=1}ge.prototype=Object.create(me.prototype);ge.prototype.constructor=ge;function ve(){me.call(this);this.vcount=3}ve.prototype=Object.create(me.prototype);ve.prototype.constructor=ve;function ye(){this.source="";this.count=0;this.stride=0;this.params=[]}ye.prototype.parse=function(e){this.params=[];this.source=e.getAttribute("source");this.count=Ke(e,"count",0);this.stride=Ke(e,"stride",0);for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeName==="param"){var n={};n["name"]=r.getAttribute("name");n["type"]=r.getAttribute("type");this.params.push(n)}}return this};function be(){this.input={}}be.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++){if(e.childNodes[t].nodeName==="input"){var r=(new Te).parse(e.childNodes[t]);this.input[r.semantic]=r}}return this};function Te(){this.semantic="";this.offset=0;this.source="";this.set=0}Te.prototype.parse=function(e){this.semantic=e.getAttribute("semantic");this.source=e.getAttribute("source").replace(/^#/,"");this.set=Ke(e,"set",-1);this.offset=Ke(e,"offset",0);if(this.semantic==="TEXCOORD"&&this.set<0){this.set=0}return this};function Re(e){this.id=e;this.type=null}Re.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"bool_array":this.data=Ge(r.textContent);this.type=r.nodeName;break;case"float_array":this.data=ze(r.textContent);this.type=r.nodeName;break;case"int_array":this.data=We(r.textContent);this.type=r.nodeName;break;case"IDREF_array":case"Name_array":this.data=qe(r.textContent);this.type=r.nodeName;break;case"technique_common":for(var n=0;n<r.childNodes.length;n++){if(r.childNodes[n].nodeName==="accessor"){this.accessor=(new ye).parse(r.childNodes[n]);break}}break;default:break}}return this};Re.prototype.read=function(){var e=[];var t=this.accessor.params[0];switch(t.type){case"IDREF":case"Name":case"name":case"float":return this.data;case"float4x4":for(var r=0;r<this.data.length;r+=16){var n=this.data.slice(r,r+16);var i=ot(n);e.push(i)}break;default:console.log("ColladaLoader: Source: Read dont know how to read "+t.type+".");break}return e};function we(){this.id="";this.name="";this.instance_effect=null}we.prototype.parse=function(e){this.id=e.getAttribute("id");this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++){if(e.childNodes[t].nodeName==="instance_effect"){this.instance_effect=(new Ae).parse(e.childNodes[t]);break}}return this};function xe(){this.color=new THREE.Color;this.color.setRGB(Math.random(),Math.random(),Math.random());this.color.a=1;this.texture=null;this.texcoord=null;this.texOpts=null}xe.prototype.isColor=function(){return this.texture===null};xe.prototype.isTexture=function(){return this.texture!=null};xe.prototype.parse=function(e){if(e.nodeName==="transparent"){this.opaque=e.getAttribute("opaque")}for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"color":var n=ze(r.textContent);this.color=new THREE.Color;this.color.setRGB(n[0],n[1],n[2]);this.color.a=n[3];break;case"texture":this.texture=r.getAttribute("texture");this.texcoord=r.getAttribute("texcoord");this.texOpts={offsetU:0,offsetV:0,repeatU:1,repeatV:1,wrapU:1,wrapV:1};this.parseTexture(r);break;default:break}}return this};xe.prototype.parseTexture=function(e){if(!e.childNodes)return this;if(e.childNodes[1]&&e.childNodes[1].nodeName==="extra"){e=e.childNodes[1];if(e.childNodes[1]&&e.childNodes[1].nodeName==="technique"){e=e.childNodes[1]}}for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"offsetU":case"offsetV":case"repeatU":case"repeatV":this.texOpts[r.nodeName]=parseFloat(r.textContent);break;case"wrapU":case"wrapV":if(r.textContent.toUpperCase()==="TRUE"){this.texOpts[r.nodeName]=1}else{this.texOpts[r.nodeName]=parseInt(r.textContent)}break;default:this.texOpts[r.nodeName]=r.textContent;break}}return this};function He(e,t){this.type=e;this.effect=t;this.material=null}He.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"emission":case"diffuse":case"specular":case"transparent":this[r.nodeName]=(new xe).parse(r);break;case"bump":var n=r.getAttribute("bumptype");if(n){if(n.toLowerCase()==="heightfield"){this["bump"]=(new xe).parse(r)}else if(n.toLowerCase()==="normalmap"){this["normal"]=(new xe).parse(r)}else{console.error("Shader.prototype.parse: Invalid value for attribute 'bumptype' ("+n+") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'HEIGHTFIELD'");this["bump"]=(new xe).parse(r)}}else{console.warn("Shader.prototype.parse: Attribute 'bumptype' missing from bump node - defaulting to 'HEIGHTFIELD'");this["bump"]=(new xe).parse(r)}break;case"shininess":case"reflectivity":case"index_of_refraction":case"transparency":var i=r.querySelectorAll("float");if(i.length>0)this[r.nodeName]=parseFloat(i[0].textContent);break;default:break}}this.create();return this};He.prototype.create=function(){var e={};var t=false;if(this["transparency"]!==undefined&&this["transparent"]!==undefined){var r=this["transparent"];var n=(this.transparent.color.r+this.transparent.color.g+this.transparent.color.b)/3*this.transparency;if(n>0){t=true;e["transparent"]=true;e["opacity"]=1-n}}var i={diffuse:"map",ambient:"lightMap",specular:"specularMap",emission:"emissionMap",bump:"bumpMap",normal:"normalMap"};for(var o in this){switch(o){case"ambient":case"emission":case"diffuse":case"specular":case"bump":case"normal":var s=this[o];if(s instanceof xe){if(s.isTexture()){var c=s.texture;var u=this.effect.sampler[c];if(u!==undefined&&u.source!==undefined){var l=this.effect.surface[u.source];if(l!==undefined){var h=a[l.init_from];if(h){var f=v+h.init_from;var p;var d=THREE.Loader.Handlers.get(f);if(d!==null){p=d.load(f)}else{p=new THREE.Texture;Ze(p,f)}p.wrapS=s.texOpts.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;p.wrapT=s.texOpts.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;p.offset.x=s.texOpts.offsetU;p.offset.y=s.texOpts.offsetV;p.repeat.x=s.texOpts.repeatU;p.repeat.y=s.texOpts.repeatV;e[i[o]]=p;if(o==="emission")e["emissive"]=16777215}}}}else if(o==="diffuse"||!t){if(o==="emission"){e["emissive"]=s.color.getHex()}else{e[o]=s.color.getHex()}}}break;case"shininess":e[o]=this[o];break;case"reflectivity":e[o]=this[o];if(e[o]>0)e["envMap"]=w.defaultEnvMap;e["combine"]=THREE.MixOperation;break;case"index_of_refraction":e["refractionRatio"]=this[o];if(this[o]!==1)e["envMap"]=w.defaultEnvMap;break;case"transparency":break;default:break}}e["shading"]=R;e["side"]=this.effect.doubleSided?THREE.DoubleSide:THREE.FrontSide;if(e.diffuse!==undefined){e.color=e.diffuse;delete e.diffuse}switch(this.type){case"constant":if(e.emissive!=undefined)e.color=e.emissive;this.material=new THREE.MeshBasicMaterial(e);break;case"phong":case"blinn":this.material=new THREE.MeshPhongMaterial(e);break;case"lambert":default:this.material=new THREE.MeshLambertMaterial(e);break}return this.material};function _e(e){this.effect=e;this.init_from=null;this.format=null}_e.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"init_from":this.init_from=r.textContent;break;case"format":this.format=r.textContent;break;default:console.log("unhandled Surface prop: "+r.nodeName);break}}return this};function Se(e){this.effect=e;this.source=null;this.wrap_s=null;this.wrap_t=null;this.minfilter=null;this.magfilter=null;this.mipfilter=null}Se.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"source":this.source=r.textContent;break;case"minfilter":this.minfilter=r.textContent;break;case"magfilter":this.magfilter=r.textContent;break;case"mipfilter":this.mipfilter=r.textContent;break;case"wrap_s":this.wrap_s=r.textContent;break;case"wrap_t":this.wrap_t=r.textContent;break;default:console.log("unhandled Sampler2D prop: "+r.nodeName);break}}return this};function Me(){this.id="";this.name="";this.shader=null;this.surface={};this.sampler={}}Me.prototype.create=function(){if(this.shader===null){return null}};Me.prototype.parse=function(e){this.id=e.getAttribute("id");this.name=e.getAttribute("name");et(this,e);this.shader=null;for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"profile_COMMON":this.parseTechnique(this.parseProfileCOMMON(r));break;default:break}}return this};Me.prototype.parseNewparam=function(e){var t=e.getAttribute("sid");for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(n.nodeType!=1)continue;switch(n.nodeName){case"surface":this.surface[t]=new _e(this).parse(n);break;case"sampler2D":this.sampler[t]=new Se(this).parse(n);break;case"extra":break;default:console.log(n.nodeName);break}}};Me.prototype.parseProfileCOMMON=function(e){var t;for(var r=0;r<e.childNodes.length;r++){var n=e.childNodes[r];if(n.nodeType!=1)continue;switch(n.nodeName){case"profile_COMMON":this.parseProfileCOMMON(n);break;case"technique":t=n;break;case"newparam":this.parseNewparam(n);break;case"image":var i=(new ne).parse(n);a[i.id]=i;break;case"extra":break;default:console.log(n.nodeName);break}}return t};Me.prototype.parseTechnique=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.shader=new He(r.nodeName,this).parse(r);break;case"extra":this.parseExtra(r);break;default:break}}};Me.prototype.parseExtra=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"technique":this.parseExtraTechnique(r);break;default:break}}};Me.prototype.parseExtraTechnique=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"bump":this.shader.parse(e);break;default:break}}};function Ae(){this.url=""}Ae.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,"");return this};function Ce(){this.id="";this.name="";this.source={};this.sampler=[];this.channel=[]}Ce.prototype.parse=function(e){this.id=e.getAttribute("id");this.name=e.getAttribute("name");this.source={};for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"animation":var n=(new Ce).parse(r);for(var i in n.source){this.source[i]=n.source[i]}for(var o=0;o<n.channel.length;o++){this.channel.push(n.channel[o]);this.sampler.push(n.sampler[o])}break;case"source":var i=(new Re).parse(r);this.source[i.id]=i;break;case"sampler":this.sampler.push(new Le(this).parse(r));break;case"channel":this.channel.push(new ke(this).parse(r));break;default:break}}return this};function ke(e){this.animation=e;this.source="";this.target="";this.fullSid=null;this.sid=null;this.dotSyntax=null;this.arrSyntax=null;this.arrIndices=null;this.member=null}ke.prototype.parse=function(e){this.source=e.getAttribute("source").replace(/^#/,"");this.target=e.getAttribute("target");var t=this.target.split("/");var r=t.shift();var n=t.shift();var i=n.indexOf(".")>=0;var o=n.indexOf("(")>=0;if(i){t=n.split(".");this.sid=t.shift();this.member=t.shift()}else if(o){var a=n.split("(");this.sid=a.shift();for(var s=0;s<a.length;s++){a[s]=parseInt(a[s].replace(/\)/,""))}this.arrIndices=a}else{this.sid=n}this.fullSid=n;this.dotSyntax=i;this.arrSyntax=o;return this};function Le(e){this.id="";this.animation=e;this.inputs=[];this.input=null;this.output=null;this.strideOut=null;this.interpolation=null;this.startTime=null;this.endTime=null;this.duration=0}Le.prototype.parse=function(e){this.id=e.getAttribute("id");this.inputs=[];for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"input":this.inputs.push((new Te).parse(r));break;default:break}}return this};Le.prototype.create=function(){for(var e=0;e<this.inputs.length;e++){var t=this.inputs[e];var r=this.animation.source[t.source];switch(t.semantic){case"INPUT":this.input=r.read();break;case"OUTPUT":this.output=r.read();this.strideOut=r.accessor.stride;break;case"INTERPOLATION":this.interpolation=r.read();break;case"IN_TANGENT":break;case"OUT_TANGENT":break;default:console.log(t.semantic);break}}this.startTime=0;this.endTime=0;this.duration=0;if(this.input.length){this.startTime=1e8;this.endTime=-1e8;for(var e=0;e<this.input.length;e++){this.startTime=Math.min(this.startTime,this.input[e]);this.endTime=Math.max(this.endTime,this.input[e])}this.duration=this.endTime-this.startTime}};Le.prototype.getData=function(e,t,r){var n;if(e==="matrix"&&this.strideOut===16){n=this.output[t]}else if(this.strideOut>1){n=[];t*=this.strideOut;for(var i=0;i<this.strideOut;++i){n[i]=this.output[t+i]}if(this.strideOut===3){switch(e){case"rotate":case"translate":rt(n,-1);break;case"scale":rt(n,1);break}}else if(this.strideOut===4&&e==="matrix"){rt(n,-1)}}else{n=this.output[t];if(r&&e==="translate"){n=nt(r,n)}}return n};function Pe(e){this.targets=[];this.time=e}Pe.prototype.addTarget=function(e,t,r,n){this.targets.push({sid:e,member:r,transform:t,data:n})};Pe.prototype.apply=function(e){for(var t=0;t<this.targets.length;++t){var r=this.targets[t];if(!e||r.sid===e){r.transform.update(r.data,r.member)}}};Pe.prototype.getTarget=function(e){for(var t=0;t<this.targets.length;++t){if(this.targets[t].sid===e){return this.targets[t]}}return null};Pe.prototype.hasTarget=function(e){for(var t=0;t<this.targets.length;++t){if(this.targets[t].sid===e){return true}}return false};Pe.prototype.interpolate=function(e,t){for(var r=0,n=this.targets.length;r<n;r++){var i=this.targets[r],o=e.getTarget(i.sid),a;if(i.transform.type!=="matrix"&&o){var s=(t-this.time)/(e.time-this.time),c=o.data,u=i.data;if(s<0)s=0;if(s>1)s=1;if(u.length){a=[];for(var l=0;l<u.length;++l){a[l]=u[l]+(c[l]-u[l])*s}}else{a=u+(c-u)*s}}else{a=i.data}i.transform.update(a,i.member)}};function Oe(){this.id="";this.name="";this.technique=""}Oe.prototype.parse=function(e){this.id=e.getAttribute("id");this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"optics":this.parseOptics(r);break;default:break}}return this};Oe.prototype.parseOptics=function(e){for(var t=0;t<e.childNodes.length;t++){if(e.childNodes[t].nodeName==="technique_common"){var r=e.childNodes[t];for(var n=0;n<r.childNodes.length;n++){this.technique=r.childNodes[n].nodeName;if(this.technique==="perspective"){var i=r.childNodes[n];for(var o=0;o<i.childNodes.length;o++){var a=i.childNodes[o];switch(a.nodeName){case"yfov":this.yfov=a.textContent;break;case"xfov":this.xfov=a.textContent;break;case"znear":this.znear=a.textContent;break;case"zfar":this.zfar=a.textContent;break;case"aspect_ratio":this.aspect_ratio=a.textContent;break}}}else if(this.technique==="orthographic"){var s=r.childNodes[n];for(var o=0;o<s.childNodes.length;o++){var a=s.childNodes[o];switch(a.nodeName){case"xmag":this.xmag=a.textContent;break;case"ymag":this.ymag=a.textContent;break;case"znear":this.znear=a.textContent;break;case"zfar":this.zfar=a.textContent;break;case"aspect_ratio":this.aspect_ratio=a.textContent;break}}}}}}return this};function Ne(){this.url=""}Ne.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,"");return this};function Fe(){this.id="";this.name="";this.technique=""}Fe.prototype.parse=function(e){this.id=e.getAttribute("id");this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"technique_common":this.parseCommon(r);break;case"technique":this.parseTechnique(r);break;default:break}}return this};Fe.prototype.parseCommon=function(e){for(var t=0;t<e.childNodes.length;t++){switch(e.childNodes[t].nodeName){case"directional":case"point":case"spot":case"ambient":this.technique=e.childNodes[t].nodeName;var r=e.childNodes[t];for(var n=0;n<r.childNodes.length;n++){var i=r.childNodes[n];switch(i.nodeName){case"color":var o=ze(i.textContent);this.color=new THREE.Color(0);this.color.setRGB(o[0],o[1],o[2]);this.color.a=o[3];break;case"falloff_angle":this.falloff_angle=parseFloat(i.textContent);break;case"quadratic_attenuation":var a=parseFloat(i.textContent);this.distance=a?Math.sqrt(1/a):0}}}}return this};Fe.prototype.parseTechnique=function(e){this.profile=e.getAttribute("profile");for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"intensity":this.intensity=parseFloat(r.textContent);break}}return this};function Ie(){this.url=""}Ie.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,"");return this};function Be(){this.id="";this.name="";this.joints=[];this.links=[]}Be.prototype.parse=function(e){this.id=e.getAttribute("id");this.name=e.getAttribute("name");this.joints=[];this.links=[];for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"technique_common":this.parseCommon(r);break;default:break}}return this};Be.prototype.parseCommon=function(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(e.childNodes[t].nodeName){case"joint":this.joints.push((new je).parse(r));break;case"link":this.links.push((new De).parse(r));break;default:break}}return this};function je(){this.sid="";this.name="";this.axis=new THREE.Vector3;this.limits={min:0,max:0};this.type="";this.static=false;this.zeroPosition=0;this.middlePosition=0}je.prototype.parse=function(e){this.sid=e.getAttribute("sid");this.name=e.getAttribute("name");this.axis=new THREE.Vector3;this.limits={min:0,max:0};this.type="";this.static=false;this.zeroPosition=0;this.middlePosition=0;var t=e.querySelector("axis");var r=ze(t.textContent);this.axis=it(r,0);var n=e.querySelector("limits min")?parseFloat(e.querySelector("limits min").textContent):-360;var i=e.querySelector("limits max")?parseFloat(e.querySelector("limits max").textContent):360;this.limits={min:n,max:i};var o=["prismatic","revolute"];for(var a=0;a<o.length;a++){var s=o[a];var c=e.querySelector(s);if(c){this.type=s}}if(this.limits.min>=this.limits.max){this.static=true}this.middlePosition=(this.limits.min+this.limits.max)/2;return this};function De(){this.sid="";this.name="";this.transforms=[];this.attachments=[]}De.prototype.parse=function(e){this.sid=e.getAttribute("sid");this.name=e.getAttribute("name");this.transforms=[];this.attachments=[];for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"attachment_full":this.attachments.push((new Ue).parse(r));break;case"rotate":case"translate":case"matrix":this.transforms.push((new ue).parse(r));break;default:break}}return this};function Ue(){this.joint="";this.transforms=[];this.links=[]}Ue.prototype.parse=function(e){this.joint=e.getAttribute("joint").split("/").pop();this.links=[];for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];if(r.nodeType!=1)continue;switch(r.nodeName){case"link":this.links.push((new De).parse(r));break;case"rotate":case"translate":case"matrix":this.transforms.push((new ue).parse(r));break;default:break}}return this};function $e(e){var t=e.getAttribute("id");if(o[t]!=undefined){return o[t]}o[t]=new Re(t).parse(e);return o[t]}function Ve(e){if(e==="dae"){return"http://www.collada.org/2005/11/COLLADASchema"}return null}function Ge(e){var t=qe(e);var r=[];for(var n=0,i=t.length;n<i;n++){r.push(t[n]==="true"||t[n]==="1"?true:false)}return r}function ze(e){var t=qe(e);var r=[];for(var n=0,i=t.length;n<i;n++){r.push(parseFloat(t[n]))}return r}function We(e){var t=qe(e);var r=[];for(var n=0,i=t.length;n<i;n++){r.push(parseInt(t[n],10))}return r}function qe(e){return e.length>0?Xe(e).split(/\s+/):[]}function Xe(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function Ye(e,t,r){if(e.hasAttribute(t)){return parseFloat(e.getAttribute(t))}else{return r}}function Ke(e,t,r){if(e.hasAttribute(t)){return parseInt(e.getAttribute(t),10)}else{return r}}function Qe(e,t,r){if(e.hasAttribute(t)){return e.getAttribute(t)}else{return r}}function Je(e,t){if(e===undefined){var r="0.";while(r.length<t+2){r+="0"}return r}t=t||2;var n=e.toString().split(".");n[1]=n.length>1?n[1].substr(0,t):"0";while(n[1].length<t){n[1]+="0"}return n.join(".")}function Ze(e,t){var r=new THREE.ImageLoader;r.load(t,function(t){e.image=t;e.needsUpdate=true})}function et(e,t){e.doubleSided=false;var r=t.querySelectorAll("extra double_sided")[0];if(r){if(r&&parseInt(r.textContent,10)===1){e.doubleSided=true}}}function tt(){if(w.convertUpAxis!==true||H===w.upAxis){_=null}else{switch(H){case"X":_=w.upAxis==="Y"?"XtoY":"XtoZ";break;case"Y":_=w.upAxis==="X"?"YtoX":"YtoZ";break;case"Z":_=w.upAxis==="X"?"ZtoX":"ZtoY";break}}}function rt(e,t){if(w.convertUpAxis!==true||H===w.upAxis){return}switch(_){case"XtoY":var r=e[0];e[0]=t*e[1];e[1]=r;break;case"XtoZ":var r=e[2];e[2]=e[1];e[1]=e[0];e[0]=r;break;case"YtoX":var r=e[0];e[0]=e[1];e[1]=t*r;break;case"YtoZ":var r=e[1];e[1]=t*e[2];e[2]=r;break;case"ZtoX":var r=e[0];e[0]=e[1];e[1]=e[2];e[2]=r;break;case"ZtoY":var r=e[1];e[1]=e[2];e[2]=t*r;break}}function nt(e,t){if(w.convertUpAxis!==true||H===w.upAxis){return t}switch(e){case"X":t=_==="XtoY"?t*-1:t;break;case"Y":t=_==="YtoZ"||_==="YtoX"?t*-1:t;break;case"Z":t=_==="ZtoY"?t*-1:t;break;default:break}return t}function it(e,t){var r=[e[t],e[t+1],e[t+2]];rt(r,-1);return new THREE.Vector3(r[0],r[1],r[2])}function ot(e){if(w.convertUpAxis){var t=[e[0],e[4],e[8]];rt(t,-1);e[0]=t[0];e[4]=t[1];e[8]=t[2];t=[e[1],e[5],e[9]];rt(t,-1);e[1]=t[0];e[5]=t[1];e[9]=t[2];t=[e[2],e[6],e[10]];rt(t,-1);e[2]=t[0];e[6]=t[1];e[10]=t[2];t=[e[0],e[1],e[2]];rt(t,-1);e[0]=t[0];e[1]=t[1];e[2]=t[2];t=[e[4],e[5],e[6]];rt(t,-1);e[4]=t[0];e[5]=t[1];e[6]=t[2];t=[e[8],e[9],e[10]];rt(t,-1);e[8]=t[0];e[9]=t[1];e[10]=t[2];t=[e[3],e[7],e[11]];rt(t,-1);e[3]=t[0];e[7]=t[1];e[11]=t[2]}return(new THREE.Matrix4).set(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function at(e){if(e>-1&&e<3){var t=["X","Y","Z"],r={X:0,Y:1,Z:2};e=st(t[e]);e=r[e]}return e}function st(e){if(w.convertUpAxis){switch(e){case"X":switch(_){case"XtoY":case"XtoZ":case"YtoX":e="Y";break;case"ZtoX":e="Z";break}break;case"Y":switch(_){case"XtoY":case"YtoX":case"ZtoX":e="X";break;case"XtoZ":case"YtoZ":case"ZtoY":e="Z";break}break;case"Z":switch(_){case"XtoZ":e="X";break;case"YtoZ":case"ZtoX":case"ZtoY":e="Y";break}break}}return e}return{load:S,parse:M,setPreferredShading:A,applySkin:V,geometries:u,options:w}};THREE.OBJLoader=function(e){this.manager=e!==undefined?e:THREE.DefaultLoadingManager;this.materials=null};THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(e,t,r,n){var i=this;var o=new THREE.XHRLoader(i.manager);o.setPath(this.path);o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){this.path=e},setMaterials:function(e){this.materials=e},parse:function(e){console.time("OBJLoader");var t=[];var r;var n=false;var i=[];var o=[];var a=[];function s(e){var n={vertices:[],normals:[],uvs:[]};var i={name:"",smooth:true};r={name:e,geometry:n,material:i};t.push(r)}function c(e){var t=parseInt(e);return(t>=0?t-1:t+i.length/3)*3}function u(e){var t=parseInt(e);return(t>=0?t-1:t+o.length/3)*3}function l(e){var t=parseInt(e);return(t>=0?t-1:t+a.length/2)*2}function h(e,t,n){r.geometry.vertices.push(i[e],i[e+1],i[e+2],i[t],i[t+1],i[t+2],i[n],i[n+1],i[n+2])}function f(e,t,n){r.geometry.normals.push(o[e],o[e+1],o[e+2],o[t],o[t+1],o[t+2],o[n],o[n+1],o[n+2])}function p(e,t,n){r.geometry.uvs.push(a[e],a[e+1],a[t],a[t+1],a[n],a[n+1])}function d(e,t,r,n,i,o,a,s,d,m,E,g){var v=c(e);var y=c(t);var b=c(r);var T;if(n===undefined){h(v,y,b)}else{T=c(n);h(v,y,T);h(y,b,T)}if(i!==undefined){v=l(i);y=l(o);b=l(a);if(n===undefined){p(v,y,b)}else{T=l(s);p(v,y,T);p(y,b,T)}}if(d!==undefined){v=u(d);y=u(m);b=u(E);if(n===undefined){f(v,y,b)}else{T=u(g);f(v,y,T);f(y,b,T)}}}s("");var m=/^v\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/;var E=/^vn\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/;var g=/^vt\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/;var v=/^f\s+(-?\d+)\s+(-?\d+)\s+(-?\d+)(?:\s+(-?\d+))?/;var y=/^f\s+((-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+))(?:\s+((-?\d+)\/(-?\d+)))?/;var b=/^f\s+((-?\d+)\/(-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+)\/(-?\d+))\s+((-?\d+)\/(-?\d+)\/(-?\d+))(?:\s+((-?\d+)\/(-?\d+)\/(-?\d+)))?/;var T=/^f\s+((-?\d+)\/\/(-?\d+))\s+((-?\d+)\/\/(-?\d+))\s+((-?\d+)\/\/(-?\d+))(?:\s+((-?\d+)\/\/(-?\d+)))?/;var R=/^[og]\s+(.+)/;var w=/^s\s+(\d+|on|off)/;var x=e.split("\n");for(var H=0;H<x.length;H++){var _=x[H];_=_.trim();var S;if(_.length===0||_.charAt(0)==="#"){continue}else if((S=m.exec(_))!==null){i.push(parseFloat(S[1]),parseFloat(S[2]),parseFloat(S[3]))}else if((S=E.exec(_))!==null){o.push(parseFloat(S[1]),parseFloat(S[2]),parseFloat(S[3]))}else if((S=g.exec(_))!==null){a.push(parseFloat(S[1]),parseFloat(S[2]))}else if((S=v.exec(_))!==null){d(S[1],S[2],S[3],S[4])}else if((S=y.exec(_))!==null){d(S[2],S[5],S[8],S[11],S[3],S[6],S[9],S[12])}else if((S=b.exec(_))!==null){d(S[2],S[6],S[10],S[14],S[3],S[7],S[11],S[15],S[4],S[8],S[12],S[16])}else if((S=T.exec(_))!==null){d(S[2],S[5],S[8],S[11],undefined,undefined,undefined,undefined,S[3],S[6],S[9],S[12])}else if((S=R.exec(_))!==null){var M=S[1].trim();if(n===false){n=true;r.name=M}else{s(M)}}else if(/^usemtl /.test(_)){r.material.name=_.substring(7).trim()}else if(/^mtllib /.test(_)){}else if((S=w.exec(_))!==null){r.material.smooth=S[1]==="1"||S[1]==="on"}else{throw new Error("Unexpected line: "+_)}}var A=new THREE.Group;for(var H=0,C=t.length;H<C;H++){r=t[H];var k=r.geometry;var L=new THREE.BufferGeometry;L.addAttribute("position",new THREE.BufferAttribute(new Float32Array(k.vertices),3));if(k.normals.length>0){L.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(k.normals),3))}else{L.computeVertexNormals()}if(k.uvs.length>0){L.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(k.uvs),2))}var P;if(this.materials!==null){P=this.materials.create(r.material.name)}if(!P){P=new THREE.MeshPhongMaterial;P.name=r.material.name}P.shading=r.material.smooth?THREE.SmoothShading:THREE.FlatShading;var O=new THREE.Mesh(L,P);O.name=r.name;A.add(O)}console.timeEnd("OBJLoader");return A}};THREE.MTLLoader=function(e){this.manager=e!==undefined?e:THREE.DefaultLoadingManager};THREE.MTLLoader.prototype={constructor:THREE.MTLLoader,load:function(e,t,r,n){var i=this;var o=new THREE.XHRLoader(this.manager);o.setPath(this.path);o.load(e,function(e){t(i.parse(e))},r,n)},setPath:function(e){this.path=e},setBaseUrl:function(e){this.baseUrl=e},setCrossOrigin:function(e){this.crossOrigin=e},setMaterialOptions:function(e){this.materialOptions=e},parse:function(e){var t=e.split("\n");var r={};var n=/\s+/;var i={};for(var o=0;o<t.length;o++){var a=t[o];a=a.trim();if(a.length===0||a.charAt(0)==="#"){continue}var s=a.indexOf(" ");var c=s>=0?a.substring(0,s):a;c=c.toLowerCase();var u=s>=0?a.substring(s+1):"";u=u.trim();if(c==="newmtl"){r={name:u};i[u]=r}else if(r){if(c==="ka"||c==="kd"||c==="ks"){var l=u.split(n,3);r[c]=[parseFloat(l[0]),parseFloat(l[1]),parseFloat(l[2])]}else{r[c]=u}}}var h=new THREE.MTLLoader.MaterialCreator(this.baseUrl,this.materialOptions);h.setCrossOrigin(this.crossOrigin);h.setManager(this.manager);h.setMaterials(i);return h}};THREE.MTLLoader.MaterialCreator=function(e,t){this.baseUrl=e;this.options=t;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide;this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping};THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,setCrossOrigin:function(e){this.crossOrigin=e},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e);this.materials={};this.materialsArray=[];this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var r in e){var n=e[r];var i={};t[r]=i;for(var o in n){var a=true;var s=n[o];var c=o.toLowerCase();switch(c){case"kd":case"ka":case"ks":if(this.options&&this.options.normalizeRGB){s=[s[0]/255,s[1]/255,s[2]/255]}if(this.options&&this.options.ignoreZeroRGBs){if(s[0]===0&&s[1]===0&&s[1]===0){a=false}}break;default:break}if(a){i[c]=s}}}return t},preload:function(){for(var e in this.materialsInfo){this.create(e)}},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo){this.materialsArray[e]=this.create(t);this.nameLookup[t]=e;e++}return this.materialsArray},create:function(e){if(this.materials[e]===undefined){this.createMaterial_(e)}return this.materials[e]},createMaterial_:function(e){var t=this.materialsInfo[e];var r={name:e,side:this.side};for(var n in t){var i=t[n];if(i==="")continue;switch(n.toLowerCase()){case"kd":r["color"]=(new THREE.Color).fromArray(i);break;case"ks":r["specular"]=(new THREE.Color).fromArray(i);break;case"map_kd":r["map"]=this.loadTexture(this.baseUrl+i);r["map"].wrapS=this.wrap;r["map"].wrapT=this.wrap;break;case"ns":r["shininess"]=parseFloat(i);break;case"d":if(i<1){r["opacity"]=i;r["transparent"]=true}break;case"Tr":if(i>0){r["opacity"]=1-i;r["transparent"]=true}break;case"map_bump":case"bump":if(r["bumpMap"])break;r["bumpMap"]=this.loadTexture(this.baseUrl+i);r["bumpMap"].wrapS=this.wrap;r["bumpMap"].wrapT=this.wrap;break;default:break}}this.materials[e]=new THREE.MeshPhongMaterial(r);return this.materials[e]},loadTexture:function(e,t,r,n,i){var o;var a=THREE.Loader.Handlers.get(e);var s=this.manager!==undefined?this.manager:THREE.DefaultLoadingManager;
if(a===null){a=new THREE.TextureLoader(s)}if(a.setCrossOrigin)a.setCrossOrigin(this.crossOrigin);o=a.load(e,r,n,i);if(t!==undefined)o.mapping=t;return o}};THREE.EventDispatcher.prototype.apply(THREE.MTLLoader.prototype);(function(e,t){if(typeof define==="function"&&define.amd){define(["three"],t)}else if(typeof exports==="object"){module.exports=t(require("three"))}else{e.altspace=t(e.THREE)}})(this,function(THREE){(function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){var c=typeof require=="function"&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};t[a][0].call(l.exports,function(e){var r=t[a][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[a].exports}var o=typeof require=="function"&&require;for(var a=0;a<n.length;a++)i(n[a]);return i})({1:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/define-property"),__esModule:true}},{"core-js/library/fn/object/define-property":4}],2:[function(e,t,r){"use strict";r["default"]=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};r.__esModule=true},{}],3:[function(e,t,r){"use strict";var n=e("babel-runtime/core-js/object/define-property")["default"];r["default"]=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;n(e,i.key,i)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();r.__esModule=true},{"babel-runtime/core-js/object/define-property":1}],4:[function(e,t,r){var n=e("../../modules/$");t.exports=function e(t,r,i){return n.setDesc(t,r,i)}},{"../../modules/$":5}],5:[function(e,t,r){var n=Object;t.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},{}],6:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"];var i=e("babel-runtime/helpers/class-call-check")["default"];if(!window.altspace){window.altspace={}}if(!window.altspace.utilities){window.altspace.utilities={}}if(!window.altspace.utilities.shims){window.altspace.utilities.shims={}}var o=function(){function e(){i(this,e)}n(e,[{key:"load",value:function e(t,r,n){var i=new THREE.MTLLoader;var o=r.split("/").slice(0,-1).join("/");i.setBaseUrl(o+"/");i.load(r,function(e){var r=new THREE.OBJLoader;r.setMaterials(e);r.load(t,n)})}}]);return e}();window.altspace.utilities.shims.OBJMTLLoader=o},{"babel-runtime/helpers/class-call-check":2,"babel-runtime/helpers/create-class":3}]},{},[6]);(function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){var c=typeof require=="function"&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};t[a][0].call(l.exports,function(e){var r=t[a][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[a].exports}var o=typeof require=="function"&&require;for(var a=0;a<n.length;a++)i(n[a]);return i})({1:[function(e,t,r){(function(e){var n={function:true,object:true};var i=n[typeof r]&&r&&!r.nodeType?r:undefined;var o=n[typeof t]&&t&&!t.nodeType?t:undefined;var a=h(i&&o&&typeof e=="object"&&e);var s=h(n[typeof self]&&self);var c=h(n[typeof window]&&window);var u=h(n[typeof this]&&this);var l=a||c!==(u&&u.window)&&c||s||u||Function("return this")();function h(e){return e&&e.Object===Object?e:null}t.exports=l}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],2:[function(e,t,r){(function(e){var n=200;var i="__lodash_hash_undefined__";var o="[object Function]",a="[object GeneratorFunction]";var s=/[\\^$.*+?()[\]{}|]/g;var c=/^\[object .+?Constructor\]$/;var u={function:true,object:true};var l=u[typeof r]&&r&&!r.nodeType?r:undefined;var h=u[typeof t]&&t&&!t.nodeType?t:undefined;var f=g(l&&h&&typeof e=="object"&&e);var p=g(u[typeof self]&&self);var d=g(u[typeof window]&&window);var m=g(u[typeof this]&&this);var E=f||d!==(m&&m.window)&&d||p||m||Function("return this")();function g(e){return e&&e.Object===Object?e:null}function v(e){var t=false;if(e!=null&&typeof e.toString!="function"){try{t=!!(e+"")}catch(e){}}return t}var y=Array.prototype,b=Object.prototype;var T=Function.prototype.toString;var R=b.hasOwnProperty;var w=b.toString;var x=RegExp("^"+T.call(R).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var H=y.splice;var _=K(E,"Map"),S=K(Object,"create");function M(){}function A(e,t){return k(e,t)&&delete e[t]}function C(e,t){if(S){var r=e[t];return r===i?undefined:r}return R.call(e,t)?e[t]:undefined}function k(e,t){return S?e[t]!==undefined:R.call(e,t)}function L(e,t,r){e[t]=S&&r===undefined?i:r}M.prototype=S?S(null):b;function P(e){var t=-1,r=e?e.length:0;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}function O(){this.__data__={hash:new M,map:_?new _:[],string:new M}}function N(e){var t=this.__data__;if(Q(e)){return A(typeof e=="string"?t.string:t.hash,e)}return _?t.map["delete"](e):z(t.map,e)}function F(e){var t=this.__data__;if(Q(e)){return C(typeof e=="string"?t.string:t.hash,e)}return _?t.map.get(e):W(t.map,e)}function I(e){var t=this.__data__;if(Q(e)){return k(typeof e=="string"?t.string:t.hash,e)}return _?t.map.has(e):q(t.map,e)}function B(e,t){var r=this.__data__;if(Q(e)){L(typeof e=="string"?r.string:r.hash,e,t)}else if(_){r.map.set(e,t)}else{Y(r.map,e,t)}return this}P.prototype.clear=O;P.prototype["delete"]=N;P.prototype.get=F;P.prototype.has=I;P.prototype.set=B;function j(e){var t=-1,r=e?e.length:0;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}function D(){this.__data__={array:[],map:null}}function U(e){var t=this.__data__,r=t.array;return r?z(r,e):t.map["delete"](e)}function $(e){var t=this.__data__,r=t.array;return r?W(r,e):t.map.get(e)}function V(e){var t=this.__data__,r=t.array;return r?q(r,e):t.map.has(e)}function G(e,t){var r=this.__data__,i=r.array;if(i){if(i.length<n-1){Y(i,e,t)}else{r.array=null;r.map=new P(i)}}var o=r.map;if(o){o.set(e,t)}return this}j.prototype.clear=D;j.prototype["delete"]=U;j.prototype.get=$;j.prototype.has=V;j.prototype.set=G;function z(e,t){var r=X(e,t);if(r<0){return false}var n=e.length-1;if(r==n){e.pop()}else{H.call(e,r,1)}return true}function W(e,t){var r=X(e,t);return r<0?undefined:e[r][1]}function q(e,t){return X(e,t)>-1}function X(e,t){var r=e.length;while(r--){if(Z(e[r][0],t)){return r}}return-1}function Y(e,t,r){var n=X(e,t);if(n<0){e.push([t,r])}else{e[n][1]=r}}function K(e,t){var r=e[t];return re(r)?r:undefined}function Q(e){var t=typeof e;return t=="number"||t=="boolean"||t=="string"&&e!="__proto__"||e==null}function J(e){if(e!=null){try{return T.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Z(e,t){return e===t||e!==e&&t!==t}function ee(e){var t=te(e)?w.call(e):"";return t==o||t==a}function te(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function re(e){if(!te(e)){return false}var t=ee(e)||v(e)?x:c;return t.test(J(e))}t.exports=j}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],3:[function(e,t,r){var n=e("lodash._stack"),i=e("lodash.keys"),o=e("lodash._root");var a=1,s=2;var c=9007199254740991;var u="[object Arguments]",l="[object Array]",h="[object Boolean]",f="[object Date]",p="[object Error]",d="[object Function]",m="[object GeneratorFunction]",E="[object Map]",g="[object Number]",v="[object Object]",y="[object Promise]",b="[object RegExp]",T="[object Set]",R="[object String]",w="[object Symbol]",x="[object WeakMap]";var H="[object ArrayBuffer]",_="[object DataView]",S="[object Float32Array]",M="[object Float64Array]",A="[object Int8Array]",C="[object Int16Array]",k="[object Int32Array]",L="[object Uint8Array]",P="[object Uint8ClampedArray]",O="[object Uint16Array]",N="[object Uint32Array]";var F=/[\\^$.*+?()[\]{}|]/g;var I=/^\[object .+?Constructor\]$/;var B={};B[S]=B[M]=B[A]=B[C]=B[k]=B[L]=B[P]=B[O]=B[N]=true;B[u]=B[l]=B[H]=B[h]=B[_]=B[f]=B[p]=B[d]=B[E]=B[g]=B[v]=B[b]=B[T]=B[R]=B[x]=false;function j(e,t){var r=-1,n=e.length;while(++r<n){if(t(e[r],r,e)){return true}}return false}function D(e){var t=false;if(e!=null&&typeof e.toString!="function"){try{t=!!(e+"")}catch(e){}}return t}function U(e){var t=-1,r=Array(e.size);e.forEach(function(e,n){r[++t]=[n,e]});return r}function $(e){var t=-1,r=Array(e.size);e.forEach(function(e){r[++t]=e});return r}var V=Object.prototype;var G=Function.prototype.toString;var z=V.hasOwnProperty;var W=V.toString;var q=RegExp("^"+G.call(z).replace(F,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var X=o.Symbol,Y=o.Uint8Array;var K=Object.getPrototypeOf;var Q=me(o,"DataView"),J=me(o,"Map"),Z=me(o,"Promise"),ee=me(o,"Set"),te=me(o,"WeakMap");var re=Q?Q+"":"",ne=J?G.call(J):"",ie=Z?G.call(Z):"",oe=ee?G.call(ee):"",ae=te?G.call(te):"";var se=X?X.prototype:undefined,ce=se?se.valueOf:undefined;function ue(e,t){return z.call(e,t)||typeof e=="object"&&t in e&&Ee(e)===null}function le(e,t,r,n,i){if(e===t){return true}if(e==null||t==null||!Re(e)&&!we(t)){return e!==e&&t!==t}return he(e,t,le,r,n,i)}function he(e,t,r,i,o,a){var c=ve(e),h=ve(t),f=l,p=l;if(!c){f=ge(e);f=f==u?v:f}if(!h){p=ge(t);p=p==u?v:p}var d=f==v&&!D(e),m=p==v&&!D(t),E=f==p;if(E&&!d){a||(a=new n);return c||He(e)?fe(e,t,r,i,o,a):pe(e,t,f,r,i,o,a)}if(!(o&s)){var g=d&&z.call(e,"__wrapped__"),y=m&&z.call(t,"__wrapped__");if(g||y){var b=g?e.value():e,T=y?t.value():t;a||(a=new n);return r(b,T,i,o,a)}}if(!E){return false}a||(a=new n);return de(e,t,r,i,o,a)}function fe(e,t,r,n,i,o){var c=-1,u=i&s,l=i&a,h=e.length,f=t.length;if(h!=f&&!(u&&f>h)){return false}var p=o.get(e);if(p){return p==t}var d=true;o.set(e,t);while(++c<h){var m=e[c],E=t[c];if(n){var g=u?n(E,m,c,t,e,o):n(m,E,c,e,t,o)}if(g!==undefined){if(g){continue}d=false;break}if(l){if(!j(t,function(e){return m===e||r(m,e,n,i,o)})){d=false;break}}else if(!(m===E||r(m,E,n,i,o))){d=false;break}}o["delete"](e);return d}function pe(e,t,r,n,i,o,c){switch(r){case _:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset){return false}e=e.buffer;t=t.buffer;case H:if(e.byteLength!=t.byteLength||!n(new Y(e),new Y(t))){return false}return true;case h:case f:return+e==+t;case p:return e.name==t.name&&e.message==t.message;case g:return e!=+e?t!=+t:e==+t;case b:case R:return e==t+"";case E:var u=U;case T:var l=o&s;u||(u=$);if(e.size!=t.size&&!l){return false}var d=c.get(e);if(d){return d==t}o|=a;c.set(e,t);return fe(u(e),u(t),n,i,o,c);case w:if(ce){return ce.call(e)==ce.call(t)}}return false}function de(e,t,r,n,o,a){var c=o&s,u=i(e),l=u.length,h=i(t),f=h.length;if(l!=f&&!c){return false}var p=l;while(p--){var d=u[p];if(!(c?d in t:ue(t,d))){return false}}var m=a.get(e);if(m){return m==t}var E=true;a.set(e,t);var g=c;while(++p<l){d=u[p];var v=e[d],y=t[d];if(n){var b=c?n(y,v,d,t,e,a):n(v,y,d,e,t,a)}if(!(b===undefined?v===y||r(v,y,n,o,a):b)){E=false;break}g||(g=d=="constructor")}if(E&&!g){var T=e.constructor,R=t.constructor;if(T!=R&&("constructor"in e&&"constructor"in t)&&!(typeof T=="function"&&T instanceof T&&typeof R=="function"&&R instanceof R)){E=false}}a["delete"](e);return E}function me(e,t){var r=e[t];return xe(r)?r:undefined}function Ee(e){return K(Object(e))}function ge(e){return W.call(e)}if(Q&&ge(new Q(new ArrayBuffer(1)))!=_||J&&ge(new J)!=E||Z&&ge(Z.resolve())!=y||ee&&ge(new ee)!=T||te&&ge(new te)!=x){ge=function(e){var t=W.call(e),r=t==v?e.constructor:null,n=typeof r=="function"?G.call(r):"";if(n){switch(n){case re:return _;case ne:return E;case ie:return y;case oe:return T;case ae:return x}}return t}}var ve=Array.isArray;function ye(e,t){return le(e,t)}function be(e){var t=Re(e)?W.call(e):"";return t==d||t==m}function Te(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=c}function Re(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function we(e){return!!e&&typeof e=="object"}function xe(e){if(e==null){return false}if(be(e)){return q.test(G.call(e))}return we(e)&&(D(e)?q:I).test(e)}function He(e){return we(e)&&Te(e.length)&&!!B[W.call(e)]}t.exports=ye},{"lodash._root":1,"lodash._stack":2,"lodash.keys":4}],4:[function(e,t,r){var n=9007199254740991;var i="[object Arguments]",o="[object Function]",a="[object GeneratorFunction]",s="[object String]";var c=/^(?:0|[1-9]\d*)$/;function u(e,t){var r=-1,n=Array(e);while(++r<e){n[r]=t(r)}return n}var l=Object.prototype;var h=l.hasOwnProperty;var f=l.toString;var p=l.propertyIsEnumerable;var d=Object.getPrototypeOf,m=Object.keys;function E(e,t){return h.call(e,t)||typeof e=="object"&&t in e&&b(e)===null}function g(e){return m(Object(e))}function v(e){return function(t){return t==null?undefined:t[e]}}var y=v("length");function b(e){return d(Object(e))}function T(e){var t=e?e.length:undefined;if(A(t)&&(H(e)||L(e)||x(e))){return u(t,String)}return null}function R(e,t){t=t==null?n:t;return!!t&&(typeof e=="number"||c.test(e))&&(e>-1&&e%1==0&&e<t)}function w(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||l;return e===r}function x(e){return S(e)&&h.call(e,"callee")&&(!p.call(e,"callee")||f.call(e)==i)}var H=Array.isArray;function _(e){return e!=null&&A(y(e))&&!M(e)}function S(e){return k(e)&&_(e)}function M(e){var t=C(e)?f.call(e):"";return t==o||t==a}function A(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=n}function C(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function k(e){return!!e&&typeof e=="object"}function L(e){return typeof e=="string"||!H(e)&&k(e)&&f.call(e)==s}function P(e){var t=w(e);if(!(t||_(e))){return g(e)}var r=T(e),n=!!r,i=r||[],o=i.length;for(var a in e){if(E(e,a)&&!(n&&(a=="length"||R(a,o)))&&!(t&&a=="constructor")){i.push(a)}}return i}t.exports=P},{}],5:[function(e,t,r){window.altspace=window.altspace||{};window.altspace.utilities=window.altspace.utilities||{};window.altspace.utilities.behaviors=window.altspace.utilities.behaviors||{};window.altspace.utilities.behaviors.Object3DSync=function(t){t=t||{};var r;var n;var i;var o;var a;var s;var c;var u;var l=false;var h=new THREE.Vector3;var f=new THREE.Quaternion;var p=new THREE.Vector3;var d=e("lodash.isequal");function m(e,t){i=e;o=i.key();c=i.child("batch");a=i.child("data");s=i.child("owner");u=t}function E(){c.on("value",function(e){if(l)return;var n=e.val();if(!n)return;if(t.position){r.position.set(n.position.x,n.position.y,n.position.z)}if(t.rotation){r.quaternion.set(n.quaternion.x,n.quaternion.y,n.quaternion.z,n.quaternion.w)}if(t.scale){r.scale.set(n.scale.x,n.scale.y,n.scale.z)}});s.on("value",function(e){var t=e.val();var n=t===u.clientId&&!l;if(n)r.dispatchEvent({type:"ownershipgained"});var i=t!==u.clientId&&l;if(i)r.dispatchEvent({type:"ownershiplost"});l=t===u.clientId})}function g(){if(!l)return;var e={};if(t.world){r.updateMatrixWorld();r.matrixWorld.decompose(h,f,p)}else{h=r.position;f=r.quaternion;p=r.scale}if(t.position){e.position={x:h.x,y:h.y,z:h.z}}if(t.rotation){e.quaternion={x:f.x,y:f.y,z:f.z,w:f.w}}if(t.scale){e.scale={x:p.x,y:p.y,z:p.z}}if(Object.keys(e).length>0){if(d(e,this.lastTransform)){return}c.set(e);this.lastTransform=e}}function v(e,t){r=e;n=t;E()}function y(e){}function b(){s.set(u.clientId)}var T={awake:v,update:y,type:"Object3DSync",link:m,autoSend:g,takeOwnership:b};Object.defineProperty(T,"dataRef",{get:function(){return a}});Object.defineProperty(T,"isMine",{get:function(){return l}});return T}},{"lodash.isequal":3}]},{},[5]);!function(e,t,r){"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?module.exports=r():t[e]=r()}("Please",this,function(){"use strict";function e(){function e(e,t,r){var n=Math.random;return r instanceof a&&(n=r.random),Math.floor(n()*(t-e+1))+e}function t(e,t,r){var n=Math.random;return r instanceof a&&(n=r.random),n()*(t-e)+e}function r(e,t,r){return Math.max(t,Math.min(e,r))}function n(e,t){var r;switch(e){case"hex":for(r=0;r<t.length;r++)t[r]=s.HSV_to_HEX(t[r]);break;case"rgb":for(r=0;r<t.length;r++)t[r]=s.HSV_to_RGB(t[r]);break;case"rgb-string":for(r=0;r<t.length;r++){var n=s.HSV_to_RGB(t[r]);t[r]="rgb("+n.r+","+n.g+","+n.b+")"}break;case"hsv":break;default:console.error("Format not recognized.")}return t}function i(e){var t=s.HSV_to_RGB(e),r=(299*t.r+587*t.g+114*t.b)/1e3;return r>=128?"dark":"light"}function o(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function a(e){function t(){n=(n+1)%256,i=(i+r[n])%256;var e=r[n];return r[n]=r[i],r[i]=e,r[(r[n]+r[i])%256]}for(var r=[],n=0,i=0,o=0;256>o;o++)r[o]=o;for(var a=0,s=0;256>a;a++){s=(s+r[a]+e.charCodeAt(a%e.length))%256;var c=r[a];r[a]=r[s],r[s]=c}this.random=function(){for(var e=0,r=0,n=1;8>e;e++)r+=t()*n,n*=256;return r/0x10000000000000000}}var s={},c={aliceblue:"F0F8FF",antiquewhite:"FAEBD7",aqua:"00FFFF",aquamarine:"7FFFD4",azure:"F0FFFF",beige:"F5F5DC",bisque:"FFE4C4",black:"000000",blanchedalmond:"FFEBCD",blue:"0000FF",blueviolet:"8A2BE2",brown:"A52A2A",burlywood:"DEB887",cadetblue:"5F9EA0",chartreuse:"7FFF00",chocolate:"D2691E",coral:"FF7F50",cornflowerblue:"6495ED",cornsilk:"FFF8DC",crimson:"DC143C",cyan:"00FFFF",darkblue:"00008B",darkcyan:"008B8B",darkgoldenrod:"B8860B",darkgray:"A9A9A9",darkgrey:"A9A9A9",darkgreen:"006400",darkkhaki:"BDB76B",darkmagenta:"8B008B",darkolivegreen:"556B2F",darkorange:"FF8C00",darkorchid:"9932CC",darkred:"8B0000",darksalmon:"E9967A",darkseagreen:"8FBC8F",darkslateblue:"483D8B",darkslategray:"2F4F4F",darkslategrey:"2F4F4F",darkturquoise:"00CED1",darkviolet:"9400D3",deeppink:"FF1493",deepskyblue:"00BFFF",dimgray:"696969",dimgrey:"696969",dodgerblue:"1E90FF",firebrick:"B22222",floralwhite:"FFFAF0",forestgreen:"228B22",fuchsia:"FF00FF",gainsboro:"DCDCDC",ghostwhite:"F8F8FF",gold:"FFD700",goldenrod:"DAA520",gray:"808080",grey:"808080",green:"008000",greenyellow:"ADFF2F",honeydew:"F0FFF0",hotpink:"FF69B4",indianred:"CD5C5C",indigo:"4B0082",ivory:"FFFFF0",khaki:"F0E68C",lavender:"E6E6FA",lavenderblush:"FFF0F5",lawngreen:"7CFC00",lemonchiffon:"FFFACD",lightblue:"ADD8E6",lightcoral:"F08080",lightcyan:"E0FFFF",lightgoldenrodyellow:"FAFAD2",lightgray:"D3D3D3",lightgrey:"D3D3D3",lightgreen:"90EE90",lightpink:"FFB6C1",lightsalmon:"FFA07A",lightseagreen:"20B2AA",lightskyblue:"87CEFA",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"B0C4DE",lightyellow:"FFFFE0",lime:"00FF00",limegreen:"32CD32",linen:"FAF0E6",magenta:"FF00FF",maroon:"800000",mediumaquamarine:"66CDAA",mediumblue:"0000CD",mediumorchid:"BA55D3",mediumpurple:"9370D8",mediumseagreen:"3CB371",mediumslateblue:"7B68EE",mediumspringgreen:"00FA9A",mediumturquoise:"48D1CC",mediumvioletred:"C71585",midnightblue:"191970",mintcream:"F5FFFA",mistyrose:"FFE4E1",moccasin:"FFE4B5",navajowhite:"FFDEAD",navy:"000080",oldlace:"FDF5E6",olive:"808000",olivedrab:"6B8E23",orange:"FFA500",orangered:"FF4500",orchid:"DA70D6",palegoldenrod:"EEE8AA",palegreen:"98FB98",paleturquoise:"AFEEEE",palevioletred:"D87093",papayawhip:"FFEFD5",peachpuff:"FFDAB9",peru:"CD853F",pink:"FFC0CB",plum:"DDA0DD",powderblue:"B0E0E6",purple:"800080",rebeccapurple:"663399",red:"FF0000",rosybrown:"BC8F8F",royalblue:"4169E1",saddlebrown:"8B4513",salmon:"FA8072",sandybrown:"F4A460",seagreen:"2E8B57",seashell:"FFF5EE",sienna:"A0522D",silver:"C0C0C0",skyblue:"87CEEB",slateblue:"6A5ACD",slategray:"708090",slategrey:"708090",snow:"FFFAFA",springgreen:"00FF7F",steelblue:"4682B4",tan:"D2B48C",teal:"008080",thistle:"D8BFD8",tomato:"FF6347",turquoise:"40E0D0",violet:"EE82EE",wheat:"F5DEB3",white:"FFFFFF",whitesmoke:"F5F5F5",yellow:"FFFF00",yellowgreen:"9ACD32"},u=.618033988749895,l={hue:null,saturation:null,value:null,base_color:"",greyscale:!1,grayscale:!1,golden:!0,full_random:!1,colors_returned:1,format:"hex",seed:null},h={scheme_type:"analogous",format:"hex"},f={golden:!1,format:"hex"};return s.NAME_to_HEX=function(e){return e=e.toLowerCase(),e in c?c[e]:(console.error("Color name not recognized."),void 0)},s.NAME_to_RGB=function(e){return s.HEX_to_RGB(s.NAME_to_HEX(e))},s.NAME_to_HSV=function(e){return s.HEX_to_HSV(s.NAME_to_HEX(e))},s.HEX_to_RGB=function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,r,n){return t+t+r+r+n+n});var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return r?{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16)}:null},s.RGB_to_HEX=function(e){return"#"+((1<<24)+(e.r<<16)+(e.g<<8)+e.b).toString(16).slice(1)},s.HSV_to_RGB=function(e){var t,r,n,i,o,a,s,c,u=e.h,l=e.s,h=e.v;if(0===l)return{r:h,g:h,b:h};switch(u/=60,i=Math.floor(u),o=u-i,a=h*(1-l),s=h*(1-l*o),c=h*(1-l*(1-o)),i){case 0:t=h,r=c,n=a;break;case 1:t=s,r=h,n=a;break;case 2:t=a,r=h,n=c;break;case 3:t=a,r=s,n=h;break;case 4:t=c,r=a,n=h;break;case 5:t=h,r=a,n=s}return{r:Math.floor(255*t),g:Math.floor(255*r),b:Math.floor(255*n)}},s.RGB_to_HSV=function(e){var t=e.r/255,r=e.g/255,n=e.b/255,i=0,o=0,a=0,s=Math.min(t,Math.min(r,n)),c=Math.max(t,Math.max(r,n));if(s===c)return a=s,{h:0,s:0,v:a};var u=t===s?r-n:n===s?t-r:n-t,l=t===s?3:n===s?1:5;return i=60*(l-u/(c-s)),o=(c-s)/c,a=c,{h:i,s:o,v:a}},s.HSV_to_HEX=function(e){return s.RGB_to_HEX(s.HSV_to_RGB(e))},s.HEX_to_HSV=function(e){return s.RGB_to_HSV(s.HEX_to_RGB(e))},s.make_scheme=function(e,t){function i(e){return{h:e.h,s:e.s,v:e.v}}var a,s,c,u,l,f=o(h);if(null!==t)for(var p in t)t.hasOwnProperty(p)&&(f[p]=t[p]);var d=[e];switch(f.scheme_type.toLowerCase()){case"monochromatic":case"mono":for(l=1;2>=l;l++)a=i(e),c=a.s+.1*l,c=r(c,0,1),u=a.v+.1*l,u=r(u,0,1),a.s=c,a.v=u,d.push(a);for(l=1;2>=l;l++)a=i(e),c=a.s-.1*l,c=r(c,0,1),u=a.v-.1*l,u=r(u,0,1),a.s=c,a.v=u,d.push(a);break;case"complementary":case"complement":case"comp":a=i(e),a.h=(a.h+180)%360,d.push(a);break;case"split-complementary":case"split-complement":case"split":a=i(e),a.h=(a.h+165)%360,d.push(a),a=i(e),a.h=Math.abs((a.h-165)%360),d.push(a);break;case"double-complementary":case"double-complement":case"double":a=i(e),a.h=(a.h+180)%360,d.push(a),a.h=(a.h+30)%360,s=i(a),d.push(a),a.h=(a.h+180)%360,d.push(s);break;case"analogous":case"ana":for(l=1;5>=l;l++)a=i(e),a.h=(a.h+20*l)%360,d.push(a);break;case"triadic":case"triad":case"tri":for(l=1;3>l;l++)a=i(e),a.h=(a.h+120*l)%360,d.push(a);break;default:console.error("Color scheme not recognized.")}return n(f.format.toLowerCase(),d),d},s.make_color=function(i){var c=[],h=o(l),f=null;if(null!==i)for(var p in i)i.hasOwnProperty(p)&&(h[p]=i[p]);var d=null;"string"==typeof h.seed&&(d=new a(h.seed)),h.base_color.length>0&&(f=h.base_color.match(/^#?([0-9a-f]{3})([0-9a-f]{3})?$/i)?s.HEX_to_HSV(h.base_color):s.NAME_to_HSV(h.base_color));for(var m=0;m<h.colors_returned;m++){var E,g,v,y=e(0,360,d);null!==f?(E=r(e(f.h-5,f.h+5,d),0,360),g=0===f.s?0:t(.4,.85,d),v=t(.4,.85,d),c.push({h:E,s:g,v:v})):(E=h.greyscale===!0||h.grayscale===!0?0:h.golden===!0?(y+y/u)%360:null===h.hue||h.full_random===!0?y:r(h.hue,0,360),g=h.greyscale===!0||h.grayscale===!0?0:h.full_random===!0?t(0,1,d):null===h.saturation?.4:r(h.saturation,0,1),v=h.full_random===!0?t(0,1,d):h.greyscale===!0||h.grayscale===!0?t(.15,.75,d):null===h.value?.75:r(h.value,0,1),c.push({h:E,s:g,v:v}))}return n(h.format.toLowerCase(),c),c},s.make_contrast=function(e,t){var a=o(f);if(null!==t)for(var c in t)t.hasOwnProperty(c)&&(a[c]=t[c]);var l,h,p=i(e);if(a.golden===!0)h=e.h*(1+u)%360;else{var d=s.make_scheme(e,{scheme_type:"complementary",format:"hsv"})[1];h=r(d.h-30,0,360)}var m;return"dark"===p?m=r(e.v-.25,0,1):"light"===p&&(m=r(e.v+.25,0,1)),l=[{h:h,s:e.s,v:m}],n(a.format.toLowerCase(),l),l[0]},s}return e()});var Url=function(){"use strict";var e={protocol:"protocol",host:"hostname",port:"port",path:"pathname",query:"search",hash:"hash"},t={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443},r=function(r,n){var o=document,a=o.createElement("a"),n=n||o.location.href,s=n.match(/\/\/(.*?)(?::(.*?))?@/)||[];a.href=n;for(var c in e){r[c]=a[e[c]]||""}r.protocol=r.protocol.replace(/:$/,"");r.query=r.query.replace(/^\?/,"");r.hash=r.hash.replace(/^#/,"");r.user=s[1]||"";r.pass=s[2]||"";r.port=t[r.protocol]==r.port||r.port==0?"":r.port;if(!r.protocol&&!/^([a-z]+:)?\/\//.test(n)){var u=new Url(o.location.href.match(/(.*\/)/)[0]),l=u.path.split("/"),h=r.path.split("/");l.pop();for(var c=0,f=["protocol","user","pass","host","port"],p=f.length;c<p;c++){r[f[c]]=u[f[c]]}while(h[0]==".."){l.pop();h.shift()}r.path=(n.substring(0,1)!="/"?l.join("/"):"")+"/"+h.join("/")}else{r.path=r.path.replace(/^\/?/,"/")}i(r)},n=function(e){e=e.replace(/\+/g," ");e=e.replace(/%([ef][0-9a-f])%([89ab][0-9a-f])%([89ab][0-9a-f])/gi,function(e,t,r,n){var i=parseInt(t,16)-224,o=parseInt(r,16)-128;if(i==0&&o<32){return e}var a=parseInt(n,16)-128,s=(i<<12)+(o<<6)+a;if(s>65535){return e}return String.fromCharCode(s)});e=e.replace(/%([cd][0-9a-f])%([89ab][0-9a-f])/gi,function(e,t,r){var n=parseInt(t,16)-192;if(n<2){return e}var i=parseInt(r,16)-128;return String.fromCharCode((n<<6)+i)});e=e.replace(/%([0-7][0-9a-f])/gi,function(e,t){return String.fromCharCode(parseInt(t,16))});return e},i=function(e){var t=e.query;e.query=new function(e){var t=/([^=&]+)(=([^&]*))?/g,r;while(r=t.exec(e)){var i=decodeURIComponent(r[1].replace(/\+/g," ")),o=r[3]?n(r[3]):"";if(this[i]!=null){if(!(this[i]instanceof Array)){this[i]=[this[i]]}this[i].push(o)}else{this[i]=o}}this.clear=function(){for(i in this){if(!(this[i]instanceof Function)){delete this[i]}}};this.toString=function(){var e="",t=encodeURIComponent;for(var r in this){if(this[r]instanceof Function){continue}if(this[r]instanceof Array){var n=this[r].length;if(n){for(var i=0;i<n;i++){e+=e?"&":"";e+=t(r)+"="+t(this[r][i])}}else{e+=(e?"&":"")+t(r)+"="}}else{e+=e?"&":"";e+=t(r)+"="+t(this[r])}}return e}}(t)};return function(e){this.toString=function(){return(this.protocol&&this.protocol+"://")+(this.user&&this.user+(this.pass&&":"+this.pass)+"@")+(this.host&&this.host)+(this.port&&":"+this.port)+(this.path&&this.path)+(this.query.toString()&&"?"+this.query)+(this.hash&&"#"+this.hash)};r(this,e)}}();(function(){var g,aa=this;function n(e){return void 0!==e}function ba(){}function ca(e){e.vb=function(){return e.uf?e.uf:e.uf=new e}}function da(e){var t=typeof e;if("object"==t)if(e){if(e instanceof Array)return"array";if(e instanceof Object)return t;var r=Object.prototype.toString.call(e);if("[object Window]"==r)return"object";if("[object Array]"==r||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==r||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==t&&"undefined"==typeof e.call)return"object";return t}function ea(e){return"array"==da(e)}function fa(e){var t=da(e);return"array"==t||"object"==t&&"number"==typeof e.length}function p(e){return"string"==typeof e}function ga(e){return"number"==typeof e}function ha(e){return"function"==da(e)}function ia(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function ja(e,t,r){return e.call.apply(e.bind,arguments)}function ka(e,t,r){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(r,n);return e.apply(t,r)}}return function(){return e.apply(t,arguments)}}function q(e,t,r){q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ja:ka;return q.apply(null,arguments)}var la=Date.now||function(){return+new Date};function ma(e,t){function r(){}r.prototype=t.prototype;e.$g=t.prototype;e.prototype=new r;e.prototype.constructor=e;e.Wg=function(e,r,n){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[r].apply(e,i)}}function r(e,t){for(var r in e)t.call(void 0,e[r],r,e)}function na(e,t){var r={},n;for(n in e)r[n]=t.call(void 0,e[n],n,e);return r}function oa(e,t){for(var r in e)if(!t.call(void 0,e[r],r,e))return!1;return!0}function pa(e){var t=0,r;for(r in e)t++;return t}function qa(e){for(var t in e)return t}function ra(e){var t=[],r=0,n;for(n in e)t[r++]=e[n];return t}function sa(e){var t=[],r=0,n;for(n in e)t[r++]=n;return t}function ta(e,t){for(var r in e)if(e[r]==t)return!0;return!1}function ua(e,t,r){for(var n in e)if(t.call(r,e[n],n,e))return n}function va(e,t){var r=ua(e,t,void 0);return r&&e[r]}function wa(e){for(var t in e)return!1;return!0}function xa(e){var t={},r;for(r in e)t[r]=e[r];return t}var ya="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function za(e,t){for(var r,n,i=1;i<arguments.length;i++){n=arguments[i];for(r in n)e[r]=n[r];for(var o=0;o<ya.length;o++)r=ya[o],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}}function Aa(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(e){}throw Error("Invalid JSON string: "+a)}function Ba(){this.Sd=void 0}function Ca(e,t,r){switch(typeof t){case"string":Da(t,r);break;case"number":r.push(isFinite(t)&&!isNaN(t)?t:"null");break;case"boolean":r.push(t);break;case"undefined":r.push("null");break;case"object":if(null==t){r.push("null");break}if(ea(t)){var n=t.length;r.push("[");for(var i="",o=0;o<n;o++)r.push(i),i=t[o],Ca(e,e.Sd?e.Sd.call(t,String(o),i):i,r),i=",";r.push("]");break}r.push("{");n="";for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&(i=t[o],"function"!=typeof i&&(r.push(n),Da(o,r),r.push(":"),Ca(e,e.Sd?e.Sd.call(t,o,i):i,r),n=","));r.push("}");break;case"function":break;default:throw Error("Unknown type: "+typeof t)}}var Ea={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Fa=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function Da(e,t){t.push('"',e.replace(Fa,function(e){if(e in Ea)return Ea[e];var t=e.charCodeAt(0),r="\\u";16>t?r+="000":256>t?r+="00":4096>t&&(r+="0");return Ea[e]=r+t.toString(16)}),'"')}function Ga(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^la()).toString(36)}var Ha;e:{var Ia=aa.navigator;if(Ia){var Ja=Ia.userAgent;if(Ja){Ha=Ja;break e}}Ha=""}function Ka(){this.Wa=-1}function La(){this.Wa=-1;this.Wa=64;this.P=[];this.ne=[];this.Uf=[];this.Ld=[];this.Ld[0]=128;for(var e=1;e<this.Wa;++e)this.Ld[e]=0;this.ee=this.ac=0;this.reset()}ma(La,Ka);La.prototype.reset=function(){this.P[0]=1732584193;this.P[1]=4023233417;this.P[2]=2562383102;this.P[3]=271733878;this.P[4]=3285377520;this.ee=this.ac=0};function Ma(e,t,r){r||(r=0);var n=e.Uf;if(p(t))for(var i=0;16>i;i++)n[i]=t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|t.charCodeAt(r+3),r+=4;else for(i=0;16>i;i++)n[i]=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3],r+=4;for(i=16;80>i;i++){var o=n[i-3]^n[i-8]^n[i-14]^n[i-16];n[i]=(o<<1|o>>>31)&4294967295}t=e.P[0];r=e.P[1];for(var a=e.P[2],s=e.P[3],c=e.P[4],u,i=0;80>i;i++)40>i?20>i?(o=s^r&(a^s),u=1518500249):(o=r^a^s,u=1859775393):60>i?(o=r&a|s&(r|a),u=2400959708):(o=r^a^s,u=3395469782),o=(t<<5|t>>>27)+o+c+u+n[i]&4294967295,c=s,s=a,a=(r<<30|r>>>2)&4294967295,r=t,t=o;e.P[0]=e.P[0]+t&4294967295;e.P[1]=e.P[1]+r&4294967295;e.P[2]=e.P[2]+a&4294967295;e.P[3]=e.P[3]+s&4294967295;e.P[4]=e.P[4]+c&4294967295}La.prototype.update=function(e,t){if(null!=e){n(t)||(t=e.length);for(var r=t-this.Wa,i=0,o=this.ne,a=this.ac;i<t;){if(0==a)for(;i<=r;)Ma(this,e,i),i+=this.Wa;if(p(e))for(;i<t;){if(o[a]=e.charCodeAt(i),++a,++i,a==this.Wa){Ma(this,o);a=0;break}}else for(;i<t;)if(o[a]=e[i],++a,++i,a==this.Wa){Ma(this,o);a=0;break}}this.ac=a;this.ee+=t}};var u=Array.prototype,Na=u.indexOf?function(e,t,r){return u.indexOf.call(e,t,r)}:function(e,t,r){r=null==r?0:0>r?Math.max(0,e.length+r):r;
if(p(e))return p(t)&&1==t.length?e.indexOf(t,r):-1;for(;r<e.length;r++)if(r in e&&e[r]===t)return r;return-1},Oa=u.forEach?function(e,t,r){u.forEach.call(e,t,r)}:function(e,t,r){for(var n=e.length,i=p(e)?e.split(""):e,o=0;o<n;o++)o in i&&t.call(r,i[o],o,e)},Pa=u.filter?function(e,t,r){return u.filter.call(e,t,r)}:function(e,t,r){for(var n=e.length,i=[],o=0,a=p(e)?e.split(""):e,s=0;s<n;s++)if(s in a){var c=a[s];t.call(r,c,s,e)&&(i[o++]=c)}return i},Qa=u.map?function(e,t,r){return u.map.call(e,t,r)}:function(e,t,r){for(var n=e.length,i=Array(n),o=p(e)?e.split(""):e,a=0;a<n;a++)a in o&&(i[a]=t.call(r,o[a],a,e));return i},Ra=u.reduce?function(e,t,r,n){for(var i=[],o=1,a=arguments.length;o<a;o++)i.push(arguments[o]);n&&(i[0]=q(t,n));return u.reduce.apply(e,i)}:function(e,t,r,n){var i=r;Oa(e,function(r,o){i=t.call(n,i,r,o,e)});return i},Sa=u.every?function(e,t,r){return u.every.call(e,t,r)}:function(e,t,r){for(var n=e.length,i=p(e)?e.split(""):e,o=0;o<n;o++)if(o in i&&!t.call(r,i[o],o,e))return!1;return!0};function Ta(e,t){var r=Ua(e,t,void 0);return 0>r?null:p(e)?e.charAt(r):e[r]}function Ua(e,t,r){for(var n=e.length,i=p(e)?e.split(""):e,o=0;o<n;o++)if(o in i&&t.call(r,i[o],o,e))return o;return-1}function Va(e,t){var r=Na(e,t);0<=r&&u.splice.call(e,r,1)}function Wa(e,t,r){return 2>=arguments.length?u.slice.call(e,t):u.slice.call(e,t,r)}function Xa(e,t){e.sort(t||Ya)}function Ya(e,t){return e>t?1:e<t?-1:0}var Za=-1!=Ha.indexOf("Opera")||-1!=Ha.indexOf("OPR"),$a=-1!=Ha.indexOf("Trident")||-1!=Ha.indexOf("MSIE"),ab=-1!=Ha.indexOf("Gecko")&&-1==Ha.toLowerCase().indexOf("webkit")&&!(-1!=Ha.indexOf("Trident")||-1!=Ha.indexOf("MSIE")),bb=-1!=Ha.toLowerCase().indexOf("webkit");(function(){var e="",t;if(Za&&aa.opera)return e=aa.opera.version,ha(e)?e():e;ab?t=/rv\:([^\);]+)(\)|;)/:$a?t=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:bb&&(t=/WebKit\/(\S+)/);t&&(e=(e=t.exec(Ha))?e[1]:"");return $a&&(t=(t=aa.document)?t.documentMode:void 0,t>parseFloat(e))?String(t):e})();var cb=null,db=null,eb=null;function fb(e,t){if(!fa(e))throw Error("encodeByteArray takes an array as a parameter");gb();for(var r=t?db:cb,n=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,c=i+2<e.length,u=c?e[i+2]:0,l=o>>2,o=(o&3)<<4|s>>4,s=(s&15)<<2|u>>6,u=u&63;c||(u=64,a||(s=64));n.push(r[l],r[o],r[s],r[u])}return n.join("")}function gb(){if(!cb){cb={};db={};eb={};for(var e=0;65>e;e++)cb[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e),db[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(e),eb[db[e]]=e,62<=e&&(eb["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)]=e)}}var hb=hb||"2.2.9";function v(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function w(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function ib(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function jb(e){var t={};ib(e,function(e,r){t[e]=r});return t}function kb(e){var t=[];ib(e,function(e,r){ea(r)?Oa(r,function(r){t.push(encodeURIComponent(e)+"="+encodeURIComponent(r))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r))});return t.length?"&"+t.join("&"):""}function lb(e){var t={};e=e.replace(/^\?/,"").split("&");Oa(e,function(e){e&&(e=e.split("="),t[e[0]]=e[1])});return t}function x(e,t,r,n){var i;n<t?i="at least "+t:n>r&&(i=0===r?"none":"no more than "+r);if(i)throw Error(e+" failed: Was called with "+n+(1===n?" argument.":" arguments.")+" Expects "+i+".")}function z(e,t,r){var n="";switch(t){case 1:n=r?"first":"First";break;case 2:n=r?"second":"Second";break;case 3:n=r?"third":"Third";break;case 4:n=r?"fourth":"Fourth";break;default:throw Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return e=e+" failed: "+(n+" argument ")}function A(e,t,r,i){if((!i||n(r))&&!ha(r))throw Error(z(e,t,i)+"must be a valid function.")}function mb(e,t,r){if(n(r)&&(!ia(r)||null===r))throw Error(z(e,t,!0)+"must be a valid context object.")}function nb(e){return"undefined"!==typeof JSON&&n(JSON.parse)?JSON.parse(e):Aa(e)}function B(e){if("undefined"!==typeof JSON&&n(JSON.stringify))e=JSON.stringify(e);else{var t=[];Ca(new Ba,e,t);e=t.join("")}return e}function ob(){this.Wd=C}ob.prototype.j=function(e){return this.Wd.Y(e)};ob.prototype.toString=function(){return this.Wd.toString()};function pb(){}pb.prototype.qf=function(){return null};pb.prototype.ze=function(){return null};var qb=new pb;function rb(e,t,r){this.Rf=e;this.Ka=t;this.Kd=r}rb.prototype.qf=function(e){var t=this.Ka.Q;if(sb(t,e))return t.j().J(e);t=null!=this.Kd?new tb(this.Kd,!0,!1):this.Ka.C();return this.Rf.xc(e,t)};rb.prototype.ze=function(e,t,r){var n=null!=this.Kd?this.Kd:ub(this.Ka);e=this.Rf.oe(n,t,1,r,e);return 0===e.length?null:e[0]};function vb(){this.ub=[]}function wb(e,t){for(var r=null,n=0;n<t.length;n++){var i=t[n],o=i.Zb();null===r||o.ca(r.Zb())||(e.ub.push(r),r=null);null===r&&(r=new xb(o));r.add(i)}r&&e.ub.push(r)}function yb(e,t,r){wb(e,r);zb(e,function(e){return e.ca(t)})}function Ab(e,t,r){wb(e,r);zb(e,function(e){return e.contains(t)||t.contains(e)})}function zb(e,t){for(var r=!0,n=0;n<e.ub.length;n++){var i=e.ub[n];if(i)if(i=i.Zb(),t(i)){for(var i=e.ub[n],o=0;o<i.vd.length;o++){var a=i.vd[o];if(null!==a){i.vd[o]=null;var s=a.Vb();Bb&&Cb("event: "+a.toString());Db(s)}}e.ub[n]=null}else r=!1}r&&(e.ub=[])}function xb(e){this.ra=e;this.vd=[]}xb.prototype.add=function(e){this.vd.push(e)};xb.prototype.Zb=function(){return this.ra};function D(e,t,r,n){this.type=e;this.Ja=t;this.Xa=r;this.Le=n;this.Qd=void 0}function Eb(e){return new D(Fb,e)}var Fb="value";function Gb(e,t,r,n){this.ve=t;this.$d=r;this.Qd=n;this.ud=e}Gb.prototype.Zb=function(){var e=this.$d.mc();return"value"===this.ud?e.path:e.parent().path};Gb.prototype.Ae=function(){return this.ud};Gb.prototype.Vb=function(){return this.ve.Vb(this)};Gb.prototype.toString=function(){return this.Zb().toString()+":"+this.ud+":"+B(this.$d.mf())};function Hb(e,t,r){this.ve=e;this.error=t;this.path=r}Hb.prototype.Zb=function(){return this.path};Hb.prototype.Ae=function(){return"cancel"};Hb.prototype.Vb=function(){return this.ve.Vb(this)};Hb.prototype.toString=function(){return this.path.toString()+":cancel"};function tb(e,t,r){this.w=e;this.ea=t;this.Ub=r}function Ib(e){return e.ea}function Jb(e,t){return t.e()?e.ea&&!e.Ub:sb(e,E(t))}function sb(e,t){return e.ea&&!e.Ub||e.w.Da(t)}tb.prototype.j=function(){return this.w};function Kb(e){this.eg=e;this.Dd=null}Kb.prototype.get=function(){var e=this.eg.get(),t=xa(e);if(this.Dd)for(var r in this.Dd)t[r]-=this.Dd[r];this.Dd=e;return t};function Lb(e,t){this.Nf={};this.fd=new Kb(e);this.ba=t;var r=1e4+2e4*Math.random();setTimeout(q(this.If,this),Math.floor(r))}Lb.prototype.If=function(){var e=this.fd.get(),t={},r=!1,n;for(n in e)0<e[n]&&v(this.Nf,n)&&(t[n]=e[n],r=!0);r&&this.ba.Ve(t);setTimeout(q(this.If,this),Math.floor(6e5*Math.random()))};function Mb(){this.Ec={}}function Nb(e,t,r){n(r)||(r=1);v(e.Ec,t)||(e.Ec[t]=0);e.Ec[t]+=r}Mb.prototype.get=function(){return xa(this.Ec)};var Ob={},Pb={};function Qb(e){e=e.toString();Ob[e]||(Ob[e]=new Mb);return Ob[e]}function Rb(e,t){var r=e.toString();Pb[r]||(Pb[r]=t());return Pb[r]}function F(e,t){this.name=e;this.S=t}function Sb(e,t){return new F(e,t)}function Tb(e,t){return Ub(e.name,t.name)}function Vb(e,t){return Ub(e,t)}function Wb(e,t,r){this.type=Xb;this.source=e;this.path=t;this.Ga=r}Wb.prototype.Xc=function(e){return this.path.e()?new Wb(this.source,G,this.Ga.J(e)):new Wb(this.source,H(this.path),this.Ga)};Wb.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" overwrite: "+this.Ga.toString()+")"};function Yb(e,t){this.type=Zb;this.source=e;this.path=t}Yb.prototype.Xc=function(){return this.path.e()?new Yb(this.source,G):new Yb(this.source,H(this.path))};Yb.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" listen_complete)"};function $b(e,t){this.La=e;this.wa=t?t:ac}g=$b.prototype;g.Oa=function(e,t){return new $b(this.La,this.wa.Oa(e,t,this.La).X(null,null,!1,null,null))};g.remove=function(e){return new $b(this.La,this.wa.remove(e,this.La).X(null,null,!1,null,null))};g.get=function(e){for(var t,r=this.wa;!r.e();){t=this.La(e,r.key);if(0===t)return r.value;0>t?r=r.left:0<t&&(r=r.right)}return null};function bc(e,t){for(var r,n=e.wa,i=null;!n.e();){r=e.La(t,n.key);if(0===r){if(n.left.e())return i?i.key:null;for(n=n.left;!n.right.e();)n=n.right;return n.key}0>r?n=n.left:0<r&&(i=n,n=n.right)}throw Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}g.e=function(){return this.wa.e()};g.count=function(){return this.wa.count()};g.Sc=function(){return this.wa.Sc()};g.fc=function(){return this.wa.fc()};g.ia=function(e){return this.wa.ia(e)};g.Xb=function(e){return new cc(this.wa,null,this.La,!1,e)};g.Yb=function(e,t){return new cc(this.wa,e,this.La,!1,t)};g.$b=function(e,t){return new cc(this.wa,e,this.La,!0,t)};g.sf=function(e){return new cc(this.wa,null,this.La,!0,e)};function cc(e,t,r,n,i){this.Ud=i||null;this.Ge=n;this.Qa=[];for(i=1;!e.e();)if(i=t?r(e.key,t):1,n&&(i*=-1),0>i)e=this.Ge?e.left:e.right;else if(0===i){this.Qa.push(e);break}else this.Qa.push(e),e=this.Ge?e.right:e.left}function J(e){if(0===e.Qa.length)return null;var t=e.Qa.pop(),r;r=e.Ud?e.Ud(t.key,t.value):{key:t.key,value:t.value};if(e.Ge)for(t=t.left;!t.e();)e.Qa.push(t),t=t.right;else for(t=t.right;!t.e();)e.Qa.push(t),t=t.left;return r}function dc(e){if(0===e.Qa.length)return null;var t;t=e.Qa;t=t[t.length-1];return e.Ud?e.Ud(t.key,t.value):{key:t.key,value:t.value}}function ec(e,t,r,n,i){this.key=e;this.value=t;this.color=null!=r?r:!0;this.left=null!=n?n:ac;this.right=null!=i?i:ac}g=ec.prototype;g.X=function(e,t,r,n,i){return new ec(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=n?n:this.left,null!=i?i:this.right)};g.count=function(){return this.left.count()+1+this.right.count()};g.e=function(){return!1};g.ia=function(e){return this.left.ia(e)||e(this.key,this.value)||this.right.ia(e)};function fc(e){return e.left.e()?e:fc(e.left)}g.Sc=function(){return fc(this).key};g.fc=function(){return this.right.e()?this.key:this.right.fc()};g.Oa=function(e,t,r){var n,i;i=this;n=r(e,i.key);i=0>n?i.X(null,null,null,i.left.Oa(e,t,r),null):0===n?i.X(null,t,null,null,null):i.X(null,null,null,null,i.right.Oa(e,t,r));return gc(i)};function hc(e){if(e.left.e())return ac;e.left.fa()||e.left.left.fa()||(e=ic(e));e=e.X(null,null,null,hc(e.left),null);return gc(e)}g.remove=function(e,t){var r,n;r=this;if(0>t(e,r.key))r.left.e()||r.left.fa()||r.left.left.fa()||(r=ic(r)),r=r.X(null,null,null,r.left.remove(e,t),null);else{r.left.fa()&&(r=jc(r));r.right.e()||r.right.fa()||r.right.left.fa()||(r=kc(r),r.left.left.fa()&&(r=jc(r),r=kc(r)));if(0===t(e,r.key)){if(r.right.e())return ac;n=fc(r.right);r=r.X(n.key,n.value,null,null,hc(r.right))}r=r.X(null,null,null,null,r.right.remove(e,t))}return gc(r)};g.fa=function(){return this.color};function gc(e){e.right.fa()&&!e.left.fa()&&(e=lc(e));e.left.fa()&&e.left.left.fa()&&(e=jc(e));e.left.fa()&&e.right.fa()&&(e=kc(e));return e}function ic(e){e=kc(e);e.right.left.fa()&&(e=e.X(null,null,null,null,jc(e.right)),e=lc(e),e=kc(e));return e}function lc(e){return e.right.X(null,null,e.color,e.X(null,null,!0,null,e.right.left),null)}function jc(e){return e.left.X(null,null,e.color,null,e.X(null,null,!0,e.left.right,null))}function kc(e){return e.X(null,null,!e.color,e.left.X(null,null,!e.left.color,null,null),e.right.X(null,null,!e.right.color,null,null))}function mc(){}g=mc.prototype;g.X=function(){return this};g.Oa=function(e,t){return new ec(e,t,null)};g.remove=function(){return this};g.count=function(){return 0};g.e=function(){return!0};g.ia=function(){return!1};g.Sc=function(){return null};g.fc=function(){return null};g.fa=function(){return!1};var ac=new mc;function nc(e,t){return e&&"object"===typeof e?(K(".sv"in e,"Unexpected leaf node or priority contents"),t[e[".sv"]]):e}function oc(e,t){var r=new pc;qc(e,new L(""),function(e,n){r.nc(e,rc(n,t))});return r}function rc(e,t){var r=e.B().H(),r=nc(r,t),n;if(e.L()){var i=nc(e.Ca(),t);return i!==e.Ca()||r!==e.B().H()?new sc(i,M(r)):e}n=e;r!==e.B().H()&&(n=n.ga(new sc(r)));e.R(N,function(e,r){var i=rc(r,t);i!==r&&(n=n.O(e,i))});return n}function L(e,t){if(1==arguments.length){this.n=e.split("/");for(var r=0,n=0;n<this.n.length;n++)0<this.n[n].length&&(this.n[r]=this.n[n],r++);this.n.length=r;this.Z=0}else this.n=e,this.Z=t}function O(e,t){var r=E(e);if(null===r)return t;if(r===E(t))return O(H(e),H(t));throw Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function E(e){return e.Z>=e.n.length?null:e.n[e.Z]}function tc(e){return e.n.length-e.Z}function H(e){var t=e.Z;t<e.n.length&&t++;return new L(e.n,t)}function uc(e){return e.Z<e.n.length?e.n[e.n.length-1]:null}g=L.prototype;g.toString=function(){for(var e="",t=this.Z;t<this.n.length;t++)""!==this.n[t]&&(e+="/"+this.n[t]);return e||"/"};g.slice=function(e){return this.n.slice(this.Z+(e||0))};g.parent=function(){if(this.Z>=this.n.length)return null;for(var e=[],t=this.Z;t<this.n.length-1;t++)e.push(this.n[t]);return new L(e,0)};g.u=function(e){for(var t=[],r=this.Z;r<this.n.length;r++)t.push(this.n[r]);if(e instanceof L)for(r=e.Z;r<e.n.length;r++)t.push(e.n[r]);else for(e=e.split("/"),r=0;r<e.length;r++)0<e[r].length&&t.push(e[r]);return new L(t,0)};g.e=function(){return this.Z>=this.n.length};g.ca=function(e){if(tc(this)!==tc(e))return!1;for(var t=this.Z,r=e.Z;t<=this.n.length;t++,r++)if(this.n[t]!==e.n[r])return!1;return!0};g.contains=function(e){var t=this.Z,r=e.Z;if(tc(this)>tc(e))return!1;for(;t<this.n.length;){if(this.n[t]!==e.n[r])return!1;++t;++r}return!0};var G=new L("");function vc(e,t){this.Ra=e.slice();this.Ha=Math.max(1,this.Ra.length);this.lf=t;for(var r=0;r<this.Ra.length;r++)this.Ha+=wc(this.Ra[r]);xc(this)}vc.prototype.push=function(e){0<this.Ra.length&&(this.Ha+=1);this.Ra.push(e);this.Ha+=wc(e);xc(this)};vc.prototype.pop=function(){var e=this.Ra.pop();this.Ha-=wc(e);0<this.Ra.length&&--this.Ha};function xc(e){if(768<e.Ha)throw Error(e.lf+"has a key path longer than 768 bytes ("+e.Ha+").");if(32<e.Ra.length)throw Error(e.lf+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+yc(e))}function yc(e){return 0==e.Ra.length?"":"in property '"+e.Ra.join(".")+"'"}function zc(){this.wc={}}zc.prototype.set=function(e,t){null==t?delete this.wc[e]:this.wc[e]=t};zc.prototype.get=function(e){return v(this.wc,e)?this.wc[e]:null};zc.prototype.remove=function(e){delete this.wc[e]};zc.prototype.wf=!0;function Ac(e){this.Fc=e;this.Pd="firebase:"}g=Ac.prototype;g.set=function(e,t){null==t?this.Fc.removeItem(this.Pd+e):this.Fc.setItem(this.Pd+e,B(t))};g.get=function(e){e=this.Fc.getItem(this.Pd+e);return null==e?null:nb(e)};g.remove=function(e){this.Fc.removeItem(this.Pd+e)};g.wf=!1;g.toString=function(){return this.Fc.toString()};function Bc(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){var t=window[e];t.setItem("firebase:sentinel","cache");t.removeItem("firebase:sentinel");return new Ac(t)}}catch(e){}return new zc}var Cc=Bc("localStorage"),P=Bc("sessionStorage");function Dc(e,t,r,n,i){this.host=e.toLowerCase();this.domain=this.host.substr(this.host.indexOf(".")+1);this.lb=t;this.Db=r;this.Ug=n;this.Od=i||"";this.Pa=Cc.get("host:"+e)||this.host}function Ec(e,t){t!==e.Pa&&(e.Pa=t,"s-"===e.Pa.substr(0,2)&&Cc.set("host:"+e.host,e.Pa))}Dc.prototype.toString=function(){var e=(this.lb?"https://":"http://")+this.host;this.Od&&(e+="<"+this.Od+">");return e};var Fc=function(){var e=1;return function(){return e++}}();function K(e,t){if(!e)throw Gc(t)}function Gc(e){return Error("Firebase ("+hb+") INTERNAL ASSERT FAILED: "+e)}function Hc(e){try{var t;if("undefined"!==typeof atob)t=atob(e);else{gb();for(var r=eb,n=[],i=0;i<e.length;){var o=r[e.charAt(i++)],a=i<e.length?r[e.charAt(i)]:0;++i;var s=i<e.length?r[e.charAt(i)]:64;++i;var c=i<e.length?r[e.charAt(i)]:64;++i;if(null==o||null==a||null==s||null==c)throw Error();n.push(o<<2|a>>4);64!=s&&(n.push(a<<4&240|s>>2),64!=c&&n.push(s<<6&192|c))}if(8192>n.length)t=String.fromCharCode.apply(null,n);else{e="";for(r=0;r<n.length;r+=8192)e+=String.fromCharCode.apply(null,Wa(n,r,r+8192));t=e}}return t}catch(e){Cb("base64Decode failed: ",e)}return null}function Ic(e){var t=Jc(e);e=new La;e.update(t);var t=[],r=8*e.ee;56>e.ac?e.update(e.Ld,56-e.ac):e.update(e.Ld,e.Wa-(e.ac-56));for(var n=e.Wa-1;56<=n;n--)e.ne[n]=r&255,r/=256;Ma(e,e.ne);for(n=r=0;5>n;n++)for(var i=24;0<=i;i-=8)t[r]=e.P[n]>>i&255,++r;return fb(t)}function Kc(e){for(var t="",r=0;r<arguments.length;r++)t=fa(arguments[r])?t+Kc.apply(null,arguments[r]):"object"===typeof arguments[r]?t+B(arguments[r]):t+arguments[r],t+=" ";return t}var Bb=null,Lc=!0;function Cb(e){!0===Lc&&(Lc=!1,null===Bb&&!0===P.get("logging_enabled")&&Mc(!0));if(Bb){var t=Kc.apply(null,arguments);Bb(t)}}function Nc(e){return function(){Cb(e,arguments)}}function Oc(e){if("undefined"!==typeof console){var t="FIREBASE INTERNAL ERROR: "+Kc.apply(null,arguments);"undefined"!==typeof console.error?console.error(t):console.log(t)}}function Pc(e){var t=Kc.apply(null,arguments);throw Error("FIREBASE FATAL ERROR: "+t)}function Q(e){if("undefined"!==typeof console){var t="FIREBASE WARNING: "+Kc.apply(null,arguments);"undefined"!==typeof console.warn?console.warn(t):console.log(t)}}function Qc(e){var t="",r="",n="",i="",o=!0,a="https",s=443;if(p(e)){var c=e.indexOf("//");0<=c&&(a=e.substring(0,c-1),e=e.substring(c+2));c=e.indexOf("/");-1===c&&(c=e.length);t=e.substring(0,c);i="";e=e.substring(c).split("/");for(c=0;c<e.length;c++)if(0<e[c].length){var u=e[c];try{u=decodeURIComponent(u.replace(/\+/g," "))}catch(e){}i+="/"+u}e=t.split(".");3===e.length?(r=e[1],n=e[0].toLowerCase()):2===e.length&&(r=e[0]);c=t.indexOf(":");0<=c&&(o="https"===a||"wss"===a,s=t.substring(c+1),isFinite(s)&&(s=String(s)),s=p(s)?/^\s*-?0x/i.test(s)?parseInt(s,16):parseInt(s,10):NaN)}return{host:t,port:s,domain:r,Rg:n,lb:o,scheme:a,$c:i}}function Rc(e){return ga(e)&&(e!=e||e==Number.POSITIVE_INFINITY||e==Number.NEGATIVE_INFINITY)}function Sc(e){if("complete"===document.readyState)e();else{var t=!1,r=function(){document.body?t||(t=!0,e()):setTimeout(r,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&r()}),window.attachEvent("onload",r))}}function Ub(e,t){if(e===t)return 0;if("[MIN_NAME]"===e||"[MAX_NAME]"===t)return-1;if("[MIN_NAME]"===t||"[MAX_NAME]"===e)return 1;var r=Tc(e),n=Tc(t);return null!==r?null!==n?0==r-n?e.length-t.length:r-n:-1:null!==n?1:e<t?-1:1}function Uc(e,t){if(t&&e in t)return t[e];throw Error("Missing required key ("+e+") in object: "+B(t))}function Vc(e){if("object"!==typeof e||null===e)return B(e);var t=[],r;for(r in e)t.push(r);t.sort();r="{";for(var n=0;n<t.length;n++)0!==n&&(r+=","),r+=B(t[n]),r+=":",r+=Vc(e[t[n]]);return r+"}"}function Wc(e,t){if(e.length<=t)return[e];for(var r=[],n=0;n<e.length;n+=t)n+t>e?r.push(e.substring(n,e.length)):r.push(e.substring(n,n+t));return r}function Xc(e,t){if(ea(e))for(var n=0;n<e.length;++n)t(n,e[n]);else r(e,t)}function Yc(e){K(!Rc(e),"Invalid JSON number");var t,r,n,i;0===e?(n=r=0,t=-Infinity===1/e?1:0):(t=0>e,e=Math.abs(e),e>=Math.pow(2,-1022)?(n=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),r=n+1023,n=Math.round(e*Math.pow(2,52-n)-Math.pow(2,52))):(r=0,n=Math.round(e/Math.pow(2,-1074))));i=[];for(e=52;e;--e)i.push(n%2?1:0),n=Math.floor(n/2);for(e=11;e;--e)i.push(r%2?1:0),r=Math.floor(r/2);i.push(t?1:0);i.reverse();t=i.join("");r="";for(e=0;64>e;e+=8)n=parseInt(t.substr(e,8),2).toString(16),1===n.length&&(n="0"+n),r+=n;return r.toLowerCase()}var Zc=/^-?\d{1,10}$/;function Tc(e){return Zc.test(e)&&(e=Number(e),-2147483648<=e&&2147483647>=e)?e:null}function Db(e){try{e()}catch(e){setTimeout(function(){Q("Exception was thrown by user callback.",e.stack||"");throw e},Math.floor(0))}}function R(e,t){if(ha(e)){var r=Array.prototype.slice.call(arguments,1).slice();Db(function(){e.apply(null,r)})}}function Jc(e){for(var t=[],r=0,n=0;n<e.length;n++){var i=e.charCodeAt(n);55296<=i&&56319>=i&&(i-=55296,n++,K(n<e.length,"Surrogate pair missing trail surrogate."),i=65536+(i<<10)+(e.charCodeAt(n)-56320));128>i?t[r++]=i:(2048>i?t[r++]=i>>6|192:(65536>i?t[r++]=i>>12|224:(t[r++]=i>>18|240,t[r++]=i>>12&63|128),t[r++]=i>>6&63|128),t[r++]=i&63|128)}return t}function wc(e){for(var t=0,r=0;r<e.length;r++){var n=e.charCodeAt(r);128>n?t++:2048>n?t+=2:55296<=n&&56319>=n?(t+=4,r++):t+=3}return t}function $c(e){var t={},r={},n={},i="";try{var o=e.split("."),t=nb(Hc(o[0])||""),r=nb(Hc(o[1])||""),i=o[2],n=r.d||{};delete r.d}catch(e){}return{Xg:t,Bc:r,data:n,Og:i}}function ad(e){e=$c(e).Bc;return"object"===typeof e&&e.hasOwnProperty("iat")?w(e,"iat"):null}function bd(e){e=$c(e);var t=e.Bc;return!!e.Og&&!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}function cd(e){this.V=e;this.g=e.o.g}function dd(e,t,r,n){var i=[],o=[];Oa(t,function(t){"child_changed"===t.type&&e.g.Ad(t.Le,t.Ja)&&o.push(new D("child_moved",t.Ja,t.Xa))});ed(e,i,"child_removed",t,n,r);ed(e,i,"child_added",t,n,r);ed(e,i,"child_moved",o,n,r);ed(e,i,"child_changed",t,n,r);ed(e,i,Fb,t,n,r);return i}function ed(e,t,r,n,i,o){n=Pa(n,function(e){return e.type===r});Xa(n,q(e.fg,e));Oa(n,function(r){var n=fd(e,r,o);Oa(i,function(i){i.Kf(r.type)&&t.push(i.createEvent(n,e.V))})})}function fd(e,t,r){"value"!==t.type&&"child_removed"!==t.type&&(t.Qd=r.rf(t.Xa,t.Ja,e.g));return t}cd.prototype.fg=function(e,t){if(null==e.Xa||null==t.Xa)throw Gc("Should only compare child_ events.");return this.g.compare(new F(e.Xa,e.Ja),new F(t.Xa,t.Ja))};function gd(){this.bb={}}function hd(e,t){var r=t.type,n=t.Xa;K("child_added"==r||"child_changed"==r||"child_removed"==r,"Only child changes supported for tracking");K(".priority"!==n,"Only non-priority child changes can be tracked.");var i=w(e.bb,n);if(i){var o=i.type;if("child_added"==r&&"child_removed"==o)e.bb[n]=new D("child_changed",t.Ja,n,i.Ja);else if("child_removed"==r&&"child_added"==o)delete e.bb[n];else if("child_removed"==r&&"child_changed"==o)e.bb[n]=new D("child_removed",i.Le,n);else if("child_changed"==r&&"child_added"==o)e.bb[n]=new D("child_added",t.Ja,n);else if("child_changed"==r&&"child_changed"==o)e.bb[n]=new D("child_changed",t.Ja,n,i.Le);else throw Gc("Illegal combination of changes: "+t+" occurred after "+i)}else e.bb[n]=t}function id(e,t,r){this.Rb=e;this.qb=t;this.sb=r||null}g=id.prototype;g.Kf=function(e){return"value"===e};g.createEvent=function(e,t){var r=t.o.g;return new Gb("value",this,new S(e.Ja,t.mc(),r))};g.Vb=function(e){var t=this.sb;if("cancel"===e.Ae()){K(this.qb,"Raising a cancel event on a listener with no cancel callback");var r=this.qb;return function(){r.call(t,e.error)}}var n=this.Rb;return function(){n.call(t,e.$d)}};g.gf=function(e,t){return this.qb?new Hb(this,e,t):null};g.matches=function(e){return e instanceof id?e.Rb&&this.Rb?e.Rb===this.Rb&&e.sb===this.sb:!0:!1};g.tf=function(){return null!==this.Rb};function jd(e,t,r){this.ha=e;this.qb=t;this.sb=r}g=jd.prototype;g.Kf=function(e){e="children_added"===e?"child_added":e;return("children_removed"===e?"child_removed":e)in this.ha};g.gf=function(e,t){return this.qb?new Hb(this,e,t):null};g.createEvent=function(e,t){K(null!=e.Xa,"Child events should have a childName.");var r=t.mc().u(e.Xa);return new Gb(e.type,this,new S(e.Ja,r,t.o.g),e.Qd)};g.Vb=function(e){var t=this.sb;if("cancel"===e.Ae()){K(this.qb,"Raising a cancel event on a listener with no cancel callback");var r=this.qb;return function(){r.call(t,e.error)}}var n=this.ha[e.ud];return function(){n.call(t,e.$d,e.Qd)}};g.matches=function(e){if(e instanceof jd){if(!this.ha||!e.ha)return!0;if(this.sb===e.sb){var t=pa(e.ha);if(t===pa(this.ha)){if(1===t){var t=qa(e.ha),r=qa(this.ha);return r===t&&(!e.ha[t]||!this.ha[r]||e.ha[t]===this.ha[r])}return oa(this.ha,function(t,r){return e.ha[r]===t})}}}return!1};g.tf=function(){return null!==this.ha};function kd(e){this.g=e}g=kd.prototype;g.K=function(e,t,r,n,i,o){K(e.Jc(this.g),"A node must be indexed if only a child is updated");i=e.J(t);if(i.Y(n).ca(r.Y(n))&&i.e()==r.e())return e;null!=o&&(r.e()?e.Da(t)?hd(o,new D("child_removed",i,t)):K(e.L(),"A child remove without an old child only makes sense on a leaf node"):i.e()?hd(o,new D("child_added",r,t)):hd(o,new D("child_changed",r,t,i)));return e.L()&&r.e()?e:e.O(t,r).mb(this.g)};g.xa=function(e,t,r){null!=r&&(e.L()||e.R(N,function(e,n){t.Da(e)||hd(r,new D("child_removed",n,e))}),t.L()||t.R(N,function(t,n){if(e.Da(t)){var i=e.J(t);i.ca(n)||hd(r,new D("child_changed",n,t,i))}else hd(r,new D("child_added",n,t))}));return t.mb(this.g)};g.ga=function(e,t){return e.e()?C:e.ga(t)};g.Na=function(){return!1};g.Wb=function(){return this};function ld(e){this.Ce=new kd(e.g);this.g=e.g;var t;e.ma?(t=md(e),t=e.g.Pc(nd(e),t)):t=e.g.Tc();this.ed=t;e.pa?(t=od(e),e=e.g.Pc(pd(e),t)):e=e.g.Qc();this.Gc=e}g=ld.prototype;g.matches=function(e){return 0>=this.g.compare(this.ed,e)&&0>=this.g.compare(e,this.Gc)};g.K=function(e,t,r,n,i,o){this.matches(new F(t,r))||(r=C);return this.Ce.K(e,t,r,n,i,o)};g.xa=function(e,t,r){t.L()&&(t=C);var n=t.mb(this.g),n=n.ga(C),i=this;t.R(N,function(e,t){i.matches(new F(e,t))||(n=n.O(e,C))});return this.Ce.xa(e,n,r)};g.ga=function(e){return e};g.Na=function(){return!0};g.Wb=function(){return this.Ce};function qd(e){this.sa=new ld(e);this.g=e.g;K(e.ja,"Only valid if limit has been set");this.ka=e.ka;this.Jb=!rd(e)}g=qd.prototype;g.K=function(e,t,r,n,i,o){this.sa.matches(new F(t,r))||(r=C);return e.J(t).ca(r)?e:e.Eb()<this.ka?this.sa.Wb().K(e,t,r,n,i,o):sd(this,e,t,r,i,o)};g.xa=function(e,t,r){var n;if(t.L()||t.e())n=C.mb(this.g);else if(2*this.ka<t.Eb()&&t.Jc(this.g)){n=C.mb(this.g);t=this.Jb?t.$b(this.sa.Gc,this.g):t.Yb(this.sa.ed,this.g);for(var i=0;0<t.Qa.length&&i<this.ka;){var o=J(t),a;if(a=this.Jb?0>=this.g.compare(this.sa.ed,o):0>=this.g.compare(o,this.sa.Gc))n=n.O(o.name,o.S),i++;else break}}else{n=t.mb(this.g);n=n.ga(C);var s,c,u;if(this.Jb){t=n.sf(this.g);s=this.sa.Gc;c=this.sa.ed;var l=td(this.g);u=function(e,t){return l(t,e)}}else t=n.Xb(this.g),s=this.sa.ed,c=this.sa.Gc,u=td(this.g);for(var i=0,h=!1;0<t.Qa.length;)o=J(t),!h&&0>=u(s,o)&&(h=!0),(a=h&&i<this.ka&&0>=u(o,c))?i++:n=n.O(o.name,C)}return this.sa.Wb().xa(e,n,r)};g.ga=function(e){return e};g.Na=function(){return!0};g.Wb=function(){return this.sa.Wb()};function sd(e,t,r,n,i,o){var a;if(e.Jb){var s=td(e.g);a=function(e,t){return s(t,e)}}else a=td(e.g);K(t.Eb()==e.ka,"");var c=new F(r,n),u=e.Jb?ud(t,e.g):vd(t,e.g),l=e.sa.matches(c);if(t.Da(r)){for(var h=t.J(r),u=i.ze(e.g,u,e.Jb);null!=u&&(u.name==r||t.Da(u.name));)u=i.ze(e.g,u,e.Jb);i=null==u?1:a(u,c);if(l&&!n.e()&&0<=i)return null!=o&&hd(o,new D("child_changed",n,r,h)),t.O(r,n);null!=o&&hd(o,new D("child_removed",h,r));t=t.O(r,C);return null!=u&&e.sa.matches(u)?(null!=o&&hd(o,new D("child_added",u.S,u.name)),t.O(u.name,u.S)):t}return n.e()?t:l&&0<=a(u,c)?(null!=o&&(hd(o,new D("child_removed",u.S,u.name)),hd(o,new D("child_added",n,r))),t.O(r,n).O(u.name,C)):t}function wd(e,t){this.ke=e;this.dg=t}function yd(e){this.U=e}yd.prototype.ab=function(e,t,r,n){var i=new gd,o;if(t.type===Xb)t.source.xe?r=zd(this,e,t.path,t.Ga,r,n,i):(K(t.source.pf,"Unknown source."),o=t.source.bf,r=Ad(this,e,t.path,t.Ga,r,n,o,i));else if(t.type===Bd)t.source.xe?r=Cd(this,e,t.path,t.children,r,n,i):(K(t.source.pf,"Unknown source."),o=t.source.bf,r=Dd(this,e,t.path,t.children,r,n,o,i));else if(t.type===Ed)if(t.Vd)if(t=t.path,null!=r.tc(t))r=e;else{o=new rb(r,e,n);n=e.Q.j();if(t.e()||".priority"===E(t))Ib(e.C())?t=r.za(ub(e)):(t=e.C().j(),K(t instanceof T,"serverChildren would be complete if leaf node"),t=r.yc(t)),t=this.U.xa(n,t,i);else{var a=E(t),s=r.xc(a,e.C());null==s&&sb(e.C(),a)&&(s=n.J(a));t=null!=s?this.U.K(n,a,s,H(t),o,i):e.Q.j().Da(a)?this.U.K(n,a,C,H(t),o,i):n;t.e()&&Ib(e.C())&&(n=r.za(ub(e)),n.L()&&(t=this.U.xa(t,n,i)))}n=Ib(e.C())||null!=r.tc(G);r=Fd(e,t,n,this.U.Na())}else r=Gd(this,e,t.path,t.Qb,r,n,i);else if(t.type===Zb)n=t.path,t=e.C(),o=t.j(),a=t.ea||n.e(),r=Hd(this,new Id(e.Q,new tb(o,a,t.Ub)),n,r,qb,i);else throw Gc("Unknown operation type: "+t.type);i=ra(i.bb);n=r;t=n.Q;t.ea&&(o=t.j().L()||t.j().e(),a=Jd(e),(0<i.length||!e.Q.ea||o&&!t.j().ca(a)||!t.j().B().ca(a.B()))&&i.push(Eb(Jd(n))));return new wd(r,i)};function Hd(e,t,r,n,i,o){var a=t.Q;if(null!=n.tc(r))return t;var s;if(r.e())K(Ib(t.C()),"If change path is empty, we must have complete server data"),t.C().Ub?(i=ub(t),n=n.yc(i instanceof T?i:C)):n=n.za(ub(t)),o=e.U.xa(t.Q.j(),n,o);else{var c=E(r);if(".priority"==c)K(1==tc(r),"Can't have a priority with additional path components"),o=a.j(),s=t.C().j(),n=n.ld(r,o,s),o=null!=n?e.U.ga(o,n):a.j();else{var u=H(r);sb(a,c)?(s=t.C().j(),n=n.ld(r,a.j(),s),n=null!=n?a.j().J(c).K(u,n):a.j().J(c)):n=n.xc(c,t.C());o=null!=n?e.U.K(a.j(),c,n,u,i,o):a.j()}}return Fd(t,o,a.ea||r.e(),e.U.Na())}function Ad(e,t,r,n,i,o,a,s){var c=t.C();a=a?e.U:e.U.Wb();if(r.e())n=a.xa(c.j(),n,null);else if(a.Na()&&!c.Ub)n=c.j().K(r,n),n=a.xa(c.j(),n,null);else{var u=E(r);if(!Jb(c,r)&&1<tc(r))return t;var l=H(r);n=c.j().J(u).K(l,n);n=".priority"==u?a.ga(c.j(),n):a.K(c.j(),u,n,l,qb,null)}c=c.ea||r.e();t=new Id(t.Q,new tb(n,c,a.Na()));return Hd(e,t,r,i,new rb(i,t,o),s)}function zd(e,t,r,n,i,o,a){var s=t.Q;i=new rb(i,t,o);if(r.e())a=e.U.xa(t.Q.j(),n,a),e=Fd(t,a,!0,e.U.Na());else if(o=E(r),".priority"===o)a=e.U.ga(t.Q.j(),n),e=Fd(t,a,s.ea,s.Ub);else{r=H(r);var c=s.j().J(o);if(!r.e()){var u=i.qf(o);n=null!=u?".priority"===uc(r)&&u.Y(r.parent()).e()?u:u.K(r,n):C}c.ca(n)?e=t:(a=e.U.K(s.j(),o,n,r,i,a),e=Fd(t,a,s.ea,e.U.Na()))}return e}function Cd(e,t,r,n,i,o,a){var s=t;Kd(n,function(n,c){var u=r.u(n);sb(t.Q,E(u))&&(s=zd(e,s,u,c,i,o,a))});Kd(n,function(n,c){var u=r.u(n);sb(t.Q,E(u))||(s=zd(e,s,u,c,i,o,a))});return s}function Ld(e,t){Kd(t,function(t,r){e=e.K(t,r)});return e}function Dd(e,t,r,n,i,o,a,s){if(t.C().j().e()&&!Ib(t.C()))return t;var c=t;r=r.e()?n:Md(Nd,r,n);var u=t.C().j();r.children.ia(function(r,n){if(u.Da(r)){var l=t.C().j().J(r),l=Ld(l,n);c=Ad(e,c,new L(r),l,i,o,a,s)}});r.children.ia(function(r,n){var l=!sb(t.C(),r)&&null==n.value;u.Da(r)||l||(l=t.C().j().J(r),l=Ld(l,n),c=Ad(e,c,new L(r),l,i,o,a,s))});return c}function Gd(e,t,r,n,i,o,a){if(null!=i.tc(r))return t;var s=t.C();if(null!=n.value){if(r.e()&&s.ea||Jb(s,r))return Ad(e,t,r,s.j().Y(r),i,o,!1,a);if(r.e()){var c=Nd;s.j().R(Od,function(e,t){c=c.set(new L(e),t)});return Dd(e,t,r,c,i,o,!1,a)}return t}c=Nd;Kd(n,function(e){var t=r.u(e);Jb(s,t)&&(c=c.set(e,s.j().Y(t)))});return Dd(e,t,r,c,i,o,!1,a)}function Pd(){}var Qd={};function td(e){return q(e.compare,e)}Pd.prototype.Ad=function(e,t){return 0!==this.compare(new F("[MIN_NAME]",e),new F("[MIN_NAME]",t))};Pd.prototype.Tc=function(){return Rd};function Sd(e){this.cc=e}ma(Sd,Pd);g=Sd.prototype;g.Ic=function(e){return!e.J(this.cc).e()};g.compare=function(e,t){var r=e.S.J(this.cc),n=t.S.J(this.cc),r=r.Dc(n);return 0===r?Ub(e.name,t.name):r};g.Pc=function(e,t){var r=M(e),r=C.O(this.cc,r);return new F(t,r)};g.Qc=function(){var e=C.O(this.cc,Td);return new F("[MAX_NAME]",e)};g.toString=function(){return this.cc};function Ud(){}ma(Ud,Pd);g=Ud.prototype;g.compare=function(e,t){var r=e.S.B(),n=t.S.B(),r=r.Dc(n);return 0===r?Ub(e.name,t.name):r};g.Ic=function(e){return!e.B().e()};g.Ad=function(e,t){return!e.B().ca(t.B())};g.Tc=function(){return Rd};g.Qc=function(){return new F("[MAX_NAME]",new sc("[PRIORITY-POST]",Td))};g.Pc=function(e,t){var r=M(e);return new F(t,new sc("[PRIORITY-POST]",r))};g.toString=function(){return".priority"};var N=new Ud;function Vd(){}ma(Vd,Pd);g=Vd.prototype;g.compare=function(e,t){return Ub(e.name,t.name)};g.Ic=function(){throw Gc("KeyIndex.isDefinedOn not expected to be called.")};g.Ad=function(){return!1};g.Tc=function(){return Rd};g.Qc=function(){
return new F("[MAX_NAME]",C)};g.Pc=function(e){K(p(e),"KeyIndex indexValue must always be a string.");return new F(e,C)};g.toString=function(){return".key"};var Od=new Vd;function Wd(){}ma(Wd,Pd);g=Wd.prototype;g.compare=function(e,t){var r=e.S.Dc(t.S);return 0===r?Ub(e.name,t.name):r};g.Ic=function(){return!0};g.Ad=function(e,t){return!e.ca(t)};g.Tc=function(){return Rd};g.Qc=function(){return Xd};g.Pc=function(e,t){var r=M(e);return new F(t,r)};g.toString=function(){return".value"};var Yd=new Wd;function Zd(){this.Tb=this.pa=this.Lb=this.ma=this.ja=!1;this.ka=0;this.Nb="";this.ec=null;this.yb="";this.bc=null;this.wb="";this.g=N}var $d=new Zd;function rd(e){return""===e.Nb?e.ma:"l"===e.Nb}function nd(e){K(e.ma,"Only valid if start has been set");return e.ec}function md(e){K(e.ma,"Only valid if start has been set");return e.Lb?e.yb:"[MIN_NAME]"}function pd(e){K(e.pa,"Only valid if end has been set");return e.bc}function od(e){K(e.pa,"Only valid if end has been set");return e.Tb?e.wb:"[MAX_NAME]"}function ae(e){var t=new Zd;t.ja=e.ja;t.ka=e.ka;t.ma=e.ma;t.ec=e.ec;t.Lb=e.Lb;t.yb=e.yb;t.pa=e.pa;t.bc=e.bc;t.Tb=e.Tb;t.wb=e.wb;t.g=e.g;return t}g=Zd.prototype;g.Ie=function(e){var t=ae(this);t.ja=!0;t.ka=e;t.Nb="";return t};g.Je=function(e){var t=ae(this);t.ja=!0;t.ka=e;t.Nb="l";return t};g.Ke=function(e){var t=ae(this);t.ja=!0;t.ka=e;t.Nb="r";return t};g.ae=function(e,t){var r=ae(this);r.ma=!0;n(e)||(e=null);r.ec=e;null!=t?(r.Lb=!0,r.yb=t):(r.Lb=!1,r.yb="");return r};g.td=function(e,t){var r=ae(this);r.pa=!0;n(e)||(e=null);r.bc=e;n(t)?(r.Tb=!0,r.wb=t):(r.Zg=!1,r.wb="");return r};function be(e,t){var r=ae(e);r.g=t;return r}function ce(e){var t={};e.ma&&(t.sp=e.ec,e.Lb&&(t.sn=e.yb));e.pa&&(t.ep=e.bc,e.Tb&&(t.en=e.wb));if(e.ja){t.l=e.ka;var r=e.Nb;""===r&&(r=rd(e)?"l":"r");t.vf=r}e.g!==N&&(t.i=e.g.toString());return t}function de(e){return!(e.ma||e.pa||e.ja)}function ee(e){var t={};if(de(e)&&e.g==N)return t;var r;e.g===N?r="$priority":e.g===Yd?r="$value":e.g===Od?r="$key":(K(e.g instanceof Sd,"Unrecognized index type!"),r=e.g.toString());t.orderBy=B(r);e.ma&&(t.startAt=B(e.ec),e.Lb&&(t.startAt+=","+B(e.yb)));e.pa&&(t.endAt=B(e.bc),e.Tb&&(t.endAt+=","+B(e.wb)));e.ja&&(rd(e)?t.limitToFirst=e.ka:t.limitToLast=e.ka);return t}g.toString=function(){return B(ce(this))};function fe(e,t){this.Bd=e;this.dc=t}fe.prototype.get=function(e){var t=w(this.Bd,e);if(!t)throw Error("No index defined for "+e);return t===Qd?null:t};function ge(e,t,r){var n=na(e.Bd,function(n,i){var o=w(e.dc,i);K(o,"Missing index implementation for "+i);if(n===Qd){if(o.Ic(t.S)){for(var a=[],s=r.Xb(Sb),c=J(s);c;)c.name!=t.name&&a.push(c),c=J(s);a.push(t);return he(a,td(o))}return Qd}o=r.get(t.name);a=n;o&&(a=a.remove(new F(t.name,o)));return a.Oa(t,t.S)});return new fe(n,e.dc)}function ie(e,t,r){var n=na(e.Bd,function(e){if(e===Qd)return e;var n=r.get(t.name);return n?e.remove(new F(t.name,n)):e});return new fe(n,e.dc)}var je=new fe({".priority":Qd},{".priority":N});function sc(e,t){this.A=e;K(n(this.A)&&null!==this.A,"LeafNode shouldn't be created with null/undefined value.");this.aa=t||C;ke(this.aa);this.Cb=null}var le=["object","boolean","number","string"];g=sc.prototype;g.L=function(){return!0};g.B=function(){return this.aa};g.ga=function(e){return new sc(this.A,e)};g.J=function(e){return".priority"===e?this.aa:C};g.Y=function(e){return e.e()?this:".priority"===E(e)?this.aa:C};g.Da=function(){return!1};g.rf=function(){return null};g.O=function(e,t){return".priority"===e?this.ga(t):t.e()&&".priority"!==e?this:C.O(e,t).ga(this.aa)};g.K=function(e,t){var r=E(e);if(null===r)return t;if(t.e()&&".priority"!==r)return this;K(".priority"!==r||1===tc(e),".priority must be the last token in a path");return this.O(r,C.K(H(e),t))};g.e=function(){return!1};g.Eb=function(){return 0};g.R=function(){return!1};g.H=function(e){return e&&!this.B().e()?{".value":this.Ca(),".priority":this.B().H()}:this.Ca()};g.hash=function(){if(null===this.Cb){var e="";this.aa.e()||(e+="priority:"+me(this.aa.H())+":");var t=typeof this.A,e=e+(t+":"),e="number"===t?e+Yc(this.A):e+this.A;this.Cb=Ic(e)}return this.Cb};g.Ca=function(){return this.A};g.Dc=function(e){if(e===C)return 1;if(e instanceof T)return-1;K(e.L(),"Unknown node type");var t=typeof e.A,r=typeof this.A,n=Na(le,t),i=Na(le,r);K(0<=n,"Unknown leaf type: "+t);K(0<=i,"Unknown leaf type: "+r);return n===i?"object"===r?0:this.A<e.A?-1:this.A===e.A?0:1:i-n};g.mb=function(){return this};g.Jc=function(){return!0};g.ca=function(e){return e===this?!0:e.L()?this.A===e.A&&this.aa.ca(e.aa):!1};g.toString=function(){return B(this.H(!0))};function T(e,t,r){this.m=e;(this.aa=t)&&ke(this.aa);e.e()&&K(!this.aa||this.aa.e(),"An empty node cannot have a priority");this.xb=r;this.Cb=null}g=T.prototype;g.L=function(){return!1};g.B=function(){return this.aa||C};g.ga=function(e){return this.m.e()?this:new T(this.m,e,this.xb)};g.J=function(e){if(".priority"===e)return this.B();e=this.m.get(e);return null===e?C:e};g.Y=function(e){var t=E(e);return null===t?this:this.J(t).Y(H(e))};g.Da=function(e){return null!==this.m.get(e)};g.O=function(e,t){K(t,"We should always be passing snapshot nodes");if(".priority"===e)return this.ga(t);var r=new F(e,t),n,i;t.e()?(n=this.m.remove(e),r=ie(this.xb,r,this.m)):(n=this.m.Oa(e,t),r=ge(this.xb,r,this.m));i=n.e()?C:this.aa;return new T(n,i,r)};g.K=function(e,t){var r=E(e);if(null===r)return t;K(".priority"!==E(e)||1===tc(e),".priority must be the last token in a path");var n=this.J(r).K(H(e),t);return this.O(r,n)};g.e=function(){return this.m.e()};g.Eb=function(){return this.m.count()};var ne=/^(0|[1-9]\d*)$/;g=T.prototype;g.H=function(e){if(this.e())return null;var t={},r=0,n=0,i=!0;this.R(N,function(o,a){t[o]=a.H(e);r++;i&&ne.test(o)?n=Math.max(n,Number(o)):i=!1});if(!e&&i&&n<2*r){var o=[],a;for(a in t)o[a]=t[a];return o}e&&!this.B().e()&&(t[".priority"]=this.B().H());return t};g.hash=function(){if(null===this.Cb){var e="";this.B().e()||(e+="priority:"+me(this.B().H())+":");this.R(N,function(t,r){var n=r.hash();""!==n&&(e+=":"+t+":"+n)});this.Cb=""===e?"":Ic(e)}return this.Cb};g.rf=function(e,t,r){return(r=oe(this,r))?(e=bc(r,new F(e,t)))?e.name:null:bc(this.m,e)};function ud(e,t){var r;r=(r=oe(e,t))?(r=r.Sc())&&r.name:e.m.Sc();return r?new F(r,e.m.get(r)):null}function vd(e,t){var r;r=(r=oe(e,t))?(r=r.fc())&&r.name:e.m.fc();return r?new F(r,e.m.get(r)):null}g.R=function(e,t){var r=oe(this,e);return r?r.ia(function(e){return t(e.name,e.S)}):this.m.ia(t)};g.Xb=function(e){return this.Yb(e.Tc(),e)};g.Yb=function(e,t){var r=oe(this,t);if(r)return r.Yb(e,function(e){return e});for(var r=this.m.Yb(e.name,Sb),n=dc(r);null!=n&&0>t.compare(n,e);)J(r),n=dc(r);return r};g.sf=function(e){return this.$b(e.Qc(),e)};g.$b=function(e,t){var r=oe(this,t);if(r)return r.$b(e,function(e){return e});for(var r=this.m.$b(e.name,Sb),n=dc(r);null!=n&&0<t.compare(n,e);)J(r),n=dc(r);return r};g.Dc=function(e){return this.e()?e.e()?0:-1:e.L()||e.e()?1:e===Td?-1:0};g.mb=function(e){if(e===Od||ta(this.xb.dc,e.toString()))return this;var t=this.xb,r=this.m;K(e!==Od,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n=[],i=!1,r=r.Xb(Sb),o=J(r);o;)i=i||e.Ic(o.S),n.push(o),o=J(r);n=i?he(n,td(e)):Qd;i=e.toString();r=xa(t.dc);r[i]=e;e=xa(t.Bd);e[i]=n;return new T(this.m,this.aa,new fe(e,r))};g.Jc=function(e){return e===Od||ta(this.xb.dc,e.toString())};g.ca=function(e){if(e===this)return!0;if(e.L())return!1;if(this.B().ca(e.B())&&this.m.count()===e.m.count()){var t=this.Xb(N);e=e.Xb(N);for(var r=J(t),n=J(e);r&&n;){if(r.name!==n.name||!r.S.ca(n.S))return!1;r=J(t);n=J(e)}return null===r&&null===n}return!1};function oe(e,t){return t===Od?null:e.xb.get(t.toString())}g.toString=function(){return B(this.H(!0))};function M(e,t){if(null===e)return C;var n=null;"object"===typeof e&&".priority"in e?n=e[".priority"]:"undefined"!==typeof t&&(n=t);K(null===n||"string"===typeof n||"number"===typeof n||"object"===typeof n&&".sv"in n,"Invalid priority type found: "+typeof n);"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]);if("object"!==typeof e||".sv"in e)return new sc(e,M(n));if(e instanceof Array){var i=C,o=e;r(o,function(e,t){if(v(o,t)&&"."!==t.substring(0,1)){var r=M(e);if(r.L()||!r.e())i=i.O(t,r)}});return i.ga(M(n))}var a=[],s=!1,c=e;ib(c,function(e){if("string"!==typeof e||"."!==e.substring(0,1)){var t=M(c[e]);t.e()||(s=s||!t.B().e(),a.push(new F(e,t)))}});if(0==a.length)return C;var u=he(a,Tb,function(e){return e.name},Vb);if(s){var l=he(a,td(N));return new T(u,M(n),new fe({".priority":l},{".priority":N}))}return new T(u,M(n),je)}var pe=Math.log(2);function qe(e){this.count=parseInt(Math.log(e+1)/pe,10);this.jf=this.count-1;this.cg=e+1&parseInt(Array(this.count+1).join("1"),2)}function re(e){var t=!(e.cg&1<<e.jf);e.jf--;return t}function he(e,t,r,n){function i(t,n){var o=n-t;if(0==o)return null;if(1==o){var a=e[t],s=r?r(a):a;return new ec(s,a.S,!1,null,null)}var a=parseInt(o/2,10)+t,o=i(t,a),c=i(a+1,n),a=e[a],s=r?r(a):a;return new ec(s,a.S,!1,o,c)}e.sort(t);var o=function(t){function n(t,n){var c=s-t,u=s;s-=t;var u=i(c+1,u),c=e[c],l=r?r(c):c,u=new ec(l,c.S,n,null,u);o?o.left=u:a=u;o=u}for(var o=null,a=null,s=e.length,c=0;c<t.count;++c){var u=re(t),l=Math.pow(2,t.count-(c+1));u?n(l,!1):(n(l,!1),n(l,!0))}return a}(new qe(e.length));return null!==o?new $b(n||t,o):new $b(n||t)}function me(e){return"number"===typeof e?"number:"+Yc(e):"string:"+e}function ke(e){if(e.L()){var t=e.H();K("string"===typeof t||"number"===typeof t||"object"===typeof t&&v(t,".sv"),"Priority must be a string or number.")}else K(e===Td||e.e(),"priority of unexpected type.");K(e===Td||e.B().e(),"Priority nodes can't have a priority of their own.")}var C=new T(new $b(Vb),null,je);function se(){T.call(this,new $b(Vb),C,je)}ma(se,T);g=se.prototype;g.Dc=function(e){return e===this?0:1};g.ca=function(e){return e===this};g.B=function(){return this};g.J=function(){return C};g.e=function(){return!1};var Td=new se,Rd=new F("[MIN_NAME]",C),Xd=new F("[MAX_NAME]",Td);function Id(e,t){this.Q=e;this.Yd=t}function Fd(e,t,r,n){return new Id(new tb(t,r,n),e.Yd)}function Jd(e){return e.Q.ea?e.Q.j():null}Id.prototype.C=function(){return this.Yd};function ub(e){return e.Yd.ea?e.Yd.j():null}function te(e,t){this.V=e;var r=e.o,n=new kd(r.g),r=de(r)?new kd(r.g):r.ja?new qd(r):new ld(r);this.Hf=new yd(r);var i=t.C(),o=t.Q,a=n.xa(C,i.j(),null),s=r.xa(C,o.j(),null);this.Ka=new Id(new tb(s,o.ea,r.Na()),new tb(a,i.ea,n.Na()));this.Ya=[];this.jg=new cd(e)}function ue(e){return e.V}g=te.prototype;g.C=function(){return this.Ka.C().j()};g.gb=function(e){var t=ub(this.Ka);return t&&(de(this.V.o)||!e.e()&&!t.J(E(e)).e())?t.Y(e):null};g.e=function(){return 0===this.Ya.length};g.Pb=function(e){this.Ya.push(e)};g.kb=function(e,t){var r=[];if(t){K(null==e,"A cancel should cancel all event registrations.");var n=this.V.path;Oa(this.Ya,function(e){(e=e.gf(t,n))&&r.push(e)})}if(e){for(var i=[],o=0;o<this.Ya.length;++o){var a=this.Ya[o];if(!a.matches(e))i.push(a);else if(e.tf()){i=i.concat(this.Ya.slice(o+1));break}}this.Ya=i}else this.Ya=[];return r};g.ab=function(e,t,r){e.type===Bd&&null!==e.source.Ib&&(K(ub(this.Ka),"We should always have a full cache before handling merges"),K(Jd(this.Ka),"Missing event cache, even though we have a server cache"));var n=this.Ka;e=this.Hf.ab(n,e,t,r);t=this.Hf;r=e.ke;K(r.Q.j().Jc(t.U.g),"Event snap not indexed");K(r.C().j().Jc(t.U.g),"Server snap not indexed");K(Ib(e.ke.C())||!Ib(n.C()),"Once a server snap is complete, it should never go back");this.Ka=e.ke;return ve(this,e.dg,e.ke.Q.j(),null)};function we(e,t){var r=e.Ka.Q,n=[];r.j().L()||r.j().R(N,function(e,t){n.push(new D("child_added",t,e))});r.ea&&n.push(Eb(r.j()));return ve(e,n,r.j(),t)}function ve(e,t,r,n){return dd(e.jg,t,r,n?[n]:e.Ya)}function xe(e,t,r){this.type=Bd;this.source=e;this.path=t;this.children=r}xe.prototype.Xc=function(e){if(this.path.e())return e=this.children.subtree(new L(e)),e.e()?null:e.value?new Wb(this.source,G,e.value):new xe(this.source,G,e);K(E(this.path)===e,"Can't get a merge for a child not on the path of the operation");return new xe(this.source,H(this.path),this.children)};xe.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"};function ye(e,t){this.f=Nc("p:rest:");this.F=e;this.Hb=t;this.Aa=null;this.$={}}function ze(e,t){if(n(t))return"tag$"+t;var r=e.o;K(de(r)&&r.g==N,"should have a tag if it's not a default query.");return e.path.toString()}g=ye.prototype;g.yf=function(e,t,r,n){var i=e.path.toString();this.f("Listen called for "+i+" "+e.va());var o=ze(e,r),a={};this.$[o]=a;e=ee(e.o);var s=this;Ae(this,i+".json",e,function(e,t){var c=t;404===e&&(e=c=null);null===e&&s.Hb(i,c,!1,r);w(s.$,o)===a&&n(e?401==e?"permission_denied":"rest_error:"+e:"ok",null)})};g.Pf=function(e,t){var r=ze(e,t);delete this.$[r]};g.N=function(e,t){this.Aa=e;var r=$c(e),n=r.data,r=r.Bc&&r.Bc.exp;t&&t("ok",{auth:n,expires:r})};g.he=function(e){this.Aa=null;e("ok",null)};g.Ne=function(){};g.Cf=function(){};g.Jd=function(){};g.put=function(){};g.zf=function(){};g.Ve=function(){};function Ae(e,t,r,n){r=r||{};r.format="export";e.Aa&&(r.auth=e.Aa);var i=(e.F.lb?"https://":"http://")+e.F.host+t+"?"+kb(r);e.f("Sending REST request for "+i);var o=new XMLHttpRequest;o.onreadystatechange=function(){if(n&&4===o.readyState){e.f("REST Response for "+i+" received. status:",o.status,"response:",o.responseText);var t=null;if(200<=o.status&&300>o.status){try{t=nb(o.responseText)}catch(e){Q("Failed to parse JSON response for "+i+": "+o.responseText)}n(null,t)}else 401!==o.status&&404!==o.status&&Q("Got unsuccessful REST response for "+i+" Status: "+o.status),n(o.status);n=null}};o.open("GET",i,!0);o.send()}function Be(e,t){this.value=e;this.children=t||Ce}var Ce=new $b(function(e,t){return e===t?0:e<t?-1:1});function De(e){var t=Nd;r(e,function(e,r){t=t.set(new L(r),e)});return t}g=Be.prototype;g.e=function(){return null===this.value&&this.children.e()};function Ee(e,t,r){if(null!=e.value&&r(e.value))return{path:G,value:e.value};if(t.e())return null;var n=E(t);e=e.children.get(n);return null!==e?(t=Ee(e,H(t),r),null!=t?{path:new L(n).u(t.path),value:t.value}:null):null}function Fe(e,t){return Ee(e,t,function(){return!0})}g.subtree=function(e){if(e.e())return this;var t=this.children.get(E(e));return null!==t?t.subtree(H(e)):Nd};g.set=function(e,t){if(e.e())return new Be(t,this.children);var r=E(e),n=(this.children.get(r)||Nd).set(H(e),t),r=this.children.Oa(r,n);return new Be(this.value,r)};g.remove=function(e){if(e.e())return this.children.e()?Nd:new Be(null,this.children);var t=E(e),r=this.children.get(t);return r?(e=r.remove(H(e)),t=e.e()?this.children.remove(t):this.children.Oa(t,e),null===this.value&&t.e()?Nd:new Be(this.value,t)):this};g.get=function(e){if(e.e())return this.value;var t=this.children.get(E(e));return t?t.get(H(e)):null};function Md(e,t,r){if(t.e())return r;var n=E(t);t=Md(e.children.get(n)||Nd,H(t),r);n=t.e()?e.children.remove(n):e.children.Oa(n,t);return new Be(e.value,n)}function Ge(e,t){return He(e,G,t)}function He(e,t,r){var n={};e.children.ia(function(e,i){n[e]=He(i,t.u(e),r)});return r(t,e.value,n)}function Ie(e,t,r){return Je(e,t,G,r)}function Je(e,t,r,n){var i=e.value?n(r,e.value):!1;if(i)return i;if(t.e())return null;i=E(t);return(e=e.children.get(i))?Je(e,H(t),r.u(i),n):null}function Ke(e,t,r){var n=G;if(!t.e()){var i=!0;e.value&&(i=r(n,e.value));!0===i&&(i=E(t),(e=e.children.get(i))&&Le(e,H(t),n.u(i),r))}}function Le(e,t,r,n){if(t.e())return e;e.value&&n(r,e.value);var i=E(t);return(e=e.children.get(i))?Le(e,H(t),r.u(i),n):Nd}function Kd(e,t){Me(e,G,t)}function Me(e,t,r){e.children.ia(function(e,n){Me(n,t.u(e),r)});e.value&&r(t,e.value)}function Ne(e,t){e.children.ia(function(e,r){r.value&&t(e,r.value)})}var Nd=new Be(null);Be.prototype.toString=function(){var e={};Kd(this,function(t,r){e[t.toString()]=r.toString()});return B(e)};function Oe(e,t,r){this.type=Ed;this.source=Pe;this.path=e;this.Qb=t;this.Vd=r}Oe.prototype.Xc=function(e){if(this.path.e()){if(null!=this.Qb.value)return K(this.Qb.children.e(),"affectedTree should not have overlapping affected paths."),this;e=this.Qb.subtree(new L(e));return new Oe(G,e,this.Vd)}K(E(this.path)===e,"operationForChild called for unrelated child.");return new Oe(H(this.path),this.Qb,this.Vd)};Oe.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" ack write revert="+this.Vd+" affectedTree="+this.Qb+")"};var Xb=0,Bd=1,Ed=2,Zb=3;function Qe(e,t,r,n){this.xe=e;this.pf=t;this.Ib=r;this.bf=n;K(!n||t,"Tagged queries must be from server.")}var Pe=new Qe(!0,!1,null,!1),Re=new Qe(!1,!0,null,!1);Qe.prototype.toString=function(){return this.xe?"user":this.bf?"server(queryID="+this.Ib+")":"server"};function Se(e){this.W=e}var Te=new Se(new Be(null));function Ue(e,t,r){if(t.e())return new Se(new Be(r));var n=Fe(e.W,t);if(null!=n){var i=n.path,n=n.value;t=O(i,t);n=n.K(t,r);return new Se(e.W.set(i,n))}e=Md(e.W,t,new Be(r));return new Se(e)}function Ve(e,t,r){var n=e;ib(r,function(e,r){n=Ue(n,t.u(e),r)});return n}Se.prototype.Rd=function(e){if(e.e())return Te;e=Md(this.W,e,Nd);return new Se(e)};function We(e,t){var r=Fe(e.W,t);return null!=r?e.W.get(r.path).Y(O(r.path,t)):null}function Xe(e){var t=[],r=e.W.value;null!=r?r.L()||r.R(N,function(e,r){t.push(new F(e,r))}):e.W.children.ia(function(e,r){null!=r.value&&t.push(new F(e,r.value))});return t}function Ye(e,t){if(t.e())return e;var r=We(e,t);return null!=r?new Se(new Be(r)):new Se(e.W.subtree(t))}Se.prototype.e=function(){return this.W.e()};Se.prototype.apply=function(e){return Ze(G,this.W,e)};function Ze(e,t,r){if(null!=t.value)return r.K(e,t.value);var n=null;t.children.ia(function(t,i){".priority"===t?(K(null!==i.value,"Priority writes must always be leaf nodes"),n=i.value):r=Ze(e.u(t),i,r)});r.Y(e).e()||null===n||(r=r.K(e.u(".priority"),n));return r}function $e(){this.T=Te;this.na=[];this.Mc=-1}function af(e,t){for(var r=0;r<e.na.length;r++){var n=e.na[r];if(n.kd===t)return n}return null}g=$e.prototype;g.Rd=function(e){var t=Ua(this.na,function(t){return t.kd===e});K(0<=t,"removeWrite called with nonexistent writeId.");var n=this.na[t];this.na.splice(t,1);for(var i=n.visible,o=!1,a=this.na.length-1;i&&0<=a;){var s=this.na[a];s.visible&&(a>=t&&bf(s,n.path)?i=!1:n.path.contains(s.path)&&(o=!0));a--}if(i){if(o)this.T=cf(this.na,df,G),this.Mc=0<this.na.length?this.na[this.na.length-1].kd:-1;else if(n.Ga)this.T=this.T.Rd(n.path);else{var c=this;r(n.children,function(e,t){c.T=c.T.Rd(n.path.u(t))})}return!0}return!1};g.za=function(e,t,r,n){if(r||n){var i=Ye(this.T,e);return!n&&i.e()?t:n||null!=t||null!=We(i,G)?(i=cf(this.na,function(t){return(t.visible||n)&&(!r||!(0<=Na(r,t.kd)))&&(t.path.contains(e)||e.contains(t.path))},e),t=t||C,i.apply(t)):null}i=We(this.T,e);if(null!=i)return i;i=Ye(this.T,e);return i.e()?t:null!=t||null!=We(i,G)?(t=t||C,i.apply(t)):null};g.yc=function(e,t){var r=C,n=We(this.T,e);if(n)n.L()||n.R(N,function(e,t){r=r.O(e,t)});else if(t){var i=Ye(this.T,e);t.R(N,function(e,t){var n=Ye(i,new L(e)).apply(t);r=r.O(e,n)});Oa(Xe(i),function(e){r=r.O(e.name,e.S)})}else i=Ye(this.T,e),Oa(Xe(i),function(e){r=r.O(e.name,e.S)});return r};g.ld=function(e,t,r,n){K(r||n,"Either existingEventSnap or existingServerSnap must exist");e=e.u(t);if(null!=We(this.T,e))return null;e=Ye(this.T,e);return e.e()?n.Y(t):e.apply(n.Y(t))};g.xc=function(e,t,r){e=e.u(t);var n=We(this.T,e);return null!=n?n:sb(r,t)?Ye(this.T,e).apply(r.j().J(t)):null};g.tc=function(e){return We(this.T,e)};g.oe=function(e,t,r,n,i,o){var a;e=Ye(this.T,e);a=We(e,G);if(null==a)if(null!=t)a=e.apply(t);else return[];a=a.mb(o);if(a.e()||a.L())return[];t=[];e=td(o);i=i?a.$b(r,o):a.Yb(r,o);for(o=J(i);o&&t.length<n;)0!==e(o,r)&&t.push(o),o=J(i);return t};function bf(e,t){return e.Ga?e.path.contains(t):!!ua(e.children,function(r,n){return e.path.u(n).contains(t)})}function df(e){return e.visible}function cf(e,t,r){for(var n=Te,i=0;i<e.length;++i){var o=e[i];if(t(o)){var a=o.path;if(o.Ga)r.contains(a)?(a=O(r,a),n=Ue(n,a,o.Ga)):a.contains(r)&&(a=O(a,r),n=Ue(n,G,o.Ga.Y(a)));else if(o.children)if(r.contains(a))a=O(r,a),n=Ve(n,a,o.children);else{if(a.contains(r))if(a=O(a,r),a.e())n=Ve(n,G,o.children);else if(o=w(o.children,E(a)))o=o.Y(H(a)),n=Ue(n,G,o)}else throw Gc("WriteRecord should have .snap or .children")}}return n}function ef(e,t){this.Mb=e;this.W=t}g=ef.prototype;g.za=function(e,t,r){return this.W.za(this.Mb,e,t,r)};g.yc=function(e){return this.W.yc(this.Mb,e)};g.ld=function(e,t,r){return this.W.ld(this.Mb,e,t,r)};g.tc=function(e){return this.W.tc(this.Mb.u(e))};g.oe=function(e,t,r,n,i){return this.W.oe(this.Mb,e,t,r,n,i)};g.xc=function(e,t){return this.W.xc(this.Mb,e,t)};g.u=function(e){return new ef(this.Mb.u(e),this.W)};function ff(){this.ya={}}g=ff.prototype;g.e=function(){return wa(this.ya)};g.ab=function(e,t,n){var i=e.source.Ib;if(null!==i)return i=w(this.ya,i),K(null!=i,"SyncTree gave us an op for an invalid query."),i.ab(e,t,n);var o=[];r(this.ya,function(r){o=o.concat(r.ab(e,t,n))});return o};g.Pb=function(e,t,r,n,i){var o=e.va(),a=w(this.ya,o);if(!a){var a=r.za(i?n:null),s=!1;a?s=!0:(a=n instanceof T?r.yc(n):C,s=!1);a=new te(e,new Id(new tb(a,s,!1),new tb(n,i,!1)));this.ya[o]=a}a.Pb(t);return we(a,t)};g.kb=function(e,t,n){var i=e.va(),o=[],a=[],s=null!=gf(this);if("default"===i){var c=this;r(this.ya,function(e,r){a=a.concat(e.kb(t,n));e.e()&&(delete c.ya[r],de(e.V.o)||o.push(e.V))})}else{var u=w(this.ya,i);u&&(a=a.concat(u.kb(t,n)),u.e()&&(delete this.ya[i],de(u.V.o)||o.push(u.V)))}s&&null==gf(this)&&o.push(new U(e.k,e.path));return{Ig:o,kg:a}};function hf(e){return Pa(ra(e.ya),function(e){return!de(e.V.o)})}g.gb=function(e){var t=null;r(this.ya,function(r){t=t||r.gb(e)});return t};function jf(e,t){if(de(t.o))return gf(e);var r=t.va();return w(e.ya,r)}function gf(e){return va(e.ya,function(e){return de(e.V.o)})||null}function kf(e){this.ta=Nd;this.jb=new $e;this.af={};this.lc={};this.Nc=e}function lf(e,t,r,i,o){var a=e.jb,s=o;K(i>a.Mc,"Stacking an older write on top of newer ones");n(s)||(s=!0);a.na.push({path:t,Ga:r,kd:i,visible:s});s&&(a.T=Ue(a.T,t,r));a.Mc=i;return o?mf(e,new Wb(Pe,t,r)):[]}function nf(e,t,r,n){var i=e.jb;K(n>i.Mc,"Stacking an older merge on top of newer ones");i.na.push({path:t,children:r,kd:n,visible:!0});i.T=Ve(i.T,t,r);i.Mc=n;r=De(r);return mf(e,new xe(Pe,t,r))}function of(e,t,r){r=r||!1;var n=af(e.jb,t);if(e.jb.Rd(t)){var i=Nd;null!=n.Ga?i=i.set(G,!0):ib(n.children,function(e,t){i=i.set(new L(e),t)});return mf(e,new Oe(n.path,i,r))}return[]}function pf(e,t,r){r=De(r);return mf(e,new xe(Re,t,r))}function qf(e,t,r,n){n=rf(e,n);if(null!=n){var i=sf(n);n=i.path;i=i.Ib;t=O(n,t);r=new Wb(new Qe(!1,!0,i,!0),t,r);return tf(e,n,r)}return[]}function uf(e,t,r,n){if(n=rf(e,n)){var i=sf(n);n=i.path;i=i.Ib;t=O(n,t);r=De(r);r=new xe(new Qe(!1,!0,i,!0),t,r);return tf(e,n,r)}return[]}kf.prototype.Pb=function(e,t){var r=e.path,n=null,i=!1;Ke(this.ta,r,function(e,t){var o=O(e,r);n=t.gb(o);i=i||null!=gf(t);return!n});var o=this.ta.get(r);o?(i=i||null!=gf(o),n=n||o.gb(G)):(o=new ff,this.ta=this.ta.set(r,o));var a;null!=n?a=!0:(a=!1,n=C,Ne(this.ta.subtree(r),function(e,t){var r=t.gb(G);r&&(n=n.O(e,r))}));var s=null!=jf(o,e);if(!s&&!de(e.o)){var c=vf(e);K(!(c in this.lc),"View does not exist, but we have a tag");var u=wf++;this.lc[c]=u;this.af["_"+u]=c}a=o.Pb(e,t,new ef(r,this.jb),n,a);s||i||(o=jf(o,e),a=a.concat(xf(this,e,o)));return a};kf.prototype.kb=function(e,t,r){var n=e.path,i=this.ta.get(n),o=[];if(i&&("default"===e.va()||null!=jf(i,e))){o=i.kb(e,t,r);i.e()&&(this.ta=this.ta.remove(n));i=o.Ig;o=o.kg;t=-1!==Ua(i,function(e){return de(e.o)});var a=Ie(this.ta,n,function(e,t){return null!=gf(t)});if(t&&!a&&(n=this.ta.subtree(n),!n.e()))for(var n=yf(n),s=0;s<n.length;++s){var c=n[s],u=c.V,c=zf(this,c);this.Nc.Ye(u,Af(this,u),c.xd,c.G)}if(!a&&0<i.length&&!r)if(t)this.Nc.be(e,null);else{var l=this;Oa(i,function(e){e.va();var t=l.lc[vf(e)];l.Nc.be(e,t)})}Bf(this,i)}return o};kf.prototype.za=function(e,t){var r=this.jb,n=Ie(this.ta,e,function(t,r){var n=O(t,e);if(n=r.gb(n))return n});return r.za(e,n,t,!0)};function yf(e){return Ge(e,function(e,t,n){if(t&&null!=gf(t))return[gf(t)];var i=[];t&&(i=hf(t));r(n,function(e){i=i.concat(e)});return i})}function Bf(e,t){for(var r=0;r<t.length;++r){var n=t[r];if(!de(n.o)){var n=vf(n),i=e.lc[n];delete e.lc[n];delete e.af["_"+i]}}}function xf(e,t,n){var i=t.path,o=Af(e,t);n=zf(e,n);t=e.Nc.Ye(t,o,n.xd,n.G);i=e.ta.subtree(i);if(o)K(null==gf(i.value),"If we're adding a query, it shouldn't be shadowed");else for(o=Ge(i,function(e,t,n){if(!e.e()&&t&&null!=gf(t))return[ue(gf(t))];var i=[];t&&(i=i.concat(Qa(hf(t),function(e){return e.V})));r(n,function(e){i=i.concat(e)});return i}),i=0;i<o.length;++i)n=o[i],e.Nc.be(n,Af(e,n));return t}function zf(e,t){var r=t.V,n=Af(e,r);return{xd:function(){return(t.C()||C).hash()},G:function(t){if("ok"===t){if(n){var i=r.path;if(t=rf(e,n)){var o=sf(t);t=o.path;o=o.Ib;i=O(t,i);i=new Yb(new Qe(!1,!0,o,!0),i);t=tf(e,t,i)}else t=[]}else t=mf(e,new Yb(Re,r.path));return t}i="Unknown Error";"too_big"===t?i="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==t?i="Client doesn't have permission to access the desired data.":"unavailable"==t&&(i="The service is unavailable");i=Error(t+": "+i);i.code=t.toUpperCase();return e.kb(r,null,i)}}}function vf(e){return e.path.toString()+"$"+e.va()}function sf(e){var t=e.indexOf("$");K(-1!==t&&t<e.length-1,"Bad queryKey.");return{Ib:e.substr(t+1),path:new L(e.substr(0,t))}}function rf(e,t){var r=e.af,n="_"+t;return n in r?r[n]:void 0}function Af(e,t){var r=vf(t);return w(e.lc,r)}var wf=1;function tf(e,t,r){var n=e.ta.get(t);K(n,"Missing sync point for query tag that we're tracking");return n.ab(r,new ef(t,e.jb),null)}function mf(e,t){return Cf(e,t,e.ta,null,new ef(G,e.jb))}function Cf(e,t,r,n,i){if(t.path.e())return Df(e,t,r,n,i);var o=r.get(G);null==n&&null!=o&&(n=o.gb(G));var a=[],s=E(t.path),c=t.Xc(s);if((r=r.children.get(s))&&c)var u=n?n.J(s):null,s=i.u(s),a=a.concat(Cf(e,c,r,u,s));o&&(a=a.concat(o.ab(t,i,n)));return a}function Df(e,t,r,n,i){var o=r.get(G);null==n&&null!=o&&(n=o.gb(G));var a=[];r.children.ia(function(r,o){var s=n?n.J(r):null,c=i.u(r),u=t.Xc(r);u&&(a=a.concat(Df(e,u,o,s,c)))});o&&(a=a.concat(o.ab(t,i,n)));return a}function Ef(){this.children={};this.nd=0;this.value=null}function Ff(e,t,r){this.Gd=e?e:"";this.Zc=t?t:null;this.w=r?r:new Ef}function Gf(e,t){for(var r=t instanceof L?t:new L(t),n=e,i;null!==(i=E(r));)n=new Ff(i,n,w(n.w.children,i)||new Ef),r=H(r);return n}g=Ff.prototype;g.Ca=function(){return this.w.value};function Hf(e,t){K("undefined"!==typeof t,"Cannot set value to undefined");e.w.value=t;If(e)}g.clear=function(){this.w.value=null;this.w.children={};this.w.nd=0;If(this)};g.wd=function(){return 0<this.w.nd};g.e=function(){return null===this.Ca()&&!this.wd()};g.R=function(e){var t=this;r(this.w.children,function(r,n){e(new Ff(n,t,r))})};function Jf(e,t,r,n){r&&!n&&t(e);e.R(function(e){Jf(e,t,!0,n)});r&&n&&t(e)}function Kf(e,t){for(var r=e.parent();null!==r&&!t(r);)r=r.parent()}g.path=function(){return new L(null===this.Zc?this.Gd:this.Zc.path()+"/"+this.Gd)};g.name=function(){return this.Gd};g.parent=function(){return this.Zc};function If(e){if(null!==e.Zc){var t=e.Zc,r=e.Gd,n=e.e(),i=v(t.w.children,r);n&&i?(delete t.w.children[r],t.w.nd--,If(t)):n||i||(t.w.children[r]=e.w,t.w.nd++,If(t))}}function Lf(e){K(ea(e)&&0<e.length,"Requires a non-empty array");this.Vf=e;this.Oc={}}Lf.prototype.ge=function(e,t){for(var r=this.Oc[e]||[],n=0;n<r.length;n++)r[n].zc.apply(r[n].Ma,Array.prototype.slice.call(arguments,1))};Lf.prototype.Fb=function(e,t,r){Mf(this,e);this.Oc[e]=this.Oc[e]||[];this.Oc[e].push({zc:t,Ma:r});(e=this.Be(e))&&t.apply(r,e)};Lf.prototype.hc=function(e,t,r){Mf(this,e);e=this.Oc[e]||[];for(var n=0;n<e.length;n++)if(e[n].zc===t&&(!r||r===e[n].Ma)){e.splice(n,1);break}};function Mf(e,t){K(Ta(e.Vf,function(e){return e===t}),"Unknown event: "+t)}var Nf=function(){var e=0,t=[];return function(r){var n=r===e;e=r;for(var i=Array(8),o=7;0<=o;o--)i[o]="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(r%64),r=Math.floor(r/64);K(0===r,"Cannot push at time == 0");r=i.join("");if(n){for(o=11;0<=o&&63===t[o];o--)t[o]=0;t[o]++}else for(o=0;12>o;o++)t[o]=Math.floor(64*Math.random());for(o=0;12>o;o++)r+="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(t[o]);K(20===r.length,"nextPushId: Length should be 20.");return r}}();function Of(){Lf.call(this,["online"]);this.jc=!0;if("undefined"!==typeof window&&"undefined"!==typeof window.addEventListener){var e=this;window.addEventListener("online",function(){e.jc||(e.jc=!0,e.ge("online",!0))},!1);window.addEventListener("offline",function(){e.jc&&(e.jc=!1,e.ge("online",!1))},!1)}}ma(Of,Lf);Of.prototype.Be=function(e){K("online"===e,"Unknown event type: "+e);return[this.jc]};ca(Of);function Pf(){Lf.call(this,["visible"]);var e,t;"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(t="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(t="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden"));this.Ob=!0;if(t){var r=this;document.addEventListener(t,function(){var t=!document[e];t!==r.Ob&&(r.Ob=t,r.ge("visible",t))},!1)}}ma(Pf,Lf);Pf.prototype.Be=function(e){K("visible"===e,"Unknown event type: "+e);return[this.Ob]};ca(Pf);var Qf=/[\[\].#$\/\u0000-\u001F\u007F]/,Rf=/[\[\].#$\u0000-\u001F\u007F]/,Sf=/^[a-zA-Z][a-zA-Z._\-+]+$/;function Tf(e){return p(e)&&0!==e.length&&!Qf.test(e)}function Uf(e){return null===e||p(e)||ga(e)&&!Rc(e)||ia(e)&&v(e,".sv")}function Vf(e,t,r,i){i&&!n(t)||Wf(z(e,1,i),t,r)}function Wf(e,t,r){r instanceof L&&(r=new vc(r,e));if(!n(t))throw Error(e+"contains undefined "+yc(r));if(ha(t))throw Error(e+"contains a function "+yc(r)+" with contents: "+t.toString());if(Rc(t))throw Error(e+"contains "+t.toString()+" "+yc(r));if(p(t)&&t.length>10485760/3&&10485760<wc(t))throw Error(e+"contains a string greater than 10485760 utf8 bytes "+yc(r)+" ('"+t.substring(0,50)+"...')");if(ia(t)){var i=!1,o=!1;ib(t,function(t,n){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(o=!0,!Tf(t)))throw Error(e+" contains an invalid key ("+t+") "+yc(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(t);Wf(e,n,r);r.pop()});if(i&&o)throw Error(e+' contains ".value" child '+yc(r)+" in addition to actual children.")}}function Xf(e,t,r){if(!ia(t)||ea(t))throw Error(z(e,1,!1)+" must be an Object containing the children to replace.");if(v(t,".value"))throw Error(z(e,1,!1)+' must not contain ".value".  To overwrite with a leaf value, just use .set() instead.');Vf(e,t,r,!1)}function Yf(e,t,r){if(Rc(r))throw Error(z(e,t,!1)+"is "+r.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Uf(r))throw Error(z(e,t,!1)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}function Zf(e,t,r){if(!r||n(t))switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw Error(z(e,1,r)+'must be a valid event type: "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}function $f(e,t,r,i){if((!i||n(r))&&!Tf(r))throw Error(z(e,t,i)+'was an invalid key: "'+r+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')}function ag(e,t){if(!p(t)||0===t.length||Rf.test(t))throw Error(z(e,1,!1)+'was an invalid path: "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')}function bg(e,t){if(".info"===E(t))throw Error(e+" failed: Can't modify data under /.info/");
}function cg(e,t){if(!p(t))throw Error(z(e,1,!1)+"must be a valid credential (a string).")}function dg(e,t,r){if(!p(r))throw Error(z(e,t,!1)+"must be a valid string.")}function eg(e,t){dg(e,1,t);if(!Sf.test(t))throw Error(z(e,1,!1)+"'"+t+"' is not a valid authentication provider.")}function fg(e,t,r,i){if(!i||n(r))if(!ia(r)||null===r)throw Error(z(e,t,i)+"must be a valid object.")}function gg(e,t,r){if(!ia(t)||!v(t,r))throw Error(z(e,1,!1)+'must contain the key "'+r+'"');if(!p(w(t,r)))throw Error(z(e,1,!1)+'must contain the key "'+r+'" with type "string"')}function hg(){this.set={}}g=hg.prototype;g.add=function(e,t){this.set[e]=null!==t?t:!0};g.contains=function(e){return v(this.set,e)};g.get=function(e){return this.contains(e)?this.set[e]:void 0};g.remove=function(e){delete this.set[e]};g.clear=function(){this.set={}};g.e=function(){return wa(this.set)};g.count=function(){return pa(this.set)};function ig(e,t){r(e.set,function(e,r){t(r,e)})}g.keys=function(){var e=[];r(this.set,function(t,r){e.push(r)});return e};function pc(){this.m=this.A=null}pc.prototype.find=function(e){if(null!=this.A)return this.A.Y(e);if(e.e()||null==this.m)return null;var t=E(e);e=H(e);return this.m.contains(t)?this.m.get(t).find(e):null};pc.prototype.nc=function(e,t){if(e.e())this.A=t,this.m=null;else if(null!==this.A)this.A=this.A.K(e,t);else{null==this.m&&(this.m=new hg);var r=E(e);this.m.contains(r)||this.m.add(r,new pc);r=this.m.get(r);e=H(e);r.nc(e,t)}};function jg(e,t){if(t.e())return e.A=null,e.m=null,!0;if(null!==e.A){if(e.A.L())return!1;var r=e.A;e.A=null;r.R(N,function(t,r){e.nc(new L(t),r)});return jg(e,t)}return null!==e.m?(r=E(t),t=H(t),e.m.contains(r)&&jg(e.m.get(r),t)&&e.m.remove(r),e.m.e()?(e.m=null,!0):!1):!0}function qc(e,t,r){null!==e.A?r(t,e.A):e.R(function(e,n){var i=new L(t.toString()+"/"+e);qc(n,i,r)})}pc.prototype.R=function(e){null!==this.m&&ig(this.m,function(t,r){e(t,r)})};var kg="auth.firebase.com";function lg(e,t,r){this.od=e||{};this.fe=t||{};this.$a=r||{};this.od.remember||(this.od.remember="default")}var mg=["remember","redirectTo"];function ng(e){var t={},r={};ib(e||{},function(e,n){0<=Na(mg,e)?t[e]=n:r[e]=n});return new lg(t,{},r)}function og(e,t){this.Re=["session",e.Od,e.Db].join(":");this.ce=t}og.prototype.set=function(e,t){if(!t)if(this.ce.length)t=this.ce[0];else throw Error("fb.login.SessionManager : No storage options available!");t.set(this.Re,e)};og.prototype.get=function(){var e=Qa(this.ce,q(this.og,this)),e=Pa(e,function(e){return null!==e});Xa(e,function(e,t){return ad(t.token)-ad(e.token)});return 0<e.length?e.shift():null};og.prototype.og=function(e){try{var t=e.get(this.Re);if(t&&t.token)return t}catch(e){}return null};og.prototype.clear=function(){var e=this;Oa(this.ce,function(t){t.remove(e.Re)})};function pg(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function qg(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pg())}function rg(){return"undefined"!==typeof location&&/^file:\//.test(location.href)}function sg(e){var t=pg();if(""===t)return!1;if("Microsoft Internet Explorer"===navigator.appName){if((t=t.match(/MSIE ([0-9]{1,}[\.0-9]{0,})/))&&1<t.length)return parseFloat(t[1])>=e}else if(-1<t.indexOf("Trident")&&(t=t.match(/rv:([0-9]{2,2}[\.0-9]{0,})/))&&1<t.length)return parseFloat(t[1])>=e;return!1}function tg(){var e=window.opener.frames,t;for(t=e.length-1;0<=t;t--)try{if(e[t].location.protocol===window.location.protocol&&e[t].location.host===window.location.host&&"__winchan_relay_frame"===e[t].name)return e[t]}catch(e){}return null}function ug(e,t,r){e.attachEvent?e.attachEvent("on"+t,r):e.addEventListener&&e.addEventListener(t,r,!1)}function vg(e,t,r){e.detachEvent?e.detachEvent("on"+t,r):e.removeEventListener&&e.removeEventListener(t,r,!1)}function wg(e){/^https?:\/\//.test(e)||(e=window.location.href);var t=/^(https?:\/\/[\-_a-zA-Z\.0-9:]+)/.exec(e);return t?t[1]:e}function xg(e){var t="";try{e=e.replace("#","");var r=lb(e);r&&v(r,"__firebase_request_key")&&(t=w(r,"__firebase_request_key"))}catch(e){}return t}function yg(){var e=Qc(kg);return e.scheme+"://"+e.host+"/v2"}function zg(e){return yg()+"/"+e+"/auth/channel"}function Ag(e){var t=this;this.Ac=e;this.de="*";sg(8)?this.Rc=this.zd=tg():(this.Rc=window.opener,this.zd=window);if(!t.Rc)throw"Unable to find relay frame";ug(this.zd,"message",q(this.ic,this));ug(this.zd,"message",q(this.Bf,this));try{Bg(this,{a:"ready"})}catch(e){ug(this.Rc,"load",function(){Bg(t,{a:"ready"})})}ug(window,"unload",q(this.zg,this))}function Bg(e,t){t=B(t);sg(8)?e.Rc.doPost(t,e.de):e.Rc.postMessage(t,e.de)}Ag.prototype.ic=function(e){var t=this,r;try{r=nb(e.data)}catch(e){}r&&"request"===r.a&&(vg(window,"message",this.ic),this.de=e.origin,this.Ac&&setTimeout(function(){t.Ac(t.de,r.d,function(e,r){t.bg=!r;t.Ac=void 0;Bg(t,{a:"response",d:e,forceKeepWindowOpen:r})})},0))};Ag.prototype.zg=function(){try{vg(this.zd,"message",this.Bf)}catch(e){}this.Ac&&(Bg(this,{a:"error",d:"unknown closed window"}),this.Ac=void 0);try{window.close()}catch(e){}};Ag.prototype.Bf=function(e){if(this.bg&&"die"===e.data)try{window.close()}catch(e){}};function Cg(e){this.pc=Ga()+Ga()+Ga();this.Ef=e}Cg.prototype.open=function(e,t){P.set("redirect_request_id",this.pc);P.set("redirect_request_id",this.pc);t.requestId=this.pc;t.redirectTo=t.redirectTo||window.location.href;e+=(/\?/.test(e)?"":"?")+kb(t);window.location=e};Cg.isAvailable=function(){return!rg()&&!qg()};Cg.prototype.Cc=function(){return"redirect"};var Dg={NETWORK_ERROR:"Unable to contact the Firebase server.",SERVER_ERROR:"An unknown server error occurred.",TRANSPORT_UNAVAILABLE:"There are no login transports available for the requested method.",REQUEST_INTERRUPTED:"The browser redirected the page before the login request could complete.",USER_CANCELLED:"The user cancelled authentication."};function Eg(e){var t=Error(w(Dg,e),e);t.code=e;return t}function Fg(e){var t;(t=!e.window_features)||(t=pg(),t=-1!==t.indexOf("Fennec/")||-1!==t.indexOf("Firefox/")&&-1!==t.indexOf("Android"));t&&(e.window_features=void 0);e.window_name||(e.window_name="_blank");this.options=e}Fg.prototype.open=function(e,t,r){function n(e){a&&(document.body.removeChild(a),a=void 0);l&&(l=clearInterval(l));vg(window,"message",i);vg(window,"unload",n);if(u&&!e)try{u.close()}catch(e){s.postMessage("die",c)}u=s=void 0}function i(e){if(e.origin===c)try{var t=nb(e.data);"ready"===t.a?s.postMessage(h,c):"error"===t.a?(n(!1),r&&(r(t.d),r=null)):"response"===t.a&&(n(t.forceKeepWindowOpen),r&&(r(null,t.d),r=null))}catch(e){}}var o=sg(8),a,s;if(!this.options.relay_url)return r(Error("invalid arguments: origin of url and relay_url must match"));var c=wg(e);if(c!==wg(this.options.relay_url))r&&setTimeout(function(){r(Error("invalid arguments: origin of url and relay_url must match"))},0);else{o&&(a=document.createElement("iframe"),a.setAttribute("src",this.options.relay_url),a.style.display="none",a.setAttribute("name","__winchan_relay_frame"),document.body.appendChild(a),s=a.contentWindow);e+=(/\?/.test(e)?"":"?")+kb(t);var u=window.open(e,this.options.window_name,this.options.window_features);s||(s=u);var l=setInterval(function(){u&&u.closed&&(n(!1),r&&(r(Eg("USER_CANCELLED")),r=null))},500),h=B({a:"request",d:t});ug(window,"unload",n);ug(window,"message",i)}};Fg.isAvailable=function(){var e;if(e="postMessage"in window&&!rg())(e=qg()||"undefined"!==typeof navigator&&(!!pg().match(/Windows Phone/)||!!window.Windows&&/^ms-appx:/.test(location.href)))||(e=pg(),e="undefined"!==typeof navigator&&"undefined"!==typeof window&&!!(e.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i)||e.match(/CriOS/)||e.match(/Twitter for iPhone/)||e.match(/FBAN\/FBIOS/)||window.navigator.standalone)),e=!e;return e&&!pg().match(/PhantomJS/)};Fg.prototype.Cc=function(){return"popup"};function Gg(e){e.method||(e.method="GET");e.headers||(e.headers={});e.headers.content_type||(e.headers.content_type="application/json");e.headers.content_type=e.headers.content_type.toLowerCase();this.options=e}Gg.prototype.open=function(e,t,r){function n(){r&&(r(Eg("REQUEST_INTERRUPTED")),r=null)}var i=new XMLHttpRequest,o=this.options.method.toUpperCase(),a;ug(window,"beforeunload",n);i.onreadystatechange=function(){if(r&&4===i.readyState){var e;if(200<=i.status&&300>i.status){try{e=nb(i.responseText)}catch(e){}r(null,e)}else 500<=i.status&&600>i.status?r(Eg("SERVER_ERROR")):r(Eg("NETWORK_ERROR"));r=null;vg(window,"beforeunload",n)}};if("GET"===o)e+=(/\?/.test(e)?"":"?")+kb(t),a=null;else{var s=this.options.headers.content_type;"application/json"===s&&(a=B(t));"application/x-www-form-urlencoded"===s&&(a=kb(t))}i.open(o,e,!0);e={"X-Requested-With":"XMLHttpRequest",Accept:"application/json;text/plain"};za(e,this.options.headers);for(var c in e)i.setRequestHeader(c,e[c]);i.send(a)};Gg.isAvailable=function(){var e;if(e=!!window.XMLHttpRequest)e=pg(),e=!(e.match(/MSIE/)||e.match(/Trident/))||sg(10);return e};Gg.prototype.Cc=function(){return"json"};function Hg(e){this.pc=Ga()+Ga()+Ga();this.Ef=e}Hg.prototype.open=function(e,t,r){function n(){r&&(r(Eg("USER_CANCELLED")),r=null)}var i=this,o=Qc(kg),a;t.requestId=this.pc;t.redirectTo=o.scheme+"://"+o.host+"/blank/page.html";e+=/\?/.test(e)?"":"?";e+=kb(t);(a=window.open(e,"_blank","location=no"))&&ha(a.addEventListener)?(a.addEventListener("loadstart",function(e){var t;if(t=e&&e.url)e:{try{var s=document.createElement("a");s.href=e.url;t=s.host===o.host&&"/blank/page.html"===s.pathname;break e}catch(e){}t=!1}t&&(e=xg(e.url),a.removeEventListener("exit",n),a.close(),e=new lg(null,null,{requestId:i.pc,requestKey:e}),i.Ef.requestWithCredential("/auth/session",e,r),r=null)}),a.addEventListener("exit",n)):r(Eg("TRANSPORT_UNAVAILABLE"))};Hg.isAvailable=function(){return qg()};Hg.prototype.Cc=function(){return"redirect"};function Ig(e){e.callback_parameter||(e.callback_parameter="callback");this.options=e;window.__firebase_auth_jsonp=window.__firebase_auth_jsonp||{}}Ig.prototype.open=function(e,t,r){function n(){r&&(r(Eg("REQUEST_INTERRUPTED")),r=null)}function i(){setTimeout(function(){window.__firebase_auth_jsonp[o]=void 0;wa(window.__firebase_auth_jsonp)&&(window.__firebase_auth_jsonp=void 0);try{var e=document.getElementById(o);e&&e.parentNode.removeChild(e)}catch(e){}},1);vg(window,"beforeunload",n)}var o="fn"+(new Date).getTime()+Math.floor(99999*Math.random());t[this.options.callback_parameter]="__firebase_auth_jsonp."+o;e+=(/\?/.test(e)?"":"?")+kb(t);ug(window,"beforeunload",n);window.__firebase_auth_jsonp[o]=function(e){r&&(r(null,e),r=null);i()};Jg(o,e,r)};function Jg(e,t,r){setTimeout(function(){try{var n=document.createElement("script");n.type="text/javascript";n.id=e;n.async=!0;n.src=t;n.onerror=function(){var t=document.getElementById(e);null!==t&&t.parentNode.removeChild(t);r&&r(Eg("NETWORK_ERROR"))};var i=document.getElementsByTagName("head");(i&&0!=i.length?i[0]:document.documentElement).appendChild(n)}catch(e){r&&r(Eg("NETWORK_ERROR"))}},0)}Ig.isAvailable=function(){return"undefined"!==typeof document&&null!=document.createElement};Ig.prototype.Cc=function(){return"json"};function Kg(e,t,r,n){Lf.call(this,["auth_status"]);this.F=e;this.ef=t;this.Tg=r;this.Me=n;this.sc=new og(e,[Cc,P]);this.nb=null;this.Te=!1;Lg(this)}ma(Kg,Lf);g=Kg.prototype;g.ye=function(){return this.nb||null};function Lg(e){P.get("redirect_request_id")&&Mg(e);var t=e.sc.get();t&&t.token?(Ng(e,t),e.ef(t.token,function(r,n){Og(e,r,n,!1,t.token,t)},function(t,r){Pg(e,"resumeSession()",t,r)})):Ng(e,null)}function Qg(e,t,r,n,i,o){"firebaseio-demo.com"===e.F.domain&&Q("Firebase authentication is not supported on demo Firebases (*.firebaseio-demo.com). To secure your Firebase, create a production Firebase at https://www.firebase.com.");e.ef(t,function(o,a){Og(e,o,a,!0,t,r,n||{},i)},function(t,r){Pg(e,"auth()",t,r,o)})}function Rg(e,t){e.sc.clear();Ng(e,null);e.Tg(function(e,r){if("ok"===e)R(t,null);else{var n=(e||"error").toUpperCase(),i=n;r&&(i+=": "+r);i=Error(i);i.code=n;R(t,i)}})}function Og(e,t,r,n,i,o,a,s){"ok"===t?(n&&(t=r.auth,o.auth=t,o.expires=r.expires,o.token=bd(i)?i:"",r=null,t&&v(t,"uid")?r=w(t,"uid"):v(o,"uid")&&(r=w(o,"uid")),o.uid=r,r="custom",t&&v(t,"provider")?r=w(t,"provider"):v(o,"provider")&&(r=w(o,"provider")),o.provider=r,e.sc.clear(),bd(i)&&(a=a||{},r=Cc,"sessionOnly"===a.remember&&(r=P),"none"!==a.remember&&e.sc.set(o,r)),Ng(e,o)),R(s,null,o)):(e.sc.clear(),Ng(e,null),o=e=(t||"error").toUpperCase(),r&&(o+=": "+r),o=Error(o),o.code=e,R(s,o))}function Pg(e,t,r,n,i){Q(t+" was canceled: "+n);e.sc.clear();Ng(e,null);e=Error(n);e.code=r.toUpperCase();R(i,e)}function Sg(e,t,r,n,i){Tg(e);r=new lg(n||{},{},r||{});Ug(e,[Gg,Ig],"/auth/"+t,r,i)}function Vg(e,t,r,n){Tg(e);var i=[Fg,Hg];r=ng(r);"anonymous"===t||"password"===t?setTimeout(function(){R(n,Eg("TRANSPORT_UNAVAILABLE"))},0):(r.fe.window_features="menubar=yes,modal=yes,alwaysRaised=yeslocation=yes,resizable=yes,scrollbars=yes,status=yes,height=625,width=625,top="+("object"===typeof screen?.5*(screen.height-625):0)+",left="+("object"===typeof screen?.5*(screen.width-625):0),r.fe.relay_url=zg(e.F.Db),r.fe.requestWithCredential=q(e.qc,e),Ug(e,i,"/auth/"+t,r,n))}function Mg(e){var t=P.get("redirect_request_id");if(t){var r=P.get("redirect_client_options");P.remove("redirect_request_id");P.remove("redirect_client_options");var n=[Gg,Ig],t={requestId:t,requestKey:xg(document.location.hash)},r=new lg(r,{},t);e.Te=!0;try{document.location.hash=document.location.hash.replace(/&__firebase_request_key=([a-zA-z0-9]*)/,"")}catch(e){}Ug(e,n,"/auth/session",r,function(){this.Te=!1}.bind(e))}}g.te=function(e,t){Tg(this);var r=ng(e);r.$a._method="POST";this.qc("/users",r,function(e,r){e?R(t,e):R(t,e,r)})};g.Ue=function(e,t){var r=this;Tg(this);var n="/users/"+encodeURIComponent(e.email),i=ng(e);i.$a._method="DELETE";this.qc(n,i,function(e,n){!e&&n&&n.uid&&r.nb&&r.nb.uid&&r.nb.uid===n.uid&&Rg(r);R(t,e)})};g.qe=function(e,t){Tg(this);var r="/users/"+encodeURIComponent(e.email)+"/password",n=ng(e);n.$a._method="PUT";n.$a.password=e.newPassword;this.qc(r,n,function(e){R(t,e)})};g.pe=function(e,t){Tg(this);var r="/users/"+encodeURIComponent(e.oldEmail)+"/email",n=ng(e);n.$a._method="PUT";n.$a.email=e.newEmail;n.$a.password=e.password;this.qc(r,n,function(e){R(t,e)})};g.We=function(e,t){Tg(this);var r="/users/"+encodeURIComponent(e.email)+"/password",n=ng(e);n.$a._method="POST";this.qc(r,n,function(e){R(t,e)})};g.qc=function(e,t,r){Wg(this,[Gg,Ig],e,t,r)};function Ug(e,t,r,n,i){Wg(e,t,r,n,function(t,r){!t&&r&&r.token&&r.uid?Qg(e,r.token,r,n.od,function(e,t){e?R(i,e):R(i,null,t)}):R(i,t||Eg("UNKNOWN_ERROR"))})}function Wg(e,t,r,n,i){t=Pa(t,function(e){return"function"===typeof e.isAvailable&&e.isAvailable()});0===t.length?setTimeout(function(){R(i,Eg("TRANSPORT_UNAVAILABLE"))},0):(t=new(t.shift())(n.fe),n=jb(n.$a),n.v="js-"+hb,n.transport=t.Cc(),n.suppress_status_codes=!0,e=yg()+"/"+e.F.Db+r,t.open(e,n,function(e,t){if(e)R(i,e);else if(t&&t.error){var r=Error(t.error.message);r.code=t.error.code;r.details=t.error.details;R(i,r)}else R(i,null,t)}))}function Ng(e,t){var r=null!==e.nb||null!==t;e.nb=t;r&&e.ge("auth_status",t);e.Me(null!==t)}g.Be=function(e){K("auth_status"===e,'initial event must be of type "auth_status"');return this.Te?null:[this.nb]};function Tg(e){var t=e.F;if("firebaseio.com"!==t.domain&&"firebaseio-demo.com"!==t.domain&&"auth.firebase.com"===kg)throw Error("This custom Firebase server ('"+e.F.domain+"') does not support delegated login.")}function Xg(e){this.ic=e;this.Nd=[];this.Sb=0;this.re=-1;this.Gb=null}function Yg(e,t,r){e.re=t;e.Gb=r;e.re<e.Sb&&(e.Gb(),e.Gb=null)}function Zg(e,t,r){for(e.Nd[t]=r;e.Nd[e.Sb];){var n=e.Nd[e.Sb];delete e.Nd[e.Sb];for(var i=0;i<n.length;++i)if(n[i]){var o=e;Db(function(){o.ic(n[i])})}if(e.Sb===e.re){e.Gb&&(clearTimeout(e.Gb),e.Gb(),e.Gb=null);break}e.Sb++}}function $g(e,t,r){this.se=e;this.f=Nc(e);this.ob=this.pb=0;this.Va=Qb(t);this.Zd=r;this.Hc=!1;this.jd=function(e){t.host!==t.Pa&&(e.ns=t.Db);var r=[],n;for(n in e)e.hasOwnProperty(n)&&r.push(n+"="+e[n]);return(t.lb?"https://":"http://")+t.Pa+"/.lp?"+r.join("&")}}var ah,bh;$g.prototype.open=function(e,t){this.hf=0;this.la=t;this.Af=new Xg(e);this.Ab=!1;var r=this;this.rb=setTimeout(function(){r.f("Timed out trying to connect.");r.hb();r.rb=null},Math.floor(3e4));Sc(function(){if(!r.Ab){r.Ta=new ch(function(e,t,n,i,o){dh(r,arguments);if(r.Ta)if(r.rb&&(clearTimeout(r.rb),r.rb=null),r.Hc=!0,"start"==e)r.id=t,r.Gf=n;else if("close"===e)t?(r.Ta.Xd=!1,Yg(r.Af,t,function(){r.hb()})):r.hb();else throw Error("Unrecognized command received: "+e)},function(e,t){dh(r,arguments);Zg(r.Af,e,t)},function(){r.hb()},r.jd);var e={start:"t"};e.ser=Math.floor(1e8*Math.random());r.Ta.ie&&(e.cb=r.Ta.ie);e.v="5";r.Zd&&(e.s=r.Zd);"undefined"!==typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(e.r="f");e=r.jd(e);r.f("Connecting via long-poll to "+e);eh(r.Ta,e,function(){})}})};$g.prototype.start=function(){var e=this.Ta,t=this.Gf;e.sg=this.id;e.tg=t;for(e.me=!0;fh(e););e=this.id;t=this.Gf;this.gc=document.createElement("iframe");var r={dframe:"t"};r.id=e;r.pw=t;this.gc.src=this.jd(r);this.gc.style.display="none";document.body.appendChild(this.gc)};$g.isAvailable=function(){return ah||!bh&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.Vg)&&!0};g=$g.prototype;g.Ed=function(){};g.dd=function(){this.Ab=!0;this.Ta&&(this.Ta.close(),this.Ta=null);this.gc&&(document.body.removeChild(this.gc),this.gc=null);this.rb&&(clearTimeout(this.rb),this.rb=null)};g.hb=function(){this.Ab||(this.f("Longpoll is closing itself"),this.dd(),this.la&&(this.la(this.Hc),this.la=null))};g.close=function(){this.Ab||(this.f("Longpoll is being closed."),this.dd())};g.send=function(e){e=B(e);this.pb+=e.length;Nb(this.Va,"bytes_sent",e.length);e=Jc(e);e=fb(e,!0);e=Wc(e,1840);for(var t=0;t<e.length;t++){var r=this.Ta;r.ad.push({Kg:this.hf,Sg:e.length,kf:e[t]});r.me&&fh(r);this.hf++}};function dh(e,t){var r=B(t).length;e.ob+=r;Nb(e.Va,"bytes_received",r)}function ch(e,t,r,n){this.jd=n;this.ib=r;this.Qe=new hg;this.ad=[];this.ue=Math.floor(1e8*Math.random());this.Xd=!0;this.ie=Fc();window["pLPCommand"+this.ie]=e;window["pRTLPCB"+this.ie]=t;e=document.createElement("iframe");e.style.display="none";if(document.body){document.body.appendChild(e);try{e.contentWindow.document||Cb("No IE domain setting required")}catch(t){e.src="javascript:void((function(){document.open();document.domain='"+document.domain+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";e.contentDocument?e.fb=e.contentDocument:e.contentWindow?e.fb=e.contentWindow.document:e.document&&(e.fb=e.document);this.Ea=e;e="";this.Ea.src&&"javascript:"===this.Ea.src.substr(0,11)&&(e='<script>document.domain="'+document.domain+'";</script>');e="<html><body>"+e+"</body></html>";try{this.Ea.fb.open(),this.Ea.fb.write(e),this.Ea.fb.close()}catch(e){Cb("frame writing exception"),e.stack&&Cb(e.stack),Cb(e)}}ch.prototype.close=function(){this.me=!1;if(this.Ea){this.Ea.fb.body.innerHTML="";var e=this;setTimeout(function(){null!==e.Ea&&(document.body.removeChild(e.Ea),e.Ea=null)},Math.floor(0))}var t=this.ib;t&&(this.ib=null,t())};function fh(e){if(e.me&&e.Xd&&e.Qe.count()<(0<e.ad.length?2:1)){e.ue++;var t={};t.id=e.sg;t.pw=e.tg;t.ser=e.ue;for(var t=e.jd(t),r="",n=0;0<e.ad.length;)if(1870>=e.ad[0].kf.length+30+r.length){var i=e.ad.shift(),r=r+"&seg"+n+"="+i.Kg+"&ts"+n+"="+i.Sg+"&d"+n+"="+i.kf;n++}else break;gh(e,t+r,e.ue);return!0}return!1}function gh(e,t,r){function n(){e.Qe.remove(r);fh(e)}e.Qe.add(r,1);var i=setTimeout(n,Math.floor(25e3));eh(e,t,function(){clearTimeout(i);n()})}function eh(e,t,r){setTimeout(function(){try{if(e.Xd){var n=e.Ea.fb.createElement("script");n.type="text/javascript";n.async=!0;n.src=t;n.onload=n.onreadystatechange=function(){var e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),r())};n.onerror=function(){Cb("Long-poll script failed to load: "+t);e.Xd=!1;e.close()};e.Ea.fb.body.appendChild(n)}}catch(e){}},Math.floor(1))}var hh=null;"undefined"!==typeof MozWebSocket?hh=MozWebSocket:"undefined"!==typeof WebSocket&&(hh=WebSocket);function ih(e,t,r){this.se=e;this.f=Nc(this.se);this.frames=this.Kc=null;this.ob=this.pb=this.cf=0;this.Va=Qb(t);this.eb=(t.lb?"wss://":"ws://")+t.Pa+"/.ws?v=5";"undefined"!==typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(this.eb+="&r=f");t.host!==t.Pa&&(this.eb=this.eb+"&ns="+t.Db);r&&(this.eb=this.eb+"&s="+r)}var jh;ih.prototype.open=function(e,t){this.ib=t;this.xg=e;this.f("Websocket connecting to "+this.eb);this.Hc=!1;Cc.set("previous_websocket_failure",!0);try{this.ua=new hh(this.eb)}catch(e){this.f("Error instantiating WebSocket.");var r=e.message||e.data;r&&this.f(r);this.hb();return}var n=this;this.ua.onopen=function(){n.f("Websocket connected.");n.Hc=!0};this.ua.onclose=function(){n.f("Websocket connection was disconnected.");n.ua=null;n.hb()};this.ua.onmessage=function(e){if(null!==n.ua)if(e=e.data,n.ob+=e.length,Nb(n.Va,"bytes_received",e.length),kh(n),null!==n.frames)lh(n,e);else{e:{K(null===n.frames,"We already have a frame buffer");if(6>=e.length){var t=Number(e);if(!isNaN(t)){n.cf=t;n.frames=[];e=null;break e}}n.cf=1;n.frames=[]}null!==e&&lh(n,e)}};this.ua.onerror=function(e){n.f("WebSocket error.  Closing connection.");(e=e.message||e.data)&&n.f(e);n.hb()}};ih.prototype.start=function(){};ih.isAvailable=function(){var e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var t=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);t&&1<t.length&&4.4>parseFloat(t[1])&&(e=!0)}return!e&&null!==hh&&!jh};ih.responsesRequiredToBeHealthy=2;ih.healthyTimeout=3e4;g=ih.prototype;g.Ed=function(){Cc.remove("previous_websocket_failure")};function lh(e,t){e.frames.push(t);if(e.frames.length==e.cf){var r=e.frames.join("");e.frames=null;r=nb(r);e.xg(r)}}g.send=function(e){kh(this);e=B(e);this.pb+=e.length;Nb(this.Va,"bytes_sent",e.length);e=Wc(e,16384);1<e.length&&this.ua.send(String(e.length));for(var t=0;t<e.length;t++)this.ua.send(e[t])};g.dd=function(){this.Ab=!0;this.Kc&&(clearInterval(this.Kc),this.Kc=null);this.ua&&(this.ua.close(),this.ua=null)};g.hb=function(){this.Ab||(this.f("WebSocket is closing itself"),this.dd(),this.ib&&(this.ib(this.Hc),this.ib=null))};g.close=function(){this.Ab||(this.f("WebSocket is being closed"),this.dd())};function kh(e){clearInterval(e.Kc);e.Kc=setInterval(function(){e.ua&&e.ua.send("0");kh(e)},Math.floor(45e3))}function mh(e){nh(this,e)}var oh=[$g,ih];function nh(e,t){var r=ih&&ih.isAvailable(),n=r&&!(Cc.wf||!0===Cc.get("previous_websocket_failure"));t.Ug&&(r||Q("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0);if(n)e.gd=[ih];else{var i=e.gd=[];Xc(oh,function(e,t){t&&t.isAvailable()&&i.push(t)})}}function ph(e){if(0<e.gd.length)return e.gd[0];throw Error("No transports available")}function qh(e,t,r,n,i,o){this.id=e;this.f=Nc("c:"+this.id+":");this.ic=r;this.Wc=n;this.la=i;this.Oe=o;this.F=t;this.Md=[];this.ff=0;this.Of=new mh(t);this.Ua=0;this.f("Connection created");rh(this)}function rh(e){var t=ph(e.Of);e.I=new t("c:"+e.id+":"+e.ff++,e.F);e.Se=t.responsesRequiredToBeHealthy||0;var r=sh(e,e.I),n=th(e,e.I);e.hd=e.I;e.cd=e.I;e.D=null;e.Bb=!1;setTimeout(function(){e.I&&e.I.open(r,n)},Math.floor(0));t=t.healthyTimeout||0;0<t&&(e.yd=setTimeout(function(){e.yd=null;e.Bb||(e.I&&102400<e.I.ob?(e.f("Connection exceeded healthy timeout but has received "+e.I.ob+" bytes.  Marking connection healthy."),e.Bb=!0,e.I.Ed()):e.I&&10240<e.I.pb?e.f("Connection exceeded healthy timeout but has sent "+e.I.pb+" bytes.  Leaving connection alive."):(e.f("Closing unhealthy connection after timeout."),e.close()))},Math.floor(t)))}function th(e,t){return function(r){t===e.I?(e.I=null,r||0!==e.Ua?1===e.Ua&&e.f("Realtime connection lost."):(e.f("Realtime connection failed."),"s-"===e.F.Pa.substr(0,2)&&(Cc.remove("host:"+e.F.host),e.F.Pa=e.F.host)),e.close()):t===e.D?(e.f("Secondary connection lost."),r=e.D,e.D=null,e.hd!==r&&e.cd!==r||e.close()):e.f("closing an old connection")}}function sh(e,t){return function(r){if(2!=e.Ua)if(t===e.cd){var n=Uc("t",r);r=Uc("d",r);if("c"==n){if(n=Uc("t",r),"d"in r)if(r=r.d,"h"===n){var n=r.ts,i=r.v,o=r.h;e.Zd=r.s;Ec(e.F,o);0==e.Ua&&(e.I.start(),uh(e,e.I,n),"5"!==i&&Q("Protocol version mismatch detected"),r=e.Of,(r=1<r.gd.length?r.gd[1]:null)&&vh(e,r))}else if("n"===n){e.f("recvd end transmission on primary");e.cd=e.D;for(r=0;r<e.Md.length;++r)e.Id(e.Md[r]);e.Md=[];wh(e)}else"s"===n?(e.f("Connection shutdown command received. Shutting down..."),e.Oe&&(e.Oe(r),e.Oe=null),e.la=null,e.close()):"r"===n?(e.f("Reset packet received.  New host: "+r),Ec(e.F,r),1===e.Ua?e.close():(xh(e),rh(e))):"e"===n?Oc("Server Error: "+r):"o"===n?(e.f("got pong on primary."),yh(e),zh(e)):Oc("Unknown control packet command: "+n)}else"d"==n&&e.Id(r)}else if(t===e.D)if(n=Uc("t",r),r=Uc("d",r),"c"==n)"t"in r&&(r=r.t,"a"===r?Ah(e):"r"===r?(e.f("Got a reset on secondary, closing it"),e.D.close(),e.hd!==e.D&&e.cd!==e.D||e.close()):"o"===r&&(e.f("got pong on secondary."),e.Mf--,Ah(e)));else if("d"==n)e.Md.push(r);else throw Error("Unknown protocol layer: "+n);else e.f("message on old connection")}}qh.prototype.Fa=function(e){Bh(this,{t:"d",d:e})};function wh(e){e.hd===e.D&&e.cd===e.D&&(e.f("cleaning up and promoting a connection: "+e.D.se),e.I=e.D,e.D=null)}function Ah(e){0>=e.Mf?(e.f("Secondary connection is healthy."),e.Bb=!0,e.D.Ed(),e.D.start(),e.f("sending client ack on secondary"),e.D.send({t:"c",d:{t:"a",d:{}}}),e.f("Ending transmission on primary"),e.I.send({t:"c",d:{t:"n",d:{}}}),e.hd=e.D,wh(e)):(e.f("sending ping on secondary."),e.D.send({t:"c",d:{t:"p",d:{}}}))}qh.prototype.Id=function(e){yh(this);this.ic(e)};function yh(e){e.Bb||(e.Se--,0>=e.Se&&(e.f("Primary connection is healthy."),e.Bb=!0,e.I.Ed()))}function vh(e,t){e.D=new t("c:"+e.id+":"+e.ff++,e.F,e.Zd);e.Mf=t.responsesRequiredToBeHealthy||0;e.D.open(sh(e,e.D),th(e,e.D));setTimeout(function(){e.D&&(e.f("Timed out trying to upgrade."),e.D.close())},Math.floor(6e4))}function uh(e,t,r){e.f("Realtime connection established.");e.I=t;e.Ua=1;e.Wc&&(e.Wc(r),e.Wc=null);0===e.Se?(e.f("Primary connection is healthy."),e.Bb=!0):setTimeout(function(){zh(e)},Math.floor(5e3))}function zh(e){e.Bb||1!==e.Ua||(e.f("sending ping on primary."),Bh(e,{t:"c",d:{t:"p",d:{}}}))}function Bh(e,t){if(1!==e.Ua)throw"Connection is not connected";e.hd.send(t)}qh.prototype.close=function(){2!==this.Ua&&(this.f("Closing realtime connection."),this.Ua=2,xh(this),this.la&&(this.la(),this.la=null))};function xh(e){e.f("Shutting down all connections");e.I&&(e.I.close(),e.I=null);e.D&&(e.D.close(),e.D=null);e.yd&&(clearTimeout(e.yd),e.yd=null)}function Ch(e,t,r,n){this.id=Dh++;this.f=Nc("p:"+this.id+":");this.xf=this.Fe=!1;this.$={};this.qa=[];this.Yc=0;this.Vc=[];this.oa=!1;this.Za=1e3;this.Fd=3e5;this.Hb=t;this.Uc=r;this.Pe=n;this.F=e;this.tb=this.Aa=this.Ia=this.Xe=null;this.Ob=!1;this.Td={};this.Jg=0;this.nf=!0;this.Lc=this.He=null;Eh(this,0);Pf.vb().Fb("visible",this.Ag,this);-1===e.host.indexOf("fblocal")&&Of.vb().Fb("online",this.yg,this)}var Dh=0,Fh=0;g=Ch.prototype;g.Fa=function(e,t,r){var n=++this.Jg;e={r:n,a:e,b:t};this.f(B(e));K(this.oa,"sendRequest call when we're not connected not allowed.");this.Ia.Fa(e);r&&(this.Td[n]=r)};g.yf=function(e,t,r,n){var i=e.va(),o=e.path.toString();this.f("Listen called for "+o+" "+i);this.$[o]=this.$[o]||{};K(!this.$[o][i],"listen() called twice for same path/queryId.");e={G:n,xd:t,Gg:e,tag:r};this.$[o][i]=e;this.oa&&Gh(this,e)};function Gh(e,t){var r=t.Gg,n=r.path.toString(),i=r.va();e.f("Listen on "+n+" for "+i);var o={p:n};t.tag&&(o.q=ce(r.o),o.t=t.tag);o.h=t.xd();e.Fa("q",o,function(o){var a=o.d,s=o.s;if(a&&"object"===typeof a&&v(a,"w")){var c=w(a,"w");ea(c)&&0<=Na(c,"no_index")&&Q("Using an unspecified index. Consider adding "+('".indexOn": "'+r.o.g.toString()+'"')+" at "+r.path.toString()+" to your security rules for better performance")}(e.$[n]&&e.$[n][i])===t&&(e.f("listen response",o),"ok"!==s&&Hh(e,n,i),t.G&&t.G(s,a))})}g.N=function(e,t,r){this.Aa={gg:e,of:!1,zc:t,md:r};this.f("Authenticating using credential: "+e);Ih(this);(t=40==e.length)||(e=$c(e).Bc,t="object"===typeof e&&!0===w(e,"admin"));t&&(this.f("Admin auth credential detected.  Reducing max reconnect time."),this.Fd=3e4)};g.he=function(e){delete this.Aa;this.oa&&this.Fa("unauth",{},function(t){e(t.s,t.d)})};function Ih(e){var t=e.Aa;e.oa&&t&&e.Fa("auth",{cred:t.gg},function(r){var n=r.s;r=r.d||"error";"ok"!==n&&e.Aa===t&&delete e.Aa;t.of?"ok"!==n&&t.md&&t.md(n,r):(t.of=!0,t.zc&&t.zc(n,r))})}g.Pf=function(e,t){var r=e.path.toString(),n=e.va();this.f("Unlisten called for "+r+" "+n);if(Hh(this,r,n)&&this.oa){var i=ce(e.o);this.f("Unlisten on "+r+" for "+n);r={p:r};t&&(r.q=i,r.t=t);this.Fa("n",r)}};g.Ne=function(e,t,r){this.oa?Jh(this,"o",e,t,r):this.Vc.push({$c:e,action:"o",data:t,G:r})};g.Cf=function(e,t,r){this.oa?Jh(this,"om",e,t,r):this.Vc.push({$c:e,action:"om",data:t,G:r})};g.Jd=function(e,t){this.oa?Jh(this,"oc",e,null,t):this.Vc.push({$c:e,action:"oc",data:null,G:t})};function Jh(e,t,r,n,i){r={p:r,d:n};e.f("onDisconnect "+t,r);e.Fa(t,r,function(e){i&&setTimeout(function(){i(e.s,e.d)},Math.floor(0))})}g.put=function(e,t,r,n){Kh(this,"p",e,t,r,n)};g.zf=function(e,t,r,n){Kh(this,"m",e,t,r,n)};function Kh(e,t,r,i,o,a){i={p:r,d:i};n(a)&&(i.h=a);e.qa.push({action:t,Jf:i,G:o});e.Yc++;t=e.qa.length-1;e.oa?Lh(e,t):e.f("Buffering put: "+r)}function Lh(e,t){var r=e.qa[t].action,n=e.qa[t].Jf,i=e.qa[t].G;e.qa[t].Hg=e.oa;e.Fa(r,n,function(n){e.f(r+" response",n);delete e.qa[t];e.Yc--;0===e.Yc&&(e.qa=[]);i&&i(n.s,n.d)})}g.Ve=function(e){this.oa&&(e={c:e},this.f("reportStats",e),this.Fa("s",e,function(e){"ok"!==e.s&&this.f("reportStats","Error sending stats: "+e.d)}))};g.Id=function(e){if("r"in e){this.f("from server: "+B(e));var t=e.r,r=this.Td[t];r&&(delete this.Td[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&(t=e.a,r=e.b,this.f("handleServerMessage",t,r),"d"===t?this.Hb(r.p,r.d,!1,r.t):"m"===t?this.Hb(r.p,r.d,!0,r.t):"c"===t?Mh(this,r.p,r.q):"ac"===t?(e=r.s,t=r.d,r=this.Aa,delete this.Aa,r&&r.md&&r.md(e,t)):"sd"===t?this.Xe?this.Xe(r):"msg"in r&&"undefined"!==typeof console&&console.log("FIREBASE: "+r.msg.replace("\n","\nFIREBASE: ")):Oc("Unrecognized action received from server: "+B(t)+"\nAre you using the latest client?"))}};g.Wc=function(e){this.f("connection ready");this.oa=!0;this.Lc=(new Date).getTime();this.Pe({serverTimeOffset:e-(new Date).getTime()});this.nf&&(e={},e["sdk.js."+hb.replace(/\./g,"-")]=1,qg()&&(e["framework.cordova"]=1),this.Ve(e));Nh(this);this.nf=!1;this.Uc(!0)};function Eh(e,t){K(!e.Ia,"Scheduling a connect when we're already connected/ing?");e.tb&&clearTimeout(e.tb);e.tb=setTimeout(function(){e.tb=null;Oh(e)},Math.floor(t))}g.Ag=function(e){e&&!this.Ob&&this.Za===this.Fd&&(this.f("Window became visible.  Reducing delay."),this.Za=1e3,this.Ia||Eh(this,0));this.Ob=e};g.yg=function(e){e?(this.f("Browser went online."),this.Za=1e3,this.Ia||Eh(this,0)):(this.f("Browser went offline.  Killing connection."),this.Ia&&this.Ia.close())};g.Df=function(){this.f("data client disconnected");this.oa=!1;this.Ia=null;for(var e=0;e<this.qa.length;e++){var t=this.qa[e];t&&"h"in t.Jf&&t.Hg&&(t.G&&t.G("disconnect"),delete this.qa[e],this.Yc--)}0===this.Yc&&(this.qa=[]);this.Td={};Ph(this)&&(this.Ob?this.Lc&&(3e4<(new Date).getTime()-this.Lc&&(this.Za=1e3),this.Lc=null):(this.f("Window isn't visible.  Delaying reconnect."),this.Za=this.Fd,this.He=(new Date).getTime()),
e=Math.max(0,this.Za-((new Date).getTime()-this.He)),e*=Math.random(),this.f("Trying to reconnect in "+e+"ms"),Eh(this,e),this.Za=Math.min(this.Fd,1.3*this.Za));this.Uc(!1)};function Oh(e){if(Ph(e)){e.f("Making a connection attempt");e.He=(new Date).getTime();e.Lc=null;var t=q(e.Id,e),r=q(e.Wc,e),n=q(e.Df,e),i=e.id+":"+Fh++;e.Ia=new qh(i,e.F,t,r,n,function(t){Q(t+" ("+e.F.toString()+")");e.xf=!0})}}g.zb=function(){this.Fe=!0;this.Ia?this.Ia.close():(this.tb&&(clearTimeout(this.tb),this.tb=null),this.oa&&this.Df())};g.rc=function(){this.Fe=!1;this.Za=1e3;this.Ia||Eh(this,0)};function Mh(e,t,r){r=r?Qa(r,function(e){return Vc(e)}).join("$"):"default";(e=Hh(e,t,r))&&e.G&&e.G("permission_denied")}function Hh(e,t,r){t=new L(t).toString();var i;n(e.$[t])?(i=e.$[t][r],delete e.$[t][r],0===pa(e.$[t])&&delete e.$[t]):i=void 0;return i}function Nh(e){Ih(e);r(e.$,function(t){r(t,function(t){Gh(e,t)})});for(var t=0;t<e.qa.length;t++)e.qa[t]&&Lh(e,t);for(;e.Vc.length;)t=e.Vc.shift(),Jh(e,t.action,t.$c,t.data,t.G)}function Ph(e){var t;t=Of.vb().jc;return!e.xf&&!e.Fe&&t}var V={mg:function(){ah=jh=!0}};V.forceLongPolling=V.mg;V.ng=function(){bh=!0};V.forceWebSockets=V.ng;V.Ng=function(e,t){e.k.Sa.Xe=t};V.setSecurityDebugCallback=V.Ng;V.Ze=function(e,t){e.k.Ze(t)};V.stats=V.Ze;V.$e=function(e,t){e.k.$e(t)};V.statsIncrementCounter=V.$e;V.sd=function(e){return e.k.sd};V.dataUpdateCount=V.sd;V.qg=function(e,t){e.k.Ee=t};V.interceptServerData=V.qg;V.wg=function(e){new Ag(e)};V.onPopupOpen=V.wg;V.Lg=function(e){kg=e};V.setAuthenticationServer=V.Lg;function S(e,t,r){this.w=e;this.V=t;this.g=r}S.prototype.H=function(){x("Firebase.DataSnapshot.val",0,0,arguments.length);return this.w.H()};S.prototype.val=S.prototype.H;S.prototype.mf=function(){x("Firebase.DataSnapshot.exportVal",0,0,arguments.length);return this.w.H(!0)};S.prototype.exportVal=S.prototype.mf;S.prototype.lg=function(){x("Firebase.DataSnapshot.exists",0,0,arguments.length);return!this.w.e()};S.prototype.exists=S.prototype.lg;S.prototype.u=function(e){x("Firebase.DataSnapshot.child",0,1,arguments.length);ga(e)&&(e=String(e));ag("Firebase.DataSnapshot.child",e);var t=new L(e),r=this.V.u(t);return new S(this.w.Y(t),r,N)};S.prototype.child=S.prototype.u;S.prototype.Da=function(e){x("Firebase.DataSnapshot.hasChild",1,1,arguments.length);ag("Firebase.DataSnapshot.hasChild",e);var t=new L(e);return!this.w.Y(t).e()};S.prototype.hasChild=S.prototype.Da;S.prototype.B=function(){x("Firebase.DataSnapshot.getPriority",0,0,arguments.length);return this.w.B().H()};S.prototype.getPriority=S.prototype.B;S.prototype.forEach=function(e){x("Firebase.DataSnapshot.forEach",1,1,arguments.length);A("Firebase.DataSnapshot.forEach",1,e,!1);if(this.w.L())return!1;var t=this;return!!this.w.R(this.g,function(r,n){return e(new S(n,t.V.u(r),N))})};S.prototype.forEach=S.prototype.forEach;S.prototype.wd=function(){x("Firebase.DataSnapshot.hasChildren",0,0,arguments.length);return this.w.L()?!1:!this.w.e()};S.prototype.hasChildren=S.prototype.wd;S.prototype.name=function(){Q("Firebase.DataSnapshot.name() being deprecated. Please use Firebase.DataSnapshot.key() instead.");x("Firebase.DataSnapshot.name",0,0,arguments.length);return this.key()};S.prototype.name=S.prototype.name;S.prototype.key=function(){x("Firebase.DataSnapshot.key",0,0,arguments.length);return this.V.key()};S.prototype.key=S.prototype.key;S.prototype.Eb=function(){x("Firebase.DataSnapshot.numChildren",0,0,arguments.length);return this.w.Eb()};S.prototype.numChildren=S.prototype.Eb;S.prototype.mc=function(){x("Firebase.DataSnapshot.ref",0,0,arguments.length);return this.V};S.prototype.ref=S.prototype.mc;function Qh(e,t){this.F=e;this.Va=Qb(e);this.fd=null;this.da=new vb;this.Hd=1;this.Sa=null;t||0<=("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)?(this.ba=new ye(this.F,q(this.Hb,this)),setTimeout(q(this.Uc,this,!0),0)):this.ba=this.Sa=new Ch(this.F,q(this.Hb,this),q(this.Uc,this),q(this.Pe,this));this.Qg=Rb(e,q(function(){return new Lb(this.Va,this.ba)},this));this.uc=new Ff;this.De=new ob;var r=this;this.Cd=new kf({Ye:function(e,t,n,i){t=[];n=r.De.j(e.path);n.e()||(t=mf(r.Cd,new Wb(Re,e.path,n)),setTimeout(function(){i("ok")},0));return t},be:ba});Rh(this,"connected",!1);this.la=new pc;this.N=new Kg(e,q(this.ba.N,this.ba),q(this.ba.he,this.ba),q(this.Me,this));this.sd=0;this.Ee=null;this.M=new kf({Ye:function(e,t,n,i){r.ba.yf(e,n,t,function(t,n){var o=i(t,n);Ab(r.da,e.path,o)});return[]},be:function(e,t){r.ba.Pf(e,t)}})}g=Qh.prototype;g.toString=function(){return(this.F.lb?"https://":"http://")+this.F.host};g.name=function(){return this.F.Db};function Sh(e){e=e.De.j(new L(".info/serverTimeOffset")).H()||0;return(new Date).getTime()+e}function Th(e){e=e={timestamp:Sh(e)};e.timestamp=e.timestamp||(new Date).getTime();return e}g.Hb=function(e,t,r,n){this.sd++;var i=new L(e);t=this.Ee?this.Ee(e,t):t;e=[];n?r?(t=na(t,function(e){return M(e)}),e=uf(this.M,i,t,n)):(t=M(t),e=qf(this.M,i,t,n)):r?(n=na(t,function(e){return M(e)}),e=pf(this.M,i,n)):(n=M(t),e=mf(this.M,new Wb(Re,i,n)));n=i;0<e.length&&(n=Uh(this,i));Ab(this.da,n,e)};g.Uc=function(e){Rh(this,"connected",e);!1===e&&Vh(this)};g.Pe=function(e){var t=this;Xc(e,function(e,r){Rh(t,r,e)})};g.Me=function(e){Rh(this,"authenticated",e)};function Rh(e,t,r){t=new L("/.info/"+t);r=M(r);var n=e.De;n.Wd=n.Wd.K(t,r);r=mf(e.Cd,new Wb(Re,t,r));Ab(e.da,t,r)}g.Kb=function(e,t,r,n){this.f("set",{path:e.toString(),value:t,Yg:r});var i=Th(this);t=M(t,r);var i=rc(t,i),o=this.Hd++,i=lf(this.M,e,i,o,!0);wb(this.da,i);var a=this;this.ba.put(e.toString(),t.H(!0),function(t,r){var i="ok"===t;i||Q("set at "+e+" failed: "+t);i=of(a.M,o,!i);Ab(a.da,e,i);Wh(n,t,r)});i=Xh(this,e);Uh(this,i);Ab(this.da,i,[])};g.update=function(e,t,n){this.f("update",{path:e.toString(),value:t});var i=!0,o=Th(this),a={};r(t,function(e,t){i=!1;var r=M(e);a[t]=rc(r,o)});if(i)Cb("update() called with empty data.  Don't do anything."),Wh(n,"ok");else{var s=this.Hd++,c=nf(this.M,e,a,s);wb(this.da,c);var u=this;this.ba.zf(e.toString(),t,function(t,r){var i="ok"===t;i||Q("update at "+e+" failed: "+t);var i=of(u.M,s,!i),o=e;0<i.length&&(o=Uh(u,e));Ab(u.da,o,i);Wh(n,t,r)});t=Xh(this,e);Uh(this,t);Ab(this.da,e,[])}};function Vh(e){e.f("onDisconnectEvents");var t=Th(e),r=[];qc(oc(e.la,t),G,function(t,n){r=r.concat(mf(e.M,new Wb(Re,t,n)));var i=Xh(e,t);Uh(e,i)});e.la=new pc;Ab(e.da,G,r)}g.Jd=function(e,t){var r=this;this.ba.Jd(e.toString(),function(n,i){"ok"===n&&jg(r.la,e);Wh(t,n,i)})};function Yh(e,t,r,n){var i=M(r);e.ba.Ne(t.toString(),i.H(!0),function(r,o){"ok"===r&&e.la.nc(t,i);Wh(n,r,o)})}function Zh(e,t,r,n,i){var o=M(r,n);e.ba.Ne(t.toString(),o.H(!0),function(r,n){"ok"===r&&e.la.nc(t,o);Wh(i,r,n)})}function $h(e,t,r,n){var i=!0,o;for(o in r)i=!1;i?(Cb("onDisconnect().update() called with empty data.  Don't do anything."),Wh(n,"ok")):e.ba.Cf(t.toString(),r,function(i,o){if("ok"===i)for(var a in r){var s=M(r[a]);e.la.nc(t.u(a),s)}Wh(n,i,o)})}function ai(e,t,r){r=".info"===E(t.path)?e.Cd.Pb(t,r):e.M.Pb(t,r);yb(e.da,t.path,r)}g.zb=function(){this.Sa&&this.Sa.zb()};g.rc=function(){this.Sa&&this.Sa.rc()};g.Ze=function(e){if("undefined"!==typeof console){e?(this.fd||(this.fd=new Kb(this.Va)),e=this.fd.get()):e=this.Va.get();var t=Ra(sa(e),function(e,t){return Math.max(t.length,e)},0),r;for(r in e){for(var n=e[r],i=r.length;i<t+2;i++)r+=" ";console.log(r+n)}}};g.$e=function(e){Nb(this.Va,e);this.Qg.Nf[e]=!0};g.f=function(e){var t="";this.Sa&&(t=this.Sa.id+":");Cb(t,arguments)};function Wh(e,t,r){e&&Db(function(){if("ok"==t)e(null);else{var n=(t||"error").toUpperCase(),i=n;r&&(i+=": "+r);i=Error(i);i.code=n;e(i)}})}function bi(e,t,r,i,o){function a(){}e.f("transaction on "+t);var s=new U(e,t);s.Fb("value",a);r={path:t,update:r,G:i,status:null,Ff:Fc(),df:o,Lf:0,je:function(){s.hc("value",a)},le:null,Ba:null,pd:null,qd:null,rd:null};i=e.M.za(t,void 0)||C;r.pd=i;i=r.update(i.H());if(n(i)){Wf("transaction failed: Data returned ",i,r.path);r.status=1;o=Gf(e.uc,t);var c=o.Ca()||[];c.push(r);Hf(o,c);"object"===typeof i&&null!==i&&v(i,".priority")?(c=w(i,".priority"),K(Uf(c),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):c=(e.M.za(t)||C).B().H();o=Th(e);i=M(i,c);o=rc(i,o);r.qd=i;r.rd=o;r.Ba=e.Hd++;r=lf(e.M,t,o,r.Ba,r.df);Ab(e.da,t,r);ci(e)}else r.je(),r.qd=null,r.rd=null,r.G&&(e=new S(r.pd,new U(e,r.path),N),r.G(null,!1,e))}function ci(e,t){var r=t||e.uc;t||di(e,r);if(null!==r.Ca()){var n=ei(e,r);K(0<n.length,"Sending zero length transaction queue");Sa(n,function(e){return 1===e.status})&&fi(e,r.path(),n)}else r.wd()&&r.R(function(t){ci(e,t)})}function fi(e,t,r){for(var n=Qa(r,function(e){return e.Ba}),i=e.M.za(t,n)||C,n=i,i=i.hash(),o=0;o<r.length;o++){var a=r[o];K(1===a.status,"tryToSendTransactionQueue_: items in queue should all be run.");a.status=2;a.Lf++;var s=O(t,a.path),n=n.K(s,a.qd)}n=n.H(!0);e.ba.put(t.toString(),n,function(n){e.f("transaction put response",{path:t.toString(),status:n});var i=[];if("ok"===n){n=[];for(o=0;o<r.length;o++){r[o].status=3;i=i.concat(of(e.M,r[o].Ba));if(r[o].G){var a=r[o].rd,s=new U(e,r[o].path);n.push(q(r[o].G,null,null,!0,new S(a,s,N)))}r[o].je()}di(e,Gf(e.uc,t));ci(e);Ab(e.da,t,i);for(o=0;o<n.length;o++)Db(n[o])}else{if("datastale"===n)for(o=0;o<r.length;o++)r[o].status=4===r[o].status?5:1;else for(Q("transaction at "+t.toString()+" failed: "+n),o=0;o<r.length;o++)r[o].status=5,r[o].le=n;Uh(e,t)}},i)}function Uh(e,t){var r=gi(e,t),n=r.path(),r=ei(e,r);hi(e,r,n);return n}function hi(e,t,r){if(0!==t.length){for(var i=[],o=[],a=Qa(t,function(e){return e.Ba}),s=0;s<t.length;s++){var c=t[s],u=O(r,c.path),l=!1,h;K(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null.");if(5===c.status)l=!0,h=c.le,o=o.concat(of(e.M,c.Ba,!0));else if(1===c.status)if(25<=c.Lf)l=!0,h="maxretry",o=o.concat(of(e.M,c.Ba,!0));else{var f=e.M.za(c.path,a)||C;c.pd=f;var p=t[s].update(f.H());n(p)?(Wf("transaction failed: Data returned ",p,c.path),u=M(p),"object"===typeof p&&null!=p&&v(p,".priority")||(u=u.ga(f.B())),f=c.Ba,p=Th(e),p=rc(u,p),c.qd=u,c.rd=p,c.Ba=e.Hd++,Va(a,f),o=o.concat(lf(e.M,c.path,p,c.Ba,c.df)),o=o.concat(of(e.M,f,!0))):(l=!0,h="nodata",o=o.concat(of(e.M,c.Ba,!0)))}Ab(e.da,r,o);o=[];l&&(t[s].status=3,setTimeout(t[s].je,Math.floor(0)),t[s].G&&("nodata"===h?(c=new U(e,t[s].path),i.push(q(t[s].G,null,null,!1,new S(t[s].pd,c,N)))):i.push(q(t[s].G,null,Error(h),!1,null))))}di(e,e.uc);for(s=0;s<i.length;s++)Db(i[s]);ci(e)}}function gi(e,t){for(var r,n=e.uc;null!==(r=E(t))&&null===n.Ca();)n=Gf(n,r),t=H(t);return n}function ei(e,t){var r=[];ii(e,t,r);r.sort(function(e,t){return e.Ff-t.Ff});return r}function ii(e,t,r){var n=t.Ca();if(null!==n)for(var i=0;i<n.length;i++)r.push(n[i]);t.R(function(t){ii(e,t,r)})}function di(e,t){var r=t.Ca();if(r){for(var n=0,i=0;i<r.length;i++)3!==r[i].status&&(r[n]=r[i],n++);r.length=n;Hf(t,0<r.length?r:null)}t.R(function(t){di(e,t)})}function Xh(e,t){var r=gi(e,t).path(),n=Gf(e.uc,t);Kf(n,function(t){ji(e,t)});ji(e,n);Jf(n,function(t){ji(e,t)});return r}function ji(e,t){var r=t.Ca();if(null!==r){for(var n=[],i=[],o=-1,a=0;a<r.length;a++)4!==r[a].status&&(2===r[a].status?(K(o===a-1,"All SENT items should be at beginning of queue."),o=a,r[a].status=4,r[a].le="set"):(K(1===r[a].status,"Unexpected transaction status in abort"),r[a].je(),i=i.concat(of(e.M,r[a].Ba,!0)),r[a].G&&n.push(q(r[a].G,null,Error("set"),!1,null))));-1===o?Hf(t,null):r.length=o+1;Ab(e.da,t.path(),i);for(a=0;a<n.length;a++)Db(n[a])}}function W(){this.oc={};this.Qf=!1}W.prototype.zb=function(){for(var e in this.oc)this.oc[e].zb()};W.prototype.rc=function(){for(var e in this.oc)this.oc[e].rc()};W.prototype.we=function(){this.Qf=!0};ca(W);W.prototype.interrupt=W.prototype.zb;W.prototype.resume=W.prototype.rc;function X(e,t){this.bd=e;this.ra=t}X.prototype.cancel=function(e){x("Firebase.onDisconnect().cancel",0,1,arguments.length);A("Firebase.onDisconnect().cancel",1,e,!0);this.bd.Jd(this.ra,e||null)};X.prototype.cancel=X.prototype.cancel;X.prototype.remove=function(e){x("Firebase.onDisconnect().remove",0,1,arguments.length);bg("Firebase.onDisconnect().remove",this.ra);A("Firebase.onDisconnect().remove",1,e,!0);Yh(this.bd,this.ra,null,e)};X.prototype.remove=X.prototype.remove;X.prototype.set=function(e,t){x("Firebase.onDisconnect().set",1,2,arguments.length);bg("Firebase.onDisconnect().set",this.ra);Vf("Firebase.onDisconnect().set",e,this.ra,!1);A("Firebase.onDisconnect().set",2,t,!0);Yh(this.bd,this.ra,e,t)};X.prototype.set=X.prototype.set;X.prototype.Kb=function(e,t,r){x("Firebase.onDisconnect().setWithPriority",2,3,arguments.length);bg("Firebase.onDisconnect().setWithPriority",this.ra);Vf("Firebase.onDisconnect().setWithPriority",e,this.ra,!1);Yf("Firebase.onDisconnect().setWithPriority",2,t);A("Firebase.onDisconnect().setWithPriority",3,r,!0);Zh(this.bd,this.ra,e,t,r)};X.prototype.setWithPriority=X.prototype.Kb;X.prototype.update=function(e,t){x("Firebase.onDisconnect().update",1,2,arguments.length);bg("Firebase.onDisconnect().update",this.ra);if(ea(e)){for(var r={},n=0;n<e.length;++n)r[""+n]=e[n];e=r;Q("Passing an Array to Firebase.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Xf("Firebase.onDisconnect().update",e,this.ra);A("Firebase.onDisconnect().update",2,t,!0);$h(this.bd,this.ra,e,t)};X.prototype.update=X.prototype.update;function Y(e,t,r,n){this.k=e;this.path=t;this.o=r;this.kc=n}function ki(e){var t=null,r=null;e.ma&&(t=nd(e));e.pa&&(r=pd(e));if(e.g===Od){if(e.ma){if("[MIN_NAME]"!=md(e))throw Error("Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().");if("string"!==typeof t)throw Error("Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.")}if(e.pa){if("[MAX_NAME]"!=od(e))throw Error("Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().");if("string"!==typeof r)throw Error("Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.")}}else if(e.g===N){if(null!=t&&!Uf(t)||null!=r&&!Uf(r))throw Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(K(e.g instanceof Sd||e.g===Yd,"unknown index type."),null!=t&&"object"===typeof t||null!=r&&"object"===typeof r)throw Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")}function li(e){if(e.ma&&e.pa&&e.ja&&(!e.ja||""===e.Nb))throw Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")}function mi(e,t){if(!0===e.kc)throw Error(t+": You can't combine multiple orderBy calls.")}g=Y.prototype;g.mc=function(){x("Query.ref",0,0,arguments.length);return new U(this.k,this.path)};g.Fb=function(e,t,r,n){x("Query.on",2,4,arguments.length);Zf("Query.on",e,!1);A("Query.on",2,t,!1);var i=ni("Query.on",r,n);if("value"===e)ai(this.k,this,new id(t,i.cancel||null,i.Ma||null));else{var o={};o[e]=t;ai(this.k,this,new jd(o,i.cancel,i.Ma))}return t};g.hc=function(e,t,r){x("Query.off",0,3,arguments.length);Zf("Query.off",e,!0);A("Query.off",2,t,!0);mb("Query.off",3,r);var n=null,i=null;"value"===e?n=new id(t||null,null,r||null):e&&(t&&(i={},i[e]=t),n=new jd(i,null,r||null));i=this.k;n=".info"===E(this.path)?i.Cd.kb(this,n):i.M.kb(this,n);yb(i.da,this.path,n)};g.Bg=function(e,t){function r(a){o&&(o=!1,i.hc(e,r),t.call(n.Ma,a))}x("Query.once",2,4,arguments.length);Zf("Query.once",e,!1);A("Query.once",2,t,!1);var n=ni("Query.once",arguments[2],arguments[3]),i=this,o=!0;this.Fb(e,r,function(t){i.hc(e,r);n.cancel&&n.cancel.call(n.Ma,t)})};g.Ie=function(e){Q("Query.limit() being deprecated. Please use Query.limitToFirst() or Query.limitToLast() instead.");x("Query.limit",1,1,arguments.length);if(!ga(e)||Math.floor(e)!==e||0>=e)throw Error("Query.limit: First argument must be a positive integer.");if(this.o.ja)throw Error("Query.limit: Limit was already set (by another call to limit, limitToFirst, orlimitToLast.");var t=this.o.Ie(e);li(t);return new Y(this.k,this.path,t,this.kc)};g.Je=function(e){x("Query.limitToFirst",1,1,arguments.length);if(!ga(e)||Math.floor(e)!==e||0>=e)throw Error("Query.limitToFirst: First argument must be a positive integer.");if(this.o.ja)throw Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new Y(this.k,this.path,this.o.Je(e),this.kc)};g.Ke=function(e){x("Query.limitToLast",1,1,arguments.length);if(!ga(e)||Math.floor(e)!==e||0>=e)throw Error("Query.limitToLast: First argument must be a positive integer.");if(this.o.ja)throw Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new Y(this.k,this.path,this.o.Ke(e),this.kc)};g.Cg=function(e){x("Query.orderByChild",1,1,arguments.length);if("$key"===e)throw Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');$f("Query.orderByChild",1,e,!1);mi(this,"Query.orderByChild");var t=be(this.o,new Sd(e));ki(t);return new Y(this.k,this.path,t,!0)};g.Dg=function(){x("Query.orderByKey",0,0,arguments.length);mi(this,"Query.orderByKey");var e=be(this.o,Od);ki(e);return new Y(this.k,this.path,e,!0)};g.Eg=function(){x("Query.orderByPriority",0,0,arguments.length);mi(this,"Query.orderByPriority");var e=be(this.o,N);ki(e);return new Y(this.k,this.path,e,!0)};g.Fg=function(){x("Query.orderByValue",0,0,arguments.length);mi(this,"Query.orderByValue");var e=be(this.o,Yd);ki(e);return new Y(this.k,this.path,e,!0)};g.ae=function(e,t){x("Query.startAt",0,2,arguments.length);Vf("Query.startAt",e,this.path,!0);$f("Query.startAt",2,t,!0);var r=this.o.ae(e,t);li(r);ki(r);if(this.o.ma)throw Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");n(e)||(t=e=null);return new Y(this.k,this.path,r,this.kc)};g.td=function(e,t){x("Query.endAt",0,2,arguments.length);Vf("Query.endAt",e,this.path,!0);$f("Query.endAt",2,t,!0);var r=this.o.td(e,t);li(r);ki(r);if(this.o.pa)throw Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new Y(this.k,this.path,r,this.kc)};g.ig=function(e,t){x("Query.equalTo",1,2,arguments.length);Vf("Query.equalTo",e,this.path,!1);$f("Query.equalTo",2,t,!0);if(this.o.ma)throw Error("Query.equalTo: Starting point was already set (by another call to endAt or equalTo).");if(this.o.pa)throw Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.ae(e,t).td(e,t)};g.toString=function(){x("Query.toString",0,0,arguments.length);for(var e=this.path,t="",r=e.Z;r<e.n.length;r++)""!==e.n[r]&&(t+="/"+encodeURIComponent(String(e.n[r])));return this.k.toString()+(t||"/")};g.va=function(){var e=Vc(ce(this.o));return"{}"===e?"default":e};function ni(e,t,r){var n={cancel:null,Ma:null};if(t&&r)n.cancel=t,A(e,3,n.cancel,!0),n.Ma=r,mb(e,4,n.Ma);else if(t)if("object"===typeof t&&null!==t)n.Ma=t;else if("function"===typeof t)n.cancel=t;else throw Error(z(e,3,!0)+" must either be a cancel callback or a context object.");return n}Y.prototype.ref=Y.prototype.mc;Y.prototype.on=Y.prototype.Fb;Y.prototype.off=Y.prototype.hc;Y.prototype.once=Y.prototype.Bg;Y.prototype.limit=Y.prototype.Ie;Y.prototype.limitToFirst=Y.prototype.Je;Y.prototype.limitToLast=Y.prototype.Ke;Y.prototype.orderByChild=Y.prototype.Cg;Y.prototype.orderByKey=Y.prototype.Dg;Y.prototype.orderByPriority=Y.prototype.Eg;Y.prototype.orderByValue=Y.prototype.Fg;Y.prototype.startAt=Y.prototype.ae;Y.prototype.endAt=Y.prototype.td;Y.prototype.equalTo=Y.prototype.ig;Y.prototype.toString=Y.prototype.toString;var Z={};Z.vc=Ch;Z.DataConnection=Z.vc;Ch.prototype.Pg=function(e,t){this.Fa("q",{p:e},t)};Z.vc.prototype.simpleListen=Z.vc.prototype.Pg;Ch.prototype.hg=function(e,t){this.Fa("echo",{d:e},t)};Z.vc.prototype.echo=Z.vc.prototype.hg;Ch.prototype.interrupt=Ch.prototype.zb;Z.Tf=qh;Z.RealTimeConnection=Z.Tf;qh.prototype.sendRequest=qh.prototype.Fa;qh.prototype.close=qh.prototype.close;Z.pg=function(e){var t=Ch.prototype.put;Ch.prototype.put=function(r,i,o,a){n(a)&&(a=e());t.call(this,r,i,o,a)};return function(){Ch.prototype.put=t}};Z.hijackHash=Z.pg;Z.Sf=Dc;Z.ConnectionTarget=Z.Sf;Z.va=function(e){return e.va()};Z.queryIdentifier=Z.va;Z.rg=function(e){return e.k.Sa.$};Z.listens=Z.rg;Z.we=function(e){e.we()};Z.forceRestClient=Z.we;function U(e,t){var r,n,i;if(e instanceof Qh)r=e,n=t;else{x("new Firebase",1,2,arguments.length);n=Qc(arguments[0]);r=n.Rg;"firebase"===n.domain&&Pc(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead");r&&"undefined"!=r||Pc("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com");n.lb||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Q("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");r=new Dc(n.host,n.lb,r,"ws"===n.scheme||"wss"===n.scheme);n=new L(n.$c);i=n.toString();var o;!(o=!p(r.host)||0===r.host.length||!Tf(r.Db))&&(o=0!==i.length)&&(i&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),o=!(p(i)&&0!==i.length&&!Rf.test(i)));if(o)throw Error(z("new Firebase",1,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".');if(t)if(t instanceof W)i=t;else if(p(t))i=W.vb(),r.Od=t;else throw Error("Expected a valid Firebase.Context for second argument to new Firebase()");else i=W.vb();o=r.toString();var a=w(i.oc,o);a||(a=new Qh(r,i.Qf),i.oc[o]=a);r=a}Y.call(this,r,n,$d,!1)}ma(U,Y);var oi=U,pi=["Firebase"],qi=aa;pi[0]in qi||!qi.execScript||qi.execScript("var "+pi[0]);for(var ri;pi.length&&(ri=pi.shift());)!pi.length&&n(oi)?qi[ri]=oi:qi=qi[ri]?qi[ri]:qi[ri]={};U.goOffline=function(){x("Firebase.goOffline",0,0,arguments.length);W.vb().zb()};U.goOnline=function(){x("Firebase.goOnline",0,0,arguments.length);W.vb().rc()};function Mc(e,t){K(!t||!0===e||!1===e,"Can't turn on custom loggers persistently.");!0===e?("undefined"!==typeof console&&("function"===typeof console.log?Bb=q(console.log,console):"object"===typeof console.log&&(Bb=function(e){console.log(e)})),t&&P.set("logging_enabled",!0)):e?Bb=e:(Bb=null,P.remove("logging_enabled"))}U.enableLogging=Mc;U.ServerValue={TIMESTAMP:{".sv":"timestamp"}};U.SDK_VERSION=hb;U.INTERNAL=V;U.Context=W;U.TEST_ACCESS=Z;U.prototype.name=function(){Q("Firebase.name() being deprecated. Please use Firebase.key() instead.");x("Firebase.name",0,0,arguments.length);return this.key()};U.prototype.name=U.prototype.name;U.prototype.key=function(){x("Firebase.key",0,0,arguments.length);return this.path.e()?null:uc(this.path)};U.prototype.key=U.prototype.key;U.prototype.u=function(e){x("Firebase.child",1,1,arguments.length);if(ga(e))e=String(e);else if(!(e instanceof L))if(null===E(this.path)){var t=e;t&&(t=t.replace(/^\/*\.info(\/|$)/,"/"));ag("Firebase.child",t)}else ag("Firebase.child",e);return new U(this.k,this.path.u(e))};U.prototype.child=U.prototype.u;U.prototype.parent=function(){x("Firebase.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new U(this.k,e)};U.prototype.parent=U.prototype.parent;U.prototype.root=function(){x("Firebase.ref",0,0,arguments.length);for(var e=this;null!==e.parent();)e=e.parent();return e};U.prototype.root=U.prototype.root;U.prototype.set=function(e,t){x("Firebase.set",1,2,arguments.length);bg("Firebase.set",this.path);Vf("Firebase.set",e,this.path,!1);A("Firebase.set",2,t,!0);this.k.Kb(this.path,e,null,t||null)};U.prototype.set=U.prototype.set;U.prototype.update=function(e,t){x("Firebase.update",1,2,arguments.length);bg("Firebase.update",this.path);if(ea(e)){for(var r={},n=0;n<e.length;++n)r[""+n]=e[n];e=r;Q("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Xf("Firebase.update",e,this.path);A("Firebase.update",2,t,!0);this.k.update(this.path,e,t||null)};U.prototype.update=U.prototype.update;U.prototype.Kb=function(e,t,r){x("Firebase.setWithPriority",2,3,arguments.length);bg("Firebase.setWithPriority",this.path);Vf("Firebase.setWithPriority",e,this.path,!1);Yf("Firebase.setWithPriority",2,t);A("Firebase.setWithPriority",3,r,!0);if(".length"===this.key()||".keys"===this.key())throw"Firebase.setWithPriority failed: "+this.key()+" is a read-only object.";this.k.Kb(this.path,e,t,r||null)};U.prototype.setWithPriority=U.prototype.Kb;U.prototype.remove=function(e){x("Firebase.remove",0,1,arguments.length);bg("Firebase.remove",this.path);A("Firebase.remove",1,e,!0);this.set(null,e)};U.prototype.remove=U.prototype.remove;U.prototype.transaction=function(e,t,r){x("Firebase.transaction",1,3,arguments.length);bg("Firebase.transaction",this.path);A("Firebase.transaction",1,e,!1);A("Firebase.transaction",2,t,!0);if(n(r)&&"boolean"!=typeof r)throw Error(z("Firebase.transaction",3,!0)+"must be a boolean.");if(".length"===this.key()||".keys"===this.key())throw"Firebase.transaction failed: "+this.key()+" is a read-only object.";"undefined"===typeof r&&(r=!0);bi(this.k,this.path,e,t||null,r)};U.prototype.transaction=U.prototype.transaction;U.prototype.Mg=function(e,t){x("Firebase.setPriority",1,2,arguments.length);bg("Firebase.setPriority",this.path);Yf("Firebase.setPriority",1,e);A("Firebase.setPriority",2,t,!0);this.k.Kb(this.path.u(".priority"),e,null,t)};U.prototype.setPriority=U.prototype.Mg;U.prototype.push=function(e,t){x("Firebase.push",0,2,arguments.length);bg("Firebase.push",this.path);Vf("Firebase.push",e,this.path,!0);A("Firebase.push",2,t,!0);var r=Sh(this.k),r=Nf(r),r=this.u(r);"undefined"!==typeof e&&null!==e&&r.set(e,t);return r};U.prototype.push=U.prototype.push;U.prototype.ib=function(){bg("Firebase.onDisconnect",this.path);return new X(this.k,this.path)};U.prototype.onDisconnect=U.prototype.ib;U.prototype.N=function(e,t,r){Q("FirebaseRef.auth() being deprecated. Please use FirebaseRef.authWithCustomToken() instead.");x("Firebase.auth",1,3,arguments.length);cg("Firebase.auth",e);A("Firebase.auth",2,t,!0);A("Firebase.auth",3,t,!0);Qg(this.k.N,e,{},{remember:"none"},t,r)};U.prototype.auth=U.prototype.N;U.prototype.he=function(e){x("Firebase.unauth",0,1,arguments.length);A("Firebase.unauth",1,e,!0);Rg(this.k.N,e)};U.prototype.unauth=U.prototype.he;U.prototype.ye=function(){x("Firebase.getAuth",0,0,arguments.length);return this.k.N.ye()};U.prototype.getAuth=U.prototype.ye;U.prototype.vg=function(e,t){x("Firebase.onAuth",1,2,arguments.length);A("Firebase.onAuth",1,e,!1);mb("Firebase.onAuth",2,t);this.k.N.Fb("auth_status",e,t)};U.prototype.onAuth=U.prototype.vg;U.prototype.ug=function(e,t){x("Firebase.offAuth",1,2,arguments.length);A("Firebase.offAuth",1,e,!1);mb("Firebase.offAuth",2,t);this.k.N.hc("auth_status",e,t)};U.prototype.offAuth=U.prototype.ug;U.prototype.Xf=function(e,t,r){x("Firebase.authWithCustomToken",2,3,arguments.length);cg("Firebase.authWithCustomToken",e);A("Firebase.authWithCustomToken",2,t,!1);fg("Firebase.authWithCustomToken",3,r,!0);Qg(this.k.N,e,{},r||{},t)};U.prototype.authWithCustomToken=U.prototype.Xf;U.prototype.Yf=function(e,t,r){x("Firebase.authWithOAuthPopup",2,3,arguments.length);eg("Firebase.authWithOAuthPopup",e);A("Firebase.authWithOAuthPopup",2,t,!1);fg("Firebase.authWithOAuthPopup",3,r,!0);Vg(this.k.N,e,r,t)};U.prototype.authWithOAuthPopup=U.prototype.Yf;U.prototype.Zf=function(e,t,r){x("Firebase.authWithOAuthRedirect",2,3,arguments.length);eg("Firebase.authWithOAuthRedirect",e);A("Firebase.authWithOAuthRedirect",2,t,!1);fg("Firebase.authWithOAuthRedirect",3,r,!0);var n=this.k.N;Tg(n);var i=[Cg],o=ng(r);"anonymous"===e||"firebase"===e?R(t,Eg("TRANSPORT_UNAVAILABLE")):(P.set("redirect_client_options",o.od),Ug(n,i,"/auth/"+e,o,t))};U.prototype.authWithOAuthRedirect=U.prototype.Zf;U.prototype.$f=function(e,t,r,n){x("Firebase.authWithOAuthToken",3,4,arguments.length);eg("Firebase.authWithOAuthToken",e);A("Firebase.authWithOAuthToken",3,r,!1);fg("Firebase.authWithOAuthToken",4,n,!0);p(t)?(dg("Firebase.authWithOAuthToken",2,t),Sg(this.k.N,e+"/token",{access_token:t},n,r)):(fg("Firebase.authWithOAuthToken",2,t,!1),Sg(this.k.N,e+"/token",t,n,r))};U.prototype.authWithOAuthToken=U.prototype.$f;U.prototype.Wf=function(e,t){x("Firebase.authAnonymously",1,2,arguments.length);A("Firebase.authAnonymously",1,e,!1);fg("Firebase.authAnonymously",2,t,!0);Sg(this.k.N,"anonymous",{},t,e)};U.prototype.authAnonymously=U.prototype.Wf;U.prototype.ag=function(e,t,r){x("Firebase.authWithPassword",2,3,arguments.length);fg("Firebase.authWithPassword",1,e,!1);gg("Firebase.authWithPassword",e,"email");gg("Firebase.authWithPassword",e,"password");A("Firebase.authWithPassword",2,t,!1);fg("Firebase.authWithPassword",3,r,!0);Sg(this.k.N,"password",e,r,t)};U.prototype.authWithPassword=U.prototype.ag;U.prototype.te=function(e,t){x("Firebase.createUser",2,2,arguments.length);fg("Firebase.createUser",1,e,!1);gg("Firebase.createUser",e,"email");gg("Firebase.createUser",e,"password");A("Firebase.createUser",2,t,!1);this.k.N.te(e,t)};U.prototype.createUser=U.prototype.te;U.prototype.Ue=function(e,t){x("Firebase.removeUser",2,2,arguments.length);fg("Firebase.removeUser",1,e,!1);gg("Firebase.removeUser",e,"email");gg("Firebase.removeUser",e,"password");A("Firebase.removeUser",2,t,!1);this.k.N.Ue(e,t)};U.prototype.removeUser=U.prototype.Ue;U.prototype.qe=function(e,t){x("Firebase.changePassword",2,2,arguments.length);fg("Firebase.changePassword",1,e,!1);gg("Firebase.changePassword",e,"email");gg("Firebase.changePassword",e,"oldPassword");gg("Firebase.changePassword",e,"newPassword");A("Firebase.changePassword",2,t,!1);this.k.N.qe(e,t)};U.prototype.changePassword=U.prototype.qe;U.prototype.pe=function(e,t){x("Firebase.changeEmail",2,2,arguments.length);fg("Firebase.changeEmail",1,e,!1);gg("Firebase.changeEmail",e,"oldEmail");gg("Firebase.changeEmail",e,"newEmail");gg("Firebase.changeEmail",e,"password");A("Firebase.changeEmail",2,t,!1);this.k.N.pe(e,t)};U.prototype.changeEmail=U.prototype.pe;U.prototype.We=function(e,t){x("Firebase.resetPassword",2,2,arguments.length);fg("Firebase.resetPassword",1,e,!1);gg("Firebase.resetPassword",e,"email");A("Firebase.resetPassword",2,t,!1);this.k.N.We(e,t)};U.prototype.resetPassword=U.prototype.We})();(function(){if(!window.altspace){window.altspace={};window.altspace.inClient=false}if(!window.altspace.utilities){window.altspace.utilities={}}if(!window.THREE){window.THREE=THREE}})();altspace.utilities.sync=function(){var e=window.Firebase;var t=altspace&&altspace.inClient;var r=o();var n;function i(e){return e?encodeURIComponent(e).replace(/\./g,"%2E").replace(/%[A-Z0-9]{2}/g,"-"):null}function o(){var e=document.querySelector("link[rel=canonical]");return e?e.href:window.location.href}function a(e){console.warn("altspace.utilities.sync.getInstance has been deprecated, please use connect instead.");return s(e)}function s(t){var r=o();var i=new Url;t=t||{};var a=t.instanceId||i.query["altspace-sync-instance"];var s=c(t.appId,t.authorId,r);var u=new e("https://altspace-apps.firebaseio.com/apps/examples/").child(s);u.child("lastUrl").set(r);var l;if(a){l=u.child("instances").child(a)}else{l=u.child("instances").push();a=l.key();i.query["altspace-sync-instance"]=a;window.location.href=i.toString()}n=l;return l}function c(e,t,r){return i(t||r)+":"+i(e||"")}function u(e){console.warn("altspace.utilities.sync.authenticate has been depreciated, please use connect instead.");
var t=n||a(params);t.authAnonymously(function(t,r){if(t){console.error("Authetication Failed!",t)}else{e(r)}},{remember:"sessionOnly"})}function l(e){return new Promise(function(t,r){e.authAnonymously(function(e,n){if(e){console.error("Authetication Failed!",e);r(e)}else{t(n)}},{remember:"sessionOnly"})})}function h(n){n=n||{};var o=new Url;var a=n.baseRefUrl||"https://altspace-apps.firebaseio.com/apps/examples/";var s=new e(a);var u=n.instanceId||o.query["altspace-sync-instance"];var l=n.spaceId||o.query["altspace-sync-space"];var h=n.userId||o.query["altspace-sync-user"];if(!n.appId||!n.authorId){throw new Error("Both the appId and authorId must be provided to connect.")}var f=[];if(t){if(!l)f.unshift(altspace.getSpace());if(!h)f.unshift(altspace.getUser())}function p(){var e={};var t=c(n.appId,n.authorId,r);e.app=s.child(t).child("app");e.space=l?e.app.child("spaces").child(l):null;e.user=h?e.app.child("users").child(h):null;var i=e.app.child("instances");if(u){e.instance=i.child(u)}else{e.instance=i.push();u=e.instance.key()}return e}function d(){if(!o.query["altspace-sync-instance"]){o.query["altspace-sync-instance"]=u;window.location.href=o.toString()}}return Promise.all(f).then(function(e){if(t){if(!l)l=e.pop().sid;if(!h)h=e.pop().userId}l=i(l);h=i(h);u=i(u);var r=p();d();return r})}return{connect:h,getInstance:a,authenticate:u}}();altspace.utilities.codePen=function(){var e={};var t=window.Please;var r=window.Url;var n="VR CodePen";var i=window.name&&window.name.slice(0,4)==="pen-";var o=!!window.altspace.inClient;var a=!!location.href.match("codepen.io/");function s(){console.log("In a tile: "+i);console.log("In VR: "+o)}function c(){if(i||!o){var e=document.createElement("style");e.type="text/css";e.innerHTML="@import url(https://fonts.googleapis.com/css?family=Open+Sans:800);.altspace-info{text-align:center;font-family:'Open Sans',sans-serif;line-height:.5}.altspace-vr-notice{color:rgba(0,0,0,.7);font-size:5vw}.altspace-pen-name{font-size:7vw}";document.head.appendChild(e);document.body.style.background=t.make_color({seed:h()});var r=document.createElement("div");r.className="altspace-info";document.body.appendChild(r);var a=document.createElement("span");a.className="altspace-pen-name";a.innerHTML="<p>"+n.toUpperCase()+"</p>";r.appendChild(a);if(i){var s="VR mode does not support preview tiles. Stopping code execution.";console.log("ERROR: "+s);throw new Error(s)}if(!o){var c=document.createElement("span");c.className="altspace-vr-notice";c.innerHTML="<p>View</p>";r.insertBefore(c,a);var u=document.createElement("span");u.className="altspace-vr-notice";u.innerHTML='<p>in <a href="http://altvr.com"> AltspaceVR </a></p>';r.appendChild(u);var s="Not in VR mode. Stopping code execution.";if(i){console.log("ERROR: "+s)}throw new Error(s)}return}}function u(e){n=e}function l(){var e=document.querySelector("link[rel=canonical]");var t=e?e.href:window.location.href;return new r(t)}function h(){var e=l();var t=e.path.split("/");var r=t[t.length-1];return r}function f(){var e=l();var t=e.path.split("/");var r=t[1]=="team";var n=r?"team-"+t[2]:t[1];return n}return{inTile:i,inVR:o,inCodePen:a,ensureInVR:c,setName:u,getPenId:h,getAuthorId:f,printDebugInfo:s}}();window.altspace=window.altspace||{};window.altspace.utilities=window.altspace.utilities||{};altspace.utilities.Simulation=function(e){e=e||{};if(e.auto===undefined)e.auto=true;var t={};var r=new THREE.Scene;var n;var i;a();function o(){window.requestAnimationFrame(o);if(r.updateAllBehaviors)r.updateAllBehaviors();n.render(r,i)}function a(){function e(){n=altspace.getThreeJSRenderer();i=new THREE.PerspectiveCamera}function t(){n=new THREE.WebGLRenderer({antialias:true});i=new THREE.PerspectiveCamera;i.position.z=500;var e=function(){i.aspect=window.innerWidth/window.innerHeight;i.updateProjectionMatrix();n.setSize(window.innerWidth,window.innerHeight)};document.addEventListener("DOMContentLoaded",function(e){document.body.style.margin="0px";document.body.style.overflow="hidden";n.setClearColor("#035F72");var t=document.createElement("div");document.body.appendChild(t);t.appendChild(n.domElement)});window.addEventListener("resize",e);e();i.fov=45;i.near=1;i.far=2e3;r.add(i);r.add(new THREE.AmbientLight("white"));var t=altspace&&altspace.utilities&&altspace.utilities.shims&&altspace.utilities.shims.cursor;if(t)altspace.utilities.shims.cursor.init(r,i)}if(altspace&&altspace.inClient){e()}else{t()}}if(e.auto)window.requestAnimationFrame(o);Object.defineProperty(t,"scene",{get:function(){return r}});Object.defineProperty(t,"renderer",{get:function(){return n}});Object.defineProperty(t,"camera",{get:function(){return i},set:function(e){i=e}});return t};window.altspace=window.altspace||{};window.altspace.utilities=window.altspace.utilities||{};altspace.utilities.multiloader=function(){var e;var t;var r="";var n="";function i(){var e=[];var t=[];var r=[];var n;var i=0;return{objUrls:e,mtlUrls:t,objects:r,error:n,objectsLoaded:i}}function o(i){var o=i||{};t=o.TRACE||false;if(o.crossOrigin)n=o.crossOrigin;if(o.baseUrl)r=o.baseUrl;if(r.slice(-1)!=="/")r+="/";e=new altspace.utilities.shims.OBJMTLLoader;e.crossOrigin=n;if(t)console.log("MultiLoader initialized with params",i)}function a(n,o){var a=n;var c=Date.now();if(!a||!a instanceof i){throw new Error("MultiLoader.load expects first arg of type LoadRequest")}if(!o||typeof o!=="function"){throw new Error("MultiLoader.load expects second arg of type function")}if(!a.objUrls||!a.mtlUrls||a.objUrls.length!==a.mtlUrls.length){throw new Error("MultiLoader.load called with bad LoadRequest")}var u=a.objUrls.length;if(t)console.log("Loading models...");for(var l=0;l<u;l++){var h=function(n,i){var a=r+n.objUrls[i];var l=r+n.mtlUrls[i];if(t)console.log("Loading obj:"+a+", mtl:"+l);e.load(a,l,function(e){n.objects[i]=e;n.objectsLoaded++;if(n.objectsLoaded===u){var r=((Date.now()-c)/1e3).toFixed(2);if(t)console.log("Loaded "+u+" models in "+r+" seconds");o()}},s,function(){var e=xhr.target.responseURL||"";n.error="Error loading file "+e})};h(a,l)}}function s(e){if(e.lengthComputable&&e.target.responseURL){var r=e.loaded/e.total*100;var n=e.target.responseURL.split("/").pop();if(t)console.log("..."+n+" "+Math.round(r,2)+"% downloaded")}}return{init:o,load:a,LoadRequest:i}}();THREE.Scene.prototype.updateAllBehaviors=function(){var e=performance.now();var t=this.__lastNow||e;var r=e-t;var n=this;var i=[];this.traverse(function(e){if(e.__behaviorList){i.push(e)}});for(var o=0,a=i.length;o<a;o++){object3d=i[o];object3d.updateBehaviors(r,n)}this.__lastNow=e};THREE.Object3D.prototype.addBehavior=function(){this.__behaviorList=this.__behaviorList||[];Array.prototype.push.apply(this.__behaviorList,arguments)};THREE.Object3D.prototype.addBehaviors=function(){this.__behaviorList=this.__behaviorList||[];Array.prototype.push.apply(this.__behaviorList,arguments)};THREE.Object3D.prototype.removeBehavior=function(e){var t=this.__behaviorList.indexOf(e);if(t!==-1){this.__behaviorList.splice(t,1);try{if(e.dispose)e.dispose.call(e,this)}catch(t){console.group();(console.error||console.log).call(console,t.stack||t);console.log("[Behavior]");console.log(e);console.log("[Object3D]");console.log(this);console.groupEnd()}}};THREE.Object3D.prototype.removeAllBehaviors=function(){if(!this.__behaviorList||this.__behaviorList.length===0)return null;for(var e=0,t=this.__behaviorList.length;e<t;e++){var r=this.__behaviorList[e];try{if(r.dispose)r.dispose.call(r,this)}catch(e){console.group();(console.error||console.log).call(console,e.stack||e);console.log("[Behavior]");console.log(r);console.log("[Object3D]");console.log(this);console.groupEnd()}}};THREE.Object3D.prototype.getBehaviorByType=function(e){if(!this.__behaviorList||this.__behaviorList.length===0)return null;for(var t=0,r=this.__behaviorList.length;t<r;t++){if(this.__behaviorList[t].type===e)return this.__behaviorList[t]}};THREE.Object3D.prototype.updateBehaviors=function(e,t){if(!this.__behaviorList||this.__behaviorList.length===0)return;var r=[];var n=this.__behaviorList.slice();for(var i=0,o=this.__behaviorList.length;i<o;i++){var a=this.__behaviorList[i];if(!a.__isInitialized)r.push(a)}for(var i=0,o=r.length;i<o;i++){var a=r[i];try{if(a.awake)a.awake.call(a,this,t)}catch(e){console.group();(console.error||console.log).call(console,e.stack||e);console.log("[Behavior]");console.log(a);console.log("[Object3D]");console.log(this);console.groupEnd()}}for(var i=0,o=r.length;i<o;i++){var a=r[i];try{if(a.start)a.start.call(a)}catch(e){console.group();(console.error||console.log).call(console,e.stack||e);console.log("[Behavior]");console.log(a);console.log("[Object3D]");console.log(this);console.groupEnd()}a.__isInitialized=true}for(var i=0,o=n.length;i<o;i++){var a=n[i];try{if(a.update)a.update.call(a,e)}catch(e){console.group();(console.error||console.log).call(console,e.stack||e);console.log("[Behavior]");console.log(a);console.log("[Object3D]");console.log(this);console.groupEnd()}}};altspace=window.altspace||{};altspace.utilities=altspace.utilities||{};altspace.utilities.shims=altspace.utilities.shims||{};altspace.utilities.shims.cursor=function(){var e;var t;var r;var n;var i=new THREE.Raycaster;function o(n,i,o){if(!n||!n instanceof THREE.Scene){throw new TypeError("Requires THREE.Scene argument")}if(!i||!i instanceof THREE.Camera){throw new TypeError("Requires THREE.Camera argument")}e=n;t=i;p=o||{};r=p.renderer&&p.renderer.domElement||window;r.addEventListener("mousedown",a,false);r.addEventListener("mouseup",s,false);r.addEventListener("mousemove",c,false)}function a(e){var t=l(e);if(!t||!t.point)return;var r=u("cursordown",t);t.object.dispatchEvent(r)}function s(t){var r=l(t);var n=u("cursorup",r);if(r){r.object.dispatchEvent(n)}else{e.dispatchEvent(n)}}function c(t){var r=l(t);var i=u("cursormove",r);e.dispatchEvent(i);var o=r?r.object:null;if(n!=o){if(n){i=u("cursorleave",r);n.dispatchEvent(i)}if(o){i=u("cursorenter",r);o.dispatchEvent(i)}n=o}}function u(e,t){return{type:e,bubbles:true,target:t?t.object:null,ray:{origin:i.ray.origin.clone(),direction:i.ray.direction.clone()},point:t?t.point.clone():null}}function l(n){var o=new THREE.Vector2;o.x=n.offsetX/(r.width||r.innerWidth)*2-1;o.y=-(n.offsetY/(r.height||r.innerHeight))*2+1;i.setFromCamera(o,t);var a=i.intersectObjects(e.children,true);return a.length>0?a[0]:null}return{init:o}}();(function(){if(!THREE)return;if(window.altspace&&window.altspace.inAltspace)return;THREE.EventDispatcher.prototype.dispatchEvent=e;THREE.Object3D.prototype.dispatchEvent=e;function e(t){var r;var n;if(t.bubbles){t.currentTarget=this;t.stopPropagation=function(){r=true};t.stopImmediatePropagation=function(){n=true}}if(this._listeners){var i=this._listeners;var o=i[t.type];if(o){t.target=t.target||this;var a=[];var s=o.length;for(var c=0;c<s;c++){a[c]=o[c]}for(var c=0;c<s;c++){a[c].call(this,t);if(n)return}}}if(t.bubbles&&this.parent&&this.parent.dispatchEvent&&!r){e.call(this.parent,t)}}})();window.altspace=window.altspace||{};window.altspace.utilities=window.altspace.utilities||{};window.altspace.utilities.behaviors=window.altspace.utilities.behaviors||{};altspace.utilities.behaviors.Bob=function(e){var t;e=e||{};if(e.shouldRotate===undefined)e.shouldRotate=true;if(e.shouldMove===undefined)e.shouldMove=true;var r;var n=new THREE.Vector3;var i=Math.random()*1e4;function o(e){t=e;r=t.position.clone()}function a(o){var a=Math.floor(performance.now())+i;if(e.shouldMove){if(!n.equals(t.position))r.copy(t.position);t.position.y=r.y+Math.sin(a/800)*3;t.position.x=r.x+Math.sin(a/500)*5;n.copy(t.position)}if(e.shouldRotate){t.rotation.x=Math.sin(a/500)/15}}return{awake:o,update:a}};window.altspace=window.altspace||{};window.altspace.utilities=window.altspace.utilities||{};window.altspace.utilities.behaviors=window.altspace.utilities.behaviors||{};altspace.utilities.behaviors.ButtonStateStyle=function(e){var t;var r;var n;var i=new THREE.Color;e=e||{};var o=e.overBrightness||1.5;var a=e.downBrightness||.5;function s(e){i.set(n);i.multiplyScalar(e);i.r=THREE.Math.clamp(i.r,0,1);i.g=THREE.Math.clamp(i.g,0,1);i.b=THREE.Math.clamp(i.b,0,1);t.material.color=i}function c(){t.removeEventListener("cursorleave",c);s(1)}function u(){s(o);t.addEventListener("cursorleave",c)}function l(e){r.removeEventListener("cursorup",l);t.addEventListener("cursorenter",u);if(e.target===t){s(o);t.addEventListener("cursorleave",c)}else{s(1)}}function h(){r.addEventListener("cursorup",l);t.removeEventListener("cursorleave",c);t.removeEventListener("cursorenter",u);s(a)}function f(i,o){t=i;r=o;n=e.originalColor||t.material.color;t.addEventListener("cursorenter",u);t.addEventListener("cursordown",h)}function p(){t.removeEventListener("cursorenter",u);t.removeEventListener("cursorleave",c);t.removeEventListener("cursorup",l);t.removeEventListener("cursordown",h)}return{awake:f,dispose:p,type:"ButtonStateStyle"}};window.altspace=window.altspace||{};window.altspace.utilities=window.altspace.utilities||{};window.altspace.utilities.behaviors=window.altspace.utilities.behaviors||{};altspace.utilities.behaviors.Drag=function(e){e=e||{};if(e.space===undefined)e.space="world";if(e.x===undefined)e.x=false;if(e.y===undefined)e.y=false;if(e.z===undefined)e.z=false;if(e.cursorSnap===undefined)e.cursorSnap=true;var t=!!e.x;var r=!!e.y;var n=!!e.z;var i=new THREE.Vector3(e.x.min!==undefined?e.x.min:Number.NEGATIVE_INFINITY,e.y.min!==undefined?e.y.min:Number.NEGATIVE_INFINITY,e.z.min!==undefined?e.z.min:Number.NEGATIVE_INFINITY);var o=new THREE.Vector3(e.x.max!==undefined?e.x.max:Number.POSITIVE_INFINITY,e.y.max!==undefined?e.y.max:Number.POSITIVE_INFINITY,e.z.max!==undefined?e.z.max:Number.POSITIVE_INFINITY);var a;var s;var c;var u;var l=new THREE.Vector3;var h=new THREE.Raycaster;h.linePrecision=3;function f(e,t){a=e;s=t;c=a.getBehaviorByType("Object3DSync");p();s.add(u)}function p(){var e=1e4;var i=new THREE.PlaneGeometry(e,e);function o(){i.rotateY(Math.PI)}function a(){i.rotateX(Math.PI/2)}function s(){i.rotateY(Math.PI/2)}function c(){throw new Error("Not implemented")}var l=t+r+n;if(l===3){throw new Error("Arbitrary dragging currently unsupported. Please lock at least one axis.")}else if(l===2){if(t&&r){o()}else if(t&&n){a()}else if(r&&n){s()}}else if(l===1){throw new Error("Single axis dragging currently unsupported.")}else{throw new Error("Invalid axis configuration")}var h=new THREE.MeshBasicMaterial({color:"purple"});h.side=THREE.DoubleSide;u=new THREE.Mesh(i,h);u.visible=false;u.material.visible=false}function d(e){e.updateMatrixWorld();var t=new THREE.Vector3;t.setFromMatrixPosition(e.matrixWorld);return t}function m(e){function t(e){return Math.floor(e*100)/100}return"x: "+t(e.x)+", y: "+t(e.y)+", z: "+t(e.z)}function E(e){s.addEventListener("cursorup",v);s.addEventListener("cursormove",g);h.set(e.ray.origin,e.ray.direction);var t=h.intersectObject(a,true)[0];if(!t)return;var r=t.point.clone();var n=d(a).clone();l.copy(r).sub(n);u.position.copy(r);u.updateMatrixWorld()}function g(t){if(c&&!c.isMine)c.takeOwnership();u.visible=true;h.set(t.ray.origin,t.ray.direction);var r=h.intersectObject(u,true)[0];u.visible=false;if(!r)return;var n=new THREE.Vector3;n.copy(r.point).sub(l);n.y=d(a).y;n.clamp(i,o);a.parent.updateMatrixWorld();var s=a.parent.worldToLocal(n);a.position.set(e.x?s.x:a.position.x,e.y?s.y:a.position.y,e.z?s.z:a.position.z)}function v(){s.removeEventListener("cursorup",v);s.removeEventListener("cursormove",g)}function y(){a.addEventListener("cursordown",E)}return{awake:f,start:y}};window.altspace=window.altspace||{};window.altspace.utilities=window.altspace.utilities||{};window.altspace.utilities.behaviors=window.altspace.utilities.behaviors||{};altspace.utilities.behaviors.GamepadControls=function(e){var t;var r;var n;var i;var o=false;var a=false;var s=false;var c=false;var u=false;var l;var h=.2;e=e||{};if(e.position===undefined)e.position=true;if(e.rotation===undefined)e.rotation=true;if(e.scale===undefined)e.scale=true;function f(e,o){t=e;n=o;i=t.getBehaviorByType("Object3DSync");l=t.clone();r=p();if(r){console.log("Gamepad detected: "+r.id)}else{var a=setInterval(function(){r=p();if(r){console.log("Gamepad connected: "+r.id);clearInterval(a)}},500)}n.addEventListener("cursordown",function(e){if(r&&!u){d(r);u=true}})}function p(){if(altspace&&altspace.inClient){gamepads=altspace.getGamepads()}else{gamepads=navigator.getGamepads()}if(gamepads.length>0){for(var e=0;e<gamepads.length;e++){var t=gamepads[e];if(t&&t.axes&&t.axes.length===4&&t.buttons&&t.buttons.length===16){if(altspace&&altspace.inClient)d(t);return t}}}return undefined}function d(t){var r=[];var n=[];for(var i=0;i>t.buttons;i++)n[i]=false;for(var i=0;i>t.axes;i++)r[i]=false;if(e.position){r[0]=true;r[1]=true;n[10]=true}if(e.rotation){r[2]=true;r[3]=true;n[11]=true}if(e.scale){n[12]=true;n[13]=true}n[8]=true;t.preventDefault(r,n)}function m(n){if((!altspace||!altspace.inClient)&&window.chrome&&r){r=p()}if(!r)return;var u=r.buttons[8].pressed;if(u){if(!i.isMine)i.takeOwnership();t.position.copy(l.position);t.rotation.copy(l.rotation);t.scale.copy(l.scale);return}if(e.position){var f=r.buttons[10].pressed;if(c&&!f)a=!a;c=f;var d=r.axes[0];var m=r.axes[1];var E=Math.abs(d)>h||Math.abs(m)>h;if(E&&!i.isMine)i.takeOwnership();var g=200*(n/1e3);if(!a&&Math.abs(d)>h){t.position.x+=g*d}if(!a&&Math.abs(m)>h){t.position.z+=g*m}if(a&&Math.abs(d)>h){t.position.x+=g*d}if(a&&Math.abs(m)>h){t.position.y+=g*-m}}if(e.rotation){var v=r.buttons[11].pressed;if(s&&!v)o=!o;s=v;var y=r.axes[2];var b=r.axes[3];var T=Math.abs(y)>h||Math.abs(b)>h;if(T&&!i.isMine)i.takeOwnership();var R=Math.PI*(n/1e3);if(!o&&Math.abs(y)>h){t.rotation.y+=R*y}if(!o&&Math.abs(b)>h){t.rotation.x+=R*b}if(o&&Math.abs(y)>h){t.rotation.z+=R*-y}}if(e.scale){var w=10*(n/1e3);var x=r.buttons[12].pressed;var H=r.buttons[13].pressed;var _=r.buttons[12].pressed||r.buttons[13].pressed;if(_&&!i.isMine)i.takeOwnership();var S=t.scale;var M=new THREE.Vector3(1,1,1);M.multiplyScalar(w);if(x)t.scale.add(M);if(H){if(S.x>M.x&&S.y>M.y&&S.z>M.z){t.scale.sub(M)}}}}return{awake:f,update:m}};window.altspace=window.altspace||{};window.altspace.utilities=window.altspace.utilities||{};window.altspace.utilities.behaviors=window.altspace.utilities.behaviors||{};altspace.utilities.behaviors.HoverColor=function(e){e=e||{};if(e.event===undefined)e.event="cursorenter";if(e.event!=="cursorenter"&&e.event!=="cursordown"){throw Error('Expected config.event "cursorenter" or "cursordown"')}if(e.color===undefined)e.color=new THREE.Color("yellow");var t;var r;var n;var i;function o(r,n){t=r;i=n;t.addEventListener("cursordown",a);i.addEventListener("cursorup",u);if(e.event==="cursorenter"){t.addEventListener("cursorenter",s);t.addEventListener("cursorleave",c)}}function a(n){r=t;if(e.event==="cursordown"){l(r)}}function s(e){if(r&&r!==t){return}if(n){unsetcolor(n)}n=t;l(t)}function c(e){if(n===t){n=null;h(t)}}function u(t){if(e.event==="cursordown"&&r){h(r)}r=null}function l(t){if(t.material&&t.material.color){t.userData.origColor=t.material.color;t.material.color=e.color;if(t.material)t.material.needsUpdate=true}for(var r=0;r<t.children.length;r++){l(t.children[r],e.color)}}function h(e){if(e.material&&e.material.color){if(!e.userData.origColor){console.error("Cannot unsetColor, no userData.origColor for object",e);return}e.material.color=e.userData.origColor;if(e.material)e.material.needsUpdate=true}for(var t=0;t<e.children.length;t++){h(e.children[t])}}return{awake:o}};window.altspace=window.altspace||{};window.altspace.utilities=window.altspace.utilities||{};window.altspace.utilities.behaviors=window.altspace.utilities.behaviors||{};window.altspace.utilities.behaviors.SceneSync=function(e,t){var r=e.child("scene");var n=e.child("clients");t=t||{};var i=t.instantiators||{};var o=t.destroyers||{};var a=100;var s=[];var c={};var u={};var l;var h;function f(){for(var e=0,t=s.length;e<t;e++){s[e].autoSend()}}function p(i,o){setInterval(f,a);var s=o;l=s.uuid;n.on("value",function(e){var t=e.val();if(!t)return;masterClientKey=Object.keys(t)[0];h=t[masterClientKey]});n.push(l).onDisconnect().remove();e.child("initialized").once("value",function(e){var r=!e.val();e.ref().set(true);if(t.ready){t.ready(r)}});r.on("child_added",m.bind(this));r.on("child_removed",g.bind(this))}function d(e,t,n){t=t||{};var i=r.push({syncType:e,initData:t},function(e){if(e)throw Error("Failed to save to Firebase",e)});if(n){i.onDisconnect().remove()}var o=c[i.key()];o.getBehaviorByType("Object3DSync").takeOwnership();return o}function m(e){var t=e.val();var r=e.key();var n=i[t.syncType];if(!n){console.warn("No instantiator found for syncType: "+t.syncType);return}var o=n(t.initData,t.syncType);if(!o){console.error(t.syncType+".create must return an Object3D");return}c[r]=o;u[o.uuid]=r;var a=o.getBehaviorByType("Object3DSync");if(!a){console.error(t.syncType+" instantiator must return an Object3D with an Object3DSync behavior");return}s.push(a);a.link(e.ref(),this)}function E(e){var t=u[e.uuid];if(!t){console.warn("Failed to find key for object3d to be destroyed",e);return}r.child(t).remove(function(e){if(e)console.warn("Failed to remove from Firebase",e)});r.child(t).off()}function g(e){var t=e.val();var r=e.key();var n=c[r];if(!n){console.warn("Failed to find object matching deleted key",r);return}var i=t.syncType;if(!i){console.warn("No syncType found for object being destroyed",n);return}function a(e){e.removeAllBehaviors();if(e.parent){e.parent.remove(e)}if(e.geometry){e.geometry.dispose()}if(e.material){if(e.material.map){e.material.map.dispose()}e.material.dispose()}}var s=o[i];var l=!s;if(s){l=s(n)}if(l)a(n);delete c[r];delete u[n.uuid]}var v={awake:p,instantiate:d,destroy:E,type:"SceneSync"};Object.defineProperty(v,"autoSendRateMS",{get:function(){return a}});Object.defineProperty(v,"isMasterClient",{get:function(){return h===l}});Object.defineProperty(v,"clientId",{get:function(){return l}});Object.defineProperty(v,"clientsRef",{get:function(){return n}});return v};window.altspace=window.altspace||{};window.altspace.utilities=window.altspace.utilities||{};window.altspace.utilities.behaviors=window.altspace.utilities.behaviors||{};altspace.utilities.behaviors.Spin=function(e){e=e||{};if(e.speed===undefined)e.speed=1e-4;var t;function r(e){t=e}function n(r){t.rotation.y+=e.speed*r}return{awake:r,update:n}};window.altspace=window.altspace||{};window.altspace.utilities=window.altspace.utilities||{};window.altspace.utilities.behaviors=window.altspace.utilities.behaviors||{};altspace.utilities.behaviors.TouchpadRotate=function(e){e=e||{};var t;var r;var n;var i=false;function o(e,n){t=e;r=n;altspace.addEventListener("touchpadup",a);altspace.addEventListener("touchpaddown",s);altspace.addEventListener("touchpadmove",h)}function a(e){i=false}function s(e){i=true;n=t.rotation.clone()}var c=0;var u=5;var l=0;function h(e){var r=e.displacementX-c;t.rotation.set(n.x,n.y+e.displacementX/300,n.z);l=(l*u+r/300)/(u+1);c=e.displacementX}function f(e){if(!i&&Math.abs(l)>.01){t.rotation.y+=l;l*=.97}}function p(){}return{awake:o,start:p,update:f}};(function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){var c=typeof require=="function"&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};t[a][0].call(l.exports,function(e){var r=t[a][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[a].exports}var o=typeof require=="function"&&require;for(var a=0;a<n.length;a++)i(n[a]);return i})({1:[function(e,t,r){(function(t){"use strict";e("core-js/shim");e("regenerator/runtime");if(t._babelPolyfill){throw new Error("only one instance of babel/polyfill is allowed")}t._babelPolyfill=true}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"core-js/shim":256,"regenerator/runtime":258}],2:[function(e,t,r){t.exports=e("./lib/polyfill")},{"./lib/polyfill":1}],3:[function(e,t,r){t.exports={default:e("core-js/library/fn/array/from"),__esModule:true}},{"core-js/library/fn/array/from":10}],4:[function(e,t,r){t.exports={default:e("core-js/library/fn/map"),__esModule:true}},{"core-js/library/fn/map":11}],5:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/define-property"),__esModule:true}},{"core-js/library/fn/object/define-property":12}],6:[function(e,t,r){t.exports={default:e("core-js/library/fn/symbol"),__esModule:true}},{"core-js/library/fn/symbol":13}],7:[function(e,t,r){"use strict";r["default"]=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};r.__esModule=true},{}],8:[function(e,t,r){"use strict";var n=e("babel-runtime/core-js/object/define-property")["default"];r["default"]=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;n(e,i.key,i)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();r.__esModule=true},{"babel-runtime/core-js/object/define-property":5}],9:[function(e,t,r){t.exports=e("babel-core/polyfill")},{"babel-core/polyfill":2}],10:[function(e,t,r){e("../../modules/es6.string.iterator");e("../../modules/es6.array.from");t.exports=e("../../modules/$.core").Array.from},{"../../modules/$.core":22,"../../modules/es6.array.from":62,"../../modules/es6.string.iterator":66}],11:[function(e,t,r){e("../modules/es6.object.to-string");e("../modules/es6.string.iterator");e("../modules/web.dom.iterable");e("../modules/es6.map");e("../modules/es7.map.to-json");t.exports=e("../modules/$.core").Map},{"../modules/$.core":22,"../modules/es6.map":64,"../modules/es6.object.to-string":65,"../modules/es6.string.iterator":66,"../modules/es7.map.to-json":68,"../modules/web.dom.iterable":69}],12:[function(e,t,r){var n=e("../../modules/$");t.exports=function e(t,r,i){return n.setDesc(t,r,i)}},{"../../modules/$":44}],13:[function(e,t,r){e("../../modules/es6.symbol");e("../../modules/es6.object.to-string");t.exports=e("../../modules/$.core").Symbol},{"../../modules/$.core":22,"../../modules/es6.object.to-string":65,"../../modules/es6.symbol":67}],14:[function(e,t,r){t.exports=function(e){if(typeof e!="function")throw TypeError(e+" is not a function!");return e}},{}],15:[function(e,t,r){t.exports=function(){}},{}],16:[function(e,t,r){var n=e("./$.is-object");t.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},{"./$.is-object":37}],17:[function(e,t,r){var n=e("./$.cof"),i=e("./$.wks")("toStringTag"),o=n(function(){return arguments}())=="Arguments";t.exports=function(e){var t,r,a;return e===undefined?"Undefined":e===null?"Null":typeof(r=(t=Object(e))[i])=="string"?r:o?n(t):(a=n(t))=="Object"&&typeof t.callee=="function"?"Arguments":a}},{"./$.cof":18,"./$.wks":60}],18:[function(e,t,r){var n={}.toString;t.exports=function(e){return n.call(e).slice(8,-1)}},{}],19:[function(e,t,r){"use strict";var n=e("./$"),i=e("./$.hide"),o=e("./$.redefine-all"),a=e("./$.ctx"),s=e("./$.strict-new"),c=e("./$.defined"),u=e("./$.for-of"),l=e("./$.iter-define"),h=e("./$.iter-step"),f=e("./$.uid")("id"),p=e("./$.has"),d=e("./$.is-object"),m=e("./$.set-species"),E=e("./$.descriptors"),g=Object.isExtensible||d,v=E?"_s":"size",y=0;var b=function(e,t){if(!d(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!p(e,f)){if(!g(e))return"F";if(!t)return"E";i(e,f,++y)}return"O"+e[f]};var T=function(e,t){var r=b(t),n;if(r!=="F")return e._i[r];for(n=e._f;n;n=n.n){if(n.k==t)return n}};t.exports={getConstructor:function(e,t,r,i){var l=e(function(e,o){s(e,l,t);e._i=n.create(null);e._f=undefined;e._l=undefined;e[v]=0;if(o!=undefined)u(o,r,e[i],e)});o(l.prototype,{clear:function e(){for(var t=this,r=t._i,n=t._f;n;n=n.n){n.r=true;if(n.p)n.p=n.p.n=undefined;delete r[n.i]}t._f=t._l=undefined;t[v]=0},delete:function(e){var t=this,r=T(t,e);if(r){var n=r.n,i=r.p;delete t._i[r.i];r.r=true;if(i)i.n=n;if(n)n.p=i;if(t._f==r)t._f=n;if(t._l==r)t._l=i;t[v]--}return!!r},forEach:function e(t){var r=a(t,arguments.length>1?arguments[1]:undefined,3),n;while(n=n?n.n:this._f){r(n.v,n.k,this);while(n&&n.r)n=n.p}},has:function e(t){return!!T(this,t)}});if(E)n.setDesc(l.prototype,"size",{get:function(){return c(this[v])}});return l},def:function(e,t,r){var n=T(e,t),i,o;if(n){n.v=r}else{e._l=n={i:o=b(t,true),k:t,v:r,p:i=e._l,n:undefined,r:false};if(!e._f)e._f=n;if(i)i.n=n;e[v]++;if(o!=="F")e._i[o]=n}return e},getEntry:T,setStrong:function(e,t,r){l(e,t,function(e,t){this._t=e;this._k=t;this._l=undefined},function(){var e=this,t=e._k,r=e._l;while(r&&r.r)r=r.p;if(!e._t||!(e._l=r=r?r.n:e._t._f)){e._t=undefined;return h(1)}if(t=="keys")return h(0,r.k);if(t=="values")return h(0,r.v);return h(0,[r.k,r.v])},r?"entries":"values",!r,true);m(t)}}},{"./$":44,"./$.ctx":23,"./$.defined":24,"./$.descriptors":25,"./$.for-of":29,"./$.has":32,"./$.hide":33,"./$.is-object":37,"./$.iter-define":40,"./$.iter-step":42,"./$.redefine-all":48,"./$.set-species":50,"./$.strict-new":53,"./$.uid":59}],20:[function(e,t,r){var n=e("./$.for-of"),i=e("./$.classof");t.exports=function(e){return function t(){if(i(this)!=e)throw TypeError(e+"#toJSON isn't generic");var r=[];n(this,false,r.push,r);return r}}},{"./$.classof":17,"./$.for-of":29}],21:[function(e,t,r){"use strict";var n=e("./$"),i=e("./$.global"),o=e("./$.export"),a=e("./$.fails"),s=e("./$.hide"),c=e("./$.redefine-all"),u=e("./$.for-of"),l=e("./$.strict-new"),h=e("./$.is-object"),f=e("./$.set-to-string-tag"),p=e("./$.descriptors");t.exports=function(e,t,r,d,m,E){var g=i[e],v=g,y=m?"set":"add",b=v&&v.prototype,T={};if(!p||typeof v!="function"||!(E||b.forEach&&!a(function(){(new v).entries().next()}))){v=d.getConstructor(t,e,m,y);c(v.prototype,r)}else{v=t(function(t,r){l(t,v,e);t._c=new g;if(r!=undefined)u(r,m,t[y],t)});n.each.call("add,clear,delete,forEach,get,has,set,keys,values,entries".split(","),function(e){var t=e=="add"||e=="set";if(e in b&&!(E&&e=="clear"))s(v.prototype,e,function(r,n){if(!t&&E&&!h(r))return e=="get"?undefined:false;var i=this._c[e](r===0?0:r,n);return t?this:i})});if("size"in b)n.setDesc(v.prototype,"size",{get:function(){return this._c.size}})}f(v,e);T[e]=v;o(o.G+o.W+o.F,T);if(!E)d.setStrong(v,e,m);return v}},{"./$":44,"./$.descriptors":25,"./$.export":27,"./$.fails":28,"./$.for-of":29,"./$.global":31,"./$.hide":33,"./$.is-object":37,"./$.redefine-all":48,"./$.set-to-string-tag":51,"./$.strict-new":53}],22:[function(e,t,r){var n=t.exports={version:"1.2.6"};if(typeof __e=="number")__e=n},{}],23:[function(e,t,r){var n=e("./$.a-function");t.exports=function(e,t,r){n(e);if(t===undefined)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},{"./$.a-function":14}],24:[function(e,t,r){t.exports=function(e){if(e==undefined)throw TypeError("Can't call method on  "+e);return e}},{}],25:[function(e,t,r){t.exports=!e("./$.fails")(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},{"./$.fails":28}],26:[function(e,t,r){var n=e("./$");t.exports=function(e){var t=n.getKeys(e),r=n.getSymbols;if(r){var i=r(e),o=n.isEnum,a=0,s;while(i.length>a)if(o.call(e,s=i[a++]))t.push(s)}return t}},{"./$":44}],27:[function(e,t,r){var n=e("./$.global"),i=e("./$.core"),o=e("./$.ctx"),a="prototype";var s=function(e,t,r){var c=e&s.F,u=e&s.G,l=e&s.S,h=e&s.P,f=e&s.B,p=e&s.W,d=u?i:i[t]||(i[t]={}),m=u?n:l?n[t]:(n[t]||{})[a],E,g,v;if(u)r=t;for(E in r){g=!c&&m&&E in m;if(g&&E in d)continue;v=g?m[E]:r[E];d[E]=u&&typeof m[E]!="function"?r[E]:f&&g?o(v,n):p&&m[E]==v?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};t[a]=e[a];return t}(v):h&&typeof v=="function"?o(Function.call,v):v;if(h)(d[a]||(d[a]={}))[E]=v}};s.F=1;s.G=2;s.S=4;s.P=8;s.B=16;s.W=32;t.exports=s},{"./$.core":22,"./$.ctx":23,"./$.global":31}],28:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(e){return true}}},{}],29:[function(e,t,r){
var n=e("./$.ctx"),i=e("./$.iter-call"),o=e("./$.is-array-iter"),a=e("./$.an-object"),s=e("./$.to-length"),c=e("./core.get-iterator-method");t.exports=function(e,t,r,u){var l=c(e),h=n(r,u,t?2:1),f=0,p,d,m;if(typeof l!="function")throw TypeError(e+" is not iterable!");if(o(l))for(p=s(e.length);p>f;f++){t?h(a(d=e[f])[0],d[1]):h(e[f])}else for(m=l.call(e);!(d=m.next()).done;){i(m,h,d.value,t)}}},{"./$.an-object":16,"./$.ctx":23,"./$.is-array-iter":35,"./$.iter-call":38,"./$.to-length":57,"./core.get-iterator-method":61}],30:[function(e,t,r){var n=e("./$.to-iobject"),i=e("./$").getNames,o={}.toString;var a=typeof window=="object"&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var s=function(e){try{return i(e)}catch(e){return a.slice()}};t.exports.get=function e(t){if(a&&o.call(t)=="[object Window]")return s(t);return i(n(t))}},{"./$":44,"./$.to-iobject":56}],31:[function(e,t,r){var n=t.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();if(typeof __g=="number")__g=n},{}],32:[function(e,t,r){var n={}.hasOwnProperty;t.exports=function(e,t){return n.call(e,t)}},{}],33:[function(e,t,r){var n=e("./$"),i=e("./$.property-desc");t.exports=e("./$.descriptors")?function(e,t,r){return n.setDesc(e,t,i(1,r))}:function(e,t,r){e[t]=r;return e}},{"./$":44,"./$.descriptors":25,"./$.property-desc":47}],34:[function(e,t,r){var n=e("./$.cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return n(e)=="String"?e.split(""):Object(e)}},{"./$.cof":18}],35:[function(e,t,r){var n=e("./$.iterators"),i=e("./$.wks")("iterator"),o=Array.prototype;t.exports=function(e){return e!==undefined&&(n.Array===e||o[i]===e)}},{"./$.iterators":43,"./$.wks":60}],36:[function(e,t,r){var n=e("./$.cof");t.exports=Array.isArray||function(e){return n(e)=="Array"}},{"./$.cof":18}],37:[function(e,t,r){t.exports=function(e){return typeof e==="object"?e!==null:typeof e==="function"}},{}],38:[function(e,t,r){var n=e("./$.an-object");t.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var o=e["return"];if(o!==undefined)n(o.call(e));throw t}}},{"./$.an-object":16}],39:[function(e,t,r){"use strict";var n=e("./$"),i=e("./$.property-desc"),o=e("./$.set-to-string-tag"),a={};e("./$.hide")(a,e("./$.wks")("iterator"),function(){return this});t.exports=function(e,t,r){e.prototype=n.create(a,{next:i(1,r)});o(e,t+" Iterator")}},{"./$":44,"./$.hide":33,"./$.property-desc":47,"./$.set-to-string-tag":51,"./$.wks":60}],40:[function(e,t,r){"use strict";var n=e("./$.library"),i=e("./$.export"),o=e("./$.redefine"),a=e("./$.hide"),s=e("./$.has"),c=e("./$.iterators"),u=e("./$.iter-create"),l=e("./$.set-to-string-tag"),h=e("./$").getProto,f=e("./$.wks")("iterator"),p=!([].keys&&"next"in[].keys()),d="@@iterator",m="keys",E="values";var g=function(){return this};t.exports=function(e,t,r,v,y,b,T){u(r,t,v);var R=function(e){if(!p&&e in _)return _[e];switch(e){case m:return function t(){return new r(this,e)};case E:return function t(){return new r(this,e)}}return function t(){return new r(this,e)}};var w=t+" Iterator",x=y==E,H=false,_=e.prototype,S=_[f]||_[d]||y&&_[y],M=S||R(y),A,C;if(S){var k=h(M.call(new e));l(k,w,true);if(!n&&s(_,d))a(k,f,g);if(x&&S.name!==E){H=true;M=function e(){return S.call(this)}}}if((!n||T)&&(p||H||!_[f])){a(_,f,M)}c[t]=M;c[w]=g;if(y){A={values:x?M:R(E),keys:b?M:R(m),entries:!x?M:R("entries")};if(T)for(C in A){if(!(C in _))o(_,C,A[C])}else i(i.P+i.F*(p||H),t,A)}return A}},{"./$":44,"./$.export":27,"./$.has":32,"./$.hide":33,"./$.iter-create":39,"./$.iterators":43,"./$.library":46,"./$.redefine":49,"./$.set-to-string-tag":51,"./$.wks":60}],41:[function(e,t,r){var n=e("./$.wks")("iterator"),i=false;try{var o=[7][n]();o["return"]=function(){i=true};Array.from(o,function(){throw 2})}catch(e){}t.exports=function(e,t){if(!t&&!i)return false;var r=false;try{var o=[7],a=o[n]();a.next=function(){r=true};o[n]=function(){return a};e(o)}catch(e){}return r}},{"./$.wks":60}],42:[function(e,t,r){t.exports=function(e,t){return{value:t,done:!!e}}},{}],43:[function(e,t,r){t.exports={}},{}],44:[function(e,t,r){var n=Object;t.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},{}],45:[function(e,t,r){var n=e("./$"),i=e("./$.to-iobject");t.exports=function(e,t){var r=i(e),o=n.getKeys(r),a=o.length,s=0,c;while(a>s)if(r[c=o[s++]]===t)return c}},{"./$":44,"./$.to-iobject":56}],46:[function(e,t,r){t.exports=true},{}],47:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}},{}],48:[function(e,t,r){var n=e("./$.redefine");t.exports=function(e,t){for(var r in t)n(e,r,t[r]);return e}},{"./$.redefine":49}],49:[function(e,t,r){t.exports=e("./$.hide")},{"./$.hide":33}],50:[function(e,t,r){"use strict";var n=e("./$.core"),i=e("./$"),o=e("./$.descriptors"),a=e("./$.wks")("species");t.exports=function(e){var t=n[e];if(o&&t&&!t[a])i.setDesc(t,a,{configurable:true,get:function(){return this}})}},{"./$":44,"./$.core":22,"./$.descriptors":25,"./$.wks":60}],51:[function(e,t,r){var n=e("./$").setDesc,i=e("./$.has"),o=e("./$.wks")("toStringTag");t.exports=function(e,t,r){if(e&&!i(e=r?e:e.prototype,o))n(e,o,{configurable:true,value:t})}},{"./$":44,"./$.has":32,"./$.wks":60}],52:[function(e,t,r){var n=e("./$.global"),i="__core-js_shared__",o=n[i]||(n[i]={});t.exports=function(e){return o[e]||(o[e]={})}},{"./$.global":31}],53:[function(e,t,r){t.exports=function(e,t,r){if(!(e instanceof t))throw TypeError(r+": use the 'new' operator!");return e}},{}],54:[function(e,t,r){var n=e("./$.to-integer"),i=e("./$.defined");t.exports=function(e){return function(t,r){var o=String(i(t)),a=n(r),s=o.length,c,u;if(a<0||a>=s)return e?"":undefined;c=o.charCodeAt(a);return c<55296||c>56319||a+1===s||(u=o.charCodeAt(a+1))<56320||u>57343?e?o.charAt(a):c:e?o.slice(a,a+2):(c-55296<<10)+(u-56320)+65536}}},{"./$.defined":24,"./$.to-integer":55}],55:[function(e,t,r){var n=Math.ceil,i=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},{}],56:[function(e,t,r){var n=e("./$.iobject"),i=e("./$.defined");t.exports=function(e){return n(i(e))}},{"./$.defined":24,"./$.iobject":34}],57:[function(e,t,r){var n=e("./$.to-integer"),i=Math.min;t.exports=function(e){return e>0?i(n(e),9007199254740991):0}},{"./$.to-integer":55}],58:[function(e,t,r){var n=e("./$.defined");t.exports=function(e){return Object(n(e))}},{"./$.defined":24}],59:[function(e,t,r){var n=0,i=Math.random();t.exports=function(e){return"Symbol(".concat(e===undefined?"":e,")_",(++n+i).toString(36))}},{}],60:[function(e,t,r){var n=e("./$.shared")("wks"),i=e("./$.uid"),o=e("./$.global").Symbol;t.exports=function(e){return n[e]||(n[e]=o&&o[e]||(o||i)("Symbol."+e))}},{"./$.global":31,"./$.shared":52,"./$.uid":59}],61:[function(e,t,r){var n=e("./$.classof"),i=e("./$.wks")("iterator"),o=e("./$.iterators");t.exports=e("./$.core").getIteratorMethod=function(e){if(e!=undefined)return e[i]||e["@@iterator"]||o[n(e)]}},{"./$.classof":17,"./$.core":22,"./$.iterators":43,"./$.wks":60}],62:[function(e,t,r){"use strict";var n=e("./$.ctx"),i=e("./$.export"),o=e("./$.to-object"),a=e("./$.iter-call"),s=e("./$.is-array-iter"),c=e("./$.to-length"),u=e("./core.get-iterator-method");i(i.S+i.F*!e("./$.iter-detect")(function(e){Array.from(e)}),"Array",{from:function e(t){var r=o(t),i=typeof this=="function"?this:Array,l=arguments,h=l.length,f=h>1?l[1]:undefined,p=f!==undefined,d=0,m=u(r),E,g,v,y;if(p)f=n(f,h>2?l[2]:undefined,2);if(m!=undefined&&!(i==Array&&s(m))){for(y=m.call(r),g=new i;!(v=y.next()).done;d++){g[d]=p?a(y,f,[v.value,d],true):v.value}}else{E=c(r.length);for(g=new i(E);E>d;d++){g[d]=p?f(r[d],d):r[d]}}g.length=d;return g}})},{"./$.ctx":23,"./$.export":27,"./$.is-array-iter":35,"./$.iter-call":38,"./$.iter-detect":41,"./$.to-length":57,"./$.to-object":58,"./core.get-iterator-method":61}],63:[function(e,t,r){"use strict";var n=e("./$.add-to-unscopables"),i=e("./$.iter-step"),o=e("./$.iterators"),a=e("./$.to-iobject");t.exports=e("./$.iter-define")(Array,"Array",function(e,t){this._t=a(e);this._i=0;this._k=t},function(){var e=this._t,t=this._k,r=this._i++;if(!e||r>=e.length){this._t=undefined;return i(1)}if(t=="keys")return i(0,r);if(t=="values")return i(0,e[r]);return i(0,[r,e[r]])},"values");o.Arguments=o.Array;n("keys");n("values");n("entries")},{"./$.add-to-unscopables":15,"./$.iter-define":40,"./$.iter-step":42,"./$.iterators":43,"./$.to-iobject":56}],64:[function(e,t,r){"use strict";var n=e("./$.collection-strong");e("./$.collection")("Map",function(e){return function t(){return e(this,arguments.length>0?arguments[0]:undefined)}},{get:function e(t){var r=n.getEntry(this,t);return r&&r.v},set:function e(t,r){return n.def(this,t===0?0:t,r)}},n,true)},{"./$.collection":21,"./$.collection-strong":19}],65:[function(e,t,r){},{}],66:[function(e,t,r){"use strict";var n=e("./$.string-at")(true);e("./$.iter-define")(String,"String",function(e){this._t=String(e);this._i=0},function(){var e=this._t,t=this._i,r;if(t>=e.length)return{value:undefined,done:true};r=n(e,t);this._i+=r.length;return{value:r,done:false}})},{"./$.iter-define":40,"./$.string-at":54}],67:[function(e,t,r){"use strict";var n=e("./$"),i=e("./$.global"),o=e("./$.has"),a=e("./$.descriptors"),s=e("./$.export"),c=e("./$.redefine"),u=e("./$.fails"),l=e("./$.shared"),h=e("./$.set-to-string-tag"),f=e("./$.uid"),p=e("./$.wks"),d=e("./$.keyof"),m=e("./$.get-names"),E=e("./$.enum-keys"),g=e("./$.is-array"),v=e("./$.an-object"),y=e("./$.to-iobject"),b=e("./$.property-desc"),T=n.getDesc,R=n.setDesc,w=n.create,x=m.get,H=i.Symbol,_=i.JSON,S=_&&_.stringify,M=false,A=p("_hidden"),C=n.isEnum,k=l("symbol-registry"),L=l("symbols"),P=typeof H=="function",O=Object.prototype;var N=a&&u(function(){return w(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=T(O,t);if(n)delete O[t];R(e,t,r);if(n&&e!==O)R(O,t,n)}:R;var F=function(e){var t=L[e]=w(H.prototype);t._k=e;a&&M&&N(O,e,{configurable:true,set:function(t){if(o(this,A)&&o(this[A],e))this[A][e]=false;N(this,e,b(1,t))}});return t};var I=function(e){return typeof e=="symbol"};var B=function e(t,r,n){if(n&&o(L,r)){if(!n.enumerable){if(!o(t,A))R(t,A,b(1,{}));t[A][r]=true}else{if(o(t,A)&&t[A][r])t[A][r]=false;n=w(n,{enumerable:b(0,false)})}return N(t,r,n)}return R(t,r,n)};var j=function e(t,r){v(t);var n=E(r=y(r)),i=0,o=n.length,a;while(o>i)B(t,a=n[i++],r[a]);return t};var D=function e(t,r){return r===undefined?w(t):j(w(t),r)};var U=function e(t){var r=C.call(this,t);return r||!o(this,t)||!o(L,t)||o(this,A)&&this[A][t]?r:true};var $=function e(t,r){var n=T(t=y(t),r);if(n&&o(L,r)&&!(o(t,A)&&t[A][r]))n.enumerable=true;return n};var V=function e(t){var r=x(y(t)),n=[],i=0,a;while(r.length>i)if(!o(L,a=r[i++])&&a!=A)n.push(a);return n};var G=function e(t){var r=x(y(t)),n=[],i=0,a;while(r.length>i)if(o(L,a=r[i++]))n.push(L[a]);return n};var z=function e(t){if(t===undefined||I(t))return;var r=[t],n=1,i=arguments,o,a;while(i.length>n)r.push(i[n++]);o=r[1];if(typeof o=="function")a=o;if(a||!g(o))o=function(e,t){if(a)t=a.call(this,e,t);if(!I(t))return t};r[1]=o;return S.apply(_,r)};var W=u(function(){var e=H();return S([e])!="[null]"||S({a:e})!="{}"||S(Object(e))!="{}"});if(!P){H=function e(){if(I(this))throw TypeError("Symbol is not a constructor");return F(f(arguments.length>0?arguments[0]:undefined))};c(H.prototype,"toString",function e(){return this._k});I=function(e){return e instanceof H};n.create=D;n.isEnum=U;n.getDesc=$;n.setDesc=B;n.setDescs=j;n.getNames=m.get=V;n.getSymbols=G;if(a&&!e("./$.library")){c(O,"propertyIsEnumerable",U,true)}}var q={for:function(e){return o(k,e+="")?k[e]:k[e]=H(e)},keyFor:function e(t){return d(k,t)},useSetter:function(){M=true},useSimple:function(){M=false}};n.each.call(("hasInstance,isConcatSpreadable,iterator,match,replace,search,"+"species,split,toPrimitive,toStringTag,unscopables").split(","),function(e){var t=p(e);q[e]=P?t:F(t)});M=true;s(s.G+s.W,{Symbol:H});s(s.S,"Symbol",q);s(s.S+s.F*!P,"Object",{create:D,defineProperty:B,defineProperties:j,getOwnPropertyDescriptor:$,getOwnPropertyNames:V,getOwnPropertySymbols:G});_&&s(s.S+s.F*(!P||W),"JSON",{stringify:z});h(H,"Symbol");h(Math,"Math",true);h(i.JSON,"JSON",true)},{"./$":44,"./$.an-object":16,"./$.descriptors":25,"./$.enum-keys":26,"./$.export":27,"./$.fails":28,"./$.get-names":30,"./$.global":31,"./$.has":32,"./$.is-array":36,"./$.keyof":45,"./$.library":46,"./$.property-desc":47,"./$.redefine":49,"./$.set-to-string-tag":51,"./$.shared":52,"./$.to-iobject":56,"./$.uid":59,"./$.wks":60}],68:[function(e,t,r){var n=e("./$.export");n(n.P,"Map",{toJSON:e("./$.collection-to-json")("Map")})},{"./$.collection-to-json":20,"./$.export":27}],69:[function(e,t,r){e("./es6.array.iterator");var n=e("./$.iterators");n.NodeList=n.HTMLCollection=n.Array},{"./$.iterators":43,"./es6.array.iterator":63}],70:[function(e,t,r){arguments[4][14][0].apply(r,arguments)},{dup:14}],71:[function(e,t,r){var n=e("./$.wks")("unscopables"),i=Array.prototype;if(i[n]==undefined)e("./$.hide")(i,n,{});t.exports=function(e){i[n][e]=true}},{"./$.hide":99,"./$.wks":151}],72:[function(e,t,r){arguments[4][16][0].apply(r,arguments)},{"./$.is-object":106,dup:16}],73:[function(e,t,r){"use strict";var n=e("./$.to-object"),i=e("./$.to-index"),o=e("./$.to-length");t.exports=[].copyWithin||function e(t,r){var a=n(this),s=o(a.length),c=i(t,s),u=i(r,s),l=arguments,h=l.length>2?l[2]:undefined,f=Math.min((h===undefined?s:i(h,s))-u,s-c),p=1;if(u<c&&c<u+f){p=-1;u+=f-1;c+=f-1}while(f-- >0){if(u in a)a[c]=a[u];else delete a[c];c+=p;u+=p}return a}},{"./$.to-index":144,"./$.to-length":147,"./$.to-object":148}],74:[function(e,t,r){"use strict";var n=e("./$.to-object"),i=e("./$.to-index"),o=e("./$.to-length");t.exports=[].fill||function e(t){var r=n(this),a=o(r.length),s=arguments,c=s.length,u=i(c>1?s[1]:undefined,a),l=c>2?s[2]:undefined,h=l===undefined?a:i(l,a);while(h>u)r[u++]=t;return r}},{"./$.to-index":144,"./$.to-length":147,"./$.to-object":148}],75:[function(e,t,r){var n=e("./$.to-iobject"),i=e("./$.to-length"),o=e("./$.to-index");t.exports=function(e){return function(t,r,a){var s=n(t),c=i(s.length),u=o(a,c),l;if(e&&r!=r)while(c>u){l=s[u++];if(l!=l)return true}else for(;c>u;u++)if(e||u in s){if(s[u]===r)return e||u}return!e&&-1}}},{"./$.to-index":144,"./$.to-iobject":146,"./$.to-length":147}],76:[function(e,t,r){var n=e("./$.ctx"),i=e("./$.iobject"),o=e("./$.to-object"),a=e("./$.to-length"),s=e("./$.array-species-create");t.exports=function(e){var t=e==1,r=e==2,c=e==3,u=e==4,l=e==6,h=e==5||l;return function(f,p,d){var m=o(f),E=i(m),g=n(p,d,3),v=a(E.length),y=0,b=t?s(f,v):r?s(f,0):undefined,T,R;for(;v>y;y++)if(h||y in E){T=E[y];R=g(T,y,m);if(e){if(t)b[y]=R;else if(R)switch(e){case 3:return true;case 5:return T;case 6:return y;case 2:b.push(T)}else if(u)return false}}return l?-1:c||u?u:b}}},{"./$.array-species-create":77,"./$.ctx":85,"./$.iobject":102,"./$.to-length":147,"./$.to-object":148}],77:[function(e,t,r){var n=e("./$.is-object"),i=e("./$.is-array"),o=e("./$.wks")("species");t.exports=function(e,t){var r;if(i(e)){r=e.constructor;if(typeof r=="function"&&(r===Array||i(r.prototype)))r=undefined;if(n(r)){r=r[o];if(r===null)r=undefined}}return new(r===undefined?Array:r)(t)}},{"./$.is-array":104,"./$.is-object":106,"./$.wks":151}],78:[function(e,t,r){arguments[4][17][0].apply(r,arguments)},{"./$.cof":79,"./$.wks":151,dup:17}],79:[function(e,t,r){arguments[4][18][0].apply(r,arguments)},{dup:18}],80:[function(e,t,r){arguments[4][19][0].apply(r,arguments)},{"./$":114,"./$.ctx":85,"./$.defined":86,"./$.descriptors":87,"./$.for-of":95,"./$.has":98,"./$.hide":99,"./$.is-object":106,"./$.iter-define":110,"./$.iter-step":112,"./$.redefine-all":128,"./$.set-species":133,"./$.strict-new":137,"./$.uid":150,dup:19}],81:[function(e,t,r){arguments[4][20][0].apply(r,arguments)},{"./$.classof":78,"./$.for-of":95,dup:20}],82:[function(e,t,r){"use strict";var n=e("./$.hide"),i=e("./$.redefine-all"),o=e("./$.an-object"),a=e("./$.is-object"),s=e("./$.strict-new"),c=e("./$.for-of"),u=e("./$.array-methods"),l=e("./$.has"),h=e("./$.uid")("weak"),f=Object.isExtensible||a,p=u(5),d=u(6),m=0;var E=function(e){return e._l||(e._l=new g)};var g=function(){this.a=[]};var v=function(e,t){return p(e.a,function(e){return e[0]===t})};g.prototype={get:function(e){var t=v(this,e);if(t)return t[1]},has:function(e){return!!v(this,e)},set:function(e,t){var r=v(this,e);if(r)r[1]=t;else this.a.push([e,t])},delete:function(e){var t=d(this.a,function(t){return t[0]===e});if(~t)this.a.splice(t,1);return!!~t}};t.exports={getConstructor:function(e,t,r,n){var o=e(function(e,i){s(e,o,t);e._i=m++;e._l=undefined;if(i!=undefined)c(i,r,e[n],e)});i(o.prototype,{delete:function(e){if(!a(e))return false;if(!f(e))return E(this)["delete"](e);return l(e,h)&&l(e[h],this._i)&&delete e[h][this._i]},has:function e(t){if(!a(t))return false;if(!f(t))return E(this).has(t);return l(t,h)&&l(t[h],this._i)}});return o},def:function(e,t,r){if(!f(o(t))){E(e).set(t,r)}else{l(t,h)||n(t,h,{});t[h][e._i]=r}return e},frozenStore:E,WEAK:h}},{"./$.an-object":72,"./$.array-methods":76,"./$.for-of":95,"./$.has":98,"./$.hide":99,"./$.is-object":106,"./$.redefine-all":128,"./$.strict-new":137,"./$.uid":150}],83:[function(e,t,r){"use strict";var n=e("./$.global"),i=e("./$.export"),o=e("./$.redefine"),a=e("./$.redefine-all"),s=e("./$.for-of"),c=e("./$.strict-new"),u=e("./$.is-object"),l=e("./$.fails"),h=e("./$.iter-detect"),f=e("./$.set-to-string-tag");t.exports=function(e,t,r,p,d,m){var E=n[e],g=E,v=d?"set":"add",y=g&&g.prototype,b={};var T=function(e){var t=y[e];o(y,e,e=="delete"?function(e){return m&&!u(e)?false:t.call(this,e===0?0:e)}:e=="has"?function e(r){return m&&!u(r)?false:t.call(this,r===0?0:r)}:e=="get"?function e(r){return m&&!u(r)?undefined:t.call(this,r===0?0:r)}:e=="add"?function e(r){t.call(this,r===0?0:r);return this}:function e(r,n){t.call(this,r===0?0:r,n);return this})};if(typeof g!="function"||!(m||y.forEach&&!l(function(){(new g).entries().next()}))){g=p.getConstructor(t,e,d,v);a(g.prototype,r)}else{var R=new g,w=R[v](m?{}:-0,1)!=R,x=l(function(){R.has(1)}),H=h(function(e){new g(e)}),_;if(!H){g=t(function(t,r){c(t,g,e);var n=new E;if(r!=undefined)s(r,d,n[v],n);return n});g.prototype=y;y.constructor=g}m||R.forEach(function(e,t){_=1/t===-Infinity});if(x||_){T("delete");T("has");d&&T("get")}if(_||w)T(v);if(m&&y.clear)delete y.clear}f(g,e);b[e]=g;i(i.G+i.W+i.F*(g!=E),b);if(!m)p.setStrong(g,e,d);return g}},{"./$.export":90,"./$.fails":92,"./$.for-of":95,"./$.global":97,"./$.is-object":106,"./$.iter-detect":111,"./$.redefine":129,"./$.redefine-all":128,"./$.set-to-string-tag":134,"./$.strict-new":137}],84:[function(e,t,r){arguments[4][22][0].apply(r,arguments)},{dup:22}],85:[function(e,t,r){arguments[4][23][0].apply(r,arguments)},{"./$.a-function":70,dup:23}],86:[function(e,t,r){arguments[4][24][0].apply(r,arguments)},{dup:24}],87:[function(e,t,r){arguments[4][25][0].apply(r,arguments)},{"./$.fails":92,dup:25}],88:[function(e,t,r){var n=e("./$.is-object"),i=e("./$.global").document,o=n(i)&&n(i.createElement);t.exports=function(e){return o?i.createElement(e):{}}},{"./$.global":97,"./$.is-object":106}],89:[function(e,t,r){arguments[4][26][0].apply(r,arguments)},{"./$":114,dup:26}],90:[function(e,t,r){var n=e("./$.global"),i=e("./$.core"),o=e("./$.hide"),a=e("./$.redefine"),s=e("./$.ctx"),c="prototype";var u=function(e,t,r){var l=e&u.F,h=e&u.G,f=e&u.S,p=e&u.P,d=e&u.B,m=h?n:f?n[t]||(n[t]={}):(n[t]||{})[c],E=h?i:i[t]||(i[t]={}),g=E[c]||(E[c]={}),v,y,b,T;if(h)r=t;for(v in r){y=!l&&m&&v in m;b=(y?m:r)[v];T=d&&y?s(b,n):p&&typeof b=="function"?s(Function.call,b):b;if(m&&!y)a(m,v,b);if(E[v]!=b)o(E,v,T);if(p&&g[v]!=b)g[v]=b}};n.core=i;u.F=1;u.G=2;u.S=4;u.P=8;u.B=16;u.W=32;t.exports=u},{"./$.core":84,"./$.ctx":85,"./$.global":97,"./$.hide":99,"./$.redefine":129}],91:[function(e,t,r){var n=e("./$.wks")("match");t.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{t[n]=false;return!"/./"[e](t)}catch(e){}}return true}},{"./$.wks":151}],92:[function(e,t,r){arguments[4][28][0].apply(r,arguments)},{dup:28}],93:[function(e,t,r){"use strict";var n=e("./$.hide"),i=e("./$.redefine"),o=e("./$.fails"),a=e("./$.defined"),s=e("./$.wks");t.exports=function(e,t,r){var c=s(e),u=""[e];if(o(function(){var t={};t[c]=function(){return 7};return""[e](t)!=7})){i(String.prototype,e,r(a,c,u));n(RegExp.prototype,c,t==2?function(e,t){return u.call(e,this,t)}:function(e){return u.call(e,this)})}}},{"./$.defined":86,"./$.fails":92,"./$.hide":99,"./$.redefine":129,"./$.wks":151}],94:[function(e,t,r){"use strict";var n=e("./$.an-object");t.exports=function(){var e=n(this),t="";if(e.global)t+="g";if(e.ignoreCase)t+="i";if(e.multiline)t+="m";if(e.unicode)t+="u";if(e.sticky)t+="y";return t}},{"./$.an-object":72}],95:[function(e,t,r){arguments[4][29][0].apply(r,arguments)},{"./$.an-object":72,"./$.ctx":85,"./$.is-array-iter":103,"./$.iter-call":108,"./$.to-length":147,"./core.get-iterator-method":152,dup:29}],96:[function(e,t,r){arguments[4][30][0].apply(r,arguments)},{"./$":114,"./$.to-iobject":146,dup:30}],97:[function(e,t,r){arguments[4][31][0].apply(r,arguments)},{dup:31}],98:[function(e,t,r){arguments[4][32][0].apply(r,arguments)},{dup:32}],99:[function(e,t,r){arguments[4][33][0].apply(r,arguments)},{"./$":114,"./$.descriptors":87,"./$.property-desc":127,dup:33}],100:[function(e,t,r){t.exports=e("./$.global").document&&document.documentElement},{"./$.global":97}],101:[function(e,t,r){t.exports=function(e,t,r){var n=r===undefined;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},{}],102:[function(e,t,r){arguments[4][34][0].apply(r,arguments)},{"./$.cof":79,dup:34}],103:[function(e,t,r){arguments[4][35][0].apply(r,arguments)},{"./$.iterators":113,"./$.wks":151,dup:35}],104:[function(e,t,r){arguments[4][36][0].apply(r,arguments)},{"./$.cof":79,dup:36}],105:[function(e,t,r){var n=e("./$.is-object"),i=Math.floor;t.exports=function e(t){return!n(t)&&isFinite(t)&&i(t)===t}},{"./$.is-object":106}],106:[function(e,t,r){arguments[4][37][0].apply(r,arguments)},{dup:37}],107:[function(e,t,r){var n=e("./$.is-object"),i=e("./$.cof"),o=e("./$.wks")("match");t.exports=function(e){var t;return n(e)&&((t=e[o])!==undefined?!!t:i(e)=="RegExp")}},{"./$.cof":79,"./$.is-object":106,"./$.wks":151}],108:[function(e,t,r){arguments[4][38][0].apply(r,arguments)},{"./$.an-object":72,dup:38}],109:[function(e,t,r){arguments[4][39][0].apply(r,arguments)},{"./$":114,"./$.hide":99,"./$.property-desc":127,"./$.set-to-string-tag":134,"./$.wks":151,dup:39}],110:[function(e,t,r){arguments[4][40][0].apply(r,arguments)},{"./$":114,"./$.export":90,"./$.has":98,"./$.hide":99,"./$.iter-create":109,"./$.iterators":113,"./$.library":116,"./$.redefine":129,"./$.set-to-string-tag":134,"./$.wks":151,dup:40}],111:[function(e,t,r){arguments[4][41][0].apply(r,arguments)},{"./$.wks":151,dup:41}],112:[function(e,t,r){arguments[4][42][0].apply(r,arguments)},{dup:42}],113:[function(e,t,r){arguments[4][43][0].apply(r,arguments)},{dup:43}],114:[function(e,t,r){arguments[4][44][0].apply(r,arguments)},{dup:44}],115:[function(e,t,r){arguments[4][45][0].apply(r,arguments)},{"./$":114,"./$.to-iobject":146,dup:45}],116:[function(e,t,r){t.exports=false},{}],117:[function(e,t,r){t.exports=Math.expm1||function e(t){return(t=+t)==0?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}},{}],118:[function(e,t,r){t.exports=Math.log1p||function e(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},{}],119:[function(e,t,r){t.exports=Math.sign||function e(t){return(t=+t)==0||t!=t?t:t<0?-1:1}},{}],120:[function(e,t,r){var n=e("./$.global"),i=e("./$.task").set,o=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,c=e("./$.cof")(a)=="process",u,l,h;var f=function(){var e,t,r;if(c&&(e=a.domain)){a.domain=null;e.exit()}while(u){t=u.domain;r=u.fn;if(t)t.enter();r();if(t)t.exit();u=u.next}l=undefined;if(e)e.enter()};if(c){h=function(){a.nextTick(f)}}else if(o){var p=1,d=document.createTextNode("");new o(f).observe(d,{characterData:true});h=function(){d.data=p=-p}}else if(s&&s.resolve){h=function(){s.resolve().then(f)}}else{h=function(){i.call(n,f)}}t.exports=function e(t){var r={fn:t,next:undefined,domain:c&&a.domain};if(l)l.next=r;if(!u){u=r;h()}l=r}},{"./$.cof":79,"./$.global":97,"./$.task":143}],121:[function(e,t,r){var n=e("./$"),i=e("./$.to-object"),o=e("./$.iobject");t.exports=e("./$.fails")(function(){var e=Object.assign,t={},r={},n=Symbol(),i="abcdefghijklmnopqrst";t[n]=7;i.split("").forEach(function(e){r[e]=e});return e({},t)[n]!=7||Object.keys(e({},r)).join("")!=i})?function e(t,r){var a=i(t),s=arguments,c=s.length,u=1,l=n.getKeys,h=n.getSymbols,f=n.isEnum;while(c>u){var p=o(s[u++]),d=h?l(p).concat(h(p)):l(p),m=d.length,E=0,g;while(m>E)if(f.call(p,g=d[E++]))a[g]=p[g]}return a}:Object.assign},{"./$":114,"./$.fails":92,"./$.iobject":102,"./$.to-object":148}],122:[function(e,t,r){var n=e("./$.export"),i=e("./$.core"),o=e("./$.fails");t.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],a={};a[e]=t(r);n(n.S+n.F*o(function(){r(1)}),"Object",a)}},{"./$.core":84,"./$.export":90,"./$.fails":92}],123:[function(e,t,r){var n=e("./$"),i=e("./$.to-iobject"),o=n.isEnum;t.exports=function(e){return function(t){var r=i(t),a=n.getKeys(r),s=a.length,c=0,u=[],l;while(s>c)if(o.call(r,l=a[c++])){u.push(e?[l,r[l]]:r[l])}return u}}},{"./$":114,"./$.to-iobject":146}],124:[function(e,t,r){var n=e("./$"),i=e("./$.an-object"),o=e("./$.global").Reflect;t.exports=o&&o.ownKeys||function e(t){var r=n.getNames(i(t)),o=n.getSymbols;return o?r.concat(o(t)):r}},{"./$":114,"./$.an-object":72,"./$.global":97}],125:[function(e,t,r){"use strict";var n=e("./$.path"),i=e("./$.invoke"),o=e("./$.a-function");t.exports=function(){var e=o(this),t=arguments.length,r=Array(t),a=0,s=n._,c=false;while(t>a)if((r[a]=arguments[a++])===s)c=true;return function(){var n=this,o=arguments,a=o.length,u=0,l=0,h;if(!c&&!a)return i(e,r,n);h=r.slice();if(c)for(;t>u;u++)if(h[u]===s)h[u]=o[l++];while(a>l)h.push(o[l++]);return i(e,h,n)}}},{"./$.a-function":70,"./$.invoke":101,"./$.path":126}],126:[function(e,t,r){t.exports=e("./$.global")},{"./$.global":97}],127:[function(e,t,r){arguments[4][47][0].apply(r,arguments)},{dup:47}],128:[function(e,t,r){arguments[4][48][0].apply(r,arguments)},{"./$.redefine":129,dup:48}],129:[function(e,t,r){var n=e("./$.global"),i=e("./$.hide"),o=e("./$.uid")("src"),a="toString",s=Function[a],c=(""+s).split(a);e("./$.core").inspectSource=function(e){return s.call(e)};(t.exports=function(e,t,r,a){if(typeof r=="function"){r.hasOwnProperty(o)||i(r,o,e[t]?""+e[t]:c.join(String(t)));r.hasOwnProperty("name")||i(r,"name",t)}if(e===n){e[t]=r}else{if(!a)delete e[t];i(e,t,r)}})(Function.prototype,a,function e(){return typeof this=="function"&&this[o]||s.call(this)})},{"./$.core":84,"./$.global":97,"./$.hide":99,"./$.uid":150}],130:[function(e,t,r){t.exports=function(e,t){var r=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,r)}}},{}],131:[function(e,t,r){t.exports=Object.is||function e(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r}},{}],132:[function(e,t,r){var n=e("./$").getDesc,i=e("./$.is-object"),o=e("./$.an-object");var a=function(e,t){o(e);if(!i(t)&&t!==null)throw TypeError(t+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,r,i){try{i=e("./$.ctx")(Function.call,n(Object.prototype,"__proto__").set,2);i(t,[]);r=!(t instanceof Array)}catch(e){r=true}return function e(t,n){a(t,n);if(r)t.__proto__=n;else i(t,n);return t}}({},false):undefined),check:a}},{"./$":114,"./$.an-object":72,"./$.ctx":85,"./$.is-object":106}],133:[function(e,t,r){"use strict";var n=e("./$.global"),i=e("./$"),o=e("./$.descriptors"),a=e("./$.wks")("species");t.exports=function(e){var t=n[e];if(o&&t&&!t[a])i.setDesc(t,a,{configurable:true,get:function(){return this}})}},{"./$":114,"./$.descriptors":87,"./$.global":97,"./$.wks":151}],134:[function(e,t,r){arguments[4][51][0].apply(r,arguments)},{"./$":114,"./$.has":98,"./$.wks":151,dup:51}],135:[function(e,t,r){arguments[4][52][0].apply(r,arguments)},{"./$.global":97,dup:52}],136:[function(e,t,r){var n=e("./$.an-object"),i=e("./$.a-function"),o=e("./$.wks")("species");t.exports=function(e,t){var r=n(e).constructor,a;return r===undefined||(a=n(r)[o])==undefined?t:i(a)}},{"./$.a-function":70,"./$.an-object":72,"./$.wks":151}],137:[function(e,t,r){arguments[4][53][0].apply(r,arguments)},{dup:53}],138:[function(e,t,r){arguments[4][54][0].apply(r,arguments)},{"./$.defined":86,"./$.to-integer":145,dup:54}],139:[function(e,t,r){var n=e("./$.is-regexp"),i=e("./$.defined");t.exports=function(e,t,r){if(n(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(e))}},{"./$.defined":86,"./$.is-regexp":107}],140:[function(e,t,r){var n=e("./$.to-length"),i=e("./$.string-repeat"),o=e("./$.defined");t.exports=function(e,t,r,a){var s=String(o(e)),c=s.length,u=r===undefined?" ":String(r),l=n(t);if(l<=c)return s;if(u=="")u=" ";var h=l-c,f=i.call(u,Math.ceil(h/u.length));if(f.length>h)f=f.slice(0,h);return a?f+s:s+f}},{"./$.defined":86,"./$.string-repeat":141,"./$.to-length":147}],141:[function(e,t,r){"use strict";var n=e("./$.to-integer"),i=e("./$.defined");t.exports=function e(t){var r=String(i(this)),o="",a=n(t);if(a<0||a==Infinity)throw RangeError("Count can't be negative");for(;a>0;(a>>>=1)&&(r+=r))if(a&1)o+=r;return o}},{"./$.defined":86,"./$.to-integer":145}],142:[function(e,t,r){var n=e("./$.export"),i=e("./$.defined"),o=e("./$.fails"),a="\t\n\v\f\r   ᠎    "+"         　\u2028\u2029\ufeff",s="["+a+"]",c="​",u=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$");var h=function(e,t){var r={};r[e]=t(f);n(n.P+n.F*o(function(){return!!a[e]()||c[e]()!=c}),"String",r)};var f=h.trim=function(e,t){e=String(i(e));if(t&1)e=e.replace(u,"");if(t&2)e=e.replace(l,"");return e};t.exports=h},{"./$.defined":86,"./$.export":90,"./$.fails":92}],143:[function(e,t,r){var n=e("./$.ctx"),i=e("./$.invoke"),o=e("./$.html"),a=e("./$.dom-create"),s=e("./$.global"),c=s.process,u=s.setImmediate,l=s.clearImmediate,h=s.MessageChannel,f=0,p={},d="onreadystatechange",m,E,g;var v=function(){var e=+this;if(p.hasOwnProperty(e)){var t=p[e];delete p[e];t()}};var y=function(e){v.call(e.data)};if(!u||!l){u=function e(t){var r=[],n=1;while(arguments.length>n)r.push(arguments[n++]);p[++f]=function(){i(typeof t=="function"?t:Function(t),r)};m(f);return f};l=function e(t){delete p[t]};if(e("./$.cof")(c)=="process"){m=function(e){c.nextTick(n(v,e,1))}}else if(h){E=new h;g=E.port2;E.port1.onmessage=y;m=n(g.postMessage,g,1)}else if(s.addEventListener&&typeof postMessage=="function"&&!s.importScripts){m=function(e){s.postMessage(e+"","*")};s.addEventListener("message",y,false)}else if(d in a("script")){m=function(e){o.appendChild(a("script"))[d]=function(){o.removeChild(this);v.call(e)}}}else{m=function(e){setTimeout(n(v,e,1),0)}}}t.exports={set:u,clear:l}},{"./$.cof":79,"./$.ctx":85,"./$.dom-create":88,"./$.global":97,"./$.html":100,"./$.invoke":101}],144:[function(e,t,r){var n=e("./$.to-integer"),i=Math.max,o=Math.min;t.exports=function(e,t){e=n(e);return e<0?i(e+t,0):o(e,t)}},{"./$.to-integer":145}],145:[function(e,t,r){arguments[4][55][0].apply(r,arguments)},{dup:55}],146:[function(e,t,r){arguments[4][56][0].apply(r,arguments)},{"./$.defined":86,"./$.iobject":102,dup:56}],147:[function(e,t,r){arguments[4][57][0].apply(r,arguments)},{"./$.to-integer":145,dup:57}],148:[function(e,t,r){arguments[4][58][0].apply(r,arguments)},{"./$.defined":86,dup:58}],149:[function(e,t,r){var n=e("./$.is-object");t.exports=function(e,t){
if(!n(e))return e;var r,i;if(t&&typeof(r=e.toString)=="function"&&!n(i=r.call(e)))return i;if(typeof(r=e.valueOf)=="function"&&!n(i=r.call(e)))return i;if(!t&&typeof(r=e.toString)=="function"&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},{"./$.is-object":106}],150:[function(e,t,r){arguments[4][59][0].apply(r,arguments)},{dup:59}],151:[function(e,t,r){arguments[4][60][0].apply(r,arguments)},{"./$.global":97,"./$.shared":135,"./$.uid":150,dup:60}],152:[function(e,t,r){arguments[4][61][0].apply(r,arguments)},{"./$.classof":78,"./$.core":84,"./$.iterators":113,"./$.wks":151,dup:61}],153:[function(e,t,r){"use strict";var n=e("./$"),i=e("./$.export"),o=e("./$.descriptors"),a=e("./$.property-desc"),s=e("./$.html"),c=e("./$.dom-create"),u=e("./$.has"),l=e("./$.cof"),h=e("./$.invoke"),f=e("./$.fails"),p=e("./$.an-object"),d=e("./$.a-function"),m=e("./$.is-object"),E=e("./$.to-object"),g=e("./$.to-iobject"),v=e("./$.to-integer"),y=e("./$.to-index"),b=e("./$.to-length"),T=e("./$.iobject"),R=e("./$.uid")("__proto__"),w=e("./$.array-methods"),x=e("./$.array-includes")(false),H=Object.prototype,_=Array.prototype,S=_.slice,M=_.join,A=n.setDesc,C=n.getDesc,k=n.setDescs,L={},P;if(!o){P=!f(function(){return A(c("div"),"a",{get:function(){return 7}}).a!=7});n.setDesc=function(e,t,r){if(P)try{return A(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");if("value"in r)p(e)[t]=r.value;return e};n.getDesc=function(e,t){if(P)try{return C(e,t)}catch(e){}if(u(e,t))return a(!H.propertyIsEnumerable.call(e,t),e[t])};n.setDescs=k=function(e,t){p(e);var r=n.getKeys(t),i=r.length,o=0,a;while(i>o)n.setDesc(e,a=r[o++],t[a]);return e}}i(i.S+i.F*!o,"Object",{getOwnPropertyDescriptor:n.getDesc,defineProperty:n.setDesc,defineProperties:k});var O=("constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,"+"toLocaleString,toString,valueOf").split(","),N=O.concat("length","prototype"),F=O.length;var I=function(){var e=c("iframe"),t=F,r=">",n;e.style.display="none";s.appendChild(e);e.src="javascript:";n=e.contentWindow.document;n.open();n.write("<script>document.F=Object</script"+r);n.close();I=n.F;while(t--)delete I.prototype[O[t]];return I()};var B=function(e,t){return function(r){var n=g(r),i=0,o=[],a;for(a in n)if(a!=R)u(n,a)&&o.push(a);while(t>i)if(u(n,a=e[i++])){~x(o,a)||o.push(a)}return o}};var j=function(){};i(i.S,"Object",{getPrototypeOf:n.getProto=n.getProto||function(e){e=E(e);if(u(e,R))return e[R];if(typeof e.constructor=="function"&&e instanceof e.constructor){return e.constructor.prototype}return e instanceof Object?H:null},getOwnPropertyNames:n.getNames=n.getNames||B(N,N.length,true),create:n.create=n.create||function(e,t){var r;if(e!==null){j.prototype=p(e);r=new j;j.prototype=null;r[R]=e}else r=I();return t===undefined?r:k(r,t)},keys:n.getKeys=n.getKeys||B(O,F,false)});var D=function(e,t,r){if(!(t in L)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";L[t]=Function("F,a","return new F("+n.join(",")+")")}return L[t](e,r)};i(i.P,"Function",{bind:function e(t){var r=d(this),n=S.call(arguments,1);var i=function(){var e=n.concat(S.call(arguments));return this instanceof i?D(r,e.length,e):h(r,e,t)};if(m(r.prototype))i.prototype=r.prototype;return i}});i(i.P+i.F*f(function(){if(s)S.call(s)}),"Array",{slice:function(e,t){var r=b(this.length),n=l(this);t=t===undefined?r:t;if(n=="Array")return S.call(this,e,t);var i=y(e,r),o=y(t,r),a=b(o-i),s=Array(a),c=0;for(;c<a;c++)s[c]=n=="String"?this.charAt(i+c):this[i+c];return s}});i(i.P+i.F*(T!=Object),"Array",{join:function e(t){return M.call(T(this),t===undefined?",":t)}});i(i.S,"Array",{isArray:e("./$.is-array")});var U=function(e){return function(t,r){d(t);var n=T(this),i=b(n.length),o=e?i-1:0,a=e?-1:1;if(arguments.length<2)for(;;){if(o in n){r=n[o];o+=a;break}o+=a;if(e?o<0:i<=o){throw TypeError("Reduce of empty array with no initial value")}}for(;e?o>=0:i>o;o+=a)if(o in n){r=t(r,n[o],o,this)}return r}};var $=function(e){return function(t){return e(this,t,arguments[1])}};i(i.P,"Array",{forEach:n.each=n.each||$(w(0)),map:$(w(1)),filter:$(w(2)),some:$(w(3)),every:$(w(4)),reduce:U(false),reduceRight:U(true),indexOf:$(x),lastIndexOf:function(e,t){var r=g(this),n=b(r.length),i=n-1;if(arguments.length>1)i=Math.min(i,v(t));if(i<0)i=b(n+i);for(;i>=0;i--)if(i in r)if(r[i]===e)return i;return-1}});i(i.S,"Date",{now:function(){return+new Date}});var V=function(e){return e>9?e:"0"+e};i(i.P+i.F*(f(function(){return new Date(-5e13-1).toISOString()!="0385-07-25T07:06:39.999Z"})||!f(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function e(){if(!isFinite(this))throw RangeError("Invalid time value");var t=this,r=t.getUTCFullYear(),n=t.getUTCMilliseconds(),i=r<0?"-":r>9999?"+":"";return i+("00000"+Math.abs(r)).slice(i?-6:-4)+"-"+V(t.getUTCMonth()+1)+"-"+V(t.getUTCDate())+"T"+V(t.getUTCHours())+":"+V(t.getUTCMinutes())+":"+V(t.getUTCSeconds())+"."+(n>99?n:"0"+V(n))+"Z"}})},{"./$":114,"./$.a-function":70,"./$.an-object":72,"./$.array-includes":75,"./$.array-methods":76,"./$.cof":79,"./$.descriptors":87,"./$.dom-create":88,"./$.export":90,"./$.fails":92,"./$.has":98,"./$.html":100,"./$.invoke":101,"./$.iobject":102,"./$.is-array":104,"./$.is-object":106,"./$.property-desc":127,"./$.to-index":144,"./$.to-integer":145,"./$.to-iobject":146,"./$.to-length":147,"./$.to-object":148,"./$.uid":150}],154:[function(e,t,r){var n=e("./$.export");n(n.P,"Array",{copyWithin:e("./$.array-copy-within")});e("./$.add-to-unscopables")("copyWithin")},{"./$.add-to-unscopables":71,"./$.array-copy-within":73,"./$.export":90}],155:[function(e,t,r){var n=e("./$.export");n(n.P,"Array",{fill:e("./$.array-fill")});e("./$.add-to-unscopables")("fill")},{"./$.add-to-unscopables":71,"./$.array-fill":74,"./$.export":90}],156:[function(e,t,r){"use strict";var n=e("./$.export"),i=e("./$.array-methods")(6),o="findIndex",a=true;if(o in[])Array(1)[o](function(){a=false});n(n.P+n.F*a,"Array",{findIndex:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}});e("./$.add-to-unscopables")(o)},{"./$.add-to-unscopables":71,"./$.array-methods":76,"./$.export":90}],157:[function(e,t,r){"use strict";var n=e("./$.export"),i=e("./$.array-methods")(5),o="find",a=true;if(o in[])Array(1)[o](function(){a=false});n(n.P+n.F*a,"Array",{find:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}});e("./$.add-to-unscopables")(o)},{"./$.add-to-unscopables":71,"./$.array-methods":76,"./$.export":90}],158:[function(e,t,r){arguments[4][62][0].apply(r,arguments)},{"./$.ctx":85,"./$.export":90,"./$.is-array-iter":103,"./$.iter-call":108,"./$.iter-detect":111,"./$.to-length":147,"./$.to-object":148,"./core.get-iterator-method":152,dup:62}],159:[function(e,t,r){arguments[4][63][0].apply(r,arguments)},{"./$.add-to-unscopables":71,"./$.iter-define":110,"./$.iter-step":112,"./$.iterators":113,"./$.to-iobject":146,dup:63}],160:[function(e,t,r){"use strict";var n=e("./$.export");n(n.S+n.F*e("./$.fails")(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function e(){var t=0,r=arguments,n=r.length,i=new(typeof this=="function"?this:Array)(n);while(n>t)i[t]=r[t++];i.length=n;return i}})},{"./$.export":90,"./$.fails":92}],161:[function(e,t,r){e("./$.set-species")("Array")},{"./$.set-species":133}],162:[function(e,t,r){"use strict";var n=e("./$"),i=e("./$.is-object"),o=e("./$.wks")("hasInstance"),a=Function.prototype;if(!(o in a))n.setDesc(a,o,{value:function(e){if(typeof this!="function"||!i(e))return false;if(!i(this.prototype))return e instanceof this;while(e=n.getProto(e))if(this.prototype===e)return true;return false}})},{"./$":114,"./$.is-object":106,"./$.wks":151}],163:[function(e,t,r){var n=e("./$").setDesc,i=e("./$.property-desc"),o=e("./$.has"),a=Function.prototype,s=/^\s*function ([^ (]*)/,c="name";c in a||e("./$.descriptors")&&n(a,c,{configurable:true,get:function(){var e=(""+this).match(s),t=e?e[1]:"";o(this,c)||n(this,c,i(5,t));return t}})},{"./$":114,"./$.descriptors":87,"./$.has":98,"./$.property-desc":127}],164:[function(e,t,r){arguments[4][64][0].apply(r,arguments)},{"./$.collection":83,"./$.collection-strong":80,dup:64}],165:[function(e,t,r){var n=e("./$.export"),i=e("./$.math-log1p"),o=Math.sqrt,a=Math.acosh;n(n.S+n.F*!(a&&Math.floor(a(Number.MAX_VALUE))==710),"Math",{acosh:function e(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},{"./$.export":90,"./$.math-log1p":118}],166:[function(e,t,r){var n=e("./$.export");function i(e){return!isFinite(e=+e)||e==0?e:e<0?-i(-e):Math.log(e+Math.sqrt(e*e+1))}n(n.S,"Math",{asinh:i})},{"./$.export":90}],167:[function(e,t,r){var n=e("./$.export");n(n.S,"Math",{atanh:function e(t){return(t=+t)==0?t:Math.log((1+t)/(1-t))/2}})},{"./$.export":90}],168:[function(e,t,r){var n=e("./$.export"),i=e("./$.math-sign");n(n.S,"Math",{cbrt:function e(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},{"./$.export":90,"./$.math-sign":119}],169:[function(e,t,r){var n=e("./$.export");n(n.S,"Math",{clz32:function e(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},{"./$.export":90}],170:[function(e,t,r){var n=e("./$.export"),i=Math.exp;n(n.S,"Math",{cosh:function e(t){return(i(t=+t)+i(-t))/2}})},{"./$.export":90}],171:[function(e,t,r){var n=e("./$.export");n(n.S,"Math",{expm1:e("./$.math-expm1")})},{"./$.export":90,"./$.math-expm1":117}],172:[function(e,t,r){var n=e("./$.export"),i=e("./$.math-sign"),o=Math.pow,a=o(2,-52),s=o(2,-23),c=o(2,127)*(2-s),u=o(2,-126);var l=function(e){return e+1/a-1/a};n(n.S,"Math",{fround:function e(t){var r=Math.abs(t),n=i(t),o,h;if(r<u)return n*l(r/u/s)*u*s;o=(1+s/a)*r;h=o-(o-r);if(h>c||h!=h)return n*Infinity;return n*h}})},{"./$.export":90,"./$.math-sign":119}],173:[function(e,t,r){var n=e("./$.export"),i=Math.abs;n(n.S,"Math",{hypot:function e(t,r){var n=0,o=0,a=arguments,s=a.length,c=0,u,l;while(o<s){u=i(a[o++]);if(c<u){l=c/u;n=n*l*l+1;c=u}else if(u>0){l=u/c;n+=l*l}else n+=u}return c===Infinity?Infinity:c*Math.sqrt(n)}})},{"./$.export":90}],174:[function(e,t,r){var n=e("./$.export"),i=Math.imul;n(n.S+n.F*e("./$.fails")(function(){return i(4294967295,5)!=-5||i.length!=2}),"Math",{imul:function e(t,r){var n=65535,i=+t,o=+r,a=n&i,s=n&o;return 0|a*s+((n&i>>>16)*s+a*(n&o>>>16)<<16>>>0)}})},{"./$.export":90,"./$.fails":92}],175:[function(e,t,r){var n=e("./$.export");n(n.S,"Math",{log10:function e(t){return Math.log(t)/Math.LN10}})},{"./$.export":90}],176:[function(e,t,r){var n=e("./$.export");n(n.S,"Math",{log1p:e("./$.math-log1p")})},{"./$.export":90,"./$.math-log1p":118}],177:[function(e,t,r){var n=e("./$.export");n(n.S,"Math",{log2:function e(t){return Math.log(t)/Math.LN2}})},{"./$.export":90}],178:[function(e,t,r){var n=e("./$.export");n(n.S,"Math",{sign:e("./$.math-sign")})},{"./$.export":90,"./$.math-sign":119}],179:[function(e,t,r){var n=e("./$.export"),i=e("./$.math-expm1"),o=Math.exp;n(n.S+n.F*e("./$.fails")(function(){return!Math.sinh(-2e-17)!=-2e-17}),"Math",{sinh:function e(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},{"./$.export":90,"./$.fails":92,"./$.math-expm1":117}],180:[function(e,t,r){var n=e("./$.export"),i=e("./$.math-expm1"),o=Math.exp;n(n.S,"Math",{tanh:function e(t){var r=i(t=+t),n=i(-t);return r==Infinity?1:n==Infinity?-1:(r-n)/(o(t)+o(-t))}})},{"./$.export":90,"./$.math-expm1":117}],181:[function(e,t,r){var n=e("./$.export");n(n.S,"Math",{trunc:function e(t){return(t>0?Math.floor:Math.ceil)(t)}})},{"./$.export":90}],182:[function(e,t,r){"use strict";var n=e("./$"),i=e("./$.global"),o=e("./$.has"),a=e("./$.cof"),s=e("./$.to-primitive"),c=e("./$.fails"),u=e("./$.string-trim").trim,l="Number",h=i[l],f=h,p=h.prototype,d=a(n.create(p))==l,m="trim"in String.prototype;var E=function(e){var t=s(e,false);if(typeof t=="string"&&t.length>2){t=m?t.trim():u(t,3);var r=t.charCodeAt(0),n,i,o;if(r===43||r===45){n=t.charCodeAt(2);if(n===88||n===120)return NaN}else if(r===48){switch(t.charCodeAt(1)){case 66:case 98:i=2;o=49;break;case 79:case 111:i=8;o=55;break;default:return+t}for(var a=t.slice(2),c=0,l=a.length,h;c<l;c++){h=a.charCodeAt(c);if(h<48||h>o)return NaN}return parseInt(a,i)}}return+t};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function e(t){var r=arguments.length<1?0:t,n=this;return n instanceof h&&(d?c(function(){p.valueOf.call(n)}):a(n)!=l)?new f(E(r)):E(r)};n.each.call(e("./$.descriptors")?n.getNames(f):("MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,"+"EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,"+"MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger").split(","),function(e){if(o(f,e)&&!o(h,e)){n.setDesc(h,e,n.getDesc(f,e))}});h.prototype=p;p.constructor=h;e("./$.redefine")(i,l,h)}},{"./$":114,"./$.cof":79,"./$.descriptors":87,"./$.fails":92,"./$.global":97,"./$.has":98,"./$.redefine":129,"./$.string-trim":142,"./$.to-primitive":149}],183:[function(e,t,r){var n=e("./$.export");n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},{"./$.export":90}],184:[function(e,t,r){var n=e("./$.export"),i=e("./$.global").isFinite;n(n.S,"Number",{isFinite:function e(t){return typeof t=="number"&&i(t)}})},{"./$.export":90,"./$.global":97}],185:[function(e,t,r){var n=e("./$.export");n(n.S,"Number",{isInteger:e("./$.is-integer")})},{"./$.export":90,"./$.is-integer":105}],186:[function(e,t,r){var n=e("./$.export");n(n.S,"Number",{isNaN:function e(t){return t!=t}})},{"./$.export":90}],187:[function(e,t,r){var n=e("./$.export"),i=e("./$.is-integer"),o=Math.abs;n(n.S,"Number",{isSafeInteger:function e(t){return i(t)&&o(t)<=9007199254740991}})},{"./$.export":90,"./$.is-integer":105}],188:[function(e,t,r){var n=e("./$.export");n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},{"./$.export":90}],189:[function(e,t,r){var n=e("./$.export");n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},{"./$.export":90}],190:[function(e,t,r){var n=e("./$.export");n(n.S,"Number",{parseFloat:parseFloat})},{"./$.export":90}],191:[function(e,t,r){var n=e("./$.export");n(n.S,"Number",{parseInt:parseInt})},{"./$.export":90}],192:[function(e,t,r){var n=e("./$.export");n(n.S+n.F,"Object",{assign:e("./$.object-assign")})},{"./$.export":90,"./$.object-assign":121}],193:[function(e,t,r){var n=e("./$.is-object");e("./$.object-sap")("freeze",function(e){return function t(r){return e&&n(r)?e(r):r}})},{"./$.is-object":106,"./$.object-sap":122}],194:[function(e,t,r){var n=e("./$.to-iobject");e("./$.object-sap")("getOwnPropertyDescriptor",function(e){return function t(r,i){return e(n(r),i)}})},{"./$.object-sap":122,"./$.to-iobject":146}],195:[function(e,t,r){e("./$.object-sap")("getOwnPropertyNames",function(){return e("./$.get-names").get})},{"./$.get-names":96,"./$.object-sap":122}],196:[function(e,t,r){var n=e("./$.to-object");e("./$.object-sap")("getPrototypeOf",function(e){return function t(r){return e(n(r))}})},{"./$.object-sap":122,"./$.to-object":148}],197:[function(e,t,r){var n=e("./$.is-object");e("./$.object-sap")("isExtensible",function(e){return function t(r){return n(r)?e?e(r):true:false}})},{"./$.is-object":106,"./$.object-sap":122}],198:[function(e,t,r){var n=e("./$.is-object");e("./$.object-sap")("isFrozen",function(e){return function t(r){return n(r)?e?e(r):false:true}})},{"./$.is-object":106,"./$.object-sap":122}],199:[function(e,t,r){var n=e("./$.is-object");e("./$.object-sap")("isSealed",function(e){return function t(r){return n(r)?e?e(r):false:true}})},{"./$.is-object":106,"./$.object-sap":122}],200:[function(e,t,r){var n=e("./$.export");n(n.S,"Object",{is:e("./$.same-value")})},{"./$.export":90,"./$.same-value":131}],201:[function(e,t,r){var n=e("./$.to-object");e("./$.object-sap")("keys",function(e){return function t(r){return e(n(r))}})},{"./$.object-sap":122,"./$.to-object":148}],202:[function(e,t,r){var n=e("./$.is-object");e("./$.object-sap")("preventExtensions",function(e){return function t(r){return e&&n(r)?e(r):r}})},{"./$.is-object":106,"./$.object-sap":122}],203:[function(e,t,r){var n=e("./$.is-object");e("./$.object-sap")("seal",function(e){return function t(r){return e&&n(r)?e(r):r}})},{"./$.is-object":106,"./$.object-sap":122}],204:[function(e,t,r){var n=e("./$.export");n(n.S,"Object",{setPrototypeOf:e("./$.set-proto").set})},{"./$.export":90,"./$.set-proto":132}],205:[function(e,t,r){"use strict";var n=e("./$.classof"),i={};i[e("./$.wks")("toStringTag")]="z";if(i+""!="[object z]"){e("./$.redefine")(Object.prototype,"toString",function e(){return"[object "+n(this)+"]"},true)}},{"./$.classof":78,"./$.redefine":129,"./$.wks":151}],206:[function(e,t,r){"use strict";var n=e("./$"),i=e("./$.library"),o=e("./$.global"),a=e("./$.ctx"),s=e("./$.classof"),c=e("./$.export"),u=e("./$.is-object"),l=e("./$.an-object"),h=e("./$.a-function"),f=e("./$.strict-new"),p=e("./$.for-of"),d=e("./$.set-proto").set,m=e("./$.same-value"),E=e("./$.wks")("species"),g=e("./$.species-constructor"),v=e("./$.microtask"),y="Promise",b=o.process,T=s(b)=="process",R=o[y],w;var x=function(e){var t=new R(function(){});if(e)t.constructor=Object;return R.resolve(t)===t};var H=function(){var t=false;function r(e){var t=new R(e);d(t,r.prototype);return t}try{t=R&&R.resolve&&x();d(r,R);r.prototype=n.create(R.prototype,{constructor:{value:r}});if(!(r.resolve(5).then(function(){})instanceof r)){t=false}if(t&&e("./$.descriptors")){var i=false;R.resolve(n.setDesc({},"then",{get:function(){i=true}}));t=i}}catch(e){t=false}return t}();var _=function(e,t){if(i&&e===R&&t===w)return true;return m(e,t)};var S=function(e){var t=l(e)[E];return t!=undefined?t:e};var M=function(e){var t;return u(e)&&typeof(t=e.then)=="function"?t:false};var A=function(e){var t,r;this.promise=new e(function(e,n){if(t!==undefined||r!==undefined)throw TypeError("Bad Promise constructor");t=e;r=n});this.resolve=h(t),this.reject=h(r)};var C=function(e){try{e()}catch(e){return{error:e}}};var k=function(e,t){if(e.n)return;e.n=true;var r=e.c;v(function(){var n=e.v,i=e.s==1,a=0;var s=function(t){var r=i?t.ok:t.fail,o=t.resolve,a=t.reject,s,c;try{if(r){if(!i)e.h=true;s=r===true?n:r(n);if(s===t.promise){a(TypeError("Promise-chain cycle"))}else if(c=M(s)){c.call(s,o,a)}else o(s)}else a(n)}catch(e){a(e)}};while(r.length>a)s(r[a++]);r.length=0;e.n=false;if(t)setTimeout(function(){var t=e.p,r,i;if(L(t)){if(T){b.emit("unhandledRejection",n,t)}else if(r=o.onunhandledrejection){r({promise:t,reason:n})}else if((i=o.console)&&i.error){i.error("Unhandled promise rejection",n)}}e.a=undefined},1)})};var L=function(e){var t=e._d,r=t.a||t.c,n=0,i;if(t.h)return false;while(r.length>n){i=r[n++];if(i.fail||!L(i.promise))return false}return true};var P=function(e){var t=this;if(t.d)return;t.d=true;t=t.r||t;t.v=e;t.s=2;t.a=t.c.slice();k(t,true)};var O=function(e){var t=this,r;if(t.d)return;t.d=true;t=t.r||t;try{if(t.p===e)throw TypeError("Promise can't be resolved itself");if(r=M(e)){v(function(){var n={r:t,d:false};try{r.call(e,a(O,n,1),a(P,n,1))}catch(e){P.call(n,e)}})}else{t.v=e;t.s=1;k(t,false)}}catch(e){P.call({r:t,d:false},e)}};if(!H){R=function e(t){h(t);var r=this._d={p:f(this,R,y),c:[],a:undefined,s:0,d:false,v:undefined,h:false,n:false};try{t(a(O,r,1),a(P,r,1))}catch(e){P.call(r,e)}};e("./$.redefine-all")(R.prototype,{then:function e(t,r){var n=new A(g(this,R)),i=n.promise,o=this._d;n.ok=typeof t=="function"?t:true;n.fail=typeof r=="function"&&r;o.c.push(n);if(o.a)o.a.push(n);if(o.s)k(o,false);return i},catch:function(e){return this.then(undefined,e)}})}c(c.G+c.W+c.F*!H,{Promise:R});e("./$.set-to-string-tag")(R,y);e("./$.set-species")(y);w=e("./$.core")[y];c(c.S+c.F*!H,y,{reject:function e(t){var r=new A(this),n=r.reject;n(t);return r.promise}});c(c.S+c.F*(!H||x(true)),y,{resolve:function e(t){if(t instanceof R&&_(t.constructor,this))return t;var r=new A(this),n=r.resolve;n(t);return r.promise}});c(c.S+c.F*!(H&&e("./$.iter-detect")(function(e){R.all(e)["catch"](function(){})})),y,{all:function e(t){var r=S(this),i=new A(r),o=i.resolve,a=i.reject,s=[];var c=C(function(){p(t,false,s.push,s);var e=s.length,i=Array(e);if(e)n.each.call(s,function(t,n){var s=false;r.resolve(t).then(function(t){if(s)return;s=true;i[n]=t;--e||o(i)},a)});else o(i)});if(c)a(c.error);return i.promise},race:function e(t){var r=S(this),n=new A(r),i=n.reject;var o=C(function(){p(t,false,function(e){r.resolve(e).then(n.resolve,i)})});if(o)i(o.error);return n.promise}})},{"./$":114,"./$.a-function":70,"./$.an-object":72,"./$.classof":78,"./$.core":84,"./$.ctx":85,"./$.descriptors":87,"./$.export":90,"./$.for-of":95,"./$.global":97,"./$.is-object":106,"./$.iter-detect":111,"./$.library":116,"./$.microtask":120,"./$.redefine-all":128,"./$.same-value":131,"./$.set-proto":132,"./$.set-species":133,"./$.set-to-string-tag":134,"./$.species-constructor":136,"./$.strict-new":137,"./$.wks":151}],207:[function(e,t,r){var n=e("./$.export"),i=Function.apply;n(n.S,"Reflect",{apply:function e(t,r,n){return i.call(t,r,n)}})},{"./$.export":90}],208:[function(e,t,r){var n=e("./$"),i=e("./$.export"),o=e("./$.a-function"),a=e("./$.an-object"),s=e("./$.is-object"),c=Function.bind||e("./$.core").Function.prototype.bind;i(i.S+i.F*e("./$.fails")(function(){function e(){}return!(Reflect.construct(function(){},[],e)instanceof e)}),"Reflect",{construct:function e(t,r){o(t);var i=arguments.length<3?t:o(arguments[2]);if(t==i){if(r!=undefined)switch(a(r).length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var u=[null];u.push.apply(u,r);return new(c.apply(t,u))}var l=i.prototype,h=n.create(s(l)?l:Object.prototype),f=Function.apply.call(t,h,r);return s(f)?f:h}})},{"./$":114,"./$.a-function":70,"./$.an-object":72,"./$.core":84,"./$.export":90,"./$.fails":92,"./$.is-object":106}],209:[function(e,t,r){var n=e("./$"),i=e("./$.export"),o=e("./$.an-object");i(i.S+i.F*e("./$.fails")(function(){Reflect.defineProperty(n.setDesc({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function e(t,r,i){o(t);try{n.setDesc(t,r,i);return true}catch(e){return false}}})},{"./$":114,"./$.an-object":72,"./$.export":90,"./$.fails":92}],210:[function(e,t,r){var n=e("./$.export"),i=e("./$").getDesc,o=e("./$.an-object");n(n.S,"Reflect",{deleteProperty:function e(t,r){var n=i(o(t),r);return n&&!n.configurable?false:delete t[r]}})},{"./$":114,"./$.an-object":72,"./$.export":90}],211:[function(e,t,r){"use strict";var n=e("./$.export"),i=e("./$.an-object");var o=function(e){this._t=i(e);this._i=0;var t=this._k=[],r;for(r in e)t.push(r)};e("./$.iter-create")(o,"Object",function(){var e=this,t=e._k,r;do{if(e._i>=t.length)return{value:undefined,done:true}}while(!((r=t[e._i++])in e._t));return{value:r,done:false}});n(n.S,"Reflect",{enumerate:function e(t){return new o(t)}})},{"./$.an-object":72,"./$.export":90,"./$.iter-create":109}],212:[function(e,t,r){var n=e("./$"),i=e("./$.export"),o=e("./$.an-object");i(i.S,"Reflect",{getOwnPropertyDescriptor:function e(t,r){return n.getDesc(o(t),r)}})},{"./$":114,"./$.an-object":72,"./$.export":90}],213:[function(e,t,r){var n=e("./$.export"),i=e("./$").getProto,o=e("./$.an-object");n(n.S,"Reflect",{getPrototypeOf:function e(t){return i(o(t))}})},{"./$":114,"./$.an-object":72,"./$.export":90}],214:[function(e,t,r){var n=e("./$"),i=e("./$.has"),o=e("./$.export"),a=e("./$.is-object"),s=e("./$.an-object");function c(e,t){var r=arguments.length<3?e:arguments[2],o,u;if(s(e)===r)return e[t];if(o=n.getDesc(e,t))return i(o,"value")?o.value:o.get!==undefined?o.get.call(r):undefined;if(a(u=n.getProto(e)))return c(u,t,r)}o(o.S,"Reflect",{get:c})},{"./$":114,"./$.an-object":72,"./$.export":90,"./$.has":98,"./$.is-object":106}],215:[function(e,t,r){var n=e("./$.export");n(n.S,"Reflect",{has:function e(t,r){return r in t}})},{"./$.export":90}],216:[function(e,t,r){var n=e("./$.export"),i=e("./$.an-object"),o=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function e(t){i(t);return o?o(t):true}})},{"./$.an-object":72,"./$.export":90}],217:[function(e,t,r){var n=e("./$.export");n(n.S,"Reflect",{ownKeys:e("./$.own-keys")})},{"./$.export":90,"./$.own-keys":124}],218:[function(e,t,r){var n=e("./$.export"),i=e("./$.an-object"),o=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function e(t){i(t);try{if(o)o(t);return true}catch(e){return false}}})},{"./$.an-object":72,"./$.export":90}],219:[function(e,t,r){var n=e("./$.export"),i=e("./$.set-proto");if(i)n(n.S,"Reflect",{setPrototypeOf:function e(t,r){i.check(t,r);try{i.set(t,r);return true}catch(e){return false}}})},{"./$.export":90,"./$.set-proto":132}],220:[function(e,t,r){var n=e("./$"),i=e("./$.has"),o=e("./$.export"),a=e("./$.property-desc"),s=e("./$.an-object"),c=e("./$.is-object");function u(e,t,r){var o=arguments.length<4?e:arguments[3],l=n.getDesc(s(e),t),h,f;if(!l){if(c(f=n.getProto(e))){return u(f,t,r,o)}l=a(0)}if(i(l,"value")){if(l.writable===false||!c(o))return false;h=n.getDesc(o,t)||a(0);h.value=r;n.setDesc(o,t,h);return true}return l.set===undefined?false:(l.set.call(o,r),true)}o(o.S,"Reflect",{set:u})},{"./$":114,"./$.an-object":72,"./$.export":90,"./$.has":98,"./$.is-object":106,"./$.property-desc":127}],221:[function(e,t,r){var n=e("./$"),i=e("./$.global"),o=e("./$.is-regexp"),a=e("./$.flags"),s=i.RegExp,c=s,u=s.prototype,l=/a/g,h=/a/g,f=new s(l)!==l;if(e("./$.descriptors")&&(!f||e("./$.fails")(function(){h[e("./$.wks")("match")]=false;return s(l)!=l||s(h)==h||s(l,"i")!="/a/i"}))){s=function e(t,r){var n=o(t),i=r===undefined;return!(this instanceof s)&&n&&t.constructor===s&&i?t:f?new c(n&&!i?t.source:t,r):c((n=t instanceof s)?t.source:t,n&&i?a.call(t):r)};n.each.call(n.getNames(c),function(e){e in s||n.setDesc(s,e,{configurable:true,get:function(){return c[e]},set:function(t){c[e]=t}})});u.constructor=s;s.prototype=u;e("./$.redefine")(i,"RegExp",s)}e("./$.set-species")("RegExp")},{"./$":114,"./$.descriptors":87,"./$.fails":92,"./$.flags":94,"./$.global":97,"./$.is-regexp":107,"./$.redefine":129,"./$.set-species":133,"./$.wks":151}],222:[function(e,t,r){var n=e("./$");if(e("./$.descriptors")&&/./g.flags!="g")n.setDesc(RegExp.prototype,"flags",{configurable:true,get:e("./$.flags")})},{"./$":114,"./$.descriptors":87,"./$.flags":94}],223:[function(e,t,r){e("./$.fix-re-wks")("match",1,function(e,t){return function r(n){"use strict";var i=e(this),o=n==undefined?undefined:n[t];return o!==undefined?o.call(n,i):new RegExp(n)[t](String(i))}})},{"./$.fix-re-wks":93}],224:[function(e,t,r){e("./$.fix-re-wks")("replace",2,function(e,t,r){return function n(i,o){"use strict";var a=e(this),s=i==undefined?undefined:i[t];return s!==undefined?s.call(i,a,o):r.call(String(a),i,o)}})},{"./$.fix-re-wks":93}],225:[function(e,t,r){e("./$.fix-re-wks")("search",1,function(e,t){return function r(n){"use strict";var i=e(this),o=n==undefined?undefined:n[t];return o!==undefined?o.call(n,i):new RegExp(n)[t](String(i))}})},{"./$.fix-re-wks":93}],226:[function(e,t,r){e("./$.fix-re-wks")("split",2,function(e,t,r){return function n(i,o){"use strict";var a=e(this),s=i==undefined?undefined:i[t];return s!==undefined?s.call(i,a,o):r.call(String(a),i,o)}})},{"./$.fix-re-wks":93}],227:[function(e,t,r){"use strict";var n=e("./$.collection-strong");e("./$.collection")("Set",function(e){return function t(){return e(this,arguments.length>0?arguments[0]:undefined)}},{add:function e(t){return n.def(this,t=t===0?0:t,t)}},n)},{"./$.collection":83,"./$.collection-strong":80}],228:[function(e,t,r){"use strict";var n=e("./$.export"),i=e("./$.string-at")(false);n(n.P,"String",{codePointAt:function e(t){return i(this,t)}})},{"./$.export":90,"./$.string-at":138}],229:[function(e,t,r){"use strict";var n=e("./$.export"),i=e("./$.to-length"),o=e("./$.string-context"),a="endsWith",s=""[a];n(n.P+n.F*e("./$.fails-is-regexp")(a),"String",{endsWith:function e(t){var r=o(this,t,a),n=arguments,c=n.length>1?n[1]:undefined,u=i(r.length),l=c===undefined?u:Math.min(i(c),u),h=String(t);return s?s.call(r,h,l):r.slice(l-h.length,l)===h}})},{"./$.export":90,"./$.fails-is-regexp":91,"./$.string-context":139,"./$.to-length":147}],230:[function(e,t,r){var n=e("./$.export"),i=e("./$.to-index"),o=String.fromCharCode,a=String.fromCodePoint;n(n.S+n.F*(!!a&&a.length!=1),"String",{fromCodePoint:function e(t){var r=[],n=arguments,a=n.length,s=0,c;while(a>s){c=+n[s++];if(i(c,1114111)!==c)throw RangeError(c+" is not a valid code point");r.push(c<65536?o(c):o(((c-=65536)>>10)+55296,c%1024+56320))}return r.join("")}})},{"./$.export":90,"./$.to-index":144}],231:[function(e,t,r){"use strict";var n=e("./$.export"),i=e("./$.string-context"),o="includes";n(n.P+n.F*e("./$.fails-is-regexp")(o),"String",{includes:function e(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:undefined)}})},{"./$.export":90,"./$.fails-is-regexp":91,"./$.string-context":139}],232:[function(e,t,r){arguments[4][66][0].apply(r,arguments)},{"./$.iter-define":110,"./$.string-at":138,dup:66}],233:[function(e,t,r){var n=e("./$.export"),i=e("./$.to-iobject"),o=e("./$.to-length");n(n.S,"String",{raw:function e(t){var r=i(t.raw),n=o(r.length),a=arguments,s=a.length,c=[],u=0;while(n>u){c.push(String(r[u++]));if(u<s)c.push(String(a[u]))}return c.join("")}})},{"./$.export":90,"./$.to-iobject":146,"./$.to-length":147}],234:[function(e,t,r){var n=e("./$.export");n(n.P,"String",{repeat:e("./$.string-repeat")})},{"./$.export":90,"./$.string-repeat":141}],235:[function(e,t,r){"use strict";var n=e("./$.export"),i=e("./$.to-length"),o=e("./$.string-context"),a="startsWith",s=""[a];n(n.P+n.F*e("./$.fails-is-regexp")(a),"String",{startsWith:function e(t){var r=o(this,t,a),n=arguments,c=i(Math.min(n.length>1?n[1]:undefined,r.length)),u=String(t);return s?s.call(r,u,c):r.slice(c,c+u.length)===u}})},{"./$.export":90,"./$.fails-is-regexp":91,"./$.string-context":139,"./$.to-length":147}],236:[function(e,t,r){"use strict";e("./$.string-trim")("trim",function(e){return function t(){return e(this,3)}})},{"./$.string-trim":142}],237:[function(e,t,r){arguments[4][67][0].apply(r,arguments)},{"./$":114,"./$.an-object":72,"./$.descriptors":87,"./$.enum-keys":89,"./$.export":90,"./$.fails":92,"./$.get-names":96,"./$.global":97,"./$.has":98,"./$.is-array":104,"./$.keyof":115,"./$.library":116,"./$.property-desc":127,"./$.redefine":129,"./$.set-to-string-tag":134,"./$.shared":135,"./$.to-iobject":146,"./$.uid":150,"./$.wks":151,dup:67}],238:[function(e,t,r){"use strict";var n=e("./$"),i=e("./$.redefine"),o=e("./$.collection-weak"),a=e("./$.is-object"),s=e("./$.has"),c=o.frozenStore,u=o.WEAK,l=Object.isExtensible||a,h={};var f=e("./$.collection")("WeakMap",function(e){return function t(){return e(this,arguments.length>0?arguments[0]:undefined)}},{get:function e(t){if(a(t)){if(!l(t))return c(this).get(t);if(s(t,u))return t[u][this._i]}},set:function e(t,r){return o.def(this,t,r)}},o,true,true);if((new f).set((Object.freeze||Object)(h),7).get(h)!=7){n.each.call(["delete","has","get","set"],function(e){var t=f.prototype,r=t[e];i(t,e,function(t,n){if(a(t)&&!l(t)){var i=c(this)[e](t,n);return e=="set"?this:i}return r.call(this,t,n)})})}},{"./$":114,"./$.collection":83,"./$.collection-weak":82,"./$.has":98,"./$.is-object":106,"./$.redefine":129}],239:[function(e,t,r){"use strict";var n=e("./$.collection-weak");e("./$.collection")("WeakSet",function(e){return function t(){return e(this,arguments.length>0?arguments[0]:undefined)}},{add:function e(t){return n.def(this,t,true)}},n,false,true)},{"./$.collection":83,"./$.collection-weak":82}],240:[function(e,t,r){"use strict";var n=e("./$.export"),i=e("./$.array-includes")(true);n(n.P,"Array",{includes:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined)}});e("./$.add-to-unscopables")("includes")},{"./$.add-to-unscopables":71,"./$.array-includes":75,"./$.export":90}],241:[function(e,t,r){arguments[4][68][0].apply(r,arguments)},{"./$.collection-to-json":81,"./$.export":90,dup:68}],242:[function(e,t,r){var n=e("./$.export"),i=e("./$.object-to-array")(true);n(n.S,"Object",{entries:function e(t){return i(t)}})},{"./$.export":90,"./$.object-to-array":123}],243:[function(e,t,r){var n=e("./$"),i=e("./$.export"),o=e("./$.own-keys"),a=e("./$.to-iobject"),s=e("./$.property-desc");
i(i.S,"Object",{getOwnPropertyDescriptors:function e(t){var r=a(t),i=n.setDesc,c=n.getDesc,u=o(r),l={},h=0,f,p;while(u.length>h){p=c(r,f=u[h++]);if(f in l)i(l,f,s(0,p));else l[f]=p}return l}})},{"./$":114,"./$.export":90,"./$.own-keys":124,"./$.property-desc":127,"./$.to-iobject":146}],244:[function(e,t,r){var n=e("./$.export"),i=e("./$.object-to-array")(false);n(n.S,"Object",{values:function e(t){return i(t)}})},{"./$.export":90,"./$.object-to-array":123}],245:[function(e,t,r){var n=e("./$.export"),i=e("./$.replacer")(/[\\^$*+?.()|[\]{}]/g,"\\$&");n(n.S,"RegExp",{escape:function e(t){return i(t)}})},{"./$.export":90,"./$.replacer":130}],246:[function(e,t,r){var n=e("./$.export");n(n.P,"Set",{toJSON:e("./$.collection-to-json")("Set")})},{"./$.collection-to-json":81,"./$.export":90}],247:[function(e,t,r){"use strict";var n=e("./$.export"),i=e("./$.string-at")(true);n(n.P,"String",{at:function e(t){return i(this,t)}})},{"./$.export":90,"./$.string-at":138}],248:[function(e,t,r){"use strict";var n=e("./$.export"),i=e("./$.string-pad");n(n.P,"String",{padLeft:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined,true)}})},{"./$.export":90,"./$.string-pad":140}],249:[function(e,t,r){"use strict";var n=e("./$.export"),i=e("./$.string-pad");n(n.P,"String",{padRight:function e(t){return i(this,t,arguments.length>1?arguments[1]:undefined,false)}})},{"./$.export":90,"./$.string-pad":140}],250:[function(e,t,r){"use strict";e("./$.string-trim")("trimLeft",function(e){return function t(){return e(this,1)}})},{"./$.string-trim":142}],251:[function(e,t,r){"use strict";e("./$.string-trim")("trimRight",function(e){return function t(){return e(this,2)}})},{"./$.string-trim":142}],252:[function(e,t,r){var n=e("./$"),i=e("./$.export"),o=e("./$.ctx"),a=e("./$.core").Array||Array,s={};var c=function(e,t){n.each.call(e.split(","),function(e){if(t==undefined&&e in a)s[e]=a[e];else if(e in[])s[e]=o(Function.call,[][e],t)})};c("pop,reverse,shift,keys,values,entries",1);c("indexOf,every,some,forEach,map,filter,find,findIndex,includes",3);c("join,slice,concat,push,splice,unshift,sort,lastIndexOf,"+"reduce,reduceRight,copyWithin,fill");i(i.S,"Array",s)},{"./$":114,"./$.core":84,"./$.ctx":85,"./$.export":90}],253:[function(e,t,r){e("./es6.array.iterator");var n=e("./$.global"),i=e("./$.hide"),o=e("./$.iterators"),a=e("./$.wks")("iterator"),s=n.NodeList,c=n.HTMLCollection,u=s&&s.prototype,l=c&&c.prototype,h=o.NodeList=o.HTMLCollection=o.Array;if(u&&!u[a])i(u,a,h);if(l&&!l[a])i(l,a,h)},{"./$.global":97,"./$.hide":99,"./$.iterators":113,"./$.wks":151,"./es6.array.iterator":159}],254:[function(e,t,r){var n=e("./$.export"),i=e("./$.task");n(n.G+n.B,{setImmediate:i.set,clearImmediate:i.clear})},{"./$.export":90,"./$.task":143}],255:[function(e,t,r){var n=e("./$.global"),i=e("./$.export"),o=e("./$.invoke"),a=e("./$.partial"),s=n.navigator,c=!!s&&/MSIE .\./.test(s.userAgent);var u=function(e){return c?function(t,r){return e(o(a,[].slice.call(arguments,2),typeof t=="function"?t:Function(t)),r)}:e};i(i.G+i.B+i.F*c,{setTimeout:u(n.setTimeout),setInterval:u(n.setInterval)})},{"./$.export":90,"./$.global":97,"./$.invoke":101,"./$.partial":125}],256:[function(e,t,r){e("./modules/es5");e("./modules/es6.symbol");e("./modules/es6.object.assign");e("./modules/es6.object.is");e("./modules/es6.object.set-prototype-of");e("./modules/es6.object.to-string");e("./modules/es6.object.freeze");e("./modules/es6.object.seal");e("./modules/es6.object.prevent-extensions");e("./modules/es6.object.is-frozen");e("./modules/es6.object.is-sealed");e("./modules/es6.object.is-extensible");e("./modules/es6.object.get-own-property-descriptor");e("./modules/es6.object.get-prototype-of");e("./modules/es6.object.keys");e("./modules/es6.object.get-own-property-names");e("./modules/es6.function.name");e("./modules/es6.function.has-instance");e("./modules/es6.number.constructor");e("./modules/es6.number.epsilon");e("./modules/es6.number.is-finite");e("./modules/es6.number.is-integer");e("./modules/es6.number.is-nan");e("./modules/es6.number.is-safe-integer");e("./modules/es6.number.max-safe-integer");e("./modules/es6.number.min-safe-integer");e("./modules/es6.number.parse-float");e("./modules/es6.number.parse-int");e("./modules/es6.math.acosh");e("./modules/es6.math.asinh");e("./modules/es6.math.atanh");e("./modules/es6.math.cbrt");e("./modules/es6.math.clz32");e("./modules/es6.math.cosh");e("./modules/es6.math.expm1");e("./modules/es6.math.fround");e("./modules/es6.math.hypot");e("./modules/es6.math.imul");e("./modules/es6.math.log10");e("./modules/es6.math.log1p");e("./modules/es6.math.log2");e("./modules/es6.math.sign");e("./modules/es6.math.sinh");e("./modules/es6.math.tanh");e("./modules/es6.math.trunc");e("./modules/es6.string.from-code-point");e("./modules/es6.string.raw");e("./modules/es6.string.trim");e("./modules/es6.string.iterator");e("./modules/es6.string.code-point-at");e("./modules/es6.string.ends-with");e("./modules/es6.string.includes");e("./modules/es6.string.repeat");e("./modules/es6.string.starts-with");e("./modules/es6.array.from");e("./modules/es6.array.of");e("./modules/es6.array.iterator");e("./modules/es6.array.species");e("./modules/es6.array.copy-within");e("./modules/es6.array.fill");e("./modules/es6.array.find");e("./modules/es6.array.find-index");e("./modules/es6.regexp.constructor");e("./modules/es6.regexp.flags");e("./modules/es6.regexp.match");e("./modules/es6.regexp.replace");e("./modules/es6.regexp.search");e("./modules/es6.regexp.split");e("./modules/es6.promise");e("./modules/es6.map");e("./modules/es6.set");e("./modules/es6.weak-map");e("./modules/es6.weak-set");e("./modules/es6.reflect.apply");e("./modules/es6.reflect.construct");e("./modules/es6.reflect.define-property");e("./modules/es6.reflect.delete-property");e("./modules/es6.reflect.enumerate");e("./modules/es6.reflect.get");e("./modules/es6.reflect.get-own-property-descriptor");e("./modules/es6.reflect.get-prototype-of");e("./modules/es6.reflect.has");e("./modules/es6.reflect.is-extensible");e("./modules/es6.reflect.own-keys");e("./modules/es6.reflect.prevent-extensions");e("./modules/es6.reflect.set");e("./modules/es6.reflect.set-prototype-of");e("./modules/es7.array.includes");e("./modules/es7.string.at");e("./modules/es7.string.pad-left");e("./modules/es7.string.pad-right");e("./modules/es7.string.trim-left");e("./modules/es7.string.trim-right");e("./modules/es7.regexp.escape");e("./modules/es7.object.get-own-property-descriptors");e("./modules/es7.object.values");e("./modules/es7.object.entries");e("./modules/es7.map.to-json");e("./modules/es7.set.to-json");e("./modules/js.array.statics");e("./modules/web.timers");e("./modules/web.immediate");e("./modules/web.dom.iterable");t.exports=e("./modules/$.core")},{"./modules/$.core":84,"./modules/es5":153,"./modules/es6.array.copy-within":154,"./modules/es6.array.fill":155,"./modules/es6.array.find":157,"./modules/es6.array.find-index":156,"./modules/es6.array.from":158,"./modules/es6.array.iterator":159,"./modules/es6.array.of":160,"./modules/es6.array.species":161,"./modules/es6.function.has-instance":162,"./modules/es6.function.name":163,"./modules/es6.map":164,"./modules/es6.math.acosh":165,"./modules/es6.math.asinh":166,"./modules/es6.math.atanh":167,"./modules/es6.math.cbrt":168,"./modules/es6.math.clz32":169,"./modules/es6.math.cosh":170,"./modules/es6.math.expm1":171,"./modules/es6.math.fround":172,"./modules/es6.math.hypot":173,"./modules/es6.math.imul":174,"./modules/es6.math.log10":175,"./modules/es6.math.log1p":176,"./modules/es6.math.log2":177,"./modules/es6.math.sign":178,"./modules/es6.math.sinh":179,"./modules/es6.math.tanh":180,"./modules/es6.math.trunc":181,"./modules/es6.number.constructor":182,"./modules/es6.number.epsilon":183,"./modules/es6.number.is-finite":184,"./modules/es6.number.is-integer":185,"./modules/es6.number.is-nan":186,"./modules/es6.number.is-safe-integer":187,"./modules/es6.number.max-safe-integer":188,"./modules/es6.number.min-safe-integer":189,"./modules/es6.number.parse-float":190,"./modules/es6.number.parse-int":191,"./modules/es6.object.assign":192,"./modules/es6.object.freeze":193,"./modules/es6.object.get-own-property-descriptor":194,"./modules/es6.object.get-own-property-names":195,"./modules/es6.object.get-prototype-of":196,"./modules/es6.object.is":200,"./modules/es6.object.is-extensible":197,"./modules/es6.object.is-frozen":198,"./modules/es6.object.is-sealed":199,"./modules/es6.object.keys":201,"./modules/es6.object.prevent-extensions":202,"./modules/es6.object.seal":203,"./modules/es6.object.set-prototype-of":204,"./modules/es6.object.to-string":205,"./modules/es6.promise":206,"./modules/es6.reflect.apply":207,"./modules/es6.reflect.construct":208,"./modules/es6.reflect.define-property":209,"./modules/es6.reflect.delete-property":210,"./modules/es6.reflect.enumerate":211,"./modules/es6.reflect.get":214,"./modules/es6.reflect.get-own-property-descriptor":212,"./modules/es6.reflect.get-prototype-of":213,"./modules/es6.reflect.has":215,"./modules/es6.reflect.is-extensible":216,"./modules/es6.reflect.own-keys":217,"./modules/es6.reflect.prevent-extensions":218,"./modules/es6.reflect.set":220,"./modules/es6.reflect.set-prototype-of":219,"./modules/es6.regexp.constructor":221,"./modules/es6.regexp.flags":222,"./modules/es6.regexp.match":223,"./modules/es6.regexp.replace":224,"./modules/es6.regexp.search":225,"./modules/es6.regexp.split":226,"./modules/es6.set":227,"./modules/es6.string.code-point-at":228,"./modules/es6.string.ends-with":229,"./modules/es6.string.from-code-point":230,"./modules/es6.string.includes":231,"./modules/es6.string.iterator":232,"./modules/es6.string.raw":233,"./modules/es6.string.repeat":234,"./modules/es6.string.starts-with":235,"./modules/es6.string.trim":236,"./modules/es6.symbol":237,"./modules/es6.weak-map":238,"./modules/es6.weak-set":239,"./modules/es7.array.includes":240,"./modules/es7.map.to-json":241,"./modules/es7.object.entries":242,"./modules/es7.object.get-own-property-descriptors":243,"./modules/es7.object.values":244,"./modules/es7.regexp.escape":245,"./modules/es7.set.to-json":246,"./modules/es7.string.at":247,"./modules/es7.string.pad-left":248,"./modules/es7.string.pad-right":249,"./modules/es7.string.trim-left":250,"./modules/es7.string.trim-right":251,"./modules/js.array.statics":252,"./modules/web.dom.iterable":253,"./modules/web.immediate":254,"./modules/web.timers":255}],257:[function(e,t,r){var n=t.exports={};var i;var o;(function(){try{i=setTimeout}catch(e){i=function(){throw new Error("setTimeout is not defined")}}try{o=clearTimeout}catch(e){o=function(){throw new Error("clearTimeout is not defined")}}})();var a=[];var s=false;var c;var u=-1;function l(){if(!s||!c){return}s=false;if(c.length){a=c.concat(a)}else{u=-1}if(a.length){h()}}function h(){if(s){return}var e=i(l);s=true;var t=a.length;while(t){c=a;a=[];while(++u<t){if(c){c[u].run()}}u=-1;t=a.length}c=null;s=false;o(e)}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}a.push(new f(e,t));if(a.length===1&&!s){i(h,0)}};function f(e,t){this.fun=e;this.array=t}f.prototype.run=function(){this.fun.apply(null,this.array)};n.title="browser";n.browser=true;n.env={};n.argv=[];n.version="";n.versions={};function p(){}n.on=p;n.addListener=p;n.once=p;n.off=p;n.removeListener=p;n.removeAllListeners=p;n.emit=p;n.binding=function(e){throw new Error("process.binding is not supported")};n.cwd=function(){return"/"};n.chdir=function(e){throw new Error("process.chdir is not supported")};n.umask=function(){return 0}},{}],258:[function(e,t,r){(function(e,r){!function(r){"use strict";var n=Object.prototype.hasOwnProperty;var i;var o=typeof Symbol==="function"&&Symbol.iterator||"@@iterator";var a=typeof t==="object";var s=r.regeneratorRuntime;if(s){if(a){t.exports=s}return}s=r.regeneratorRuntime=a?t.exports:{};function c(e,t,r,n){var i=Object.create((t||m).prototype);var o=new H(n||[]);i._invoke=R(e,r,o);return i}s.wrap=c;function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}var l="suspendedStart";var h="suspendedYield";var f="executing";var p="completed";var d={};function m(){}function E(){}function g(){}var v=g.prototype=m.prototype;E.prototype=v.constructor=g;g.constructor=E;E.displayName="GeneratorFunction";function y(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}s.isGeneratorFunction=function(e){var t=typeof e==="function"&&e.constructor;return t?t===E||(t.displayName||t.name)==="GeneratorFunction":false};s.mark=function(e){if(Object.setPrototypeOf){Object.setPrototypeOf(e,g)}else{e.__proto__=g}e.prototype=Object.create(v);return e};s.awrap=function(e){return new b(e)};function b(e){this.arg=e}function T(t){function r(e,r){var o=t[e](r);var a=o.value;return a instanceof b?Promise.resolve(a.arg).then(n,i):Promise.resolve(a).then(function(e){o.value=e;return o})}if(typeof e==="object"&&e.domain){r=e.domain.bind(r)}var n=r.bind(t,"next");var i=r.bind(t,"throw");var o=r.bind(t,"return");var a;function s(e,t){function n(){return r(e,t)}return a=a?a.then(n,n):new Promise(function(e){e(n())})}this._invoke=s}y(T.prototype);s.async=function(e,t,r,n){var i=new T(c(e,t,r,n));return s.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})};function R(e,t,r){var n=l;return function o(a,s){if(n===f){throw new Error("Generator is already running")}if(n===p){if(a==="throw"){throw s}return S()}while(true){var c=r.delegate;if(c){if(a==="return"||a==="throw"&&c.iterator[a]===i){r.delegate=null;var m=c.iterator["return"];if(m){var E=u(m,c.iterator,s);if(E.type==="throw"){a="throw";s=E.arg;continue}}if(a==="return"){continue}}var E=u(c.iterator[a],c.iterator,s);if(E.type==="throw"){r.delegate=null;a="throw";s=E.arg;continue}a="next";s=i;var g=E.arg;if(g.done){r[c.resultName]=g.value;r.next=c.nextLoc}else{n=h;return g}r.delegate=null}if(a==="next"){if(n===h){r.sent=s}else{r.sent=i}}else if(a==="throw"){if(n===l){n=p;throw s}if(r.dispatchException(s)){a="next";s=i}}else if(a==="return"){r.abrupt("return",s)}n=f;var E=u(e,t,r);if(E.type==="normal"){n=r.done?p:h;var g={value:E.arg,done:r.done};if(E.arg===d){if(r.delegate&&a==="next"){s=i}}else{return g}}else if(E.type==="throw"){n=p;a="throw";s=E.arg}}}}y(v);v[o]=function(){return this};v.toString=function(){return"[object Generator]"};function w(e){var t={tryLoc:e[0]};if(1 in e){t.catchLoc=e[1]}if(2 in e){t.finallyLoc=e[2];t.afterLoc=e[3]}this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal";delete t.arg;e.completion=t}function H(e){this.tryEntries=[{tryLoc:"root"}];e.forEach(w,this);this.reset(true)}s.keys=function(e){var t=[];for(var r in e){t.push(r)}t.reverse();return function r(){while(t.length){var n=t.pop();if(n in e){r.value=n;r.done=false;return r}}r.done=true;return r}};function _(e){if(e){var t=e[o];if(t){return t.call(e)}if(typeof e.next==="function"){return e}if(!isNaN(e.length)){var r=-1,a=function t(){while(++r<e.length){if(n.call(e,r)){t.value=e[r];t.done=false;return t}}t.value=i;t.done=true;return t};return a.next=a}}return{next:S}}s.values=_;function S(){return{value:i,done:true}}H.prototype={constructor:H,reset:function(e){this.prev=0;this.next=0;this.sent=i;this.done=false;this.delegate=null;this.tryEntries.forEach(x);if(!e){for(var t in this){if(t.charAt(0)==="t"&&n.call(this,t)&&!isNaN(+t.slice(1))){this[t]=i}}}},stop:function(){this.done=true;var e=this.tryEntries[0];var t=e.completion;if(t.type==="throw"){throw t.arg}return this.rval},dispatchException:function(e){if(this.done){throw e}var t=this;function r(r,n){a.type="throw";a.arg=e;t.next=r;return!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];var a=o.completion;if(o.tryLoc==="root"){return r("end")}if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc");var c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc){return r(o.catchLoc,true)}else if(this.prev<o.finallyLoc){return r(o.finallyLoc)}}else if(s){if(this.prev<o.catchLoc){return r(o.catchLoc,true)}}else if(c){if(this.prev<o.finallyLoc){return r(o.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}if(o&&(e==="break"||e==="continue")&&o.tryLoc<=t&&t<=o.finallyLoc){o=null}var a=o?o.completion:{};a.type=e;a.arg=t;if(o){this.next=o.finallyLoc}else{this.complete(a)}return d},complete:function(e,t){if(e.type==="throw"){throw e.arg}if(e.type==="break"||e.type==="continue"){this.next=e.arg}else if(e.type==="return"){this.rval=e.arg;this.next="end"}else if(e.type==="normal"&&t){this.next=t}},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e){this.complete(r.completion,r.afterLoc);x(r);return d}}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if(n.type==="throw"){var i=n.arg;x(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){this.delegate={iterator:_(e),resultName:t,nextLoc:r};return d}}}(typeof r==="object"?r:typeof window==="object"?window:typeof self==="object"?self:this)}).call(this,e("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:257}],259:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"];var i=e("babel-runtime/helpers/class-call-check")["default"];var o=e("babel-runtime/core-js/symbol")["default"];var a=e("babel-runtime/core-js/map")["default"];var s=e("babel-runtime/core-js/array/from")["default"];if(!window.altspace){window.altspace={}}if(!window.altspace.utilities){window.altspace.utilities={}}if(!window.altspace.utilities.behaviors){window.altspace.utilities.behaviors={}}e("babel/polyfill");var c=o("containerMax"),u=o("containerMin"),l=o("object3D"),h=o("boundingBox"),f=o("origMatrix"),p=o("origMatrixAutoUpdate"),d=o("parent"),m=o("enclosure"),E=new a;var g=function(){function e(t){var r=t.my;var n=r===undefined?{}:r;var o=t.at;i(this,e);this.my=n;this.at=o}n(e,[{key:"getAxisSettings",value:function e(t,r,n,i){r=r||"center";r=/(\w+)([-+].+)?/.exec(r);var o=r[1];var a=r[2];var s=parseFloat(a)||0;if(a&&a.endsWith("%")){s=s/100*(i[t]-n[t])}else if(a&&a.endsWith("m")){console.log(s,this[m]);s=s*this[m].pixelsPerMeter;console.log(s)}return{position:o,offset:s}}},{key:"getAnchorOffset",value:function e(t,r){var n=this[h].max;var i=this[h].min;var o=this.getAxisSettings(t,r,i,n);var a=o.position;var s=o.offset;if(a==="max"){return-n[t]+s}else if(a==="min"){return-i[t]+s}else if(a==="center"){return s}else{throw new Error(r+" is an invalid layout position for "+t)}}},{key:"doLayout",value:function e(){var t=this;s("xyz").forEach(function(e){var r=t.getAxisSettings(e,t.at[e],t[u],t[c]);var n=r.position;var i=r.offset;var o=t.getAnchorOffset(e,t.my[e]);if(n==="max"){t[l].position[e]=t[c][e]+i+o}else if(n==="min"){t[l].position[e]=t[u][e]+i+o}else if(n==="center"){t[l].position[e]=i+o}else{throw new Error(t.at[e]+" is an invalid layout position for "+e)}});if(this[d]){this[d].matrix=this[f];this[d].updateMatrixWorld(true);this[d].matrixAutoUpdate=this[p]}}},{key:"awake",value:function e(t){var r=this;this[l]=t;this[h]=(new THREE.Box3).setFromObject(this[l]);altspace.getEnclosure().then(function(e){r[m]=e;if(r[l].parent instanceof THREE.Scene){var t=r[m].innerWidth/2,n=r[m].innerHeight/2,i=r[m].innerDepth/2;r[c]=new THREE.Vector3(t,n,i);r[u]=new THREE.Vector3(-t,-n,-i);r.doLayout()}else{var o=r[l].getWorldScale();r[h].min.divide(o);r[h].max.divide(o);r[d]=r[l].parent;r[f]=r[d].matrix.clone();r[p]=r[d].matrixAutoUpdate;r[d].matrixAutoUpdate=false;r[d].matrix.identity();var a=undefined;if(E.has(r[d].uuid)){a=E.get(r[d].uuid)}else{r[d].remove(r[l]);a=(new THREE.Box3).setFromObject(r[d]);r[d].add(r[l]);E.set(r[d].uuid,a)}r[c]=a.max;r[u]=a.min;r.doLayout()}})}}]);return e}();window.altspace.utilities.behaviors.Layout=g},{"babel-runtime/core-js/array/from":3,"babel-runtime/core-js/map":4,"babel-runtime/core-js/symbol":6,"babel-runtime/helpers/class-call-check":7,"babel-runtime/helpers/create-class":8,"babel/polyfill":9}]},{},[259]);(function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){var c=typeof require=="function"&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};t[a][0].call(l.exports,function(e){var r=t[a][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[a].exports}var o=typeof require=="function"&&require;for(var a=0;a<n.length;a++)i(n[a]);return i})({1:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/define-property"),__esModule:true}},{"core-js/library/fn/object/define-property":5}],2:[function(e,t,r){t.exports={default:e("core-js/library/fn/promise"),__esModule:true}},{"core-js/library/fn/promise":6}],3:[function(e,t,r){"use strict";r["default"]=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};r.__esModule=true},{}],4:[function(e,t,r){"use strict";var n=e("babel-runtime/core-js/object/define-property")["default"];r["default"]=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;n(e,i.key,i)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();r.__esModule=true},{"babel-runtime/core-js/object/define-property":1}],5:[function(e,t,r){var n=e("../../modules/$");t.exports=function e(t,r,i){return n.setDesc(t,r,i)}},{"../../modules/$":34}],6:[function(e,t,r){e("../modules/es6.object.to-string");e("../modules/es6.string.iterator");e("../modules/web.dom.iterable");e("../modules/es6.promise");t.exports=e("../modules/$.core").Promise},{"../modules/$.core":12,"../modules/es6.object.to-string":56,"../modules/es6.promise":57,"../modules/es6.string.iterator":58,"../modules/web.dom.iterable":59}],7:[function(e,t,r){t.exports=function(e){if(typeof e!="function")throw TypeError(e+" is not a function!");return e}},{}],8:[function(e,t,r){t.exports=function(){}},{}],9:[function(e,t,r){var n=e("./$.is-object");t.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},{"./$.is-object":27}],10:[function(e,t,r){var n=e("./$.cof"),i=e("./$.wks")("toStringTag"),o=n(function(){return arguments}())=="Arguments";t.exports=function(e){var t,r,a;return e===undefined?"Undefined":e===null?"Null":typeof(r=(t=Object(e))[i])=="string"?r:o?n(t):(a=n(t))=="Object"&&typeof t.callee=="function"?"Arguments":a}},{"./$.cof":11,"./$.wks":53}],11:[function(e,t,r){var n={}.toString;t.exports=function(e){return n.call(e).slice(8,-1)}},{}],12:[function(e,t,r){var n=t.exports={version:"1.2.6"};if(typeof __e=="number")__e=n},{}],13:[function(e,t,r){var n=e("./$.a-function");t.exports=function(e,t,r){n(e);if(t===undefined)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},{"./$.a-function":7}],14:[function(e,t,r){t.exports=function(e){if(e==undefined)throw TypeError("Can't call method on  "+e);return e}},{}],15:[function(e,t,r){t.exports=!e("./$.fails")(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},{"./$.fails":18}],16:[function(e,t,r){var n=e("./$.is-object"),i=e("./$.global").document,o=n(i)&&n(i.createElement);t.exports=function(e){return o?i.createElement(e):{}}},{"./$.global":20,"./$.is-object":27}],17:[function(e,t,r){var n=e("./$.global"),i=e("./$.core"),o=e("./$.ctx"),a="prototype";var s=function(e,t,r){var c=e&s.F,u=e&s.G,l=e&s.S,h=e&s.P,f=e&s.B,p=e&s.W,d=u?i:i[t]||(i[t]={}),m=u?n:l?n[t]:(n[t]||{})[a],E,g,v;if(u)r=t;for(E in r){g=!c&&m&&E in m;if(g&&E in d)continue;v=g?m[E]:r[E];d[E]=u&&typeof m[E]!="function"?r[E]:f&&g?o(v,n):p&&m[E]==v?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};t[a]=e[a];return t}(v):h&&typeof v=="function"?o(Function.call,v):v;if(h)(d[a]||(d[a]={}))[E]=v}};s.F=1;s.G=2;s.S=4;s.P=8;s.B=16;s.W=32;t.exports=s},{"./$.core":12,"./$.ctx":13,"./$.global":20}],18:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(e){return true}}},{}],19:[function(e,t,r){var n=e("./$.ctx"),i=e("./$.iter-call"),o=e("./$.is-array-iter"),a=e("./$.an-object"),s=e("./$.to-length"),c=e("./core.get-iterator-method");t.exports=function(e,t,r,u){var l=c(e),h=n(r,u,t?2:1),f=0,p,d,m;if(typeof l!="function")throw TypeError(e+" is not iterable!");if(o(l))for(p=s(e.length);p>f;f++){t?h(a(d=e[f])[0],d[1]):h(e[f])}else for(m=l.call(e);!(d=m.next()).done;){i(m,h,d.value,t)}}},{"./$.an-object":9,"./$.ctx":13,"./$.is-array-iter":26,"./$.iter-call":28,"./$.to-length":51,"./core.get-iterator-method":54}],20:[function(e,t,r){var n=t.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();if(typeof __g=="number")__g=n},{}],21:[function(e,t,r){var n={}.hasOwnProperty;t.exports=function(e,t){return n.call(e,t)}},{}],22:[function(e,t,r){var n=e("./$"),i=e("./$.property-desc");t.exports=e("./$.descriptors")?function(e,t,r){return n.setDesc(e,t,i(1,r))}:function(e,t,r){e[t]=r;return e}},{"./$":34,"./$.descriptors":15,"./$.property-desc":37}],23:[function(e,t,r){t.exports=e("./$.global").document&&document.documentElement},{"./$.global":20}],24:[function(e,t,r){t.exports=function(e,t,r){var n=r===undefined;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},{}],25:[function(e,t,r){var n=e("./$.cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return n(e)=="String"?e.split(""):Object(e)}},{"./$.cof":11}],26:[function(e,t,r){var n=e("./$.iterators"),i=e("./$.wks")("iterator"),o=Array.prototype;t.exports=function(e){return e!==undefined&&(n.Array===e||o[i]===e)}},{"./$.iterators":33,"./$.wks":53}],27:[function(e,t,r){t.exports=function(e){return typeof e==="object"?e!==null:typeof e==="function"}},{}],28:[function(e,t,r){var n=e("./$.an-object");t.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var o=e["return"];if(o!==undefined)n(o.call(e));throw t}}},{"./$.an-object":9}],29:[function(e,t,r){"use strict";var n=e("./$"),i=e("./$.property-desc"),o=e("./$.set-to-string-tag"),a={};e("./$.hide")(a,e("./$.wks")("iterator"),function(){return this});t.exports=function(e,t,r){e.prototype=n.create(a,{next:i(1,r)});o(e,t+" Iterator")}},{"./$":34,"./$.hide":22,"./$.property-desc":37,"./$.set-to-string-tag":43,"./$.wks":53}],30:[function(e,t,r){"use strict";var n=e("./$.library"),i=e("./$.export"),o=e("./$.redefine"),a=e("./$.hide"),s=e("./$.has"),c=e("./$.iterators"),u=e("./$.iter-create"),l=e("./$.set-to-string-tag"),h=e("./$").getProto,f=e("./$.wks")("iterator"),p=!([].keys&&"next"in[].keys()),d="@@iterator",m="keys",E="values";var g=function(){return this};t.exports=function(e,t,r,v,y,b,T){u(r,t,v);var R=function(e){if(!p&&e in _)return _[e];switch(e){case m:return function t(){return new r(this,e)};case E:return function t(){return new r(this,e)}}return function t(){return new r(this,e)}};var w=t+" Iterator",x=y==E,H=false,_=e.prototype,S=_[f]||_[d]||y&&_[y],M=S||R(y),A,C;if(S){var k=h(M.call(new e));l(k,w,true);if(!n&&s(_,d))a(k,f,g);if(x&&S.name!==E){H=true;M=function e(){return S.call(this)}}}if((!n||T)&&(p||H||!_[f])){a(_,f,M)}c[t]=M;c[w]=g;if(y){A={values:x?M:R(E),keys:b?M:R(m),entries:!x?M:R("entries")};if(T)for(C in A){if(!(C in _))o(_,C,A[C])}else i(i.P+i.F*(p||H),t,A)}return A}},{"./$":34,"./$.export":17,"./$.has":21,"./$.hide":22,"./$.iter-create":29,"./$.iterators":33,"./$.library":35,"./$.redefine":39,"./$.set-to-string-tag":43,"./$.wks":53}],31:[function(e,t,r){var n=e("./$.wks")("iterator"),i=false;try{var o=[7][n]();o["return"]=function(){i=true};Array.from(o,function(){throw 2})}catch(e){}t.exports=function(e,t){if(!t&&!i)return false;var r=false;try{var o=[7],a=o[n]();a.next=function(){r=true};o[n]=function(){return a};e(o)}catch(e){}return r}},{"./$.wks":53}],32:[function(e,t,r){t.exports=function(e,t){return{value:t,done:!!e}}},{}],33:[function(e,t,r){t.exports={}},{}],34:[function(e,t,r){var n=Object;t.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},{}],35:[function(e,t,r){t.exports=true},{}],36:[function(e,t,r){var n=e("./$.global"),i=e("./$.task").set,o=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,c=e("./$.cof")(a)=="process",u,l,h;var f=function(){var e,t,r;if(c&&(e=a.domain)){a.domain=null;e.exit()}while(u){t=u.domain;r=u.fn;if(t)t.enter();r();if(t)t.exit();u=u.next}l=undefined;if(e)e.enter()};if(c){h=function(){a.nextTick(f)}}else if(o){var p=1,d=document.createTextNode("");new o(f).observe(d,{characterData:true});h=function(){d.data=p=-p}}else if(s&&s.resolve){h=function(){s.resolve().then(f)}}else{h=function(){i.call(n,f)}}t.exports=function e(t){var r={fn:t,next:undefined,domain:c&&a.domain};if(l)l.next=r;if(!u){u=r;h()}l=r}},{"./$.cof":11,"./$.global":20,"./$.task":48}],37:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}},{}],38:[function(e,t,r){var n=e("./$.redefine");t.exports=function(e,t){for(var r in t)n(e,r,t[r]);return e}},{"./$.redefine":39}],39:[function(e,t,r){t.exports=e("./$.hide")},{"./$.hide":22}],40:[function(e,t,r){t.exports=Object.is||function e(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r}},{}],41:[function(e,t,r){var n=e("./$").getDesc,i=e("./$.is-object"),o=e("./$.an-object");var a=function(e,t){o(e);if(!i(t)&&t!==null)throw TypeError(t+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,r,i){try{i=e("./$.ctx")(Function.call,n(Object.prototype,"__proto__").set,2);i(t,[]);r=!(t instanceof Array)}catch(e){r=true}return function e(t,n){a(t,n);if(r)t.__proto__=n;else i(t,n);return t}}({},false):undefined),check:a}},{"./$":34,"./$.an-object":9,"./$.ctx":13,"./$.is-object":27}],42:[function(e,t,r){"use strict";var n=e("./$.core"),i=e("./$"),o=e("./$.descriptors"),a=e("./$.wks")("species");t.exports=function(e){var t=n[e];if(o&&t&&!t[a])i.setDesc(t,a,{configurable:true,get:function(){return this}})}},{"./$":34,"./$.core":12,"./$.descriptors":15,"./$.wks":53}],43:[function(e,t,r){var n=e("./$").setDesc,i=e("./$.has"),o=e("./$.wks")("toStringTag");t.exports=function(e,t,r){if(e&&!i(e=r?e:e.prototype,o))n(e,o,{configurable:true,value:t})}},{"./$":34,"./$.has":21,"./$.wks":53}],44:[function(e,t,r){var n=e("./$.global"),i="__core-js_shared__",o=n[i]||(n[i]={});t.exports=function(e){return o[e]||(o[e]={})}},{"./$.global":20}],45:[function(e,t,r){var n=e("./$.an-object"),i=e("./$.a-function"),o=e("./$.wks")("species");t.exports=function(e,t){var r=n(e).constructor,a;return r===undefined||(a=n(r)[o])==undefined?t:i(a)}},{"./$.a-function":7,"./$.an-object":9,"./$.wks":53}],46:[function(e,t,r){t.exports=function(e,t,r){if(!(e instanceof t))throw TypeError(r+": use the 'new' operator!");return e}},{}],47:[function(e,t,r){var n=e("./$.to-integer"),i=e("./$.defined");t.exports=function(e){return function(t,r){var o=String(i(t)),a=n(r),s=o.length,c,u;if(a<0||a>=s)return e?"":undefined;c=o.charCodeAt(a);return c<55296||c>56319||a+1===s||(u=o.charCodeAt(a+1))<56320||u>57343?e?o.charAt(a):c:e?o.slice(a,a+2):(c-55296<<10)+(u-56320)+65536;
}}},{"./$.defined":14,"./$.to-integer":49}],48:[function(e,t,r){var n=e("./$.ctx"),i=e("./$.invoke"),o=e("./$.html"),a=e("./$.dom-create"),s=e("./$.global"),c=s.process,u=s.setImmediate,l=s.clearImmediate,h=s.MessageChannel,f=0,p={},d="onreadystatechange",m,E,g;var v=function(){var e=+this;if(p.hasOwnProperty(e)){var t=p[e];delete p[e];t()}};var y=function(e){v.call(e.data)};if(!u||!l){u=function e(t){var r=[],n=1;while(arguments.length>n)r.push(arguments[n++]);p[++f]=function(){i(typeof t=="function"?t:Function(t),r)};m(f);return f};l=function e(t){delete p[t]};if(e("./$.cof")(c)=="process"){m=function(e){c.nextTick(n(v,e,1))}}else if(h){E=new h;g=E.port2;E.port1.onmessage=y;m=n(g.postMessage,g,1)}else if(s.addEventListener&&typeof postMessage=="function"&&!s.importScripts){m=function(e){s.postMessage(e+"","*")};s.addEventListener("message",y,false)}else if(d in a("script")){m=function(e){o.appendChild(a("script"))[d]=function(){o.removeChild(this);v.call(e)}}}else{m=function(e){setTimeout(n(v,e,1),0)}}}t.exports={set:u,clear:l}},{"./$.cof":11,"./$.ctx":13,"./$.dom-create":16,"./$.global":20,"./$.html":23,"./$.invoke":24}],49:[function(e,t,r){var n=Math.ceil,i=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},{}],50:[function(e,t,r){var n=e("./$.iobject"),i=e("./$.defined");t.exports=function(e){return n(i(e))}},{"./$.defined":14,"./$.iobject":25}],51:[function(e,t,r){var n=e("./$.to-integer"),i=Math.min;t.exports=function(e){return e>0?i(n(e),9007199254740991):0}},{"./$.to-integer":49}],52:[function(e,t,r){var n=0,i=Math.random();t.exports=function(e){return"Symbol(".concat(e===undefined?"":e,")_",(++n+i).toString(36))}},{}],53:[function(e,t,r){var n=e("./$.shared")("wks"),i=e("./$.uid"),o=e("./$.global").Symbol;t.exports=function(e){return n[e]||(n[e]=o&&o[e]||(o||i)("Symbol."+e))}},{"./$.global":20,"./$.shared":44,"./$.uid":52}],54:[function(e,t,r){var n=e("./$.classof"),i=e("./$.wks")("iterator"),o=e("./$.iterators");t.exports=e("./$.core").getIteratorMethod=function(e){if(e!=undefined)return e[i]||e["@@iterator"]||o[n(e)]}},{"./$.classof":10,"./$.core":12,"./$.iterators":33,"./$.wks":53}],55:[function(e,t,r){"use strict";var n=e("./$.add-to-unscopables"),i=e("./$.iter-step"),o=e("./$.iterators"),a=e("./$.to-iobject");t.exports=e("./$.iter-define")(Array,"Array",function(e,t){this._t=a(e);this._i=0;this._k=t},function(){var e=this._t,t=this._k,r=this._i++;if(!e||r>=e.length){this._t=undefined;return i(1)}if(t=="keys")return i(0,r);if(t=="values")return i(0,e[r]);return i(0,[r,e[r]])},"values");o.Arguments=o.Array;n("keys");n("values");n("entries")},{"./$.add-to-unscopables":8,"./$.iter-define":30,"./$.iter-step":32,"./$.iterators":33,"./$.to-iobject":50}],56:[function(e,t,r){},{}],57:[function(e,t,r){"use strict";var n=e("./$"),i=e("./$.library"),o=e("./$.global"),a=e("./$.ctx"),s=e("./$.classof"),c=e("./$.export"),u=e("./$.is-object"),l=e("./$.an-object"),h=e("./$.a-function"),f=e("./$.strict-new"),p=e("./$.for-of"),d=e("./$.set-proto").set,m=e("./$.same-value"),E=e("./$.wks")("species"),g=e("./$.species-constructor"),v=e("./$.microtask"),y="Promise",b=o.process,T=s(b)=="process",R=o[y],w;var x=function(e){var t=new R(function(){});if(e)t.constructor=Object;return R.resolve(t)===t};var H=function(){var t=false;function r(e){var t=new R(e);d(t,r.prototype);return t}try{t=R&&R.resolve&&x();d(r,R);r.prototype=n.create(R.prototype,{constructor:{value:r}});if(!(r.resolve(5).then(function(){})instanceof r)){t=false}if(t&&e("./$.descriptors")){var i=false;R.resolve(n.setDesc({},"then",{get:function(){i=true}}));t=i}}catch(e){t=false}return t}();var _=function(e,t){if(i&&e===R&&t===w)return true;return m(e,t)};var S=function(e){var t=l(e)[E];return t!=undefined?t:e};var M=function(e){var t;return u(e)&&typeof(t=e.then)=="function"?t:false};var A=function(e){var t,r;this.promise=new e(function(e,n){if(t!==undefined||r!==undefined)throw TypeError("Bad Promise constructor");t=e;r=n});this.resolve=h(t),this.reject=h(r)};var C=function(e){try{e()}catch(e){return{error:e}}};var k=function(e,t){if(e.n)return;e.n=true;var r=e.c;v(function(){var n=e.v,i=e.s==1,a=0;var s=function(t){var r=i?t.ok:t.fail,o=t.resolve,a=t.reject,s,c;try{if(r){if(!i)e.h=true;s=r===true?n:r(n);if(s===t.promise){a(TypeError("Promise-chain cycle"))}else if(c=M(s)){c.call(s,o,a)}else o(s)}else a(n)}catch(e){a(e)}};while(r.length>a)s(r[a++]);r.length=0;e.n=false;if(t)setTimeout(function(){var t=e.p,r,i;if(L(t)){if(T){b.emit("unhandledRejection",n,t)}else if(r=o.onunhandledrejection){r({promise:t,reason:n})}else if((i=o.console)&&i.error){i.error("Unhandled promise rejection",n)}}e.a=undefined},1)})};var L=function(e){var t=e._d,r=t.a||t.c,n=0,i;if(t.h)return false;while(r.length>n){i=r[n++];if(i.fail||!L(i.promise))return false}return true};var P=function(e){var t=this;if(t.d)return;t.d=true;t=t.r||t;t.v=e;t.s=2;t.a=t.c.slice();k(t,true)};var O=function(e){var t=this,r;if(t.d)return;t.d=true;t=t.r||t;try{if(t.p===e)throw TypeError("Promise can't be resolved itself");if(r=M(e)){v(function(){var n={r:t,d:false};try{r.call(e,a(O,n,1),a(P,n,1))}catch(e){P.call(n,e)}})}else{t.v=e;t.s=1;k(t,false)}}catch(e){P.call({r:t,d:false},e)}};if(!H){R=function e(t){h(t);var r=this._d={p:f(this,R,y),c:[],a:undefined,s:0,d:false,v:undefined,h:false,n:false};try{t(a(O,r,1),a(P,r,1))}catch(e){P.call(r,e)}};e("./$.redefine-all")(R.prototype,{then:function e(t,r){var n=new A(g(this,R)),i=n.promise,o=this._d;n.ok=typeof t=="function"?t:true;n.fail=typeof r=="function"&&r;o.c.push(n);if(o.a)o.a.push(n);if(o.s)k(o,false);return i},catch:function(e){return this.then(undefined,e)}})}c(c.G+c.W+c.F*!H,{Promise:R});e("./$.set-to-string-tag")(R,y);e("./$.set-species")(y);w=e("./$.core")[y];c(c.S+c.F*!H,y,{reject:function e(t){var r=new A(this),n=r.reject;n(t);return r.promise}});c(c.S+c.F*(!H||x(true)),y,{resolve:function e(t){if(t instanceof R&&_(t.constructor,this))return t;var r=new A(this),n=r.resolve;n(t);return r.promise}});c(c.S+c.F*!(H&&e("./$.iter-detect")(function(e){R.all(e)["catch"](function(){})})),y,{all:function e(t){var r=S(this),i=new A(r),o=i.resolve,a=i.reject,s=[];var c=C(function(){p(t,false,s.push,s);var e=s.length,i=Array(e);if(e)n.each.call(s,function(t,n){var s=false;r.resolve(t).then(function(t){if(s)return;s=true;i[n]=t;--e||o(i)},a)});else o(i)});if(c)a(c.error);return i.promise},race:function e(t){var r=S(this),n=new A(r),i=n.reject;var o=C(function(){p(t,false,function(e){r.resolve(e).then(n.resolve,i)})});if(o)i(o.error);return n.promise}})},{"./$":34,"./$.a-function":7,"./$.an-object":9,"./$.classof":10,"./$.core":12,"./$.ctx":13,"./$.descriptors":15,"./$.export":17,"./$.for-of":19,"./$.global":20,"./$.is-object":27,"./$.iter-detect":31,"./$.library":35,"./$.microtask":36,"./$.redefine-all":38,"./$.same-value":40,"./$.set-proto":41,"./$.set-species":42,"./$.set-to-string-tag":43,"./$.species-constructor":45,"./$.strict-new":46,"./$.wks":53}],58:[function(e,t,r){"use strict";var n=e("./$.string-at")(true);e("./$.iter-define")(String,"String",function(e){this._t=String(e);this._i=0},function(){var e=this._t,t=this._i,r;if(t>=e.length)return{value:undefined,done:true};r=n(e,t);this._i+=r.length;return{value:r,done:false}})},{"./$.iter-define":30,"./$.string-at":47}],59:[function(e,t,r){e("./es6.array.iterator");var n=e("./$.iterators");n.NodeList=n.HTMLCollection=n.Array},{"./$.iterators":33,"./es6.array.iterator":55}],60:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"];var i=e("babel-runtime/helpers/class-call-check")["default"];var o=e("babel-runtime/core-js/promise")["default"];function a(e){var t=function t(r,n){var i=altspace.getGamepads().find(function(t){return t.mapping==="steamvr"&&t.hand===e});if(i){console.log("SteamVR input device found",i);r(i)}else{console.log("SteamVR input device not found trying again in 500ms...");setTimeout(t,500,r,n)}};return new o(t)}var s=function(){function e(){i(this,e);this.type="SteamVRInput"}n(e,[{key:"awake",value:function t(){var r=this;this.leftControllerPromise=a(e.LEFT_CONTROLLER);this.rightControllerPromise=a(e.RIGHT_CONTROLLER);this.firstControllerPromise=o.race([this.leftControllerPromise,this.rightControllerPromise]);this.leftControllerPromise.then(function(e){r.leftController=e});this.rightControllerPromise.then(function(e){r.rightController=e});this.firstControllerPromise.then(function(t){r.firstController=t;var n=t.axes.map(function(){return false});var i=t.buttons.map(function(){return false});i[e.BUTTON_TRIGGER]=true;i[e.BUTTON_TOUCHPAD]=true;t.preventDefault(n,i)})}}]);return e}();s.BUTTON_TRIGGER=0;s.BUTTON_GRIP=1;s.BUTTON_TOUCHPAD=2;s.BUTTON_DPAD_UP=3;s.BUTTON_DPAD_RIGHT=4;s.BUTTON_DPAD_DOWN=5;s.BUTTON_DPAD_LEFT=6;s.AXIS_TOUCHPAD_X=0;s.AXIS_TOUCHPAD_Y=1;s.FIRST_CONTROLLER="first";s.LEFT_CONTROLLER="left";s.RIGHT_CONTROLLER="right";window.altspace.utilities.behaviors.SteamVRInput=s},{"babel-runtime/core-js/promise":2,"babel-runtime/helpers/class-call-check":3,"babel-runtime/helpers/create-class":4}]},{},[60]);(function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){var c=typeof require=="function"&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};t[a][0].call(l.exports,function(e){var r=t[a][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[a].exports}var o=typeof require=="function"&&require;for(var a=0;a<n.length;a++)i(n[a]);return i})({1:[function(e,t,r){t.exports={default:e("core-js/library/fn/object/define-property"),__esModule:true}},{"core-js/library/fn/object/define-property":4}],2:[function(e,t,r){"use strict";r["default"]=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};r.__esModule=true},{}],3:[function(e,t,r){"use strict";var n=e("babel-runtime/core-js/object/define-property")["default"];r["default"]=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;n(e,i.key,i)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();r.__esModule=true},{"babel-runtime/core-js/object/define-property":1}],4:[function(e,t,r){var n=e("../../modules/$");t.exports=function e(t,r,i){return n.setDesc(t,r,i)}},{"../../modules/$":5}],5:[function(e,t,r){var n=Object;t.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},{}],6:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"];var i=e("babel-runtime/helpers/class-call-check")["default"];var o=function(){function e(t){var r=t.hand;var n=r===undefined?"first":r;i(this,e);this._hand=n}n(e,[{key:"awake",value:function e(t,r){this._object3d=t;this._scene=r;this._steamVRInput=this._scene.getBehaviorByType("SteamVRInput")}},{key:"update",value:function e(){var t=this._steamVRInput[this._hand+"Controller"];var r=this._object3d;if(t){var n=t.position;var i=n.x;var o=n.y;var a=n.z;r.position.set(i,o,a);var s=t.rotation;var i=s.x;var o=s.y;var a=s.z;var c=s.w;r.quaternion.set(i,o,a,c)}}}]);return e}();window.altspace.utilities.behaviors.SteamVRTrackedObject=o},{"babel-runtime/helpers/class-call-check":2,"babel-runtime/helpers/create-class":3}]},{},[6]);(function(){var e="0.14.1";if(window.altspace&&window.altspace.requestVersion){window.altspace.requestVersion(e)}})();return altspace});(function(){if("performance"in window===false){window.performance={}}Date.now=Date.now||function(){return(new Date).getTime()};if("now"in window.performance===false){var e=window.performance.timing&&window.performance.timing.navigationStart?window.performance.timing.navigationStart:Date.now();window.performance.now=function(){return Date.now()-e}}})();var TWEEN=TWEEN||function(){var e=[];return{getAll:function(){return e},removeAll:function(){e=[]},add:function(t){e.push(t)},remove:function(t){var r=e.indexOf(t);if(r!==-1){e.splice(r,1)}},update:function(t){if(e.length===0){return false}var r=0;t=t!==undefined?t:window.performance.now();while(r<e.length){if(e[r].update(t)){r++}else{e.splice(r,1)}}return true}}}();TWEEN.Tween=function(e){var t=e;var r={};var n={};var i={};var o=1e3;var a=0;var s=false;var c=false;var u=false;var l=0;var h=null;var f=TWEEN.Easing.Linear.None;var p=TWEEN.Interpolation.Linear;var d=[];var m=null;var E=false;var g=null;var v=null;var y=null;for(var b in e){r[b]=parseFloat(e[b],10)}this.to=function(e,t){if(t!==undefined){o=t}n=e;return this};this.start=function(e){TWEEN.add(this);c=true;E=false;h=e!==undefined?e:window.performance.now();h+=l;for(var o in n){if(n[o]instanceof Array){if(n[o].length===0){continue}n[o]=[t[o]].concat(n[o])}if(r[o]===undefined){continue}r[o]=t[o];if(r[o]instanceof Array===false){r[o]*=1}i[o]=r[o]||0}return this};this.stop=function(){if(!c){return this}TWEEN.remove(this);c=false;if(y!==null){y.call(t)}this.stopChainedTweens();return this};this.stopChainedTweens=function(){for(var e=0,t=d.length;e<t;e++){d[e].stop()}};this.delay=function(e){l=e;return this};this.repeat=function(e){a=e;return this};this.yoyo=function(e){s=e;return this};this.easing=function(e){f=e;return this};this.interpolation=function(e){p=e;return this};this.chain=function(){d=arguments;return this};this.onStart=function(e){m=e;return this};this.onUpdate=function(e){g=e;return this};this.onComplete=function(e){v=e;return this};this.onStop=function(e){y=e;return this};this.update=function(e){var c;var y;var b;if(e<h){return true}if(E===false){if(m!==null){m.call(t)}E=true}y=(e-h)/o;y=y>1?1:y;b=f(y);for(c in n){if(r[c]===undefined){continue}var T=r[c]||0;var R=n[c];if(R instanceof Array){t[c]=p(R,b)}else{if(typeof R==="string"){if(R.startsWith("+")||R.startsWith("-")){R=T+parseFloat(R,10)}else{R=parseFloat(R,10)}}if(typeof R==="number"){t[c]=T+(R-T)*b}}}if(g!==null){g.call(t,b)}if(y===1){if(a>0){if(isFinite(a)){a--}for(c in i){if(typeof n[c]==="string"){i[c]=i[c]+parseFloat(n[c],10)}if(s){var w=i[c];i[c]=n[c];n[c]=w}r[c]=i[c]}if(s){u=!u}h=e+l;return true}else{if(v!==null){v.call(t)}for(var x=0,H=d.length;x<H;x++){d[x].start(h+o)}return false}}return true}};TWEEN.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){if((e*=2)<1){return.5*e*e}return-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){if((e*=2)<1){return.5*e*e*e}return.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){if((e*=2)<1){return.5*e*e*e*e}return-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){if((e*=2)<1){return.5*e*e*e*e*e}return.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){if(e===0){return 0}if(e===1){return 1}if((e*=2)<1){return.5*Math.pow(1024,e-1)}return.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){if((e*=2)<1){return-.5*(Math.sqrt(1-e*e)-1)}return.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t;var r=.1;var n=.4;if(e===0){return 0}if(e===1){return 1}if(!r||r<1){r=1;t=n/4}else{t=n*Math.asin(1/r)/(2*Math.PI)}return-(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n))},Out:function(e){var t;var r=.1;var n=.4;if(e===0){return 0}if(e===1){return 1}if(!r||r<1){r=1;t=n/4}else{t=n*Math.asin(1/r)/(2*Math.PI)}return r*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/n)+1},InOut:function(e){var t;var r=.1;var n=.4;if(e===0){return 0}if(e===1){return 1}if(!r||r<1){r=1;t=n/4}else{t=n*Math.asin(1/r)/(2*Math.PI)}if((e*=2)<1){return-.5*(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n))}return r*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=1.70158*1.525;if((e*=2)<1){return.5*(e*e*((t+1)*e-t))}return.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-TWEEN.Easing.Bounce.Out(1-e)},Out:function(e){if(e<1/2.75){return 7.5625*e*e}else if(e<2/2.75){return 7.5625*(e-=1.5/2.75)*e+.75}else if(e<2.5/2.75){return 7.5625*(e-=2.25/2.75)*e+.9375}else{return 7.5625*(e-=2.625/2.75)*e+.984375}},InOut:function(e){if(e<.5){return TWEEN.Easing.Bounce.In(e*2)*.5}return TWEEN.Easing.Bounce.Out(e*2-1)*.5+.5}}};TWEEN.Interpolation={Linear:function(e,t){var r=e.length-1;var n=r*t;var i=Math.floor(n);var o=TWEEN.Interpolation.Utils.Linear;if(t<0){return o(e[0],e[1],n)}if(t>1){return o(e[r],e[r-1],r-n)}return o(e[i],e[i+1>r?r:i+1],n-i)},Bezier:function(e,t){var r=0;var n=e.length-1;var i=Math.pow;var o=TWEEN.Interpolation.Utils.Bernstein;for(var a=0;a<=n;a++){r+=i(1-t,n-a)*i(t,a)*e[a]*o(n,a)}return r},CatmullRom:function(e,t){var r=e.length-1;var n=r*t;var i=Math.floor(n);var o=TWEEN.Interpolation.Utils.CatmullRom;if(e[0]===e[r]){if(t<0){i=Math.floor(n=r*(1+t))}return o(e[(i-1+r)%r],e[i],e[(i+1)%r],e[(i+2)%r],n-i)}else{if(t<0){return e[0]-(o(e[0],e[0],e[1],e[1],-n)-e[0])}if(t>1){return e[r]-(o(e[r],e[r],e[r-1],e[r-1],n-r)-e[r])}return o(e[i?i-1:0],e[i],e[r<i+1?r:i+1],e[r<i+2?r:i+2],n-i)}},Utils:{Linear:function(e,t,r){return(t-e)*r+e},Bernstein:function(e,t){var r=TWEEN.Interpolation.Utils.Factorial;return r(e)/r(t)/r(e-t)},Factorial:function(){var e=[1];return function(t){var r=1;if(e[t]){return e[t]}for(var n=t;n>1;n--){r*=n}e[t]=r;return r}}(),CatmullRom:function(e,t,r,n,i){var o=(r-e)*.5;var a=(n-t)*.5;var s=i*i;var c=i*s;return(2*t-2*r+o+a)*c+(-3*t+3*r-2*o-a)*s+o*i+t}}};(function(e){if(typeof define==="function"&&define.amd){define([],function(){return TWEEN})}else if(typeof module!=="undefined"&&typeof exports==="object"){module.exports=TWEEN}else if(e!==undefined){e.TWEEN=TWEEN}})(this);"use strict";(function(e){function t(e,t,r){this.deltaX=e||0;this.deltaY=t||0;this.deltaZ=r||0}t.prototype.awake=function(e){this.target=e};t.prototype.update=function(e){if(!this.target.visible)return;var t=this.target.rotation;this.target.rotation.set(t.x+this.deltaX*e/1e3,t.y+this.deltaY*e/1e3,t.z+this.deltaZ*e/1e3)};function r(e,t,r,n,i,o){this.parent=e||null;if(t instanceof THREE.Matrix4){this.finalPos=new THREE.Vector3;this.finalQuat=new THREE.Quaternion;this.finalScale=new THREE.Vector3;t.decompose(this.finalPos,this.finalQuat,this.finalScale);i=r;o=n}else{this.finalPos=t;this.finalQuat=r;this.finalScale=n}this.parent=e||null;this.duration=i||600;this.callback=o}r.prototype.awake=function(e){this.target=e;var t=this;e.__behaviorList.forEach(function(n){if(n instanceof r&&n!=t){if(n.callback)n.callback(e);e.removeBehavior(n)}});if(this.parent&&this.parent!==e.parent){e.applyMatrix(e.parent.matrixWorld);var n=(new THREE.Matrix4).getInverse(this.parent.matrixWorld);e.applyMatrix(n);this.parent.add(e)}this.initialPos=e.position.clone();this.initialQuat=e.quaternion.clone();this.initialScale=e.scale.clone();this.startTime=Date.now()};r.prototype.update=function(){var e=(Date.now()-this.startTime)/this.duration;e=e<1?-e*(e-2):1;if(this.finalPos){this.target.position.lerpVectors(this.initialPos,this.finalPos,e)}if(this.finalQuat){THREE.Quaternion.slerp(this.initialQuat,this.finalQuat,this.target.quaternion,e)}if(this.finalScale){this.target.scale.lerpVectors(this.initialScale,this.finalScale,e)}if(e>=1){this.target.removeBehavior(this);if(this.callback)this.callback.call(this.target)}};function n(){var e=this;var t=null;this._onCursorEnter=function(){if(e.target._listeners.cursorup&&e.target._listeners.cursorup.length>0){if(t){e.target.removeBehavior(t)}t=new Behaviors.Animate(null,null,null,e._origScale.clone().multiplyScalar(1.2),400);t.callback=function(){t=null};e.target.addBehavior(t)}};this._onCursorLeave=function(){if(e.target._listeners.cursorup&&e.target._listeners.cursorup.length>0){if(t){e.target.removeBehavior(t)}t=new Behaviors.Animate(null,null,null,e._origScale,400);t.callback=function(){t=null};e.target.addBehavior(t)}}}n.prototype.type="CursorFeedback";n.prototype.awake=function(e){this.target=e;this._origScale=e.scale.clone();this.target.addEventListener("cursorenter",this._onCursorEnter);this.target.addEventListener("cursorleave",this._onCursorLeave)};n.prototype.dispose=function(){this.target.removeEventListener("cursorenter",this._onCursorEnter);this.target.removeEventListener("cursorleave",this._onCursorLeave)};n.prototype.update=function(){};function i(e,t){this.socket=e;this.owner=t;this.lastMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}i.prototype.constructor=i;i.prototype.awake=function(e){this.target=e;e.matrixAutoUpdate=false};i.prototype.update=function(){if(Game.playerInfo.id===this.owner){this.target.updateMatrixWorld();var e=(new THREE.Matrix4).getInverse(root.matrixWorld);e=e.multiply(this.target.matrixWorld);var t=false,r=0;while(!t&&r<16){t=t||e.elements[r]!==this.lastMatrix[r];r++}if(t){this.lastMatrix=e.toArray();this.socket.emit("objectUpdate",this.target.name,this.lastMatrix)}}else if(this.target&&window._syncStates&&window._syncStates[this.target.name]){this.target.matrix.fromArray(window._syncStates[this.target.name])}};e.Rotate=t;e.Animate=r;e.CursorFeedback=n;e.Object3DSync=i})(window.Behaviors=window.Behaviors||{});"use strict";window.AudioContext=window.AudioContext||window.webkitAudioContext;(function(e,t,r){function n(e){var n={};i(function(){o(e)});c();function i(e){var t=new THREE.TextureLoader;var r=[{name:"box",url:"/static/models/box.png"},{name:"confettiLeftAO",url:"/static/models/leftao.png"},{name:"confettiRightAO",url:"/static/models/rightao.png"},{name:"check",url:"/static/check.png"},{name:"cross",url:"/static/cross.png"},{name:"suggestionTexture",url:"/static/suggestion.png"}];var i=r.length;r.forEach(function(r){t.load(r.url,function(t){n[r.name]=t;if(--i===0)e()})})}function o(e){var r=new THREE.ColladaLoader;var i=new altspace.utilities.shims.OBJMTLLoader;var o=8;r.load("/static/models/card.dae",function(r){t.card=r.scene.children[0].children[0];t.card.scale.set(2,2,2);t.blankCard=s({text:""});if(--o===0)e()});var a=297.444;var c=1/a*tableRadius*2;i.load("/static/models/nameplate/HaH_NamePlate.obj","/static/models/nameplate/HaH_NamePlate.mtl",function(r){r.rotation.x=Math.PI/2;r.scale.multiplyScalar(c);var n=1.5;r.position.z=-n+.8;var i=tableRadius*-1.05;r.position.y=-i-tableRadius*.94;t.nameplate=r;if(--o===0)e()});r.load("/static/models/box.dae",function(r){t.box=new THREE.Group;var i=r.scene.children[0].children[0].clone();i.scale.set(2,2,2);i.material=new THREE.MeshBasicMaterial({map:n.box});new TWEEN.Tween(i.position).to({z:.01},1e3).repeat(Infinity).yoyo(true).easing(TWEEN.Easing.Sinusoidal.InOut).start(performance.now()+500);t.box.add(i);var a=new THREE.Mesh(new THREE.PlaneGeometry(1,1),l("Open To Start"));a.rotation.x=-Math.PI/2;a.scale.set(4,1,1);a.scale.multiplyScalar(.1);a.position.z=-.2;t.box.add(a);if(--o===0)e()});r.load("/static/models/dialog.dae",function(r){t.dialog=r.scene.children[0];if(--o===0)e()});r.load("/static/models/confettiball.dae",function(r){t.confettiBall=r.scene.children[0];t.confettiBall.getObjectByName("left").children[0].material=new THREE.MeshBasicMaterial({map:n.confettiLeftAO,side:THREE.DoubleSide});t.confettiBall.getObjectByName("right").children[0].material=new THREE.MeshBasicMaterial({map:n.confettiRightAO,side:THREE.DoubleSide});if(--o===0)e()});i.load("/static/models/table/HaH_TableMain.obj","/static/models/table/HaH_TableMain.mtl",function(r){r.rotation.x=Math.PI/2;r.scale.multiplyScalar(c);var n=103;r.position.z=-n*c+.8;new TWEEN.Tween(r.children[1].material.map.offset).to({x:1},8e5).repeat(Infinity).start();t.table=r;if(--o===0)e()});i.load("/static/models/playerIndicator/HaH_PlayerSlice.obj","/static/models/playerIndicator/HaH_PlayerSlice.mtl",function(r){r.rotation.x=Math.PI/2;r.rotation.y=Math.PI;r.scale.multiplyScalar(c);var n=104.229;var i=1.5;r.position.z=-n*c-i+.8;var a=tableRadius*-1.05;r.position.y=-a;t.playerIndicator=r;var s=r.clone();s.children[1].visible=false;root.add(s);if(--o===0)e()});i.load("/static/models/trophy/HaH_Trophy.obj","/static/models/trophy/HaH_Trophy.mtl",function(r){t.pointModel=r;if(--o===0)e()});t.yesBox=new THREE.Mesh(new THREE.BoxGeometry(.01,.1,.1),new THREE.MeshBasicMaterial({map:n.check}));t.noBox=new THREE.Mesh(new THREE.BoxGeometry(.01,.1,.1),new THREE.MeshBasicMaterial({map:n.cross}));t.boxHoverEffect=function(){var e=new THREE.Group;var t=new THREE.MeshBasicMaterial({color:"#199597"});var r=new THREE.Mesh(new THREE.RingGeometry(1.5,2,20),t);r.position.z=.7;r.scale.multiplyScalar(.1);new TWEEN.Tween(r.position).to({z:.8},2e3).repeat(Infinity).yoyo(true).easing(TWEEN.Easing.Sinusoidal.InOut).start();e.add(r);var n=new THREE.Mesh(new THREE.RingGeometry(2.2,2.7,20),t);n.position.z=.7;n.scale.multiplyScalar(.1);new TWEEN.Tween(n.position).to({z:.8},2e3).repeat(Infinity).yoyo(true).easing(TWEEN.Easing.Sinusoidal.InOut).start(performance.now()+200);e.add(n);var i=new THREE.Mesh(new THREE.RingGeometry(.9,1.4,20),t);i.position.z=.7;i.scale.multiplyScalar(.1);new TWEEN.Tween(i.position).to({z:.8},2e3).repeat(Infinity).yoyo(true).easing(TWEEN.Easing.Sinusoidal.InOut).start(performance.now()+500);e.add(i);return e}()}function a(e,t){var n=new XMLHttpRequest;n.open("GET",e,true);n.responseType="arraybuffer";n.onload=function(){if(n.status===200||n.status===304){r.ctx.decodeAudioData(n.response,function(e){var n=r.ctx.createGain();n.connect(r.masterVol);t(e,n)},function(t){console.error("Failed to decode audio",e,t)})}};n.send()}function c(){r.ctx=new AudioContext;r.masterVol=r.ctx.createGain();r.masterVol.connect(r.ctx.destination);r.masterVol.gain.value=.25;a("/static/audio/fanfare with pop.ogg",function(e,t){r.fanfare=e;r.fanfareVol=t});a("/static/audio/ding ding.ogg",function(e,t){r.ding=e;r.dingVol=t});a("/static/audio/card_flick.ogg",function(e,t){r.card=e;r.cardVol=t});a("/static/audio/gameStart.ogg",function(e,t){r.gameStart=e;r.gameStartVol=t});a("/static/audio/playerJoin.ogg",function(e,t){r.playerJoin=e;r.playerJoinVol=t});a("/static/audio/playerKick.ogg",function(e,t){r.playerKick=e;r.playerKickVol=t})}}r.playSound=function(e){var t=r.ctx.createBufferSource();t.buffer=r[e];t.connect(r[e+"Vol"]);if(e==="fanfare")t.start(0,1.4);else t.start(0)};if(/AltspaceVR-App build-[0-9a-f]{7} Mobile/.test(window.navigator.userAgent)){var i=.85}else{i=1}function o(e,t,r){var n=Math.max.apply(null,t.map(function(t){return e.measureText(t).width}));if(n>r){var i=e.font;var o=/[0-9.]+px/.exec(i)[0];var a=parseFloat(o);a=r/n*a;i=i.replace(o,a+"px");e.font=i}}function a(e){var t=e.split(" ");var r=0;return t.reduce(function(e,t){if(r+t.length>17){e.push("");r=0}e[e.length-1]+=" "+t;r+=t.length;return e},[""])}function s(e,r){if(r==="black"){var n="#eee";var s="black"}else{n="black";s="#eee"}var c=256;var u=t.card.clone();var l='"Helvetica Neue", Helvetica, Arial, Sans-Serif';var h=document.createElement("canvas");var f=h.getContext("2d");h.width=2*c;h.height=2*c;f.fillStyle=s;f.fillRect(0,0,2*c,2*c);f.fillStyle=n;f.textAlign="left";f.font="bold "+.09*c*i+"px "+l;var p=e.text;if(p.indexOf("\n")===-1){p=a(e.text)}else{p=p.split("\n")}o(f,p,.84*c);for(var d=0;d<p.length;d++){f.fillText(p[d],.08*c,(.15+.12*d)*c)}if(e.numResponses){f.font="bold "+.07*c*i+"px "+l;o(f,["PICK 2"],.25*c);f.textAlign="right";f.fillText("PICK",.85*c,1.33*c);f.beginPath();f.arc(.91*c,1.303*c,.04*c,0,2*Math.PI);f.closePath();f.fill();f.textAlign="center";f.fillStyle=s;f.fillText(e.numResponses,.91*c,1.33*c);f.fillStyle=n;f.textAlign="left"}if(e.numDraws){f.font="bold "+.07*c*i+"px "+l;o(f,["DRAW 2"],.3*c);f.textAlign="right";f.fillText("DRAW",.85*c,1.22*c);f.beginPath();f.arc(.91*c,1.192*c,.04*c,0,2*Math.PI);f.closePath();f.fill();f.textAlign="center";f.fillStyle=s;f.fillText(e.numDraws,.91*c,1.22*c);f.fillStyle=n;f.textAlign="left"}var m=1/16*c;var E=.08*c,g=1.33*c;f.lineWidth=2;f.strokeStyle=n;f.moveTo(E,g);f.lineTo(E+m/2,g-m*Math.sin(Math.PI/3));f.lineTo(E+m,g);f.moveTo(E+m/4,g);f.lineTo(E+3*m/4,g);f.stroke();f.textAlign="left";f.font=.05*c*i+"px "+l;if(e.creator){f.fillText(e.creator,E+1.5*m,g)}else if(e.numResponses||e.numDraws){f.fillText("HAH",E+1.5*m,g)}else{o(f,["Holograms Against Humanity"],.6525*c);f.fillText("Holograms Against Humanity",E+1.5*m,g)}f.font="bold "+.15*c*i+"px "+l;o(f,["Holograms","Against","Humanity"],.8*c);f.fillText("Holograms",1.1*c,.22*c);f.fillText("Against",1.1*c,.37*c);f.fillText("Humanity",1.1*c,.52*c);u.material=new THREE.MeshBasicMaterial({map:new THREE.CanvasTexture(h)});u.userData=e;return u}function c(){var e=256;var r=t.card.clone();var n='"Helvetica Neue", Helvetica, Arial, Sans-Serif';var a=document.createElement("canvas");var s=a.getContext("2d");a.width=2*e;a.height=2*e;s.fillStyle="black";s.fillRect(0,0,2*e,2*e);s.font="bold "+.15*e*i+"px "+n;o(s,["Holograms","Against","Humanity"],.8*e);s.fillStyle="white";s.fillText("Holograms",.1*e,.22*e);s.fillText("Against",.1*e,.37*e);s.fillText("Humanity",.1*e,.52*e);s.fillText("Holograms",1.1*e,.22*e);s.fillText("Against",1.1*e,.37*e);s.fillText("Humanity",1.1*e,.52*e);s.font="bold "+.05*e*i+"px "+n;var c=["© Cards Against Humanity LLC","Licensed under CC BY-NC-SA","cardsagainsthumanity.com","Adapted for AltspaceVR by:","Derogatory, falkrons, schmidtec"];o(s,c,.86*e);for(var u=0;u<c.length;u++){s.fillText(c[u],.07*e,(1.06+.07*u)*e);s.fillText(c[u],1.07*e,(1.06+.07*u)*e)}r.material=new THREE.MeshBasicMaterial({map:new THREE.CanvasTexture(a)});return r}function u(e,t){var r=256;var n='"Helvetica Neue", Helvetica, Arial, Sans-Serif';var a=document.createElement("canvas");var s=a.getContext("2d");a.width=r;a.height=t.height||r;s.fillStyle=t.backgroundColor;s.fillRect(0,0,r,t.height||r);s.font="bold "+(t.fontScale||.1)*a.height*i+"px "+n;o(s,[e],.9*r);s.textAlign="center";if(t.textBaseline){s.textBaseline=t.textBaseline}s.fillStyle="white";if(t.single){s.lineWidth=5;s.strokeText(e,r/2,a.height/2);s.fillText(e,r/2,a.height/2)}else{s.fillText(e,r/2,35);s.fillText(e,r/2,86)}return new THREE.MeshBasicMaterial({map:new THREE.CanvasTexture(a)})}function l(e){var t=u(e,{backgroundColor:"transparent",height:50,single:true,fontScale:1,textBaseline:"middle"});t.transparent=true;t.side=THREE.DoubleSide;return t}function h(e){var r=t.nameplate.clone();r.name="nameplate";var n;if(e===Game.playerInfo.displayName)n="magenta";else n="white";r.children[0].material=r.children[0].material.clone();r.children[0].material.color.setStyle(n);var i=new THREE.PlaneGeometry(35,8);var o=l(e,{single:true});var a=new THREE.Mesh(i,o);a.position.z=3.5;var s=new THREE.Object3D;s.rotation.x=-30*Math.PI/180;s.position.y=3.5;s.add(a);r.add(s);var c=new THREE.Mesh(i,o);c.position.z=-3.5;c.rotation.y=Math.PI;var u=new THREE.Object3D;u.rotation.x=30*Math.PI/180;u.position.y=3.5;u.add(c);r.add(u);return r}function f(e,n,i,o,a){a=a||{};var s=512;var c=t.dialog.clone();var u='"Helvetica Neue", Helvetica, Arial, Sans-Serif';var l=document.createElement("canvas");var h=l.getContext("2d");l.width=s;l.height=s;h.fillStyle="whitesmoke";h.fillRect(0,0,s,s-160);h.fillStyle="#f44336";h.fillRect(0,s-166,s/2,160);h.fillStyle="#4CAF50";h.fillRect(s/2,s-160,s/2,160);h.font="bold 35px "+u;h.textAlign="center";h.fillStyle="black";var f=e.split("\n");for(var d=1;d<=f.length;d++)h.fillText(f[d-1],s/2,50*d+50);h.font="bold 45px "+u;h.fillText("No",.25*s,s-70);h.fillText(a.acceptLabel||"Yes",.75*s,s-70);var m=new THREE.MeshBasicMaterial({map:new THREE.CanvasTexture(l)});c.traverse(function(e){e.material=m});if(a.showDecline!==undefined&&!a.showDecline){
c.getObjectByName("Decline").children[0].visible=false}c.getObjectByName("Accept").addEventListener("cursorup",function(){if(n)n();if(o)o();c.parent.remove(c)});c.getObjectByName("Decline").addEventListener("cursorup",function(){if(i)i();if(o)o();c.parent.remove(c)});var E=root.getObjectByName("seat_"+Game.playerInfo.id);c.applyMatrix(p(0,Math.PI/8,1.05*tableRadius,"yzx"));E.add(c);r.playSound("ding");return c}function p(e,t,r,n){if(!n||!/^[xyz]{3}$/.test(n))n="zyx";var i=r*Math.cos(t)*Math.sin(e);var o=r*Math.cos(t)*Math.cos(e);var a=r*Math.sin(t);var s={};s[n[0]]=new THREE.Vector3(-i,-o,-a).normalize();var c=(new THREE.Vector3).crossVectors(s[n[0]],new THREE.Vector3(0,0,1)).normalize();s[n[1]]=(new THREE.Vector3).crossVectors(c,s[n[0]]);s[n[2]]=n[0]<n[1]?c:c.negate();var u=new THREE.Matrix4;u.makeBasis(s.x,s.y,s.z);u.setPosition(new THREE.Vector3(i,o,a));return u}function d(e,r,n){e=e||[];r=r||[];var i=2*Math.PI/e.length;var o=e.map(function(e){return e.id});for(var a=0;a<e.length;a++){var s=root.getObjectByName("seat_"+e[a].id);if(s){s.addBehavior(new Behaviors.Animate(null,new THREE.Vector3(-1.05*tableRadius*Math.sin(a*i),-1.05*tableRadius*Math.cos(a*i),1.5),(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,0,1),-i*a)));if(Game.playerInfo.id===n){(function(e,t){e.addEventListener("cursorup",function(){f("Do you want to kick\n"+t.displayName+"?",function(){console.log("kicking");socket.emit("playerKickRequest",t.id,t.displayName)})})})(s.getObjectByName("nameplate"),e[a])}}else{s=new Utils.Seat(e[a].id,t);s.position.set(-1.05*tableRadius*Math.sin(a*i),-1.05*tableRadius*Math.cos(a*i),1.5);s.rotation.set(0,0,-i*a);var c=h(e[a].displayName);c.addBehavior(new Behaviors.CursorFeedback);s.add(c);var u=new THREE.Object3D;u.name="presentation";u.position.set(0,1.05*tableRadius,1);u.rotation.set(0,0,Math.PI);u.scale.set(6,6,6);s.add(u);if(e[a].id===Game.playerInfo.id){c.addEventListener("cursorup",function(){f("Are you sure you want to\nleave the game?",function(){socket.emit("playerLeave",Game.playerInfo.id,Game.playerInfo.displayName,Game.playerInfo.displayName+" has left the game.")})})}else if(o.indexOf(Game.playerInfo.id)>-1){(function(e,t){e.addEventListener("cursorup",function(){f("Do you want to kick\n"+t.displayName+"?",function(){console.log("kicking");socket.emit("playerKickRequest",t.id,t.displayName)})})})(c,e[a])}var l=.5,p=Math.PI/5,d=Math.PI/3,m=Math.PI/10,E=1.5*Math.PI/10;for(var g=0;g<12;g++){if(g<5){var v=(g-2)*m;var y=-p}else if(g<10){v=(g-7)*E;y=-d}else if(g===10){v=-3*m;y=-p}else if(g===11){v=3*m;y=-p}var b=new THREE.Object3D;b.name="card"+g;b.applyMatrix(Utils.sphericalToMatrix(v,y,l,"zyx"));s.add(b);if(e[a].id===Game.playerInfo.id)b.addBehavior(new Behaviors.CursorFeedback)}root.add(s)}}for(var T=0;T<r.length;T++){for(var R=0,w=false;R<e.length&&!w;R++){w=w||e[R].id===r[T].id}if(!w){var x=root.getObjectByName("seat_"+r[T].id);root.remove(x)}}}var m={};var E={};var g=function(){m=setTimeout(function(){clearTimeout(m);f("AFK WARNING\nAre you there?",v,function(){socket.emit("playerLeave",Game.playerInfo.id,Game.playerInfo.displayName,Game.playerInfo.displayName+" has left the game.")});E=setTimeout(function(){clearTimeout(E);Game.emitPlayerLeave();console.log("you have been kicked from the game due to inactivity.")},6e4)},3e5)};var v=function(){clearTimeout(E);clearTimeout(m)};e.preloadAssets=n;e.generateCard=s;e.generateTitleCard=c;e.generateStatusTextMaterial=l;e.generateNameplate=h;e.generateDialog=f;e.sphericalToMatrix=p;e.rebalanceTable=d;e.idleCheck=g;e.idleClear=v})(window.Utils=window.Utils||{},window.Models=window.Models||{},window.Sounds=window.Sounds||{});"use strict";var socket;var isInit=false;(function(e){var t=[];var r={};var n=[];var i=[];var o="";var a={};var s=[];var c=null;var u="";var l=false;var h=3;function f(e){if(altspace.inClient){altspace.getUser().then(function(e){if(e&&e.userId&&e.displayName){r.id=e.userId;r.displayName=e.displayName}else{console.log("you have been logged out of Coherent.");var t=document.createElement("h1");t.innerHTML="You've been logged out of Coherent. Log in to join.";document.body.insertBefore(t,document.body.children[0])}})}else{r.id=""+Math.floor(Math.random()*1e3);r.displayName="anon"+r.id}socket=io("/?gameId="+e);var t=socket.onevent;socket.onevent=function(e){var r=e.data||[];t.call(this,e);e.data=["*"].concat(r);t.call(this,e)};socket.on("*",function(){});socket.on("error",function(e){console.error(e)});socket.on("objectUpdate",function(e){window._syncStates=e});socket.on("init",m);socket.on("roundReset",g);socket.on("playerJoinRequest",v);socket.on("playerJoin",T);socket.on("playerJoinDenied",R);socket.on("playerLeave",w);socket.on("playerKickRequest",x);socket.on("dealCards",H);socket.on("roundStart",M);socket.on("cardSelection",C);socket.on("cardSelectionComplete",k);socket.on("presentSubmission",O);socket.on("winnerSelection",N);socket.on("reload",function(){console.log("reloading");location.reload()})}function p(){if(r.id)socket.emit("playerJoinRequest",r.id,r.displayName)}function d(){socket.emit("playerLeave",r.id,r.displayName,r.displayName+" has left the game.","idle-kicked")}function m(e,r,n,i,a){if(isInit){var s=/[&?]cacheBuster=([^&]+)/.exec(window.location.search);if(s)window.location.replace(window.location.search.replace(s[0],"&cacheBuster="+s[1]+"1"));else window.location.replace(window.location.search+"&cacheBuster=1")}else isInit=true;var c=gameObjects.presentation.getObjectByName("blackCard");if(c){gameObjects.presentation.remove(c)}Utils.rebalanceTable(e,t);t.splice(0);t.push.apply(t,e);b();e.forEach(function(e){var t=new Utils.Crown(e.id,e.wins);root.add(t)});gameObjects.box.removeEventListener("cursorup");gameObjects.box.addEventListener("cursorup",p);o=r;var u=["roundFinished","roundStarted","playerSelectionPending","czarSelectionPending"];if(u.indexOf(o)>=1)H(t.length>0?t[0].handLength:0,n,i);if(u.indexOf(o)>=2)M();if(u.indexOf(o)>=h)k(a)}function E(e){return root.getObjectByName("seat_"+(e||r.id))}function g(){if(c){c.parent.remove(c);c=null}u="";o="roundFinished";var e=E();if(e){i.forEach(function(t,r){var i=e.getObjectByName("selection"+r);if(!i){i=Utils.generateCard(n[t])}var o=e.getObjectByName("card"+t);i.position.set(0,0,0);i.rotation.set(0,0,0);i.scale.set(2,2,2);i.name="";o.add(i)});var t=e.getObjectByName("yes");var r=e.getObjectByName("no");e.remove(t,r);i=[];gameObjects.box.removeEventListener("cursorup");gameObjects.box.addEventListener("cursorup",function(){socket.emit("dealCards")});for(var l=0;l<12;l++){var h=e.getObjectByName("card"+l);h.removeEventListener("cursorup")}}for(var f in a){for(var p=0;p<a[f].length;p++){if(a[f][p].parent)a[f][p].parent.remove(a[f][p])}}a={};s=[]}function v(e,t){if(!l){var r=Utils.generateDialog("Can this player join?\n"+t,function(){socket.emit("playerJoin",e,t)},function(){socket.emit("playerJoinDenied",e,t)});r.name="join_"+e}}function y(){return new Promise(function(e){if(!r.skeleton){altspace.getThreeJSTrackingSkeleton().then(function(t){scene.add(t);r.skeleton=t;e(r.skeleton)})}else{e(r.skeleton)}})}function b(){var e=t.length;var r=e!==0;gameObjects.box.rotation.set(r?0:Math.PI,0,0);var n=gameObjects.box.children[1];n.position.z=r?.2:-.2;n.rotation.x=r?Math.PI/2:-Math.PI/2;if(altspace.inClient){y().then(function(e){var t=e.getJoint("Head");var i=t.position.clone();i.y=0;if(!r){i.applyEuler(new THREE.Euler(0,0,-Math.PI,"XYZ"))}i.applyEuler(new THREE.Euler(Math.PI/2,0,0,"XYZ"));i.applyEuler(new THREE.Euler(0,0,Math.PI/2,"XYZ"));i.normalize();n.quaternion.setFromUnitVectors(new THREE.Vector3(1,0,0),i);n.rotateX(r?Math.PI/2:-Math.PI/2)})}gameObjects.titleCard.visible=!r;var i=!!E();var a=e>=h;var s;var c=true;if(!r){s="Open To Start"}else if(o==="roundStarted"){s="";c=false}else if(i){if(a){s="Click To Deal"}else{var u=h-e;s="Need "+u+" More Player"+(u>1?"s":"");c=false}}else if(!i){s="Click To Join"}n.material=Utils.generateStatusTextMaterial(s);if(c){var l=gameObjects.box.position.z;new TWEEN.Tween(gameObjects.box.position).to({z:l+.04},200).repeat(5).yoyo(true).start(performance.now()+800)}}function T(e,n,i){Utils.rebalanceTable(i,t,e);t.splice(0);t.push.apply(t,i);if(t.length===1){Sounds.playSound("gameStart")}else{Sounds.playSound("playerJoin")}var a=new Utils.Crown(e);root.add(a);var s;var c=E();if(c){s=c.getObjectByName("join_"+e);if(s){c.remove(s)}}if(e===r.id){gameObjects.box.removeEventListener("cursorup");if(o==="roundFinished"){gameObjects.box.addEventListener("cursorup",function(){socket.emit("dealCards")})}else{s=Utils.generateDialog("Sit tight, you'll be\ndealt into the next round.",function(){c.remove(s)},null,null,{acceptLabel:"Ok",showDecline:false})}ga("send","event","player","join",gameId);if(altspace.inClient){y().then(function(e){var t=e.getJoint("Head");t.add(a);a.scale.multiplyScalar(root.scale.x);a.updateMatrix()})}else{camera.add(a)}}console.log("New player joined:",n);b()}function R(e){var t=E();var n=t.getObjectByName("join_"+e);if(n){t.remove(n)}if(e===r.id){l=true;setTimeout(function(){l=false},5e3)}}function w(e,n,i,o,a){Utils.rebalanceTable(i,t);t.splice(0);t.push.apply(t,i);if(e===r.id){ga("send","event","player",a?"leave-"+a:"leave",gameId);gameObjects.box.removeEventListener("cursorup");gameObjects.box.addEventListener("cursorup",p);root.traverse(function(e){if(e.name==="nameplate"){e.removeEventListener("cursorup")}})}var s=scene.getObjectByName("crown_"+e);if(s){scene.remove(s)}var c=E();if(c){var u=c.getObjectByName("kick_"+e);if(u){c.remove(u)}}b();if(a==="vote-kicked"){Sounds.playSound("playerKick")}console.log("Player",n,"has left the game.")}function x(e,t){if(e!==r.id){var n=Utils.generateDialog("Group Vote:\nDo you want to kick\n"+t+"?",function(){socket.emit("playerKickResponse",e,t,true)},function(){socket.emit("playerKickResponse",e,t,false)});n.name="kick_"+e}}function H(e,t,r){o="roundStarted";if(E()){gameObjects.box.removeEventListener("cursorup")}b();if(t&&(!c||t.index!==c.userData.index)){for(var n=0;n<s.length;n++){for(var i=0;i<s[n].length;i++){var a=s[n][i];if(a.parent)a.parent.remove(a)}}s=[];c=Utils.generateCard(t,"black");c.applyMatrix(Utils.sphericalToMatrix(0,-Math.PI/4,.4,"zyx"));c.scale.set(2,2,2);c.name="blackCard"}if(Array.isArray(e)){_(e,r)}else{S(e,r)}u=r}function _(e,t){ga("send","event","player-round","start",gameId);n=e;var i=E();var o=[];var a={};for(var s=0;s<12;s++){var u=i.getObjectByName("card"+s);for(var l=0;l<u.children.length;l++){var h=u.children[l];if(n.indexOf(h.userData.index)>=0)a[h.userData.index]=h;else u.remove(h)}o.push(u)}for(var f=0;f<n.length;f++){var p=a[n[f].index];if(p){p.addBehavior(new Behaviors.Animate(o[f],new THREE.Vector3(0,0,0),new THREE.Quaternion,new THREE.Vector3(2,2,2)))}else{if(n[f])p=Utils.generateCard(n[f],"white");else p=Models.blankCard.clone();gameObjects.box.add(p);p.addBehavior(new Behaviors.Animate(o[f],new THREE.Vector3(0,0,0),new THREE.Quaternion,new THREE.Vector3(2,2,2)))}if(t===r.id)p.visible=false}if(r.id===t){i.add(c);var d=c.position.z;var m=new TWEEN.Tween(c.position).to({z:d+.02},200).repeat(5).yoyo(true).start(performance.now()+500);c.addBehavior(new Behaviors.CursorFeedback);c.addEventListener("cursorup",function(){m.stop();c.position.z=d;c.removeAllBehaviors();c.scale.set(2,2,2);socket.emit("roundStart")});i.setIndicatorState("czar")}else{i.traverse(function(e){if(/^card/.test(e.parent.name))e.visible=true});i.setIndicatorState("submitting")}Sounds.playSound("card")}function S(e,n){for(var i=0;i<t.length;i++){var o=t[i];if(o.id===r.id)continue;var a=E(o.id);var s=[];for(var u=0;u<12;u++){s.push(a.getObjectByName("card"+u))}for(var l=0;l<s.length;l++){if(s[l].children.length===0){if(e<=10&&s[10].children.length>0){s[l].add(s[10].children[0])}else if(e<=10&&s[11].children.length>0){s[l].add(s[11].children[0])}else if(l<e){var h=Models.blankCard.clone();if(o.id===n)h.visible=false;gameObjects.box.add(h);h.addBehavior(new Behaviors.Animate(s[l],new THREE.Vector3(0,0,0),new THREE.Quaternion,new THREE.Vector3(2,2,2)))}}if(o.id===n&&s[l].children[0]){s[l].children[0].visible=false}}if(c&&o.id===n){a.add(c);a.setIndicatorState("czar")}else{a.traverse(function(e){if(/^card/.test(e.parent.name))e.visible=true});a.setIndicatorState("submitting")}}}function M(){o="playerSelectionPending";var e=E();if(e)var t=e.getObjectByName("presentation");else t=root.getObjectByName("presentation");c.position.set(0,0,0);c.rotation.set(-Math.PI/2,0,Math.PI);t.add(c);if(e&&r.id!==u){[0,1,2,3,4,5,6,7,8,9,10,11].forEach(function(t){var r=e.getObjectByName("card"+t);r.addEventListener("cursorup",function(){A(t)})})}}function A(t){var r=E();var n=r.getObjectByName("card"+t);if(i.length>=(c.userData.numResponses||1)){return}var o=.3;var a=n.children[0];a.name="selection"+i.length;var s=Utils.sphericalToMatrix(o*i.length/2,0,.5);s.multiply((new THREE.Matrix4).makeScale(2,2,2));a.addBehavior(new Behaviors.Animate(r,s));n.getBehaviorByType("CursorFeedback")._onCursorLeave();var u=r.getObjectByName("selection"+(i.length-1));if(u){s=Utils.sphericalToMatrix(o*i.length/2-o,0,.5);s.multiply((new THREE.Matrix4).makeScale(2,2,2));u.addBehavior(new Behaviors.Animate(null,s))}u=r.getObjectByName("selection"+(i.length-2));if(u){s=Utils.sphericalToMatrix(o*i.length/2-2*o,0,.5);s.multiply((new THREE.Matrix4).makeScale(2,2,2));u.addBehavior(new Behaviors.Animate(null,s))}i.push(t);if(i.length===(c.userData.numResponses||1)){var l=Models.yesBox.clone();var h=Models.noBox.clone();l.name="yes";l.addBehavior(new Behaviors.CursorFeedback);l.applyMatrix(Utils.sphericalToMatrix(.6,0,.5,"xyz"));r.add(l);h.name="no";h.addBehavior(new Behaviors.CursorFeedback);h.applyMatrix(Utils.sphericalToMatrix(-.6,0,.5,"xyz"));r.add(h);l.addEventListener("cursorup",e.confirmSelection=function(){socket.emit("cardSelection",i);r.remove(l,h)});h.addEventListener("cursorup",function(){i.forEach(function(e,t){var n=r.getObjectByName("selection"+t);var i=r.getObjectByName("card"+e);n.position.set(0,0,0);n.rotation.set(0,0,0);n.scale.set(2,2,2);n.name="";i.add(n)});i=[];r.remove(l,h)})}}function C(e,t){var n=E(t);n.setIndicatorState("submitted");var i=n.getObjectByName("yes");var o=n.getObjectByName("no");n.remove(i,o);if(t===r.id){for(var a=0;a<12;a++){var s=n.getObjectByName("card"+a);s.removeEventListener("cursorup")}}var c=E(u);var l=new THREE.Vector3(c.position.x/2,c.position.y/2,.825);var h=(new THREE.Quaternion).setFromEuler(new THREE.Euler(Math.PI,0,c.rotation.z));for(var f=0;f<e.length;f++){var p=n.getObjectByName("selection"+f)||n.getObjectByName("card"+e[f]).children[0];if(p){p.name="toCzarStack";p.addBehavior(new Behaviors.Animate(root,l,h,null,600,function(){if(!root.getObjectByName("czarStack")){console.log("naming something czarStack");this.name="czarStack"}else{this.parent.remove(this)}}))}}Sounds.playSound("card")}function k(e){o="czarSelectionPending";var t=[];for(var n in e){if(u===r.id&&e[n].length>0){ga("send","event","card-tracking","played-card",gameId)}for(var i=0;i<e[n].length;i++){e[n][i]=Utils.generateCard(e[n][i],"white")}e[n].playerId=n;var c=Math.floor(Math.random()*t.length);t.splice(c,0,e[n])}a=e;a[""]=[];s=t;for(var l=0;l<root.children.length;l++){var h=root.children[l];if(h.name==="czarStack"||h.name==="toCzarStack"){h.removeAllBehaviors();root.remove(h)}}var f=E(u);var p=new THREE.Vector3(f.position.x/2,f.position.y/2,.825);var d=(new THREE.Quaternion).setFromEuler(new THREE.Euler(Math.PI,0,f.rotation.z));t.forEach(function(e,t){var n=f.getObjectByName("card"+t);for(var i=0;i<e.length;i++){e[i].position.copy(p);e[i].quaternion.copy(d);root.add(e[i]);e[i].addBehavior(new Behaviors.Animate(n,new THREE.Vector3(0,.01*i,-.01*i),new THREE.Quaternion,new THREE.Vector3(2,2,2)))}if(u===r.id){n.addEventListener("cursorup",function(){console.log("Selecting submission at",t);n.getBehaviorByType("CursorFeedback")._onCursorLeave();L(t)})}})}function L(e){var t=E(u);var r=s[e];socket.emit("presentSubmission",r.playerId);var n=t.getObjectByName("yes");var i=t.getObjectByName("no");t.remove(n,i);var o=Models.yesBox.clone();n=new THREE.Object3D;n.add(o);var a=new THREE.Mesh(new THREE.PlaneGeometry(1,1),Utils.generateStatusTextMaterial("Winner"));a.rotation.y=Math.PI/2;a.scale.set(.5,.1,1);a.position.set(0,0,-.25);n.add(a);i=Models.noBox.clone();n.name="yes";n.addBehavior(new Behaviors.CursorFeedback);n.applyMatrix(Utils.sphericalToMatrix(.6,0,.5,"xyz"));n.addEventListener("cursorup",function(){socket.emit("winnerSelection",r.playerId);t.remove(n,i)});t.add(n);i.name="no";i.addBehavior(new Behaviors.CursorFeedback);i.applyMatrix(Utils.sphericalToMatrix(-.6,0,.5,"xyz"));i.addEventListener("cursorup",function(){socket.emit("presentSubmission","");t.remove(n,i)});t.add(i)}var P="";function O(e){var t=E();if(t)var r=t.getObjectByName("presentation");else r=gameObjects.presentation;var n=a[e];if(P&&P!==e){var i=E(u);var o=s.indexOf(a[P]);var c=i.getObjectByName("card"+o);for(var l=0;l<s[o].length;l++){var f=s[o][l];f.addBehavior(new Behaviors.Animate(c,new THREE.Vector3(0,.01*l,-.01*l),new THREE.Quaternion,new THREE.Vector3(2,2,2)))}}P=e;var p=r.getObjectByName("blackCard");var d=.15;p.addBehavior(new Behaviors.Animate(null,p.position.clone().setX(n.length*d/2)));for(var m=0;m<n.length;m++){var g=n[m];g.addBehavior(new Behaviors.Animate(r,new THREE.Vector3(-d*(m+1)+n.length*d/2,0,0),(new THREE.Quaternion).setFromEuler(new THREE.Euler(-Math.PI/2,0,Math.PI)),new THREE.Vector3(2,2,2)))}if(n.length===h){r.scale.set(5,5,5)}else{r.scale.set(6,6,6)}Sounds.playSound("card")}function N(e){o="roundFinished";if(u===r.id&&a[e].length>0){ga("send","event","card-tracking","winner-chosen",gameId)}if(E()){gameObjects.box.addEventListener("cursorup",function(){socket.emit("dealCards")})}var t=E(e);var n=new Utils.Confetti({delay:1e3});n.position.copy(t.position);n.position.setZ(n.position.z+1.1);n.quaternion.copy(t.quaternion);root.add(n);Sounds.playSound("fanfare");var s=scene.getObjectByName("crown_"+e);if(s){s.addCard(c)}t.addPoint();a={};i=[];P="";var l=root.getObjectByName("czarStack");root.remove(l);var h=E();if(h){for(var f=0;f<12;f++){var p=h.getObjectByName("card"+f);p.removeEventListener("cursorup")}var d=h.getObjectByName("yes"),m=h.getObjectByName("no");h.remove(d,m);ga("send","event","player-round","end",gameId)}b()}e.socket=socket;e.turnOrder=t;e.playerInfo=r;e.emitPlayerLeave=d;e.connectToGame=f})(window.Game=window.Game||{});"use strict";(function(e){function t(e){THREE.Object3D.call(this);e=e||{};var t=e.particleCount||40;var r=e.explosiveForce||5;var n=e.delay||500;this.particleArray=[];var i=[16711680,65280,255,16776960,16711935,65535];for(var o=0;o<t;o++){var a=new THREE.Mesh(new THREE.BoxGeometry(.06,.06,.06),new THREE.MeshBasicMaterial({color:i[Math.floor(Math.random()*6)]}));a.velocity=new THREE.Vector3(Math.random()-.5,Math.random()-.5,-Math.random());a.velocity.setLength(r*Math.random());this.particleArray.push(a)}this.sphere=Models.confettiBall.clone();this.add(this.sphere);var s=this;setTimeout(function(){s.play()},n)}t.prototype=new THREE.Object3D;t.prototype.play=function(){this.sphere.getObjectByName("right").addBehavior(new Behaviors.Animate(null,null,(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,-Math.PI/4,0)),null,200));this.sphere.getObjectByName("left").addBehavior(new Behaviors.Animate(null,null,(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,Math.PI/4,0)),null,200));this.add.apply(this,this.particleArray);this.addBehavior(new r);setTimeout(function(){this.parent.remove(this)}.bind(this),3e3)};t.prototype.updateParticles=function(e){var t=new THREE.Vector3(0,0,-2);for(var r=0;r<this.particleArray.length;r++){var n=this.particleArray[r];var i=new THREE.Vector3(0,0,0);var o=new THREE.Vector3;o.copy(n.velocity).negate().setLength(.9*n.velocity.lengthSq());i.add(o);i.add(t);i.multiplyScalar(e/1e3);n.velocity.add(i);n.position.add(n.velocity.clone().multiplyScalar(e/1e3))}};function r(){this.awake=function(e){this.target=e};this.update=function(e){this.target.updateParticles(e)}}e.Confetti=t})(window.Utils=window.Utils||{});"use strict";(function(e){var t=[[-1.6,3.9443045848797766e-32,-1.9594349641362686e-16,0,-1.9594349641362686e-16,-3.55271373174006e-16,1.6,0,0,1.6,3.55271373174006e-16,0,0,.125,.175,1],[-.9729368090629578,.5315178036689758,.45922014117240906,0,.4030035734176636,-.22016185522079468,1.1086554527282715,0,.5753107070922852,1.0530991554260254,3.3009173172615647e-9,0,.07848304510116577,.10530146211385727,.15576119720935822,1],[-.9729368090629578,-.531517744064331,-.45922020077705383,0,-.40300360321998596,-.22016192972660065,1.1086554527282715,0,-.5753106474876404,1.0530991554260254,6.713475642072808e-8,0,-.07848304510116577,.10530146211385727,.15576119720935822,1],[1.1102230246251565e-16,-2.7755575615628914e-17,-1,0,-.46656057238578796,.8844892382621765,-1.1102230246251565e-16,0,.8844892382621765,.46656057238578796,1.1102230246251565e-16,0,.11284460872411728,.05446406826376915,.11999999731779099,1],[5.225140320419541e-9,2.110491337248277e-8,1,0,.46656060218811035,.8844892382621765,-2.110491337248277e-8,0,-.8844892382621765,.46656060218811035,-5.225140764508751e-9,0,-.11284460872411728,.05446406826376915,.11999999731779099,1],[5.2251394322411215e-9,-4.163336342344337e-17,-1,0,.11435113847255707,.9934403896331787,-2.0816681711721685e-17,0,.9934403896331787,-.11435113847255707,5.2251394322411215e-9,0,.12503184378147125,-.02170942910015583,.11999999731779099,1],[7.59392548843607e-9,4.356159044593966e-10,1,0,-.11435118317604065,.9934403896331787,4.356159044593966e-10,0,-.9934403896331787,-.11435118317604065,7.59392548843607e-9,0,-.12503184378147125,-.02170942910015583,.11999999731779099,1]];function r(e,t){THREE.Object3D.call(this);this.name="crown_"+e;this.root=new THREE.Object3D;this.root.rotation.set(-Math.PI/2,0,Math.PI);this.root.scale.multiplyScalar(1.4);this.add(this.root);this.addBehavior(new Behaviors.Object3DSync(socket,e));t=t||[];for(var r=0;r<t.length;r++)this.addCard(Utils.generateCard(t[r],"black"))}r.prototype=new THREE.Object3D;r.prototype.constructor=r;r.prototype.addCard=function(e){var r=this.root.children.length;if(r>=t.length){console.log("card overflow",r);if(e&&e.parent)e.parent.remove(e);return}e.matrix.fromArray(t[r]);e.matrix.decompose(e.position,e.quaternion,e.scale);this.root.add(e)};e.Crown=r})(window.Utils=window.Utils||{});"use strict";(function(e){function t(e,t){THREE.Object3D.call(this);this.name="seat_"+e;this.pointModel=t.pointModel;this.numPoints=0;this.pointContainer=new THREE.Object3D;this.pointContainer.rotation.x=Math.PI/2;this.pointContainer.scale.multiplyScalar(.01);this.pointContainer.position.set(0,.3,-.71);this.add(this.pointContainer);var r=t.playerIndicator.clone();r.name="playerIndicator";var n=r.getObjectByName("PlayerSlice");n.material=n.material.clone();n.material.map=n.material.map.clone();n.material.map.needsUpdate=true;this.playerIndicatorTexture=n.material.map;this.playerIndicatorTexture.offset.set(0,.5);this.setIndicatorState("waiting");this.add(r)}t.prototype=new THREE.Object3D;t.prototype.constructor=t;t.prototype.addPoint=function(){var e=this.pointModel.clone();e.position.x=this.numPoints*5;this.pointContainer.add(e);this.pointContainer.position.x=-this.numPoints*5*.01/2;this.numPoints++};var r={waiting:{x:0,y:.75},submitting:{x:0,y:0},submitted:{x:0,y:.5},czar:{x:.5,y:0}};t.prototype.setIndicatorState=function(e){var t=new TWEEN.Tween(this.playerIndicatorTexture.offset).to({x:.25,y:.5},500).easing(TWEEN.Easing.Quartic.In);var n=new TWEEN.Tween(this.playerIndicatorTexture.offset).to(r[e],500).easing(TWEEN.Easing.Quartic.Out);t.chain(n).start();this.indicatorState=e};e.Seat=t})(window.Utils=window.Utils||{});"use strict";if(typeof String.prototype.trim==="undefined"){String.prototype.trim=function(){return String(this).replace(/^\s+|\s+$/g,"")}}THREE.Object3D.prototype.removeEventListener=function(e,t){if(this._listeners===undefined)return;var r=this._listeners[e];if(r!==undefined){var n=r.indexOf(t);if(t===undefined){r.splice(0)}else if(n!==-1){r.splice(n,1)}}};var renderer;var camera;var scene=new THREE.Scene;var root=new THREE.Object3D;var gameId;scene.add(root);var gameObjects={};var tableRadius=1.75;var staticPage=['<p style="width:250px; height:350px; background-color:black; color:white;'+'font:bold 45px sans-serif; padding:20px; border-radius:5px;">',"Holograms<br/>","Against<br/>","Humanity","</p>"].join("\n");if(altspace.inClient){renderer=altspace.getThreeJSRenderer();altspace.getEnclosure().then(function(e){root.scale.set(e.pixelsPerMeter,e.pixelsPerMeter,e.pixelsPerMeter);root.position.setY(-e.innerHeight/2);root.rotation.set(-Math.PI/2,0,0);root.userData=e;var t=.5*Math.min(e.innerWidth,e.innerDepth)/e.pixelsPerMeter;tableRadius=Math.min(tableRadius,t-.5);if(e.innerDepth<10){document.body.innerHTML=staticPage}else{Utils.preloadAssets(init)}});altspace.open("https://docs.google.com/forms/d/1UHU5_WUsz9hoDdkiyiouvl5u49NgNUSA_ZS6qyXOtJk/viewform","_experience",{icon:window.location.origin+"/static/icon.png",hidden:true})}else{root.userData={innerWidth:3,innerDepth:3,innerHeight:3,pixelsPerMeter:1};renderer=new THREE.WebGLRenderer;renderer.setSize(1280,720);renderer.setClearColor(8947848);document.body.appendChild(renderer.domElement);camera=new THREE.PerspectiveCamera(45,1280/720,.01,1e3);camera.up.set(0,0,5);camera.position.set(0,6*tableRadius,1.5);camera.lookAt(new THREE.Vector3(0,0,0));root.add(camera);root.add(new THREE.AmbientLight(16777215));altspace.utilities.shims.cursor.init(scene,camera,{renderer:renderer});Utils.preloadAssets(init)}function init(){root.addEventListener("cursorenter",Utils.idleClear);root.addEventListener("cursorleave",Utils.idleCheck);root.add(Models.table);gameObjects.box=Models.box;gameObjects.box.position.set(0,0,.8+.025+.07);gameObjects.box.rotation.set(Math.PI,0,0);gameObjects.box.addBehavior(new Behaviors.CursorFeedback);root.add(gameObjects.box);root.add(Models.boxHoverEffect);gameObjects.presentation=new THREE.Object3D;gameObjects.presentation.name="presentation";gameObjects.presentation.position.set(0,0,2.5);gameObjects.presentation.scale.set(6,6,6);gameObjects.presentation.addBehavior(new Behaviors.Rotate(0,0,.5));gameObjects.titleCard=Utils.generateTitleCard();gameObjects.titleCard.rotation.set(Math.PI/2,0,0);gameObjects.titleCard.visible=false;gameObjects.presentation.add(gameObjects.titleCard);root.add(gameObjects.presentation);gameId=/[?&]gameId=(\w+)\b/.exec(window.location.search);if(gameId)gameId=gameId[1];if(!gameId){var e=document.createElement("h1");e.innerHTML='No game room specified! Add a "gameId" query argument.';document.body.insertBefore(e,document.body.children[0])}else{Game.connectToGame(gameId)}}function render(e){if(camera){var t=root.getObjectByName("seat_"+Game.playerInfo.id);if(t&&camera.fov!==90){camera.fov=90;camera.updateProjectionMatrix();camera.position.set(0,-.5,.1);camera.rotation.set(1.5,0,0);camera.lookAt(new THREE.Vector3(0,0,0));t.add(camera)}else if(!t){if(camera.fov!==45){camera.fov=45;camera.updateProjectionMatrix()}var r=e/2e4*2*Math.PI;camera.position.x=3*tableRadius*Math.sin(r);camera.position.y=3*tableRadius*Math.cos(r);camera.position.z=1.5;camera.lookAt(new THREE.Vector3(0,0,1.5))}}scene.updateAllBehaviors();TWEEN.update(e);renderer.render(scene,camera)}window.requestAnimationFrame(function e(t){window.requestAnimationFrame(e);render(t)});